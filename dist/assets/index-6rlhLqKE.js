const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginPage-Bb5IHeB_.js","assets/radix-ui-CnVU71F9.js","assets/react-vendor-BlRB0DQH.js","assets/refine-core-D1R8ysie.js","assets/NarrowCol-B73gMIta.js","assets/ui-utils-RTABDDyW.js","assets/utils-CbdUzxtX.js","assets/refine-ui-DbNfrzAU.js","assets/forms-D2HrApAI.js","assets/tables-CNfq072C.js","assets/RegisterFlow-DZwKpjsg.js","assets/ForgotPasswordPage-B7DOIhhG.js","assets/UpdatePasswordPage-Cf8JAKDI.js"])))=>i.map(i=>d[i]);
var qg=Object.defineProperty;var Vg=(e,s,n)=>s in e?qg(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n;var hi=(e,s,n)=>Vg(e,typeof s!="symbol"?s+"":s,n);import{j as t,S as jl,T as pm,I as Bg,a as fm,b as xm,P as Ug,C as gm,V as Wg,L as ym,c as jm,d as Kg,e as Gg,f as bm,R as Hg,g as Qg,h as wm,i as vm,F as Nm,k as km,l as Yg,m as zm,n as Sm,o as Zg,p as Jg,q as Cm,r as Xg,s as Tm,t as Am,u as Pm,v as Em,w as Dm,x as ey,y as sn,z as _m,A as bl,B as Ls,D as le,E as ty,G as sy,H as ny,J as Im,K as iy,M as ry,N as ay,O as oy,Q as Mm,U as Lm,W as Om,X as ha,Y as ly,Z as cy,_ as dy,$ as uy,a0 as my,a1 as hy,a2 as py,a3 as fy,a4 as xy,a5 as gy,a6 as yy,a7 as jy,a8 as Rm,a9 as by,aa as wy,ab as vy,ac as nd}from"./radix-ui-CnVU71F9.js";import{k as Ny,a as x,e as Z,l as L,n as Ji,N as Ts,d as wl,u as Ze,R as G,h as gi,o as pa,p as ky,O as zy,B as Sy}from"./react-vendor-BlRB0DQH.js";import{c as Cy,t as O,a as Fm,v as Ty,o as Bn,u as _n,b as vl,n as Xi,d as Qr,e as Ay,f as $m,E as Py,g as Nl,h as Ei,m as pt,i as Ey,j as Dy,k as Ns,s as Xa,r as _y,l as yi,p as xn,q as Iy,M as Cn,T as My}from"./utils-CbdUzxtX.js";import{d as kl,D as qm,E as Vm,o as Bm,n as Tt,e as zl,f as Oe,$ as Ae,k as Um,i as Ve,j as In,I as fa,X as cs,M as Wm,l as Ly,Q as Oy,m as Ry}from"./refine-core-D1R8ysie.js";import{c as Fy,_ as er,b as Km,I as Sl,k as Jt}from"./refine-ui-DbNfrzAU.js";import{t as $y,c as qy,a as xa,T as dt,Z as It,A as Ge,C as id,b as Ss,d as Di,G as Do,e as _i,f as rd,U as Ye,g as As,h as Gs,S as Ii,B as Me,i as Gm,j as ga,k as Vy,l as Ce,m as By,n as Fr,P as Hs,o as ks,p as Le,E as tr,q as qe,r as Lt,s as ya,u as Mn,v as ds,F as ft,w as Qt,x as je,y as Hm,L as Qs,z as Uy,D as st,W as Wy,H as Ky,I as Ps,J as Gy,R as ja,K as Hy,M as Cl,N as Ln,O as sr,Q as ad,X as xt,V as Qm,Y as Qy,_ as Tl,$ as Mi,a0 as Yy,a1 as Zy,a2 as Jy,a3 as Un,a4 as Al,a5 as nr,a6 as Ym,a7 as Xy,a8 as Pl,a9 as El,aa as Zm,ab as ej,ac as tj,ad as Tn,ae as sj,af as nj,ag as ij,ah as Jm,ai as od,aj as rj,ak as Yr,al as aj,am as oj,an as lj,ao as cj,ap as dj}from"./ui-utils-RTABDDyW.js";import{R as uj,A as mj,a as hj,X as pj,Y as fj}from"./tables-CNfq072C.js";import"./forms-D2HrApAI.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();var zr={},ld;function xj(){if(ld)return zr;ld=1;var e=Ny();return zr.createRoot=e.createRoot,zr.hydrateRoot=e.hydrateRoot,zr}var gj=xj();const yj="https://hqsyimochfcfqahcuprn.supabase.co",jj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhxc3lpbW9jaGZjZnFhaGN1cHJuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NjU4NTYsImV4cCI6MjA2OTQ0MTg1Nn0.KutvVrkDKuVyvrYQosU3SI6QrrMnWqDCSZ2E3fhCteI",te=Fy(yj,jj,{db:{schema:"public"},auth:{persistSession:!0}}),M=(...e)=>$y(qy(e)),bj={invalid_credentials:"Nieprawidłowy email lub hasło.","Invalid login credentials":"Nieprawidłowy email lub hasło.",email_not_confirmed:"Email nie został potwierdzony.","Email not confirmed":"Email nie został potwierdzony.",user_not_found:"Nie znaleziono użytkownika.","User not found":"Nie znaleziono użytkownika.",network_error:"Błąd połączenia z serwerem.","Too many requests":"Zbyt wiele prób. Spróbuj ponownie za chwilę."},wj=e=>{if(!e)return{message:"Nieznany błąd",name:"UnknownError",statusCode:500};const s=e.message||e.error_description||"";for(const[n,i]of Object.entries(bj))if(s.includes(n))return{message:i,name:"LoginError",statusCode:e.code==="invalid_credentials"?401:400};return{message:s||"Błąd logowania",name:"LoginError",statusCode:400}},Xm={login:async(e,s)=>{try{if(!e||!s)return{success:!1,error:"Email i hasło są wymagane"};const{data:n,error:i}=await te.auth.signInWithPassword({email:e.trim().toLowerCase(),password:s});if(i)return console.log("Login error:",i),{success:!1,error:wj(i).message};if(!n.session)return{success:!1,error:"Nie udało się utworzyć sesji"};const{data:r}=await te.from("users").select("role").eq("id",n.user.id).single();return{success:!0,redirectTo:r?.role?`/${r.role}`:"/profiles"}}catch(n){return{success:!1,error:n.message||"Nieznany błąd"}}},loginForRefine:async(e,s)=>{const n=await Xm.login(e,s);return n.success?n:{success:!1,error:{message:n.error,name:"LoginError",statusCode:400}}},checkAuth:async()=>{const{data:{session:e}}=await te.auth.getSession();return!!e}},vj={user_already_exists:"Konto z tym adresem email już istnieje","User already registered":"Konto z tym adresem email już istnieje","already exists":"Konto z tym adresem email już istnieje",weak_password:"Hasło musi mieć co najmniej 6 znaków","Password should be at least":"Hasło musi mieć co najmniej 6 znaków","Password cannot be longer than 72":"Hasło nie może być dłuższe niż 72 znaki",invalid_email:"Nieprawidłowy format adresu email","Invalid email":"Nieprawidłowy format adresu email",over_email_send_rate_limit:"Za szybko! Poczekaj 2 sekundy przed ponowną próbą"},cd=e=>{if(!e)return{message:"Nieznany błąd",name:"UnknownError",statusCode:500};const s=e.message||"";for(const[n,i]of Object.entries(vj))if(s.includes(n)){let r=400;return n.includes("already")&&(r=409),n.includes("email_send_rate")&&(r=429),{message:i,name:"RegisterError",statusCode:r}}return{message:s||"Rejestracja nie powiodła się",name:"RegisterError",statusCode:400}},eh={register:async(e,s,n)=>{try{const{data:i,error:r}=await te.auth.signUp({email:e.trim().toLowerCase(),password:s,options:{data:{full_name:n.trim(),role:"student"},emailRedirectTo:`${window.location.origin}/login?verified=true`}});return r?{success:!1,error:cd(r).message}:i.user?{success:!0,needsEmailConfirmation:!i.session}:{success:!1,error:"Rejestracja nie powiodła się"}}catch(i){return{success:!1,error:i.message||"Błąd rejestracji"}}},registerForRefine:async(e,s,n)=>{const i=await eh.register(e,s,n);return i.success?{success:!0,successNotification:i.needsEmailConfirmation?{message:"Rejestracja udana!",description:"Sprawdź email aby potwierdzić konto."}:{message:"Rejestracja udana!",description:"Możesz się teraz zalogować."}}:{success:!1,error:cd({message:i.error})}}},Nj={"User not found":"Nie znaleziono użytkownika z tym adresem email","Invalid email":"Nieprawidłowy format adresu email",over_email_send_rate_limit:"Za szybko! Poczekaj chwilę przed kolejną próbą",reset_password_rate_limit:"Zbyt wiele prób. Spróbuj ponownie za kilka minut"},dd=e=>{if(!e)return{message:"Nieznany błąd",name:"UnknownError",statusCode:500};const s=e.message||"";for(const[n,i]of Object.entries(Nj))if(s.includes(n))return{message:i,name:"ForgotPasswordError",statusCode:n.includes("rate_limit")?429:400};return{message:s||"Błąd podczas wysyłania emaila",name:"ForgotPasswordError",statusCode:400}},th={sendResetEmail:async e=>{try{const{error:s}=await te.auth.resetPasswordForEmail(e.trim().toLowerCase(),{redirectTo:`${window.location.origin}/update-password`});return s?{success:!1,error:dd(s).message}:{success:!0}}catch(s){return{success:!1,error:s.message||"Błąd podczas wysyłania emaila"}}},sendResetEmailForRefine:async e=>{const s=await th.sendResetEmail(e);return s.success?{success:!0,successNotification:{message:"Email wysłany!",description:"Sprawdź swoją skrzynkę odbiorczą"}}:{success:!1,error:dd({message:s.error})}}},kj={"New password should be different":"Nowe hasło musi być inne niż obecne","Password should be at least":"Hasło musi mieć co najmniej 6 znaków","Invalid token":"Link wygasł lub jest nieprawidłowy",session_not_found:"Sesja wygasła. Spróbuj ponownie"},ud=e=>{if(!e)return{message:"Nieznany błąd",name:"UnknownError",statusCode:500};const s=e.message||"";for(const[n,i]of Object.entries(kj))if(s.includes(n))return{message:i,name:"UpdatePasswordError",statusCode:n.includes("token")||n.includes("session")?401:400};return{message:s||"Błąd aktualizacji hasła",name:"UpdatePasswordError",statusCode:400}},sh={checkSession:async()=>{try{const{data:e}=await te.auth.getSession(),n=new URLSearchParams(window.location.hash.substring(1)).get("type");return!e.session&&n!=="recovery"?{isValid:!1,error:"Link wygasł lub jest nieprawidłowy"}:{isValid:!0}}catch{return{isValid:!1,error:"Błąd weryfikacji sesji"}}},updatePassword:async e=>{try{const{error:s}=await te.auth.updateUser({password:e});return s?{success:!1,error:ud(s).message}:{success:!0}}catch(s){return{success:!1,error:s.message||"Błąd aktualizacji hasła"}}},updatePasswordForRefine:async e=>{const s=await sh.updatePassword(e);return s.success?{success:!0,redirectTo:"/login?passwordChanged=true"}:{success:!1,error:ud({message:s.error})}}};class zj{constructor(){hi(this,"cache",null);hi(this,"lastFetch",0);hi(this,"CACHE_DURATION",300*1e3);hi(this,"fetchPromise",null)}async get(s=!1){const n=Date.now();if(!s&&this.cache&&n-this.lastFetch<this.CACHE_DURATION)return this.cache;if(this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetchUser();const i=await this.fetchPromise;return this.fetchPromise=null,i}async fetchUser(){try{const{data:{session:s}}=await te.auth.getSession();if(!s?.user)return this.clear(),null;const{data:n,error:i}=await te.from("users").select("*").eq("id",s.user.id).single();if(i||!n){console.error("Error fetching user data:",i);const a={id:s.user.id,email:s.user.email||"",full_name:s.user.user_metadata?.full_name||s.user.email?.split("@")[0]||"User",vendor_id:1,role:"student"};return this.set(a),a}const r={id:n.id,email:n.email,full_name:n.full_name,vendor_id:n.vendor_id,role:n.role,is_active:n.is_active,created_at:n.created_at};return this.set(r),r}catch(s){return console.error("Error in fetchUser:",s),this.clear(),null}}set(s){this.cache=s,this.lastFetch=Date.now()}clear(){this.cache=null,this.lastFetch=0,this.fetchPromise=null}async refresh(){return this.get(!0)}}const zs=new zj;te.auth.onAuthStateChange((e,s)=>{e==="SIGNED_OUT"||!s?zs.clear():(e==="SIGNED_IN"||e==="TOKEN_REFRESHED")&&zs.get(!0)});const eo={logout:async()=>{try{zs.clear();const{error:e}=await te.auth.signOut();return e?{success:!1,error:{message:"Błąd podczas wylogowania",name:"LogoutError",statusCode:500}}:{success:!0,redirectTo:"/login"}}catch{return{success:!1,error:{message:"Nieoczekiwany błąd podczas wylogowania",name:"LogoutError",statusCode:500}}}},check:async()=>{try{const{data:{session:e}}=await te.auth.getSession();if(!e)return{authenticated:!1,redirectTo:"/login"};const s=e.expires_at;return s&&s*1e3<Date.now()?{authenticated:!1,redirectTo:"/login"}:{authenticated:!0}}catch{return{authenticated:!1,redirectTo:"/login"}}},handleError:async e=>(console.error("Auth error:",e),e?.statusCode===401?(zs.clear(),{redirectTo:"/login",logout:!0,error:e}):{error:e})},Dl={login:async({email:e,password:s})=>{const n=await Xm.login(e,s);return n.success&&await zs.refresh(),n},logout:async()=>await eo.logout(),check:async()=>await eo.check(),getIdentity:async()=>await zs.get(),getPermissions:async()=>(await zs.get())?.role||null,register:async({email:e,password:s,name:n})=>await eh.registerForRefine(e,s,n),forgotPassword:async({email:e})=>await th.sendResetEmailForRefine(e),updatePassword:async({password:e})=>{const s=await sh.updatePasswordForRefine(e);return s.success&&await zs.clear(),s},onError:async e=>await eo.handleError(e)},ba=({isLoading:e,isError:s,loadingText:n="Loading...",errorMsg:i="Error loading data"})=>e?t.jsx("div",{className:"p-6 text-gray-600 animate-reverse-pulse",children:n}):s?t.jsx("div",{className:"p-6 text-red-500",children:i}):null;function Sj(e,s){let n;try{n=e()}catch{return}return{getItem:r=>{var a;const o=c=>c===null?null:JSON.parse(c,void 0),l=(a=n.getItem(r))!=null?a:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,a)=>n.setItem(r,JSON.stringify(a,void 0)),removeItem:r=>n.removeItem(r)}}const _o=e=>s=>{try{const n=e(s);return n instanceof Promise?n:{then(i){return _o(i)(n)},catch(i){return this}}}catch(n){return{then(i){return this},catch(i){return _o(i)(n)}}}},Cj=(e,s)=>(n,i,r)=>{let a={storage:Sj(()=>localStorage),partialize:f=>f,version:0,merge:(f,y)=>({...y,...f}),...s},o=!1;const l=new Set,c=new Set;let d=a.storage;if(!d)return e((...f)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...f)},i,r);const m=()=>{const f=a.partialize({...i()});return d.setItem(a.name,{state:f,version:a.version})},u=r.setState;r.setState=(f,y)=>{u(f,y),m()};const h=e((...f)=>{n(...f),m()},i,r);r.getInitialState=()=>h;let p;const g=()=>{var f,y;if(!d)return;o=!1,l.forEach(j=>{var w;return j((w=i())!=null?w:h)});const b=((y=a.onRehydrateStorage)==null?void 0:y.call(a,(f=i())!=null?f:h))||void 0;return _o(d.getItem.bind(d))(a.name).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==a.version){if(a.migrate){const w=a.migrate(j.state,j.version);return w instanceof Promise?w.then(S=>[!0,S]):[!0,w]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,j.state];return[!1,void 0]}).then(j=>{var w;const[S,k]=j;if(p=a.merge(k,(w=i())!=null?w:h),n(p,!0),S)return m()}).then(()=>{b?.(p,void 0),p=i(),o=!0,c.forEach(j=>j(p))}).catch(j=>{b?.(void 0,j)})};return r.persist={setOptions:f=>{a={...a,...f},f.storage&&(d=f.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>g(),hasHydrated:()=>o,onHydrate:f=>(l.add(f),()=>{l.delete(f)}),onFinishHydration:f=>(c.add(f),()=>{c.delete(f)})},a.skipHydration||g(),p||h},Tj=Cj;class Aj{static async call(s,n,i={}){const a={message:this.interpolateTemplate(n.user,i),...n.system&&{system:n.system},...s.model&&{model:s.model}},o=await fetch(s.endpoint,{method:"POST",headers:{"Content-Type":"application/json",...s.apiKey&&{Authorization:`Bearer ${s.apiKey}`}},body:JSON.stringify(a)});let l;try{l=await o.json()}catch{throw new Error(`LLM API Error: ${o.status} ${o.statusText}`)}if(!o.ok||l.error){const d=l.message||l.error||"Nieznany błąd",m=l.suggestion?` ${l.suggestion}`:"";throw new Error(`${d}${m}`)}const c=l.response||l;return n.responseFormat==="json"?this.parseJsonResponse(c):c}static interpolateTemplate(s,n){return s.replace(/\{\{(\w+)\}\}/g,(i,r)=>n[r]!==void 0?String(n[r]):i)}static cleanJsonResponse(s){let n=s;return n=n.replace(/```json\s*\n?([\s\S]*?)\n?```/g,"$1"),n=n.replace(/```\s*\n?([\s\S]*?)\n?```/g,"$1"),n.trim()}static parseJsonResponse(s){const n=this.cleanJsonResponse(s);try{return JSON.parse(n)}catch{try{const r=n.replace(/\\(\d+)\./g,"$1.");return JSON.parse(r)}catch{const a=s.match(/\{[\s\S]*\}/);if(a)try{const o=a[0].replace(/\\(\d+)\./g,"$1.");return JSON.parse(o)}catch{throw console.error("Failed to parse JSON response:",s),new Error("Nie udało się przetworzyć odpowiedzi JSON z API")}throw console.error("Failed to parse JSON response:",s),new Error("Nie udało się przetworzyć odpowiedzi JSON z API")}}}}const Pe=Cy()(Tj((e,s)=>({processes:{},formData:{},llmOperations:{},registeredLLMOperations:{},register:n=>e(i=>({processes:{...i.processes,[n.id]:n}})),unregister:(n,i="all")=>e(r=>{switch(i){case"all":{const{[n]:a,...o}=r.processes,{[n]:l,...c}=r.formData,d=Object.keys(r.llmOperations).filter(u=>!u.startsWith(`${n}-`)).reduce((u,h)=>(u[h]=r.llmOperations[h],u),{}),m=Object.keys(r.registeredLLMOperations).filter(u=>!u.startsWith(`${n}-`)).reduce((u,h)=>(u[h]=r.registeredLLMOperations[h],u),{});return{processes:o,formData:c,llmOperations:d,registeredLLMOperations:m}}case"data":{const{[n]:a,...o}=r.formData;return{...r,formData:o}}default:return r}}),get:n=>s().processes[n]||null,getSchemaFragment:n=>{const[i,...r]=n.split("."),a=s().processes[i];if(!a)return null;let o=a.schema;for(const l of r)o=o?.[l];return o},setData:(n,i)=>e(r=>({formData:{...r.formData,[n]:{...r.formData[n],...i}}})),getData:n=>s().formData[n]||{},reset:n=>e(i=>({formData:{...i.formData,[n]:{}}})),registerLLMOperation:(n,i)=>e(r=>({registeredLLMOperations:{...r.registeredLLMOperations,[`${n}-${i.id}`]:i}})),unregisterLLMOperation:(n,i)=>e(r=>{const{[`${n}-${i}`]:a,...o}=r.registeredLLMOperations;return{registeredLLMOperations:o}}),executeLLMOperation:async(n,i,r={})=>{const a=`${n}-${i}`,o=s().registeredLLMOperations[a];if(!o)throw new Error(`LLM Operation not found: ${a}`);try{s().setLLMOperationState(n,i,{loading:!0,error:null});const l=s().getData(n),c={...l,...r},d=o.inputMapping?o.inputMapping(c):c,m=await Aj.call(o.config,o.prompt,d);if(o.validation&&!o.validation(m))throw new Error("LLM result failed validation");let u=m;return o.outputMapping&&(u=o.outputMapping(m,l),s().setData(n,u)),s().setLLMOperationState(n,i,{loading:!1,error:null,result:m}),m}catch(l){throw s().setLLMOperationState(n,i,{loading:!1,error:l.message||"Unknown error",result:null}),l}},setLLMOperationState:(n,i,r)=>e(a=>({llmOperations:{...a.llmOperations,[`${n}-${i}`]:r}})),getLLMOperationState:(n,i)=>s().llmOperations[`${n}-${i}`]||{loading:!1,error:null},clearLLMOperation:(n,i)=>e(r=>{const{[`${n}-${i}`]:a,...o}=r.llmOperations;return{llmOperations:o}})}),{name:"form-schema-store",version:2,partialize:e=>({processes:e.processes,formData:e.formData})})),Wn=(e,s)=>{const{registerLLMOperation:n,unregisterLLMOperation:i,executeLLMOperation:r,getLLMOperationState:a,clearLLMOperation:o}=Pe();return{...a(e,s),registerOperation:h=>{n(e,h)},executeOperation:async h=>await r(e,s,h),clearOperation:()=>{o(e,s)},unregisterOperation:()=>{i(e,s)}}},Pj=xa("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),T=x.forwardRef(({className:e,variant:s,size:n,asChild:i=!1,...r},a)=>{const o=i?jl:"button";return t.jsx(o,{className:M(Pj({variant:s,size:n,className:e})),ref:a,...r})});T.displayName="Button";const B=x.forwardRef(({className:e,type:s,...n},i)=>t.jsx("input",{type:s,className:M("flex h-9 w-full rounded-md border border-input bg-background px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:i,...n}));B.displayName="Input";const Ej=xa("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function ne({className:e,variant:s,asChild:n=!1,...i}){const r=n?jl:"span";return t.jsx(r,{"data-slot":"badge",className:M(Ej({variant:s}),e),...i})}const Dj=()=>{const e=Z(),[s,n]=x.useState(0),[i,r]=x.useState("");x.useEffect(()=>{const o=()=>n(window.scrollY);return window.addEventListener("scroll",o),()=>window.removeEventListener("scroll",o)},[]);const a=[{name:"Sty",value:65},{name:"Lut",value:72},{name:"Mar",value:78},{name:"Kwi",value:85},{name:"Maj",value:88},{name:"Cze",value:94}];return t.jsxs("div",{className:"min-h-screen bg-white text-foreground",children:[t.jsx("nav",{className:"fixed top-0 w-full z-50 bg-white/80 backdrop-blur-xl border-b border-gray-100",children:t.jsx("div",{className:"container mx-auto px-6 py-4",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-600 to-purple-700 rounded-xl flex items-center justify-center",children:t.jsx(dt,{className:"w-5 h-5 text-white"})}),t.jsx("span",{className:"text-xl font-bold",children:"Smart Up"})]}),t.jsxs("div",{className:"hidden md:flex items-center gap-8",children:[t.jsx("a",{href:"#funkcje",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Funkcje"}),t.jsx("a",{href:"#kursy",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Kursy"}),t.jsx("a",{href:"#firma",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Dla firm"}),t.jsx("a",{href:"#cennik",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Cennik"}),t.jsx(T,{className:"bg-gray-900 hover:bg-gray-800 text-white text-sm px-6",onClick:()=>e("/login"),children:"Rozpocznij"})]})]})})}),t.jsx("section",{className:"pt-32 pb-20 overflow-hidden",children:t.jsx("div",{className:"container mx-auto px-6",children:t.jsxs("div",{className:"grid lg:grid-cols-12 gap-8 items-center",children:[t.jsxs("div",{className:"lg:col-span-5",children:[t.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-50 rounded-full mb-8",children:[t.jsx(It,{className:"w-4 h-4 text-purple-700"}),t.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Gamifikacja w edukacji"})]}),t.jsxs("h1",{className:"text-5xl md:text-6xl font-bold leading-tight mb-6",children:["Nauka, która",t.jsx("span",{className:"block text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"motywuje"})]}),t.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:"Przekształć edukację w angażującą przygodę. System poziomów, punktów i nagród sprawia, że nauka staje się uzależniająca."}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-12",children:[t.jsxs(T,{size:"lg",className:"bg-gray-900 hover:bg-gray-800 text-white px-8",onClick:()=>e("/login"),children:["Zacznij za darmo",t.jsx(Ge,{className:"ml-2 h-4 w-4"})]}),t.jsx(T,{size:"lg",variant:"outline",className:"border-gray-300",children:"Zobacz demo"})]}),t.jsxs("div",{className:"flex items-center gap-8",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold",children:"15k+"}),t.jsx("div",{className:"text-sm text-gray-500",children:"aktywnych uczniów"})]}),t.jsx("div",{className:"w-px h-12 bg-gray-200"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold",children:"92%"}),t.jsx("div",{className:"text-sm text-gray-500",children:"ukończalność"})]}),t.jsx("div",{className:"w-px h-12 bg-gray-200"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold",children:"4.9"}),t.jsx("div",{className:"text-sm text-gray-500",children:"ocena"})]})]})]}),t.jsx("div",{className:"lg:col-span-7",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute -inset-4 bg-gradient-to-r from-pink-600/5 to-purple-700/5 rounded-3xl blur-2xl"}),t.jsxs("div",{className:"relative bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[t.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-100",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-pink-600 to-purple-700 rounded-lg flex items-center justify-center",children:t.jsx(dt,{className:"w-4 h-4 text-white"})}),t.jsx("span",{className:"font-semibold",children:"Dashboard ucznia"})]}),t.jsx(ne,{className:"bg-green-50 text-green-700 border-green-200",children:"Online"})]})}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-pink-100 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(id,{className:"w-5 h-5 text-pink-600"}),t.jsx("span",{className:"text-xs text-gray-500",children:"+125"})]}),t.jsx("div",{className:"text-2xl font-bold",children:"1,842"}),t.jsx("div",{className:"text-xs text-gray-500",children:"Punkty XP"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(Ss,{className:"w-5 h-5 text-purple-700"}),t.jsx("span",{className:"text-xs text-gray-500",children:"75%"})]}),t.jsx("div",{className:"text-2xl font-bold",children:"Lvl 12"}),t.jsx("div",{className:"text-xs text-gray-500",children:"Poziom"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-teal-100 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(Di,{className:"w-5 h-5 text-teal-600"}),t.jsx("span",{className:"text-xs text-gray-500",children:"New!"})]}),t.jsx("div",{className:"text-2xl font-bold",children:"24"}),t.jsx("div",{className:"text-xs text-gray-500",children:"Odznaki"})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("span",{className:"text-sm font-medium",children:"Postęp nauki"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Ostatnie 6 miesięcy"})]}),t.jsx(uj,{width:"100%",height:120,children:t.jsxs(mj,{data:a,children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:"colorProgress",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:"#db2777",stopOpacity:.3}),t.jsx("stop",{offset:"95%",stopColor:"#db2777",stopOpacity:0})]})}),t.jsx(hj,{type:"monotone",dataKey:"value",stroke:"#db2777",strokeWidth:2,fill:"url(#colorProgress)"}),t.jsx(pj,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fontSize:11}}),t.jsx(fj,{hide:!0})]})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"font-medium",children:"Aktywne kursy"}),t.jsx("a",{href:"#",className:"text-purple-700 hover:underline",children:"Zobacz wszystkie"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-600 to-purple-700 rounded-lg flex items-center justify-center",children:t.jsx(Do,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-sm",children:"JavaScript: Gra w kodowanie"}),t.jsx("div",{className:"text-xs text-gray-500",children:"Rozdział 4 z 12"})]})]}),t.jsx(_i,{className:"w-4 h-4 text-gray-400"})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-teal-500 to-blue-600 rounded-lg flex items-center justify-center",children:t.jsx(rd,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-sm",children:"Analiza danych: Quest"}),t.jsx("div",{className:"text-xs text-gray-500",children:"Rozdział 7 z 10"})]})]}),t.jsx(_i,{className:"w-4 h-4 text-gray-400"})]})]})]})]})]})]})})]})})}),t.jsx("section",{id:"funkcje",className:"py-20 bg-gray-50",children:t.jsxs("div",{className:"container mx-auto px-6",children:[t.jsxs("div",{className:"text-center mb-16",children:[t.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Funkcje, które"," ",t.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"angażują"})]}),t.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"System zaprojektowany, aby uczynić naukę uzależniającą jak najlepsza gra"})]}),t.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-pink-600/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-pink-600 to-purple-700 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(dt,{className:"w-7 h-7 text-white"})}),t.jsx("h3",{className:"text-xl font-bold mb-3",children:"System poziomów"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"99 poziomów do zdobycia. Każdy poziom odblokowuje nowe możliwości i nagrody."}),t.jsxs("div",{className:"flex items-center text-sm text-pink-600 font-medium",children:["Dowiedz się więcej",t.jsx(Ge,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),t.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-700/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-700 to-teal-500 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(id,{className:"w-7 h-7 text-white"})}),t.jsx("h3",{className:"text-xl font-bold mb-3",children:"Idle Points"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Zdobywaj punkty nawet gdy nie uczysz się aktywnie. System pasywnego rozwoju."}),t.jsxs("div",{className:"flex items-center text-sm text-purple-700 font-medium",children:["Dowiedz się więcej",t.jsx(Ge,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),t.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-teal-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-teal-500 to-blue-600 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(Ss,{className:"w-7 h-7 text-white"})}),t.jsx("h3",{className:"text-xl font-bold mb-3",children:"Wyzwania"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Codzienne i tygodniowe wyzwania z dodatkowymi nagrodami za ukończenie."}),t.jsxs("div",{className:"flex items-center text-sm text-teal-600 font-medium",children:["Dowiedz się więcej",t.jsx(Ge,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),t.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-orange-500 to-yellow-500 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(Ye,{className:"w-7 h-7 text-white"})}),t.jsx("h3",{className:"text-xl font-bold mb-3",children:"Rankingi"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Rywalizuj z innymi uczniami. Rankingi globalne, lokalne i grupowe."}),t.jsxs("div",{className:"flex items-center text-sm text-orange-600 font-medium",children:["Dowiedz się więcej",t.jsx(Ge,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),t.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-700/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-700 to-pink-600 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(Di,{className:"w-7 h-7 text-white"})}),t.jsx("h3",{className:"text-xl font-bold mb-3",children:"Odznaki"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Kolekcjonuj unikalne odznaki za osiągnięcia i kamienie milowe."}),t.jsxs("div",{className:"flex items-center text-sm text-purple-700 font-medium",children:["Dowiedz się więcej",t.jsx(Ge,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),t.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-teal-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-teal-500 to-purple-700 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(rd,{className:"w-7 h-7 text-white"})}),t.jsx("h3",{className:"text-xl font-bold mb-3",children:"Analityka"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Szczegółowe statystyki postępów i personalizowane rekomendacje."}),t.jsxs("div",{className:"flex items-center text-sm text-teal-600 font-medium",children:["Dowiedz się więcej",t.jsx(Ge,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]})]})]})}),t.jsx("section",{className:"py-20 bg-white",children:t.jsxs("div",{className:"container mx-auto px-6",children:[t.jsxs("div",{className:"max-w-3xl mx-auto text-center mb-16",children:[t.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Jak to"," ",t.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"działa"})]}),t.jsx("p",{className:"text-lg text-gray-600",children:"Cztery proste kroki do rozpoczęcia nauki z gamifikacją"})]}),t.jsx("div",{className:"max-w-4xl mx-auto",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 top-0 bottom-0 w-0.5 bg-gray-200"}),t.jsx("div",{className:"space-y-12",children:[{number:"01",title:"Stwórz profil",description:"Wybierz swoją rolę i spersonalizuj doświadczenie nauki",icon:Ye,color:"from-pink-600 to-purple-700"},{number:"02",title:"Wybierz kursy",description:"Przeglądaj bibliotekę kursów i wybierz te, które Cię interesują",icon:As,color:"from-purple-700 to-teal-500"},{number:"03",title:"Ucz się i graj",description:"Rozwiązuj quizy, zdobywaj punkty i awansuj na kolejne poziomy",icon:Do,color:"from-teal-500 to-blue-600"},{number:"04",title:"Śledź postępy",description:"Monitoruj swoje osiągnięcia i rywalizuj z innymi",icon:Gs,color:"from-orange-500 to-yellow-500"}].map((o,l)=>t.jsx("div",{className:"relative",children:t.jsxs("div",{className:`flex items-center ${l%2===0?"flex-row":"flex-row-reverse"}`,children:[t.jsxs("div",{className:`w-5/12 ${l%2===0?"text-right pr-8":"text-left pl-8"}`,children:[t.jsxs("div",{className:`inline-flex items-center gap-4 mb-2 ${l%2===0?"flex-row-reverse":""}`,children:[t.jsx("h3",{className:"text-2xl font-bold",children:o.title}),t.jsx("span",{className:"text-4xl font-bold text-gray-200",children:o.number})]}),t.jsx("p",{className:"text-gray-600 text-lg",children:o.description})]}),t.jsx("div",{className:"w-2/12 flex justify-center",children:t.jsx("div",{className:`relative z-10 w-16 h-16 bg-gradient-to-br ${o.color} rounded-2xl flex items-center justify-center shadow-lg`,children:t.jsx(o.icon,{className:"w-8 h-8 text-white"})})}),t.jsx("div",{className:"w-5/12"})]})},l))})]})})]})}),t.jsx("section",{className:"py-20 bg-gradient-to-br from-gray-900 to-gray-800",children:t.jsx("div",{className:"container mx-auto px-6",children:t.jsx("div",{className:"grid md:grid-cols-4 gap-8",children:[{value:"15k+",label:"Aktywnych uczniów",icon:Ye},{value:"200+",label:"Kursów",icon:As},{value:"92%",label:"Ukończalność",icon:Ss},{value:"4.9/5",label:"Ocena",icon:Ii}].map((o,l)=>t.jsxs("div",{className:"text-center",children:[t.jsx(o.icon,{className:"w-8 h-8 mx-auto mb-4 text-white/60"}),t.jsx("div",{className:"text-4xl font-bold text-white mb-2",children:o.value}),t.jsx("div",{className:"text-sm text-white/60",children:o.label})]},l))})})}),t.jsx("section",{className:"py-20 bg-white",children:t.jsx("div",{className:"container mx-auto px-6",children:t.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[t.jsxs("h2",{className:"text-4xl font-bold mb-6",children:["Gotowy na naukę, która"," ",t.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"wciąga"}),"?"]}),t.jsx("p",{className:"text-lg text-gray-600 mb-8 max-w-2xl mx-auto",children:"Dołącz do tysięcy uczniów, którzy odkryli radość z nauki dzięki gamifikacji. Pierwsze 30 dni gratis."}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8",children:[t.jsx(B,{type:"email",placeholder:"twoj@email.pl",value:i,onChange:o=>r(o.target.value),className:"max-w-xs h-12"}),t.jsxs(T,{size:"lg",className:"bg-gradient-to-r from-pink-600 to-purple-700 hover:opacity-90 text-white px-8 h-12",onClick:()=>e("/login"),children:["Rozpocznij za darmo",t.jsx(Ge,{className:"ml-2 h-4 w-4"})]})]}),t.jsx("p",{className:"text-sm text-gray-500",children:"Bez karty kredytowej • Anuluj w każdej chwili • Pełny dostęp"})]})})}),t.jsx("footer",{className:"bg-gray-900 text-white py-12",children:t.jsx("div",{className:"container mx-auto px-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center",children:t.jsx(dt,{className:"w-4 h-4"})}),t.jsx("span",{className:"text-lg font-bold",children:"Smart Up"})]}),t.jsx("div",{className:"text-sm text-white/60",children:"© 2025 Smart Up. Wszystkie prawa zastrzeżone."})]})})})]})};console.log("1. Login index.tsx - ładowanie modułu");const _j=x.lazy(()=>(console.log("2. Login - rozpoczęcie lazy load"),er(()=>import("./LoginPage-Bb5IHeB_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(e=>(console.log("3. Login - moduł załadowany",e),e)))),Ij=()=>(console.log("4. Login - renderowanie fallback"),t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"Ładowanie logowania..."})]})})),nh=t.jsx(L,{path:"/login",element:t.jsx(x.Suspense,{fallback:t.jsx(Ij,{}),children:t.jsx(_j,{})})});console.log("5. Login module exported",nh);const Mj=x.lazy(()=>er(()=>import("./RegisterFlow-DZwKpjsg.js"),__vite__mapDeps([10,1,2,3,5,4,6,7,8,9]))),Lj=()=>t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"Przygotowywanie rejestracji..."})]})}),Oj=t.jsx(L,{path:"/register/*",element:t.jsx(x.Suspense,{fallback:t.jsx(Lj,{}),children:t.jsx(Mj,{})})}),Rj=x.lazy(()=>er(()=>import("./ForgotPasswordPage-B7DOIhhG.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9]))),Fj=()=>t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"Ładowanie formularza resetowania..."})]})}),$j=t.jsx(L,{path:"/forgot-password",element:t.jsx(x.Suspense,{fallback:t.jsx(Fj,{}),children:t.jsx(Rj,{})})}),qj=x.lazy(()=>er(()=>import("./UpdatePasswordPage-Cf8JAKDI.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9]))),Vj=()=>t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"Weryfikacja linku resetowania..."})]})}),Bj=t.jsx(L,{path:"/update-password",element:t.jsx(x.Suspense,{fallback:t.jsx(Vj,{}),children:t.jsx(qj,{})})}),Uj=({children:e,authKey:s})=>t.jsx(kl,{dataProvider:Sl(te),liveProvider:Km(te),authProvider:Dl,routerProvider:qm,resources:[],options:{syncWithLocation:!0,warnWhenUnsavedChanges:!0,useNewQueryKeys:!0,liveMode:"auto"},children:t.jsx(Ji,{children:t.jsx(L,{path:"/*",element:t.jsx(Vm,{fallback:t.jsx(Bm,{to:"/login"}),children:e},s)})})}),_l=({text:e="Ładowanie...",colorClass:s="border-blue-600"})=>t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:`animate-spin rounded-full h-12 w-12 border-b-2 ${s} mx-auto`}),t.jsx("p",{className:"mt-4 text-gray-600",children:e})]})}),ih=({children:e,allowedRoles:s,fallbackPath:n,loadingText:i,loadingColorClass:r})=>{const{data:a,isLoading:o}=Tt();return o?t.jsx(_l,{text:i,colorClass:r}):s.includes(a?.role)?t.jsx(t.Fragment,{children:e}):t.jsx(Ts,{to:n,replace:!0})},Il=({routes:e,layout:s,defaultPath:n="dashboard",resources:i=[]})=>t.jsx(kl,{dataProvider:Sl(te),liveProvider:Km(te),authProvider:Dl,routerProvider:qm,resources:i,options:{syncWithLocation:!0,warnWhenUnsavedChanges:!0,useNewQueryKeys:!0,liveMode:"auto"},children:s||t.jsxs(Ji,{children:[t.jsx(L,{index:!0,element:t.jsx(Ts,{to:n,replace:!0})}),...e,t.jsx(L,{path:"*",element:t.jsx(Ts,{to:n,replace:!0})})]})}),Wj=Object.freeze(Object.defineProperty({__proto__:null,ModulePanel:Il},Symbol.toStringTag,{value:"Module"})),R=x.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:M("rounded-xl border bg-card text-card-foreground shadow flex flex-col overflow-hidden",e),...s}));R.displayName="Card";const W=x.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:M("flex flex-col space-y-1.5 p-6 pb-3 bg-pink-200/25",e),...s}));W.displayName="CardHeader";const U=x.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:M("text-lg font-semibold leading-tight tracking-tight pt-3",e),...s}));U.displayName="CardTitle";const rh=x.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:M("text-sm text-muted-foreground",e),...s}));rh.displayName="CardDescription";const F=x.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:M("p-3 lg:p-6 pt-3 space-y-3 flex-1 bg-background",e),...s}));F.displayName="CardContent";const Kj=x.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:M("flex items-center justify-between p-6 pt-0",e),...s}));Kj.displayName="CardFooter";const Gj={"between-center":"flex justify-between items-center gap-2",center:"flex justify-center items-center gap-2",start:"flex justify-start items-center gap-2",end:"flex justify-end items-center gap-2"},I=({children:e,variant:s="between-center",className:n=""})=>{const i=Gj[s],r=n?`${i} ${n}`:i;return t.jsx("div",{className:r,children:e})},Hj={"1-2-3":"grid gap-6 md:grid-cols-2 lg:grid-cols-3","1-2-2":"grid gap-6 md:grid-cols-2","1-1-1":"grid gap-6","2-2-4":"grid gap-6 grid-cols-2 lg:grid-cols-4"},be=({children:e,variant:s="1-2-3",className:n=""})=>{const i=Hj[s],r=n?`${i} ${n}`:i;return t.jsx("div",{className:r,children:e})},Qj={card:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},lg:{wrap:"space-y-0",title:"text-3xl font-bold tracking-tight",description:"text-muted-foreground"},md:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},sm:{wrap:"space-y-1",title:"font-medium text-sm text-muted-foreground mb-1",description:"text-sm"}},ce=({title:e,description:s,variant:n="lg"})=>{const i=Qj[n],r=()=>{switch(n){case"lg":return t.jsx("h1",{className:i.title,children:e});case"md":return t.jsx("h2",{className:i.title,children:e});case"sm":return t.jsx("h3",{className:i.title,children:e});default:return t.jsx("h1",{className:i.title,children:e})}};return n==="card"?t.jsxs(t.Fragment,{children:[t.jsx(U,{className:"text-lg font-semibold leading-tight flex items-center gap-2",children:e}),t.jsx(rh,{className:"text-sm text-muted-foreground mt-2",children:s})]}):t.jsx(t.Fragment,{children:t.jsxs("div",{className:i.wrap,children:[r(),t.jsx("p",{className:`prose ${i.description}`,children:s})]})})},q=({children:e})=>t.jsx("div",{className:"p-2 md:p-12 space-y-6 max-w-7xl mx-auto",children:e}),Yj=()=>{const{data:e,isLoading:s}=Tt(),[n,i]=x.useState(null),[r,a]=x.useState(!0);return x.useEffect(()=>{if(s||!e?.vendor_id){a(!1);return}let o=!0;return(async()=>{try{const[c,d,m,u,h]=await Promise.all([te.from("users").select("*",{count:"exact",head:!0}).eq("vendor_id",e.vendor_id),te.from("courses").select("*",{count:"exact"}).eq("vendor_id",e.vendor_id),te.from("activities").select("*, topics!inner(course_id, courses!inner(vendor_id))",{count:"exact"}).eq("topics.courses.vendor_id",e.vendor_id),te.from("activity_progress").select("score, completed_at").not("completed_at","is",null),te.from("user_stats").select("total_points")]);if(!o)return;const p=u.data?.length?u.data.reduce((f,y)=>f+(y.score||0),0)/u.data.length:0,g=h.data?.reduce((f,y)=>f+y.total_points,0)||0;i({totalUsers:c.count||0,activeUsers:c.count||0,totalCourses:d.count||0,publishedCourses:d.data?.filter(f=>f.is_published).length||0,totalActivities:m.count||0,completedActivities:u.data?.length||0,averageScore:Math.round(p),totalPoints:g})}catch(c){console.error("Error fetching dashboard stats:",c)}finally{o&&a(!1)}})(),()=>{o=!1}},[e?.vendor_id,s]),r||s?t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e?t.jsxs(q,{children:[t.jsx(ce,{title:"Dashboard",description:"Przegląd statystyk systemu e-learning"}),t.jsxs(be,{variant:"1-2-2",children:[t.jsxs(R,{children:[t.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(U,{className:"text-sm font-medium",children:"Użytkownicy"}),t.jsx(Ye,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(F,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n?.totalUsers||0}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[n?.activeUsers||0," aktywnych"]})]})]}),t.jsxs(R,{children:[t.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(U,{className:"text-sm font-medium",children:"Kursy"}),t.jsx(Me,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(F,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n?.totalCourses||0}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[n?.publishedCourses||0," opublikowanych"]})]})]}),t.jsxs(R,{children:[t.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(U,{className:"text-sm font-medium",children:"Aktywności"}),t.jsx(Gm,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(F,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n?.totalActivities||0}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[n?.completedActivities||0," ukończonych"]})]})]}),t.jsxs(R,{children:[t.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(U,{className:"text-sm font-medium",children:"Średni wynik"}),t.jsx(Ss,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(F,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[n?.averageScore||0,"%"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"z wszystkich quizów"})]})]})]}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Aktywność w ostatnich 7 dniach"})}),t.jsx(F,{children:t.jsxs("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:[t.jsx(Gs,{className:"h-8 w-8 mr-2"}),"Wykres aktywności (do implementacji)"]})})]}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Top 5 użytkowników"})}),t.jsx(F,{children:t.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(o=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(dt,{className:`h-5 w-5 ${o<=3?"text-yellow-500":"text-muted-foreground"}`}),t.jsxs("span",{children:["Użytkownik ",o]})]}),t.jsxs("span",{className:"font-semibold",children:[1e3-o*100," pkt"]})]},o))})})]})]}):t.jsx(q,{children:t.jsx("div",{className:"text-center text-muted-foreground",children:"Nie można załadować danych użytkownika"})})},Zj=[t.jsx(L,{path:"/dashboard/overview",element:t.jsx(Yj,{})},"dashboard")],Jj=x.forwardRef(({...e},s)=>t.jsx("nav",{ref:s,"aria-label":"breadcrumb",...e}));Jj.displayName="Breadcrumb";const Xj=x.forwardRef(({className:e,...s},n)=>t.jsx("ol",{ref:n,className:M("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",e),...s}));Xj.displayName="BreadcrumbList";const eb=x.forwardRef(({className:e,...s},n)=>t.jsx("li",{ref:n,className:M("inline-flex items-center gap-1.5",e),...s}));eb.displayName="BreadcrumbItem";const tb=x.forwardRef(({asChild:e,className:s,...n},i)=>{const r=e?jl:"a";return t.jsx(r,{ref:i,className:M("transition-colors hover:text-foreground",s),...n})});tb.displayName="BreadcrumbLink";const sb=x.forwardRef(({className:e,...s},n)=>t.jsx("span",{ref:n,role:"link","aria-disabled":"true","aria-current":"page",className:M("font-normal text-foreground",e),...s}));sb.displayName="BreadcrumbPage";const ze=Hg,Se=Qg,ve=x.forwardRef(({className:e,children:s,...n},i)=>t.jsxs(pm,{ref:i,className:M("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[s,t.jsx(Bg,{asChild:!0,children:t.jsx(ga,{className:"h-4 w-4 opacity-50"})})]}));ve.displayName=pm.displayName;const ah=x.forwardRef(({className:e,...s},n)=>t.jsx(fm,{ref:n,className:M("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(Vy,{className:"h-4 w-4"})}));ah.displayName=fm.displayName;const oh=x.forwardRef(({className:e,...s},n)=>t.jsx(xm,{ref:n,className:M("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(ga,{className:"h-4 w-4"})}));oh.displayName=xm.displayName;const Ne=x.forwardRef(({className:e,children:s,position:n="popper",...i},r)=>t.jsx(Ug,{children:t.jsxs(gm,{ref:r,className:M("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...i,children:[t.jsx(ah,{}),t.jsx(Wg,{className:M("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),t.jsx(oh,{})]})}));Ne.displayName=gm.displayName;const nb=x.forwardRef(({className:e,...s},n)=>t.jsx(ym,{ref:n,className:M("px-2 py-1.5 text-sm font-semibold",e),...s}));nb.displayName=ym.displayName;const V=x.forwardRef(({className:e,children:s,...n},i)=>t.jsxs(jm,{ref:i,className:M("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[t.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(Kg,{children:t.jsx(Ce,{className:"h-4 w-4"})})}),t.jsx(Gg,{children:s})]}));V.displayName=jm.displayName;const ib=x.forwardRef(({className:e,...s},n)=>t.jsx(bm,{ref:n,className:M("-mx-1 my-1 h-px bg-muted",e),...s}));ib.displayName=bm.displayName;const wa=({current:e,pageSize:s,total:n,setCurrent:i,setPageSize:r,itemName:a="elementów",pageSizeOptions:o=[10,20,50]})=>{const l=Math.ceil(n/s),c=(e-1)*s+1,d=Math.min(e*s,n),m=e>1,u=e<l,h=()=>{const p=[];if(l<=5)for(let f=1;f<=l;f++)p.push(f);else{p.push(1),e>3&&p.push("...");const f=Math.max(2,e-1),y=Math.min(l-1,e+1);for(let b=f;b<=y;b++)p.push(b);e<l-2&&p.push("..."),p.push(l)}return p};return n===0?null:t.jsxs(I,{className:"mt-6",children:[t.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pokazuje ",c,"-",d," z ",n," ",a]}),t.jsxs(I,{className:"gap-2",children:[r&&t.jsxs(ze,{value:s.toString(),onValueChange:p=>{r(parseInt(p)),i(1)},children:[t.jsx(ve,{className:"w-[100px]",children:t.jsx(Se,{})}),t.jsx(Ne,{children:o.map(p=>t.jsxs(V,{value:p.toString(),children:[p," / str."]},p))})]}),t.jsx(T,{variant:"outline",size:"sm",onClick:()=>i(e-1),disabled:!m,children:t.jsx(By,{className:"w-4 h-4"})}),t.jsx("div",{className:"hidden sm:flex gap-1",children:h().map((p,g)=>p==="..."?t.jsx("span",{className:"px-3 py-1 text-sm text-muted-foreground",children:"..."},`ellipsis-${g}`):t.jsx(T,{variant:e===p?"default":"outline",size:"sm",onClick:()=>i(p),className:"min-w-[40px]",children:p},p))}),t.jsxs("div",{className:"flex sm:hidden items-center px-3 text-sm",children:[e," / ",l]}),t.jsx(T,{variant:"outline",size:"sm",onClick:()=>i(e+1),disabled:!u,children:t.jsx(_i,{className:"w-4 h-4"})})]})]})},rb=xa("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Es=x.forwardRef(({className:e,variant:s,...n},i)=>t.jsx("div",{ref:i,role:"alert",className:M(rb({variant:s}),e),...n}));Es.displayName="Alert";const ab=x.forwardRef(({className:e,...s},n)=>t.jsx("h5",{ref:n,className:M("mb-1 font-medium leading-none tracking-tight",e),...s}));ab.displayName="AlertTitle";const Ds=x.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:M("text-sm [&_p]:leading-relaxed",e),...s}));Ds.displayName="AlertDescription";const Io=x.forwardRef(({className:e,...s},n)=>t.jsx(wm,{ref:n,className:M("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...s}));Io.displayName=wm.displayName;const ob=x.forwardRef(({className:e,...s},n)=>t.jsx(vm,{ref:n,className:M("aspect-square h-full w-full object-cover",e),...s}));ob.displayName=vm.displayName;const Mo=x.forwardRef(({className:e,...s},n)=>t.jsx(Nm,{ref:n,className:M("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...s}));Mo.displayName=Nm.displayName;const lb=xa("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),se=x.forwardRef(({className:e,...s},n)=>t.jsx(km,{ref:n,className:M(lb(),e),...s}));se.displayName=km.displayName;x.createContext({});x.createContext({});const cb=x.forwardRef(({className:e,align:s="center",sideOffset:n=4,...i},r)=>t.jsx(Yg,{children:t.jsx(zm,{ref:r,align:s,sideOffset:n,className:M("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",e),...i})}));cb.displayName=zm.displayName;const lh=x.forwardRef(({className:e,children:s,...n},i)=>t.jsxs(Sm,{ref:i,className:M("relative overflow-hidden",e),...n,children:[t.jsx(Zg,{className:"h-full w-full rounded-[inherit]",children:s}),t.jsx(ch,{}),t.jsx(Jg,{})]}));lh.displayName=Sm.displayName;const ch=x.forwardRef(({className:e,orientation:s="vertical",...n},i)=>t.jsx(Cm,{ref:i,orientation:s,className:M("flex touch-none select-none transition-colors",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:t.jsx(Xg,{className:"relative flex-1 rounded-full bg-border"})}));ch.displayName=Cm.displayName;const Xt=x.forwardRef(({className:e,orientation:s="horizontal",decorative:n=!0,...i},r)=>t.jsx(Tm,{ref:r,decorative:n,orientation:s,className:M("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...i}));Xt.displayName=Tm.displayName;function Sr({className:e,...s}){return t.jsx("div",{className:M("animate-pulse rounded-md bg-primary/10",e),...s})}const St=x.forwardRef(({className:e,...s},n)=>t.jsx("textarea",{className:M("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...s}));St.displayName="Textarea";const db=x.forwardRef(({className:e,...s},n)=>t.jsx(Am,{ref:n,className:M("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",e),...s}));db.displayName=Am.displayName;const ub=x.forwardRef(({className:e,...s},n)=>t.jsx(Pm,{ref:n,className:M("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",e),...s}));ub.displayName=Pm.displayName;const mb=x.forwardRef(({className:e,...s},n)=>t.jsx(Em,{ref:n,className:M("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));mb.displayName=Em.displayName;const ht=x.forwardRef(({className:e,...s},n)=>t.jsx(Dm,{ref:n,className:M("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:t.jsx(ey,{className:M("flex items-center justify-center text-current"),children:t.jsx(Ce,{className:"h-4 w-4"})})}));ht.displayName=Dm.displayName;var va="Switch",[hb,UP]=bl(va),[pb,fb]=hb(va),dh=x.forwardRef((e,s)=>{const{__scopeSwitch:n,name:i,checked:r,defaultChecked:a,required:o,disabled:l,value:c="on",onCheckedChange:d,form:m,...u}=e,[h,p]=x.useState(null),g=sn(s,w=>p(w)),f=x.useRef(!1),y=h?m||!!h.closest("form"):!0,[b,j]=_m({prop:r,defaultProp:a??!1,onChange:d,caller:va});return t.jsxs(pb,{scope:n,checked:b,disabled:l,children:[t.jsx(Ls.button,{type:"button",role:"switch","aria-checked":b,"aria-required":o,"data-state":ph(b),"data-disabled":l?"":void 0,disabled:l,value:c,...u,ref:g,onClick:le(e.onClick,w=>{j(S=>!S),y&&(f.current=w.isPropagationStopped(),f.current||w.stopPropagation())})}),y&&t.jsx(hh,{control:h,bubbles:!f.current,name:i,value:c,checked:b,required:o,disabled:l,form:m,style:{transform:"translateX(-100%)"}})]})});dh.displayName=va;var uh="SwitchThumb",mh=x.forwardRef((e,s)=>{const{__scopeSwitch:n,...i}=e,r=fb(uh,n);return t.jsx(Ls.span,{"data-state":ph(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:s})});mh.displayName=uh;var xb="SwitchBubbleInput",hh=x.forwardRef(({__scopeSwitch:e,control:s,checked:n,bubbles:i=!0,...r},a)=>{const o=x.useRef(null),l=sn(o,a),c=ty(n),d=sy(s);return x.useEffect(()=>{const m=o.current;if(!m)return;const u=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(u,"checked").set;if(c!==n&&p){const g=new Event("click",{bubbles:i});p.call(m,n),m.dispatchEvent(g)}},[c,n,i]),t.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...r,tabIndex:-1,ref:l,style:{...r.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});hh.displayName=xb;function ph(e){return e?"checked":"unchecked"}var fh=dh,gb=mh;const Ot=x.forwardRef(({className:e,...s},n)=>t.jsx(fh,{className:M("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...s,ref:n,children:t.jsx(gb,{className:M("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Ot.displayName=fh.displayName;const Vt=iy,Bt=ry,Ut=ay,_t=x.forwardRef(({className:e,sideOffset:s=4,...n},i)=>t.jsx(ny,{children:t.jsx(Im,{ref:i,sideOffset:s,className:M("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e),...n})}));_t.displayName=Im.displayName;var Lo=["Enter"," "],yb=["ArrowDown","PageUp","Home"],xh=["ArrowUp","PageDown","End"],jb=[...yb,...xh],bb={ltr:[...Lo,"ArrowRight"],rtl:[...Lo,"ArrowLeft"]},wb={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ir="Menu",[Li,vb,Nb]=oy(ir),[nn,gh]=bl(ir,[Nb,Mm,Lm]),Na=Mm(),yh=Lm(),[kb,rn]=nn(ir),[zb,rr]=nn(ir),jh=e=>{const{__scopeMenu:s,open:n=!1,children:i,dir:r,onOpenChange:a,modal:o=!0}=e,l=Na(s),[c,d]=x.useState(null),m=x.useRef(!1),u=Rm(a),h=by(r);return x.useEffect(()=>{const p=()=>{m.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>m.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),t.jsx(wy,{...l,children:t.jsx(kb,{scope:s,open:n,onOpenChange:u,content:c,onContentChange:d,children:t.jsx(zb,{scope:s,onClose:x.useCallback(()=>u(!1),[u]),isUsingKeyboardRef:m,dir:h,modal:o,children:i})})})};jh.displayName=ir;var Sb="MenuAnchor",Ml=x.forwardRef((e,s)=>{const{__scopeMenu:n,...i}=e,r=Na(n);return t.jsx(cy,{...r,...i,ref:s})});Ml.displayName=Sb;var Ll="MenuPortal",[Cb,bh]=nn(Ll,{forceMount:void 0}),wh=e=>{const{__scopeMenu:s,forceMount:n,children:i,container:r}=e,a=rn(Ll,s);return t.jsx(Cb,{scope:s,forceMount:n,children:t.jsx(ha,{present:n||a.open,children:t.jsx(ly,{asChild:!0,container:r,children:i})})})};wh.displayName=Ll;var vt="MenuContent",[Tb,Ol]=nn(vt),vh=x.forwardRef((e,s)=>{const n=bh(vt,e.__scopeMenu),{forceMount:i=n.forceMount,...r}=e,a=rn(vt,e.__scopeMenu),o=rr(vt,e.__scopeMenu);return t.jsx(Li.Provider,{scope:e.__scopeMenu,children:t.jsx(ha,{present:i||a.open,children:t.jsx(Li.Slot,{scope:e.__scopeMenu,children:o.modal?t.jsx(Ab,{...r,ref:s}):t.jsx(Pb,{...r,ref:s})})})})}),Ab=x.forwardRef((e,s)=>{const n=rn(vt,e.__scopeMenu),i=x.useRef(null),r=sn(s,i);return x.useEffect(()=>{const a=i.current;if(a)return yy(a)},[]),t.jsx(Rl,{...e,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:le(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Pb=x.forwardRef((e,s)=>{const n=rn(vt,e.__scopeMenu);return t.jsx(Rl,{...e,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Eb=hy("MenuContent.ScrollLock"),Rl=x.forwardRef((e,s)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:u,onInteractOutside:h,onDismiss:p,disableOutsideScroll:g,...f}=e,y=rn(vt,n),b=rr(vt,n),j=Na(n),w=yh(n),S=vb(n),[k,z]=x.useState(null),N=x.useRef(null),C=sn(s,N,y.onContentChange),A=x.useRef(0),v=x.useRef(""),P=x.useRef(0),D=x.useRef(null),_=x.useRef("right"),E=x.useRef(0),X=g?my:x.Fragment,Be=g?{as:Eb,allowPinchZoom:!0}:void 0,Q=$=>{const me=v.current+$,Ee=S().filter(_e=>!_e.disabled),xe=document.activeElement,it=Ee.find(_e=>_e.ref.current===xe)?.textValue,At=Ee.map(_e=>_e.textValue),ps=Bb(At,me,it),De=Ee.find(_e=>_e.textValue===ps)?.ref.current;(function _e(Pt){v.current=Pt,window.clearTimeout(A.current),Pt!==""&&(A.current=window.setTimeout(()=>_e(""),1e3))})(me),De&&setTimeout(()=>De.focus())};x.useEffect(()=>()=>window.clearTimeout(A.current),[]),uy();const J=x.useCallback($=>_.current===D.current?.side&&Wb($,D.current?.area),[]);return t.jsx(Tb,{scope:n,searchRef:v,onItemEnter:x.useCallback($=>{J($)&&$.preventDefault()},[J]),onItemLeave:x.useCallback($=>{J($)||(N.current?.focus(),z(null))},[J]),onTriggerLeave:x.useCallback($=>{J($)&&$.preventDefault()},[J]),pointerGraceTimerRef:P,onPointerGraceIntentChange:x.useCallback($=>{D.current=$},[]),children:t.jsx(X,{...Be,children:t.jsx(py,{asChild:!0,trapped:r,onMountAutoFocus:le(a,$=>{$.preventDefault(),N.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:t.jsx(fy,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:u,onInteractOutside:h,onDismiss:p,children:t.jsx(xy,{asChild:!0,...w,dir:b.dir,orientation:"vertical",loop:i,currentTabStopId:k,onCurrentTabStopIdChange:z,onEntryFocus:le(c,$=>{b.isUsingKeyboardRef.current||$.preventDefault()}),preventScrollOnEntryFocus:!0,children:t.jsx(gy,{role:"menu","aria-orientation":"vertical","data-state":Rh(y.open),"data-radix-menu-content":"",dir:b.dir,...j,...f,ref:C,style:{outline:"none",...f.style},onKeyDown:le(f.onKeyDown,$=>{const Ee=$.target.closest("[data-radix-menu-content]")===$.currentTarget,xe=$.ctrlKey||$.altKey||$.metaKey,it=$.key.length===1;Ee&&($.key==="Tab"&&$.preventDefault(),!xe&&it&&Q($.key));const At=N.current;if($.target!==At||!jb.includes($.key))return;$.preventDefault();const De=S().filter(_e=>!_e.disabled).map(_e=>_e.ref.current);xh.includes($.key)&&De.reverse(),qb(De)}),onBlur:le(e.onBlur,$=>{$.currentTarget.contains($.target)||(window.clearTimeout(A.current),v.current="")}),onPointerMove:le(e.onPointerMove,Oi($=>{const me=$.target,Ee=E.current!==$.clientX;if($.currentTarget.contains(me)&&Ee){const xe=$.clientX>E.current?"right":"left";_.current=xe,E.current=$.clientX}}))})})})})})})});vh.displayName=vt;var Db="MenuGroup",Fl=x.forwardRef((e,s)=>{const{__scopeMenu:n,...i}=e;return t.jsx(Ls.div,{role:"group",...i,ref:s})});Fl.displayName=Db;var _b="MenuLabel",Nh=x.forwardRef((e,s)=>{const{__scopeMenu:n,...i}=e;return t.jsx(Ls.div,{...i,ref:s})});Nh.displayName=_b;var Zr="MenuItem",md="menu.itemSelect",ka=x.forwardRef((e,s)=>{const{disabled:n=!1,onSelect:i,...r}=e,a=x.useRef(null),o=rr(Zr,e.__scopeMenu),l=Ol(Zr,e.__scopeMenu),c=sn(s,a),d=x.useRef(!1),m=()=>{const u=a.current;if(!n&&u){const h=new CustomEvent(md,{bubbles:!0,cancelable:!0});u.addEventListener(md,p=>i?.(p),{once:!0}),jy(u,h),h.defaultPrevented?d.current=!1:o.onClose()}};return t.jsx(kh,{...r,ref:c,disabled:n,onClick:le(e.onClick,m),onPointerDown:u=>{e.onPointerDown?.(u),d.current=!0},onPointerUp:le(e.onPointerUp,u=>{d.current||u.currentTarget?.click()}),onKeyDown:le(e.onKeyDown,u=>{const h=l.searchRef.current!=="";n||h&&u.key===" "||Lo.includes(u.key)&&(u.currentTarget.click(),u.preventDefault())})})});ka.displayName=Zr;var kh=x.forwardRef((e,s)=>{const{__scopeMenu:n,disabled:i=!1,textValue:r,...a}=e,o=Ol(Zr,n),l=yh(n),c=x.useRef(null),d=sn(s,c),[m,u]=x.useState(!1),[h,p]=x.useState("");return x.useEffect(()=>{const g=c.current;g&&p((g.textContent??"").trim())},[a.children]),t.jsx(Li.ItemSlot,{scope:n,disabled:i,textValue:r??h,children:t.jsx(dy,{asChild:!0,...l,focusable:!i,children:t.jsx(Ls.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...a,ref:d,onPointerMove:le(e.onPointerMove,Oi(g=>{i?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:le(e.onPointerLeave,Oi(g=>o.onItemLeave(g))),onFocus:le(e.onFocus,()=>u(!0)),onBlur:le(e.onBlur,()=>u(!1))})})})}),Ib="MenuCheckboxItem",zh=x.forwardRef((e,s)=>{const{checked:n=!1,onCheckedChange:i,...r}=e;return t.jsx(Ph,{scope:e.__scopeMenu,checked:n,children:t.jsx(ka,{role:"menuitemcheckbox","aria-checked":Jr(n)?"mixed":n,...r,ref:s,"data-state":ql(n),onSelect:le(r.onSelect,()=>i?.(Jr(n)?!0:!n),{checkForDefaultPrevented:!1})})})});zh.displayName=Ib;var Sh="MenuRadioGroup",[Mb,Lb]=nn(Sh,{value:void 0,onValueChange:()=>{}}),Ch=x.forwardRef((e,s)=>{const{value:n,onValueChange:i,...r}=e,a=Rm(i);return t.jsx(Mb,{scope:e.__scopeMenu,value:n,onValueChange:a,children:t.jsx(Fl,{...r,ref:s})})});Ch.displayName=Sh;var Th="MenuRadioItem",Ah=x.forwardRef((e,s)=>{const{value:n,...i}=e,r=Lb(Th,e.__scopeMenu),a=n===r.value;return t.jsx(Ph,{scope:e.__scopeMenu,checked:a,children:t.jsx(ka,{role:"menuitemradio","aria-checked":a,...i,ref:s,"data-state":ql(a),onSelect:le(i.onSelect,()=>r.onValueChange?.(n),{checkForDefaultPrevented:!1})})})});Ah.displayName=Th;var $l="MenuItemIndicator",[Ph,Ob]=nn($l,{checked:!1}),Eh=x.forwardRef((e,s)=>{const{__scopeMenu:n,forceMount:i,...r}=e,a=Ob($l,n);return t.jsx(ha,{present:i||Jr(a.checked)||a.checked===!0,children:t.jsx(Ls.span,{...r,ref:s,"data-state":ql(a.checked)})})});Eh.displayName=$l;var Rb="MenuSeparator",Dh=x.forwardRef((e,s)=>{const{__scopeMenu:n,...i}=e;return t.jsx(Ls.div,{role:"separator","aria-orientation":"horizontal",...i,ref:s})});Dh.displayName=Rb;var Fb="MenuArrow",_h=x.forwardRef((e,s)=>{const{__scopeMenu:n,...i}=e,r=Na(n);return t.jsx(vy,{...r,...i,ref:s})});_h.displayName=Fb;var $b="MenuSub",[WP,Ih]=nn($b),ji="MenuSubTrigger",Mh=x.forwardRef((e,s)=>{const n=rn(ji,e.__scopeMenu),i=rr(ji,e.__scopeMenu),r=Ih(ji,e.__scopeMenu),a=Ol(ji,e.__scopeMenu),o=x.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=a,d={__scopeMenu:e.__scopeMenu},m=x.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return x.useEffect(()=>m,[m]),x.useEffect(()=>{const u=l.current;return()=>{window.clearTimeout(u),c(null)}},[l,c]),t.jsx(Ml,{asChild:!0,...d,children:t.jsx(kh,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":Rh(n.open),...e,ref:Om(s,r.onTriggerChange),onClick:u=>{e.onClick?.(u),!(e.disabled||u.defaultPrevented)&&(u.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:le(e.onPointerMove,Oi(u=>{a.onItemEnter(u),!u.defaultPrevented&&!e.disabled&&!n.open&&!o.current&&(a.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),m()},100))})),onPointerLeave:le(e.onPointerLeave,Oi(u=>{m();const h=n.content?.getBoundingClientRect();if(h){const p=n.content?.dataset.side,g=p==="right",f=g?-5:5,y=h[g?"left":"right"],b=h[g?"right":"left"];a.onPointerGraceIntentChange({area:[{x:u.clientX+f,y:u.clientY},{x:y,y:h.top},{x:b,y:h.top},{x:b,y:h.bottom},{x:y,y:h.bottom}],side:p}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(u),u.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:le(e.onKeyDown,u=>{const h=a.searchRef.current!=="";e.disabled||h&&u.key===" "||bb[i.dir].includes(u.key)&&(n.onOpenChange(!0),n.content?.focus(),u.preventDefault())})})})});Mh.displayName=ji;var Lh="MenuSubContent",Oh=x.forwardRef((e,s)=>{const n=bh(vt,e.__scopeMenu),{forceMount:i=n.forceMount,...r}=e,a=rn(vt,e.__scopeMenu),o=rr(vt,e.__scopeMenu),l=Ih(Lh,e.__scopeMenu),c=x.useRef(null),d=sn(s,c);return t.jsx(Li.Provider,{scope:e.__scopeMenu,children:t.jsx(ha,{present:i||a.open,children:t.jsx(Li.Slot,{scope:e.__scopeMenu,children:t.jsx(Rl,{id:l.contentId,"aria-labelledby":l.triggerId,...r,ref:d,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{o.isUsingKeyboardRef.current&&c.current?.focus(),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:le(e.onFocusOutside,m=>{m.target!==l.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:le(e.onEscapeKeyDown,m=>{o.onClose(),m.preventDefault()}),onKeyDown:le(e.onKeyDown,m=>{const u=m.currentTarget.contains(m.target),h=wb[o.dir].includes(m.key);u&&h&&(a.onOpenChange(!1),l.trigger?.focus(),m.preventDefault())})})})})})});Oh.displayName=Lh;function Rh(e){return e?"open":"closed"}function Jr(e){return e==="indeterminate"}function ql(e){return Jr(e)?"indeterminate":e?"checked":"unchecked"}function qb(e){const s=document.activeElement;for(const n of e)if(n===s||(n.focus(),document.activeElement!==s))return}function Vb(e,s){return e.map((n,i)=>e[(s+i)%e.length])}function Bb(e,s,n){const r=s.length>1&&Array.from(s).every(d=>d===s[0])?s[0]:s,a=n?e.indexOf(n):-1;let o=Vb(e,Math.max(a,0));r.length===1&&(o=o.filter(d=>d!==n));const c=o.find(d=>d.toLowerCase().startsWith(r.toLowerCase()));return c!==n?c:void 0}function Ub(e,s){const{x:n,y:i}=e;let r=!1;for(let a=0,o=s.length-1;a<s.length;o=a++){const l=s[a],c=s[o],d=l.x,m=l.y,u=c.x,h=c.y;m>i!=h>i&&n<(u-d)*(i-m)/(h-m)+d&&(r=!r)}return r}function Wb(e,s){if(!s)return!1;const n={x:e.clientX,y:e.clientY};return Ub(n,s)}function Oi(e){return s=>s.pointerType==="mouse"?e(s):void 0}var Kb=jh,Gb=Ml,Hb=wh,Qb=vh,Yb=Fl,Zb=Nh,Jb=ka,Xb=zh,ew=Ch,tw=Ah,sw=Eh,nw=Dh,iw=_h,rw=Mh,aw=Oh,za="DropdownMenu",[ow,KP]=bl(za,[gh]),Je=gh(),[lw,Fh]=ow(za),$h=e=>{const{__scopeDropdownMenu:s,children:n,dir:i,open:r,defaultOpen:a,onOpenChange:o,modal:l=!0}=e,c=Je(s),d=x.useRef(null),[m,u]=_m({prop:r,defaultProp:a??!1,onChange:o,caller:za});return t.jsx(lw,{scope:s,triggerId:nd(),triggerRef:d,contentId:nd(),open:m,onOpenChange:u,onOpenToggle:x.useCallback(()=>u(h=>!h),[u]),modal:l,children:t.jsx(Kb,{...c,open:m,onOpenChange:u,dir:i,modal:l,children:n})})};$h.displayName=za;var qh="DropdownMenuTrigger",Vh=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...r}=e,a=Fh(qh,n),o=Je(n);return t.jsx(Gb,{asChild:!0,...o,children:t.jsx(Ls.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...r,ref:Om(s,a.triggerRef),onPointerDown:le(e.onPointerDown,l=>{!i&&l.button===0&&l.ctrlKey===!1&&(a.onOpenToggle(),a.open||l.preventDefault())}),onKeyDown:le(e.onKeyDown,l=>{i||(["Enter"," "].includes(l.key)&&a.onOpenToggle(),l.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});Vh.displayName=qh;var cw="DropdownMenuPortal",Bh=e=>{const{__scopeDropdownMenu:s,...n}=e,i=Je(s);return t.jsx(Hb,{...i,...n})};Bh.displayName=cw;var Uh="DropdownMenuContent",Wh=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Fh(Uh,n),a=Je(n),o=x.useRef(!1);return t.jsx(Qb,{id:r.contentId,"aria-labelledby":r.triggerId,...a,...i,ref:s,onCloseAutoFocus:le(e.onCloseAutoFocus,l=>{o.current||r.triggerRef.current?.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:le(e.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,m=c.button===2||d;(!r.modal||m)&&(o.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Wh.displayName=Uh;var dw="DropdownMenuGroup",uw=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Je(n);return t.jsx(Yb,{...r,...i,ref:s})});uw.displayName=dw;var mw="DropdownMenuLabel",Kh=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Je(n);return t.jsx(Zb,{...r,...i,ref:s})});Kh.displayName=mw;var hw="DropdownMenuItem",Gh=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Je(n);return t.jsx(Jb,{...r,...i,ref:s})});Gh.displayName=hw;var pw="DropdownMenuCheckboxItem",Hh=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Je(n);return t.jsx(Xb,{...r,...i,ref:s})});Hh.displayName=pw;var fw="DropdownMenuRadioGroup",xw=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Je(n);return t.jsx(ew,{...r,...i,ref:s})});xw.displayName=fw;var gw="DropdownMenuRadioItem",Qh=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Je(n);return t.jsx(tw,{...r,...i,ref:s})});Qh.displayName=gw;var yw="DropdownMenuItemIndicator",Yh=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Je(n);return t.jsx(sw,{...r,...i,ref:s})});Yh.displayName=yw;var jw="DropdownMenuSeparator",Zh=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Je(n);return t.jsx(nw,{...r,...i,ref:s})});Zh.displayName=jw;var bw="DropdownMenuArrow",ww=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Je(n);return t.jsx(iw,{...r,...i,ref:s})});ww.displayName=bw;var vw="DropdownMenuSubTrigger",Jh=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Je(n);return t.jsx(rw,{...r,...i,ref:s})});Jh.displayName=vw;var Nw="DropdownMenuSubContent",Xh=x.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Je(n);return t.jsx(aw,{...r,...i,ref:s,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Xh.displayName=Nw;var kw=$h,zw=Vh,Sw=Bh,ep=Wh,tp=Kh,sp=Gh,np=Hh,ip=Qh,rp=Yh,ap=Zh,op=Jh,lp=Xh;const On=kw,Rn=zw,Cw=x.forwardRef(({className:e,inset:s,children:n,...i},r)=>t.jsxs(op,{ref:r,className:M("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",e),...i,children:[n,t.jsx(_i,{className:"ml-auto"})]}));Cw.displayName=op.displayName;const Tw=x.forwardRef(({className:e,...s},n)=>t.jsx(lp,{ref:n,className:M("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...s}));Tw.displayName=lp.displayName;const Js=x.forwardRef(({className:e,sideOffset:s=4,...n},i)=>t.jsx(Sw,{children:t.jsx(ep,{ref:i,sideOffset:s,className:M("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...n})}));Js.displayName=ep.displayName;const ae=x.forwardRef(({className:e,inset:s,...n},i)=>t.jsx(sp,{ref:i,className:M("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",s&&"pl-8",e),...n}));ae.displayName=sp.displayName;const Aw=x.forwardRef(({className:e,children:s,checked:n,...i},r)=>t.jsxs(np,{ref:r,className:M("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...i,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(rp,{children:t.jsx(Ce,{className:"h-4 w-4"})})}),s]}));Aw.displayName=np.displayName;const Pw=x.forwardRef(({className:e,children:s,...n},i)=>t.jsxs(ip,{ref:i,className:M("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(rp,{children:t.jsx(Fr,{className:"h-2 w-2 fill-current"})})}),s]}));Pw.displayName=ip.displayName;const cp=x.forwardRef(({className:e,inset:s,...n},i)=>t.jsx(tp,{ref:i,className:M("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",e),...n}));cp.displayName=tp.displayName;const Nt=x.forwardRef(({className:e,...s},n)=>t.jsx(ap,{ref:n,className:M("-mx-1 my-1 h-px bg-muted",e),...s}));Nt.displayName=ap.displayName;const Ew=()=>{const e=Z(),s=wl(),n=()=>{const o=`${s.pathname}${s.search}`;sessionStorage.setItem("returnUrl",o)};return{navigateWithReturn:o=>{n(),e(o)},goBack:o=>{const l=sessionStorage.getItem("returnUrl");l?(sessionStorage.removeItem("returnUrl"),e(l)):e(o||-1)},saveReturnUrl:n,navigateToWizard:(o,l)=>{l&&sessionStorage.setItem("wizardContext",JSON.stringify(l)),n(),e(o)},currentUrl:`${s.pathname}${s.search}`}},Oo=e=>{const{mutate:s,isLoading:n}=zl();return{togglePublish:async(r,a,o,l)=>{s({resource:e,id:r,values:{is_published:!a}},{onSuccess:()=>{O.success(a?`${o} został ukryty`:`${o} został opublikowany`),l?.()},onError:c=>{O.error("Nie udało się zmienić statusu publikacji"),console.error("Publish toggle error:",c)}})},isToggling:n}},hd=e=>{const{mutate:s}=zl(),n=Um(),[i,r]=x.useState(!1);return{updatePosition:x.useCallback(async(o,l)=>{if(!i){r(!0);try{await new Promise((c,d)=>{s({resource:e,id:o,values:{position:l},mutationMode:"optimistic"},{onSuccess:()=>{console.log(`Updated position for ${e} ${o} to ${l}`),c()},onError:m=>d(m)})}),setTimeout(()=>{n({resource:e,invalidates:["list"]})},1e3)}catch(c){console.error("Position update error:",c),O.error("Nie udało się zaktualizować pozycji"),await n({resource:e,invalidates:["list"]})}finally{r(!1)}}},[e,s,n,i]),isUpdating:i}},Dw=e=>{const{data:s,isLoading:n}=Oe({resource:"courses",id:e,queryOptions:{enabled:!!e}}),{data:i,isLoading:r,refetch:a}=Ae({resource:"topics",filters:[{field:"course_id",operator:"eq",value:e}],sorters:[{field:"position",order:"asc"}],meta:{select:"*, activities(count)"},queryOptions:{enabled:!!e}}),{data:o,refetch:l}=Ae({resource:"activities",filters:[{field:"topic_id",operator:"in",value:i?.data?.map(h=>h.id)||[]}],sorters:[{field:"position",order:"asc"}],meta:{select:"*, questions(count)"},queryOptions:{enabled:!!i?.data?.length}}),{data:c}=Ae({resource:"course_access",filters:[{field:"course_id",operator:"eq",value:e}],queryOptions:{enabled:!!e}}),d=n||r,m={topicsCount:i?.total||0,activitiesCount:o?.total||0,accessCount:c?.total||0},u=h=>o?.data?.filter(p=>p.topic_id===h)||[];return{course:s?.data,topics:i?.data||[],activities:o?.data||[],stats:m,isLoading:d,refetchTopics:a,refetchActivities:l,getActivitiesForTopic:u}},_w=()=>{const{create:e,edit:s,show:n}=Ve(),{mutate:i}=In(),{togglePublish:r}=Oo("courses"),{tableQuery:{data:a,isLoading:o,isError:l,refetch:c},current:d,setCurrent:m,pageSize:u,setFilters:h}=fa({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, topics(count), course_access(count)"}}),p=ba({isLoading:o,isError:l});if(p)return p;const g=(y,b)=>{confirm(`Czy na pewno chcesz usunąć kurs "${b}"?`)&&i({resource:"courses",id:y},{onSuccess:()=>{O.success("Kurs został usunięty"),c()}})},f=(y,b,j)=>{b&&j&&sessionStorage.setItem("wizardContext",JSON.stringify({courseId:b,courseTitle:j})),window.location.href=y};return t.jsxs(q,{children:[t.jsxs(I,{children:[t.jsx(ce,{title:"Kursy",description:"Zarządzaj kursami w systemie"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Vt,{children:t.jsxs(Bt,{children:[t.jsx(Ut,{asChild:!0,children:t.jsxs(T,{variant:"outline",onClick:()=>f("/teacher/course-structure/step1"),children:[t.jsx(Hs,{className:"w-4 h-4 mr-2"}),t.jsx(ks,{className:"w-3 h-3"})]})}),t.jsx(_t,{children:t.jsx("p",{children:"Stwórz kurs z pomocą AI"})})]})}),t.jsxs(T,{onClick:()=>e("courses"),children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Dodaj kurs"]})]})]}),t.jsx(I,{children:t.jsx(B,{placeholder:"Szukaj kursów...",className:"max-w-sm",onChange:y=>{h([{field:"title",operator:"contains",value:y.target.value}])}})}),t.jsx(be,{children:a?.data?.map(y=>t.jsxs(R,{className:`relative cursor-pointer transition-all duration-200 ${y.is_published?"hover:shadow-lg":"opacity-80 hover:opacity-90 "}`,onClick:b=>{b.target.closest('[role="menu"]')||n("courses",y.id)},children:[t.jsx(W,{children:t.jsxs(I,{children:[t.jsxs(U,{className:"flex items-center gap-2 min-w-0",children:[t.jsx("span",{className:"flex-shrink-0",children:y.icon_emoji?t.jsx("span",{className:"text-2xl",children:y.icon_emoji}):t.jsx(Me,{className:"w-5 h-5"})}),t.jsx(Vt,{delayDuration:200,children:t.jsxs(Bt,{children:[t.jsx(Ut,{asChild:!0,children:t.jsx("span",{className:"truncate",children:y.title})}),y.title.length>30&&t.jsx(_t,{children:t.jsx("p",{className:"max-w-xs",children:y.title})})]})})]}),t.jsxs(On,{children:[t.jsx(Rn,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"sm",onClick:b=>b.stopPropagation(),children:t.jsx(tr,{className:"h-4 w-4"})})}),t.jsxs(Js,{align:"end",children:[t.jsxs(ae,{onClick:()=>n("courses",y.id),children:[t.jsx(qe,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),t.jsxs(ae,{onClick:()=>s("courses",y.id),children:[t.jsx(Lt,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),t.jsx(Nt,{}),t.jsx(ae,{onClick:()=>r(y.id,y.is_published,y.title,c),children:y.is_published?t.jsxs(t.Fragment,{children:[t.jsx(ya,{className:"mr-2 h-4 w-4"}),"Ukryj kurs"]}):t.jsxs(t.Fragment,{children:[t.jsx(qe,{className:"mr-2 h-4 w-4"}),"Opublikuj kurs"]})}),t.jsx(Nt,{}),t.jsxs(ae,{onClick:()=>f("/educational-material/step1",y.id,y.title),className:"text-purple-600 focus:text-purple-600",children:[t.jsx(ks,{className:"mr-2 h-4 w-4"}),"Generuj materiał z AI"]}),t.jsxs(ae,{onClick:()=>f("/quiz-wizard/step1",y.id,y.title),className:"text-blue-600 focus:text-blue-600",children:[t.jsx(Mn,{className:"mr-2 h-4 w-4"}),"Generuj quiz z AI"]}),t.jsx(Nt,{}),t.jsxs(ae,{onClick:()=>g(y.id,y.title),className:"text-red-600 focus:text-red-600",children:[t.jsx(ds,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})}),t.jsxs(F,{children:[y.description&&t.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:y.description}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex gap-2",children:t.jsx(ne,{variant:y.is_published?"default":"secondary",className:y.is_published?"bg-green-600":"",children:y.is_published?"Opublikowany":"Szkic"})}),t.jsxs("div",{className:"flex gap-3 text-sm text-muted-foreground",children:[t.jsx(Vt,{children:t.jsxs(Bt,{children:[t.jsx(Ut,{asChild:!0,children:t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(ft,{className:"w-3 h-3"}),y.topics?.[0]?.count||0]})}),t.jsx(_t,{children:t.jsx("p",{children:"Liczba tematów"})})]})}),t.jsx(Vt,{children:t.jsxs(Bt,{children:[t.jsx(Ut,{asChild:!0,children:t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(Ye,{className:"w-3 h-3"}),y.course_access?.[0]?.count||0]})}),t.jsx(_t,{children:t.jsx("p",{children:"Liczba uczestników"})})]})})]})]}),y.created_at&&t.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-muted-foreground",children:[t.jsx(Qt,{className:"w-3 h-3"}),t.jsxs("span",{children:["Utworzono:"," ",new Date(y.created_at).toLocaleDateString("pl-PL")]})]})]})]},y.id))}),a?.data?.length===0&&t.jsx(R,{className:"border-dashed border-2 bg-gradient-to-r from-indigo-50/50 to-purple-50/50 dark:from-indigo-950/20 dark:to-purple-950/20",children:t.jsxs(F,{className:"text-center py-12",children:[t.jsx(Hs,{className:"w-12 h-12 mx-auto mb-4 text-indigo-600"}),t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Brak kursów"}),t.jsx("p",{className:"text-muted-foreground mb-6",children:"Rozpocznij od stworzenia pierwszego kursu"}),t.jsxs("div",{className:"flex gap-3 justify-center",children:[t.jsxs(T,{variant:"outline",onClick:()=>e("courses"),children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Dodaj ręcznie"]}),t.jsxs(T,{onClick:()=>f("/course-structure/step1"),className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700",children:[t.jsx(ks,{className:"w-4 h-4 mr-2"}),"Wygeneruj z AI"]})]})]})}),t.jsx(wa,{current:d,pageSize:u,total:a?.total||0,setCurrent:m,itemName:"kursów"}),a?.data&&a.data.length>0&&t.jsx("div",{className:"fixed bottom-6 right-6",children:t.jsx(Vt,{children:t.jsxs(Bt,{children:[t.jsx(Ut,{asChild:!0,children:t.jsxs(T,{size:"lg",className:"rounded-full shadow-lg bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700",onClick:()=>f("/course-structure/step1"),children:[t.jsx(Hs,{className:"w-5 h-5 mr-2"}),t.jsx(ks,{className:"w-4 h-4"})]})}),t.jsx(_t,{side:"left",children:t.jsx("p",{children:"Stwórz nowy kurs z pomocą AI"})})]})})})]})},es=({children:e,onSubmit:s,className:n="",...i})=>{const r="space-y-6",a=n?`${r} ${n}`:r;return t.jsx("form",{onSubmit:s,className:a,...i,children:e})},H=({children:e,label:s,htmlFor:n,error:i,required:r=!1,className:a="",hint:o})=>{const l="space-y-2",c=a?`${l} ${a}`:l,d=()=>s?typeof s=="string"?t.jsxs(se,{htmlFor:n,children:[s,r&&t.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):t.jsxs(se,{htmlFor:n,className:"flex items-center",children:[s,r&&t.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):null,m=x.isValidElement(e)?x.cloneElement(e,{className:`${e.props.className||""} ${i?"border-red-500 ring-1 ring-red-500":""}`.trim()}):e;return t.jsxs("div",{className:c,children:[d(),m,o&&!i&&t.jsx("p",{className:"text-sm text-muted-foreground",children:o}),i&&t.jsx("p",{className:"text-sm text-red-500",children:i})]})},ts=({children:e,className:s=""})=>{const n="flex justify-end items-center gap-4 pt-6 border-t",i=s?`${n} ${s}`:n;return t.jsx("div",{className:i,children:e})},Iw=["📚","🎓","💡","🚀","⭐","🏆","🎯","📖","✏️","🧮"],Mw=()=>{const{list:e}=Ve(),{data:s}=Tt(),[n,i]=x.useState(!1),{refineCore:{onFinish:r},register:a,handleSubmit:o,setValue:l,watch:c,formState:{errors:d,isSubmitting:m}}=Jt({defaultValues:{title:"",description:"",vendor_id:s?.vendor_id||0,is_published:!1,icon_emoji:"📚"}}),u=c("icon_emoji");return t.jsxs(q,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("courses"),children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsx(I,{children:t.jsx(ce,{title:"Dodaj kurs",description:"Utwórz nowy kurs w systemie"})}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Informacje o kursie"})}),t.jsx(F,{children:t.jsxs(es,{onSubmit:o(r),children:[t.jsxs(be,{variant:"1-2-2",children:[t.jsx(H,{label:"Tytuł kursu",htmlFor:"title",error:d.title?.message?.toString(),required:!0,children:t.jsx(B,{id:"title",placeholder:"np. Podstawy programowania",...a("title",{required:"Tytuł kursu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),t.jsx(H,{label:"Ikona kursu",htmlFor:"icon_emoji",children:t.jsxs("div",{className:"relative",children:[t.jsxs(T,{type:"button",variant:"outline",className:"w-full justify-start",onClick:()=>i(!n),children:[t.jsx("span",{className:"text-2xl mr-2",children:u||"📚"}),"Wybierz ikonę"]}),n&&t.jsx("div",{className:"absolute top-full mt-2 p-2 bg-white border rounded-lg shadow-lg z-10",children:t.jsx("div",{className:"grid grid-cols-5 gap-2",children:Iw.map(h=>t.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded text-2xl",onClick:()=>{l("icon_emoji",h),i(!1)},children:h},h))})})]})})]}),t.jsx(H,{label:"Opis kursu",htmlFor:"description",error:d.description?.message?.toString(),children:t.jsx(St,{id:"description",placeholder:"Opisz czego uczniowie nauczą się na tym kursie...",rows:4,...a("description")})}),t.jsx(H,{label:"Status publikacji",children:t.jsxs(I,{variant:"start",children:[t.jsx(Ot,{checked:c("is_published")||!1,onCheckedChange:h=>l("is_published",h)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj kurs od razu (możesz to zmienić później)"})]})}),t.jsxs(ts,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:()=>e("courses"),children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:m,children:m?"Tworzenie...":"Utwórz kurs"})]})]})})]})]})},Lw=["📚","🎓","💡","🚀","⭐","🏆","🎯","📖","✏️","🧮"],Ow=()=>{const{list:e}=Ve(),{id:s}=Ze(),[n,i]=x.useState(!1),{data:r,isLoading:a}=Oe({resource:"courses",id:s,liveMode:"off"}),{refineCore:{onFinish:o},register:l,handleSubmit:c,setValue:d,watch:m,formState:{errors:u,isSubmitting:h}}=Jt({refineCoreProps:{resource:"courses",id:s,liveMode:"off"}}),p=m("icon_emoji");return a?t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):t.jsxs(q,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("courses"),children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsx(I,{children:t.jsx(ce,{title:"Edytuj kurs",description:`Edycja kursu: ${r?.data?.title}`})}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Informacje o kursie"})}),t.jsx(F,{children:t.jsxs(es,{onSubmit:c(o),children:[t.jsxs(be,{variant:"1-2-2",children:[t.jsx(H,{label:"Tytuł kursu",htmlFor:"title",error:u.title?.message,required:!0,children:t.jsx(B,{id:"title",placeholder:"np. Podstawy programowania",...l("title",{required:"Tytuł kursu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),t.jsx(H,{label:"Ikona kursu",htmlFor:"icon_emoji",children:t.jsxs("div",{className:"relative",children:[t.jsxs(T,{type:"button",variant:"outline",className:"w-full justify-start",onClick:()=>i(!n),children:[t.jsx("span",{className:"text-2xl mr-2",children:p||"📚"}),"Wybierz ikonę"]}),n&&t.jsx("div",{className:"absolute top-full mt-2 p-2 bg-white border rounded-lg shadow-lg z-10",children:t.jsx("div",{className:"grid grid-cols-5 gap-2",children:Lw.map(g=>t.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded text-2xl",onClick:()=>{d("icon_emoji",g),i(!1)},children:g},g))})})]})})]}),t.jsx(H,{label:"Opis kursu",htmlFor:"description",error:u.description?.message,children:t.jsx(St,{id:"description",placeholder:"Opisz czego uczniowie nauczą się na tym kursie...",rows:4,...l("description")})}),t.jsx(H,{label:"Status publikacji",children:t.jsxs(I,{variant:"start",children:[t.jsx(Ot,{checked:m("is_published")||!1,onCheckedChange:g=>d("is_published",g)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Kurs jest opublikowany i widoczny dla uczniów"})]})}),t.jsxs(ts,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:()=>e("courses"),children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:h,children:h?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},Rw=({topic:e,isExpanded:s,onToggle:n,onDelete:i,onEdit:r,onTogglePublish:a,onNavigateToWizard:o,courseId:l,courseTitle:c,children:d,activitiesCount:m,dragHandleProps:u})=>{const h=Z(),p=f=>{const y=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",y),h(f)},g=(f,y)=>{o&&o(f,{courseId:l,courseTitle:c,topicId:e.id,topicTitle:e.title,...y})};return t.jsxs("div",{className:`border-2 rounded-lg overflow-hidden group ${s?"shadow-lg border-primary":"border-border hover:border-primary/50"}`,children:[t.jsx("div",{className:`p-4 ${s?"bg-primary text-primary-foreground":"bg-background hover:bg-muted"}`,children:t.jsxs(I,{children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[t.jsx("button",{onClick:n,className:`p-1 rounded ${s?"text-primary-foreground hover:bg-primary-foreground/20":"hover:bg-muted"}`,"aria-label":s?"Zwiń temat":"Rozwiń temat",children:s?t.jsx(ga,{className:"w-5 h-5"}):t.jsx(_i,{className:"w-5 h-5"})}),t.jsx("div",{className:"cursor-move",...u,children:t.jsx(Hm,{className:`w-4 h-4 ${s?"text-primary-foreground/70":"text-muted-foreground"}`})}),t.jsxs("div",{className:"flex-1 cursor-pointer group",onClick:n,children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("h4",{className:`font-semibold text-base ${s?"text-primary-foreground":"group-hover:text-primary"}`,children:["Temat ",e.position,": ",e.title]}),t.jsx(ne,{variant:e.is_published?s?"secondary":"default":"outline",className:s?"bg-primary-foreground/20 text-primary-foreground border-primary-foreground/30":"",children:e.is_published?"Opublikowany":"Szkic"})]}),t.jsx("div",{className:"flex items-center gap-4 mt-1",children:t.jsxs("span",{className:`text-sm flex items-center gap-1 ${s?"text-primary-foreground/80":"text-muted-foreground"}`,children:[t.jsx(ft,{className:"w-3 h-3"}),m," ",m===1?"aktywność":"aktywności"]})})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs(On,{children:[t.jsx(Rn,{asChild:!0,children:t.jsx(T,{size:"sm",variant:s?"secondary":"ghost",title:"Dodaj aktywność",className:`h-8 w-8 p-0 ${s?"bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground":""}`,children:t.jsx(Le,{className:"h-4 w-4"})})}),t.jsxs(Js,{align:"end",children:[t.jsx(cp,{children:"Dodaj treść"}),t.jsxs(ae,{onClick:()=>p(`/activities/create?topic_id=${e.id}`),children:[t.jsx(Le,{className:"mr-2 h-4 w-4"}),"Dodaj ręcznie"]}),t.jsx(Nt,{}),t.jsxs(ae,{onClick:()=>g("/educational-material/step1"),className:"text-purple-600 focus:text-purple-600",children:[t.jsx(ks,{className:"mr-2 h-4 w-4"}),"Generuj materiał z AI"]}),t.jsxs(ae,{onClick:()=>g("/quiz-wizard/step1"),className:"text-blue-600 focus:text-blue-600",children:[t.jsx(Mn,{className:"mr-2 h-4 w-4"}),"Generuj quiz z AI"]})]})]}),t.jsxs(On,{children:[t.jsx(Rn,{asChild:!0,children:t.jsx(T,{variant:s?"secondary":"ghost",size:"sm",className:`h-8 w-8 p-0 ${s?"bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground":""}`,children:t.jsx(tr,{className:"h-4 w-4"})})}),t.jsxs(Js,{align:"end",children:[t.jsxs(ae,{onClick:()=>r("topics",e.id),children:[t.jsx(Lt,{className:"mr-2 h-4 w-4"}),"Edytuj temat"]}),t.jsx(Nt,{}),t.jsx(ae,{onClick:()=>a(e.id,e.is_published,e.title),children:e.is_published?t.jsxs(t.Fragment,{children:[t.jsx(ya,{className:"mr-2 h-4 w-4"}),"Ukryj temat"]}):t.jsxs(t.Fragment,{children:[t.jsx(qe,{className:"mr-2 h-4 w-4"}),"Opublikuj temat"]})}),t.jsx(Nt,{}),t.jsxs(ae,{onClick:()=>i(e.id,e.title),className:"text-red-600 focus:text-red-600",children:[t.jsx(ds,{className:"mr-2 h-4 w-4"}),"Usuń temat"]})]})]})]})]})}),s&&t.jsx("div",{className:"p-4 bg-muted/20 border-t-2 border-primary",children:t.jsx("div",{className:"space-y-2",children:d})})]})},Fw=({activity:e,topicPosition:s,onDelete:n,onEdit:i,onTogglePublish:r,dragHandleProps:a})=>{const o=Z(),l=()=>e.type==="quiz"?t.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:t.jsx(st,{className:"w-5 h-5 text-white"})}):t.jsx("div",{className:"p-2 bg-green-600 rounded-lg",children:t.jsx(ft,{className:"w-5 h-5 text-white"})}),c=()=>e.type==="quiz"?"Quiz":"Materiał";return t.jsxs("div",{className:"group flex items-center gap-4 p-4 bg-white border-2 rounded-lg hover:border-primary/50 transition-all duration-200",children:[t.jsx("div",{className:"cursor-move opacity-0 group-hover:opacity-100 transition-opacity",...a,children:t.jsx(Hm,{className:"w-4 h-4 text-muted-foreground"})}),l(),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsxs("h5",{className:"font-semibold text-sm text-foreground",children:[s,".",e.position," ",e.title]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ne,{variant:e.type==="quiz"?"default":"secondary",className:"text-xs font-medium",children:c()}),e.type==="quiz"&&e._count?.questions!==void 0&&t.jsxs(ne,{variant:"outline",className:"text-xs font-medium border-2",children:[t.jsx(Qs,{className:"w-3 h-3 mr-1"}),e._count.questions," ",e._count.questions===1?"pytanie":"pytań"]}),t.jsx(ne,{variant:e.is_published?"default":"outline",className:`text-xs font-medium ${e.is_published?"bg-green-600 hover:bg-green-700":"border-2"}`,children:e.is_published?t.jsxs(t.Fragment,{children:[t.jsx(Uy,{className:"w-3 h-3 mr-1"}),"Opublikowany"]}):"Szkic"})]})]}),t.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[e.duration_min&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Qt,{className:"w-3 h-3"}),t.jsxs("span",{children:[e.duration_min," min"]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Ye,{className:"w-3 h-3"}),t.jsx("span",{children:"0 ukończeń"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[e.type==="quiz"&&t.jsx(T,{size:"sm",variant:"ghost",onClick:()=>o(`/questions/manage/${e.id}`),title:"Zarządzaj pytaniami",className:"h-8 w-8 p-0",children:t.jsx(Qs,{className:"h-4 w-4"})}),t.jsx(T,{size:"sm",variant:"ghost",onClick:()=>o(`/activities/show/${e.id}`),title:"Podgląd",className:"h-8 w-8 p-0",children:t.jsx(qe,{className:"h-4 w-4"})}),t.jsxs(On,{children:[t.jsx(Rn,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:t.jsx(tr,{className:"h-4 w-4"})})}),t.jsxs(Js,{align:"end",children:[t.jsxs(ae,{onClick:()=>o(`/activities/show/${e.id}`),children:[t.jsx(qe,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),t.jsxs(ae,{onClick:()=>i("activities",e.id),children:[t.jsx(Lt,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),t.jsx(Nt,{}),t.jsx(ae,{onClick:()=>r(e.id,e.is_published,e.title),children:e.is_published?t.jsxs(t.Fragment,{children:[t.jsx(ya,{className:"mr-2 h-4 w-4"}),"Ukryj aktywność"]}):t.jsxs(t.Fragment,{children:[t.jsx(qe,{className:"mr-2 h-4 w-4"}),"Opublikuj aktywność"]})}),e.type==="quiz"&&t.jsxs(t.Fragment,{children:[t.jsx(Nt,{}),t.jsxs(ae,{onClick:()=>o(`/questions/manage/${e.id}`),className:"text-blue-600 focus:text-blue-600",children:[t.jsx(Qs,{className:"mr-2 h-4 w-4"}),"Zarządzaj pytaniami"]}),t.jsxs(ae,{onClick:()=>o(`/questions/create?activity_id=${e.id}`),className:"text-blue-600 focus:text-blue-600",children:[t.jsx(Le,{className:"mr-2 h-4 w-4"}),"Dodaj pytanie"]})]}),t.jsx(Nt,{}),t.jsxs(ae,{onClick:()=>n(e.id,e.title),className:"text-red-600 focus:text-red-600",children:[t.jsx(ds,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})]})},$w=({course:e})=>e?t.jsx(R,{className:"flex-1",children:t.jsx(F,{className:"pt-6",children:t.jsxs("div",{className:"flex items-start gap-4",children:[e.icon_emoji&&t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-3xl",children:e.icon_emoji})})}),t.jsxs("div",{className:"flex-1 space-y-3",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-semibold",children:e.title}),t.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:e.is_published?"Opublikowany":"Szkic"}),e.created_at&&t.jsxs("span",{className:"text-sm text-muted-foreground",children:["Utworzony: ",new Date(e.created_at).toLocaleDateString("pl-PL")]})]})]}),e.description&&t.jsx("div",{className:"prose prose-sm max-w-none",children:t.jsx("p",{className:"text-muted-foreground leading-relaxed whitespace-pre-wrap",children:e.description})})]})]})})}):null;function qw(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return x.useMemo(()=>i=>{s.forEach(r=>r(i))},s)}const Sa=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Kn(e){const s=Object.prototype.toString.call(e);return s==="[object Window]"||s==="[object global]"}function Vl(e){return"nodeType"in e}function nt(e){var s,n;return e?Kn(e)?e:Vl(e)&&(s=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?s:window:window}function Bl(e){const{Document:s}=nt(e);return e instanceof s}function ar(e){return Kn(e)?!1:e instanceof nt(e).HTMLElement}function dp(e){return e instanceof nt(e).SVGElement}function Gn(e){return e?Kn(e)?e.document:Vl(e)?Bl(e)?e:ar(e)||dp(e)?e.ownerDocument:document:document:document}const Yt=Sa?x.useLayoutEffect:x.useEffect;function Ul(e){const s=x.useRef(e);return Yt(()=>{s.current=e}),x.useCallback(function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return s.current==null?void 0:s.current(...i)},[])}function Vw(){const e=x.useRef(null),s=x.useCallback((i,r)=>{e.current=setInterval(i,r)},[]),n=x.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[s,n]}function Ri(e,s){s===void 0&&(s=[e]);const n=x.useRef(e);return Yt(()=>{n.current!==e&&(n.current=e)},s),n}function or(e,s){const n=x.useRef();return x.useMemo(()=>{const i=e(n.current);return n.current=i,i},[...s])}function Xr(e){const s=Ul(e),n=x.useRef(null),i=x.useCallback(r=>{r!==n.current&&s?.(r,n.current),n.current=r},[]);return[n,i]}function Ro(e){const s=x.useRef();return x.useEffect(()=>{s.current=e},[e]),s.current}let to={};function lr(e,s){return x.useMemo(()=>{if(s)return s;const n=to[e]==null?0:to[e]+1;return to[e]=n,e+"-"+n},[e,s])}function up(e){return function(s){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.reduce((a,o)=>{const l=Object.entries(o);for(const[c,d]of l){const m=a[c];m!=null&&(a[c]=m+e*d)}return a},{...s})}}const An=up(1),Fi=up(-1);function Bw(e){return"clientX"in e&&"clientY"in e}function Wl(e){if(!e)return!1;const{KeyboardEvent:s}=nt(e.target);return s&&e instanceof s}function Uw(e){if(!e)return!1;const{TouchEvent:s}=nt(e.target);return s&&e instanceof s}function Fo(e){if(Uw(e)){if(e.touches&&e.touches.length){const{clientX:s,clientY:n}=e.touches[0];return{x:s,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:s,clientY:n}=e.changedTouches[0];return{x:s,y:n}}}return Bw(e)?{x:e.clientX,y:e.clientY}:null}const $i=Object.freeze({Translate:{toString(e){if(!e)return;const{x:s,y:n}=e;return"translate3d("+(s?Math.round(s):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:s,scaleY:n}=e;return"scaleX("+s+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[$i.Translate.toString(e),$i.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:s,duration:n,easing:i}=e;return s+" "+n+"ms "+i}}}),pd="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Ww(e){return e.matches(pd)?e:e.querySelector(pd)}const Kw={display:"none"};function Gw(e){let{id:s,value:n}=e;return G.createElement("div",{id:s,style:Kw},n)}function Hw(e){let{id:s,announcement:n,ariaLiveType:i="assertive"}=e;const r={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return G.createElement("div",{id:s,style:r,role:"status","aria-live":i,"aria-atomic":!0},n)}function Qw(){const[e,s]=x.useState("");return{announce:x.useCallback(i=>{i!=null&&s(i)},[]),announcement:e}}const mp=x.createContext(null);function Yw(e){const s=x.useContext(mp);x.useEffect(()=>{if(!s)throw new Error("useDndMonitor must be used within a children of <DndContext>");return s(e)},[e,s])}function Zw(){const[e]=x.useState(()=>new Set),s=x.useCallback(i=>(e.add(i),()=>e.delete(i)),[e]);return[x.useCallback(i=>{let{type:r,event:a}=i;e.forEach(o=>{var l;return(l=o[r])==null?void 0:l.call(o,a)})},[e]),s]}const Jw={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Xw={onDragStart(e){let{active:s}=e;return"Picked up draggable item "+s.id+"."},onDragOver(e){let{active:s,over:n}=e;return n?"Draggable item "+s.id+" was moved over droppable area "+n.id+".":"Draggable item "+s.id+" is no longer over a droppable area."},onDragEnd(e){let{active:s,over:n}=e;return n?"Draggable item "+s.id+" was dropped over droppable area "+n.id:"Draggable item "+s.id+" was dropped."},onDragCancel(e){let{active:s}=e;return"Dragging was cancelled. Draggable item "+s.id+" was dropped."}};function ev(e){let{announcements:s=Xw,container:n,hiddenTextDescribedById:i,screenReaderInstructions:r=Jw}=e;const{announce:a,announcement:o}=Qw(),l=lr("DndLiveRegion"),[c,d]=x.useState(!1);if(x.useEffect(()=>{d(!0)},[]),Yw(x.useMemo(()=>({onDragStart(u){let{active:h}=u;a(s.onDragStart({active:h}))},onDragMove(u){let{active:h,over:p}=u;s.onDragMove&&a(s.onDragMove({active:h,over:p}))},onDragOver(u){let{active:h,over:p}=u;a(s.onDragOver({active:h,over:p}))},onDragEnd(u){let{active:h,over:p}=u;a(s.onDragEnd({active:h,over:p}))},onDragCancel(u){let{active:h,over:p}=u;a(s.onDragCancel({active:h,over:p}))}}),[a,s])),!c)return null;const m=G.createElement(G.Fragment,null,G.createElement(Gw,{id:i,value:r.draggable}),G.createElement(Hw,{id:l,announcement:o}));return n?gi.createPortal(m,n):m}var Te;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Te||(Te={}));function ea(){}function fd(e,s){return x.useMemo(()=>({sensor:e,options:s??{}}),[e,s])}function tv(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return x.useMemo(()=>[...s].filter(i=>i!=null),[...s])}const Mt=Object.freeze({x:0,y:0});function hp(e,s){return Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2))}function pp(e,s){let{data:{value:n}}=e,{data:{value:i}}=s;return n-i}function sv(e,s){let{data:{value:n}}=e,{data:{value:i}}=s;return i-n}function xd(e){let{left:s,top:n,height:i,width:r}=e;return[{x:s,y:n},{x:s+r,y:n},{x:s,y:n+i},{x:s+r,y:n+i}]}function fp(e,s){if(!e||e.length===0)return null;const[n]=e;return n[s]}function gd(e,s,n){return s===void 0&&(s=e.left),n===void 0&&(n=e.top),{x:s+e.width*.5,y:n+e.height*.5}}const nv=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:i}=e;const r=gd(s,s.left,s.top),a=[];for(const o of i){const{id:l}=o,c=n.get(l);if(c){const d=hp(gd(c),r);a.push({id:l,data:{droppableContainer:o,value:d}})}}return a.sort(pp)},iv=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:i}=e;const r=xd(s),a=[];for(const o of i){const{id:l}=o,c=n.get(l);if(c){const d=xd(c),m=r.reduce((h,p,g)=>h+hp(d[g],p),0),u=Number((m/4).toFixed(4));a.push({id:l,data:{droppableContainer:o,value:u}})}}return a.sort(pp)};function rv(e,s){const n=Math.max(s.top,e.top),i=Math.max(s.left,e.left),r=Math.min(s.left+s.width,e.left+e.width),a=Math.min(s.top+s.height,e.top+e.height),o=r-i,l=a-n;if(i<r&&n<a){const c=s.width*s.height,d=e.width*e.height,m=o*l,u=m/(c+d-m);return Number(u.toFixed(4))}return 0}const av=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:i}=e;const r=[];for(const a of i){const{id:o}=a,l=n.get(o);if(l){const c=rv(l,s);c>0&&r.push({id:o,data:{droppableContainer:a,value:c}})}}return r.sort(sv)};function ov(e,s,n){return{...e,scaleX:s&&n?s.width/n.width:1,scaleY:s&&n?s.height/n.height:1}}function xp(e,s){return e&&s?{x:e.left-s.left,y:e.top-s.top}:Mt}function lv(e){return function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),a=1;a<i;a++)r[a-1]=arguments[a];return r.reduce((o,l)=>({...o,top:o.top+e*l.y,bottom:o.bottom+e*l.y,left:o.left+e*l.x,right:o.right+e*l.x}),{...n})}}const cv=lv(1);function dv(e){if(e.startsWith("matrix3d(")){const s=e.slice(9,-1).split(/, /);return{x:+s[12],y:+s[13],scaleX:+s[0],scaleY:+s[5]}}else if(e.startsWith("matrix(")){const s=e.slice(7,-1).split(/, /);return{x:+s[4],y:+s[5],scaleX:+s[0],scaleY:+s[3]}}return null}function uv(e,s,n){const i=dv(s);if(!i)return e;const{scaleX:r,scaleY:a,x:o,y:l}=i,c=e.left-o-(1-r)*parseFloat(n),d=e.top-l-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),m=r?e.width/r:e.width,u=a?e.height/a:e.height;return{width:m,height:u,top:d,right:c+m,bottom:d+u,left:c}}const mv={ignoreTransform:!1};function Hn(e,s){s===void 0&&(s=mv);let n=e.getBoundingClientRect();if(s.ignoreTransform){const{transform:d,transformOrigin:m}=nt(e).getComputedStyle(e);d&&(n=uv(n,d,m))}const{top:i,left:r,width:a,height:o,bottom:l,right:c}=n;return{top:i,left:r,width:a,height:o,bottom:l,right:c}}function yd(e){return Hn(e,{ignoreTransform:!0})}function hv(e){const s=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:s,bottom:n,width:s,height:n}}function pv(e,s){return s===void 0&&(s=nt(e).getComputedStyle(e)),s.position==="fixed"}function fv(e,s){s===void 0&&(s=nt(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(r=>{const a=s[r];return typeof a=="string"?n.test(a):!1})}function Ca(e,s){const n=[];function i(r){if(s!=null&&n.length>=s||!r)return n;if(Bl(r)&&r.scrollingElement!=null&&!n.includes(r.scrollingElement))return n.push(r.scrollingElement),n;if(!ar(r)||dp(r)||n.includes(r))return n;const a=nt(e).getComputedStyle(r);return r!==e&&fv(r,a)&&n.push(r),pv(r,a)?n:i(r.parentNode)}return e?i(e):n}function gp(e){const[s]=Ca(e,1);return s??null}function so(e){return!Sa||!e?null:Kn(e)?e:Vl(e)?Bl(e)||e===Gn(e).scrollingElement?window:ar(e)?e:null:null}function yp(e){return Kn(e)?e.scrollX:e.scrollLeft}function jp(e){return Kn(e)?e.scrollY:e.scrollTop}function $o(e){return{x:yp(e),y:jp(e)}}var Ie;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Ie||(Ie={}));function bp(e){return!Sa||!e?!1:e===document.scrollingElement}function wp(e){const s={x:0,y:0},n=bp(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},i={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},r=e.scrollTop<=s.y,a=e.scrollLeft<=s.x,o=e.scrollTop>=i.y,l=e.scrollLeft>=i.x;return{isTop:r,isLeft:a,isBottom:o,isRight:l,maxScroll:i,minScroll:s}}const xv={x:.2,y:.2};function gv(e,s,n,i,r){let{top:a,left:o,right:l,bottom:c}=n;i===void 0&&(i=10),r===void 0&&(r=xv);const{isTop:d,isBottom:m,isLeft:u,isRight:h}=wp(e),p={x:0,y:0},g={x:0,y:0},f={height:s.height*r.y,width:s.width*r.x};return!d&&a<=s.top+f.height?(p.y=Ie.Backward,g.y=i*Math.abs((s.top+f.height-a)/f.height)):!m&&c>=s.bottom-f.height&&(p.y=Ie.Forward,g.y=i*Math.abs((s.bottom-f.height-c)/f.height)),!h&&l>=s.right-f.width?(p.x=Ie.Forward,g.x=i*Math.abs((s.right-f.width-l)/f.width)):!u&&o<=s.left+f.width&&(p.x=Ie.Backward,g.x=i*Math.abs((s.left+f.width-o)/f.width)),{direction:p,speed:g}}function yv(e){if(e===document.scrollingElement){const{innerWidth:a,innerHeight:o}=window;return{top:0,left:0,right:a,bottom:o,width:a,height:o}}const{top:s,left:n,right:i,bottom:r}=e.getBoundingClientRect();return{top:s,left:n,right:i,bottom:r,width:e.clientWidth,height:e.clientHeight}}function vp(e){return e.reduce((s,n)=>An(s,$o(n)),Mt)}function jv(e){return e.reduce((s,n)=>s+yp(n),0)}function bv(e){return e.reduce((s,n)=>s+jp(n),0)}function wv(e,s){if(s===void 0&&(s=Hn),!e)return;const{top:n,left:i,bottom:r,right:a}=s(e);gp(e)&&(r<=0||a<=0||n>=window.innerHeight||i>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const vv=[["x",["left","right"],jv],["y",["top","bottom"],bv]];class Kl{constructor(s,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const i=Ca(n),r=vp(i);this.rect={...s},this.width=s.width,this.height=s.height;for(const[a,o,l]of vv)for(const c of o)Object.defineProperty(this,c,{get:()=>{const d=l(i),m=r[a]-d;return this.rect[c]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class vi{constructor(s){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var i;return(i=this.target)==null?void 0:i.removeEventListener(...n)})},this.target=s}add(s,n,i){var r;(r=this.target)==null||r.addEventListener(s,n,i),this.listeners.push([s,n,i])}}function Nv(e){const{EventTarget:s}=nt(e);return e instanceof s?e:Gn(e)}function no(e,s){const n=Math.abs(e.x),i=Math.abs(e.y);return typeof s=="number"?Math.sqrt(n**2+i**2)>s:"x"in s&&"y"in s?n>s.x&&i>s.y:"x"in s?n>s.x:"y"in s?i>s.y:!1}var wt;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(wt||(wt={}));function jd(e){e.preventDefault()}function kv(e){e.stopPropagation()}var ee;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(ee||(ee={}));const Np={start:[ee.Space,ee.Enter],cancel:[ee.Esc],end:[ee.Space,ee.Enter,ee.Tab]},zv=(e,s)=>{let{currentCoordinates:n}=s;switch(e.code){case ee.Right:return{...n,x:n.x+25};case ee.Left:return{...n,x:n.x-25};case ee.Down:return{...n,y:n.y+25};case ee.Up:return{...n,y:n.y-25}}};class Gl{constructor(s){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=s;const{event:{target:n}}=s;this.props=s,this.listeners=new vi(Gn(n)),this.windowListeners=new vi(nt(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(wt.Resize,this.handleCancel),this.windowListeners.add(wt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(wt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:s,onStart:n}=this.props,i=s.node.current;i&&wv(i),n(Mt)}handleKeyDown(s){if(Wl(s)){const{active:n,context:i,options:r}=this.props,{keyboardCodes:a=Np,coordinateGetter:o=zv,scrollBehavior:l="smooth"}=r,{code:c}=s;if(a.end.includes(c)){this.handleEnd(s);return}if(a.cancel.includes(c)){this.handleCancel(s);return}const{collisionRect:d}=i.current,m=d?{x:d.left,y:d.top}:Mt;this.referenceCoordinates||(this.referenceCoordinates=m);const u=o(s,{active:n,context:i.current,currentCoordinates:m});if(u){const h=Fi(u,m),p={x:0,y:0},{scrollableAncestors:g}=i.current;for(const f of g){const y=s.code,{isTop:b,isRight:j,isLeft:w,isBottom:S,maxScroll:k,minScroll:z}=wp(f),N=yv(f),C={x:Math.min(y===ee.Right?N.right-N.width/2:N.right,Math.max(y===ee.Right?N.left:N.left+N.width/2,u.x)),y:Math.min(y===ee.Down?N.bottom-N.height/2:N.bottom,Math.max(y===ee.Down?N.top:N.top+N.height/2,u.y))},A=y===ee.Right&&!j||y===ee.Left&&!w,v=y===ee.Down&&!S||y===ee.Up&&!b;if(A&&C.x!==u.x){const P=f.scrollLeft+h.x,D=y===ee.Right&&P<=k.x||y===ee.Left&&P>=z.x;if(D&&!h.y){f.scrollTo({left:P,behavior:l});return}D?p.x=f.scrollLeft-P:p.x=y===ee.Right?f.scrollLeft-k.x:f.scrollLeft-z.x,p.x&&f.scrollBy({left:-p.x,behavior:l});break}else if(v&&C.y!==u.y){const P=f.scrollTop+h.y,D=y===ee.Down&&P<=k.y||y===ee.Up&&P>=z.y;if(D&&!h.x){f.scrollTo({top:P,behavior:l});return}D?p.y=f.scrollTop-P:p.y=y===ee.Down?f.scrollTop-k.y:f.scrollTop-z.y,p.y&&f.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(s,An(Fi(u,this.referenceCoordinates),p))}}}handleMove(s,n){const{onMove:i}=this.props;s.preventDefault(),i(n)}handleEnd(s){const{onEnd:n}=this.props;s.preventDefault(),this.detach(),n()}handleCancel(s){const{onCancel:n}=this.props;s.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Gl.activators=[{eventName:"onKeyDown",handler:(e,s,n)=>{let{keyboardCodes:i=Np,onActivation:r}=s,{active:a}=n;const{code:o}=e.nativeEvent;if(i.start.includes(o)){const l=a.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),r?.({event:e.nativeEvent}),!0)}return!1}}];function bd(e){return!!(e&&"distance"in e)}function wd(e){return!!(e&&"delay"in e)}class Hl{constructor(s,n,i){var r;i===void 0&&(i=Nv(s.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=s,this.events=n;const{event:a}=s,{target:o}=a;this.props=s,this.events=n,this.document=Gn(o),this.documentListeners=new vi(this.document),this.listeners=new vi(i),this.windowListeners=new vi(nt(o)),this.initialCoordinates=(r=Fo(a))!=null?r:Mt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:s,props:{options:{activationConstraint:n,bypassActivationConstraint:i}}}=this;if(this.listeners.add(s.move.name,this.handleMove,{passive:!1}),this.listeners.add(s.end.name,this.handleEnd),s.cancel&&this.listeners.add(s.cancel.name,this.handleCancel),this.windowListeners.add(wt.Resize,this.handleCancel),this.windowListeners.add(wt.DragStart,jd),this.windowListeners.add(wt.VisibilityChange,this.handleCancel),this.windowListeners.add(wt.ContextMenu,jd),this.documentListeners.add(wt.Keydown,this.handleKeydown),n){if(i!=null&&i({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(wd(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(bd(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(s,n){const{active:i,onPending:r}=this.props;r(i,s,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:s}=this,{onStart:n}=this.props;s&&(this.activated=!0,this.documentListeners.add(wt.Click,kv,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(wt.SelectionChange,this.removeTextSelection),n(s))}handleMove(s){var n;const{activated:i,initialCoordinates:r,props:a}=this,{onMove:o,options:{activationConstraint:l}}=a;if(!r)return;const c=(n=Fo(s))!=null?n:Mt,d=Fi(r,c);if(!i&&l){if(bd(l)){if(l.tolerance!=null&&no(d,l.tolerance))return this.handleCancel();if(no(d,l.distance))return this.handleStart()}if(wd(l)&&no(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}s.cancelable&&s.preventDefault(),o(c)}handleEnd(){const{onAbort:s,onEnd:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleCancel(){const{onAbort:s,onCancel:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleKeydown(s){s.code===ee.Esc&&this.handleCancel()}removeTextSelection(){var s;(s=this.document.getSelection())==null||s.removeAllRanges()}}const Sv={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Ql extends Hl{constructor(s){const{event:n}=s,i=Gn(n.target);super(s,Sv,i)}}Ql.activators=[{eventName:"onPointerDown",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:i}=s;return!n.isPrimary||n.button!==0?!1:(i?.({event:n}),!0)}}];const Cv={move:{name:"mousemove"},end:{name:"mouseup"}};var qo;(function(e){e[e.RightClick=2]="RightClick"})(qo||(qo={}));class Tv extends Hl{constructor(s){super(s,Cv,Gn(s.event.target))}}Tv.activators=[{eventName:"onMouseDown",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:i}=s;return n.button===qo.RightClick?!1:(i?.({event:n}),!0)}}];const io={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Av extends Hl{constructor(s){super(s,io)}static setup(){return window.addEventListener(io.move.name,s,{capture:!1,passive:!1}),function(){window.removeEventListener(io.move.name,s)};function s(){}}}Av.activators=[{eventName:"onTouchStart",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:i}=s;const{touches:r}=n;return r.length>1?!1:(i?.({event:n}),!0)}}];var Ni;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Ni||(Ni={}));var ta;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ta||(ta={}));function Pv(e){let{acceleration:s,activator:n=Ni.Pointer,canScroll:i,draggingRect:r,enabled:a,interval:o=5,order:l=ta.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:m,delta:u,threshold:h}=e;const p=Dv({delta:u,disabled:!a}),[g,f]=Vw(),y=x.useRef({x:0,y:0}),b=x.useRef({x:0,y:0}),j=x.useMemo(()=>{switch(n){case Ni.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Ni.DraggableRect:return r}},[n,r,c]),w=x.useRef(null),S=x.useCallback(()=>{const z=w.current;if(!z)return;const N=y.current.x*b.current.x,C=y.current.y*b.current.y;z.scrollBy(N,C)},[]),k=x.useMemo(()=>l===ta.TreeOrder?[...d].reverse():d,[l,d]);x.useEffect(()=>{if(!a||!d.length||!j){f();return}for(const z of k){if(i?.(z)===!1)continue;const N=d.indexOf(z),C=m[N];if(!C)continue;const{direction:A,speed:v}=gv(z,C,j,s,h);for(const P of["x","y"])p[P][A[P]]||(v[P]=0,A[P]=0);if(v.x>0||v.y>0){f(),w.current=z,g(S,o),y.current=v,b.current=A;return}}y.current={x:0,y:0},b.current={x:0,y:0},f()},[s,S,i,f,a,o,JSON.stringify(j),JSON.stringify(p),g,d,k,m,JSON.stringify(h)])}const Ev={x:{[Ie.Backward]:!1,[Ie.Forward]:!1},y:{[Ie.Backward]:!1,[Ie.Forward]:!1}};function Dv(e){let{delta:s,disabled:n}=e;const i=Ro(s);return or(r=>{if(n||!i||!r)return Ev;const a={x:Math.sign(s.x-i.x),y:Math.sign(s.y-i.y)};return{x:{[Ie.Backward]:r.x[Ie.Backward]||a.x===-1,[Ie.Forward]:r.x[Ie.Forward]||a.x===1},y:{[Ie.Backward]:r.y[Ie.Backward]||a.y===-1,[Ie.Forward]:r.y[Ie.Forward]||a.y===1}}},[n,s,i])}function _v(e,s){const n=s!=null?e.get(s):void 0,i=n?n.node.current:null;return or(r=>{var a;return s==null?null:(a=i??r)!=null?a:null},[i,s])}function Iv(e,s){return x.useMemo(()=>e.reduce((n,i)=>{const{sensor:r}=i,a=r.activators.map(o=>({eventName:o.eventName,handler:s(o.handler,i)}));return[...n,...a]},[]),[e,s])}var qi;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(qi||(qi={}));var Vo;(function(e){e.Optimized="optimized"})(Vo||(Vo={}));const vd=new Map;function Mv(e,s){let{dragging:n,dependencies:i,config:r}=s;const[a,o]=x.useState(null),{frequency:l,measure:c,strategy:d}=r,m=x.useRef(e),u=y(),h=Ri(u),p=x.useCallback(function(b){b===void 0&&(b=[]),!h.current&&o(j=>j===null?b:j.concat(b.filter(w=>!j.includes(w))))},[h]),g=x.useRef(null),f=or(b=>{if(u&&!n)return vd;if(!b||b===vd||m.current!==e||a!=null){const j=new Map;for(let w of e){if(!w)continue;if(a&&a.length>0&&!a.includes(w.id)&&w.rect.current){j.set(w.id,w.rect.current);continue}const S=w.node.current,k=S?new Kl(c(S),S):null;w.rect.current=k,k&&j.set(w.id,k)}return j}return b},[e,a,n,u,c]);return x.useEffect(()=>{m.current=e},[e]),x.useEffect(()=>{u||p()},[n,u]),x.useEffect(()=>{a&&a.length>0&&o(null)},[JSON.stringify(a)]),x.useEffect(()=>{u||typeof l!="number"||g.current!==null||(g.current=setTimeout(()=>{p(),g.current=null},l))},[l,u,p,...i]),{droppableRects:f,measureDroppableContainers:p,measuringScheduled:a!=null};function y(){switch(d){case qi.Always:return!1;case qi.BeforeDragging:return n;default:return!n}}}function kp(e,s){return or(n=>e?n||(typeof s=="function"?s(e):e):null,[s,e])}function Lv(e,s){return kp(e,s)}function Ov(e){let{callback:s,disabled:n}=e;const i=Ul(s),r=x.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(i)},[i,n]);return x.useEffect(()=>()=>r?.disconnect(),[r]),r}function Ta(e){let{callback:s,disabled:n}=e;const i=Ul(s),r=x.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(i)},[n]);return x.useEffect(()=>()=>r?.disconnect(),[r]),r}function Rv(e){return new Kl(Hn(e),e)}function Nd(e,s,n){s===void 0&&(s=Rv);const[i,r]=x.useState(null);function a(){r(c=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=c??n)!=null?d:null}const m=s(e);return JSON.stringify(c)===JSON.stringify(m)?c:m})}const o=Ov({callback(c){if(e)for(const d of c){const{type:m,target:u}=d;if(m==="childList"&&u instanceof HTMLElement&&u.contains(e)){a();break}}}}),l=Ta({callback:a});return Yt(()=>{a(),e?(l?.observe(e),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[e]),i}function Fv(e){const s=kp(e);return xp(e,s)}const kd=[];function $v(e){const s=x.useRef(e),n=or(i=>e?i&&i!==kd&&e&&s.current&&e.parentNode===s.current.parentNode?i:Ca(e):kd,[e]);return x.useEffect(()=>{s.current=e},[e]),n}function qv(e){const[s,n]=x.useState(null),i=x.useRef(e),r=x.useCallback(a=>{const o=so(a.target);o&&n(l=>l?(l.set(o,$o(o)),new Map(l)):null)},[]);return x.useEffect(()=>{const a=i.current;if(e!==a){o(a);const l=e.map(c=>{const d=so(c);return d?(d.addEventListener("scroll",r,{passive:!0}),[d,$o(d)]):null}).filter(c=>c!=null);n(l.length?new Map(l):null),i.current=e}return()=>{o(e),o(a)};function o(l){l.forEach(c=>{const d=so(c);d?.removeEventListener("scroll",r)})}},[r,e]),x.useMemo(()=>e.length?s?Array.from(s.values()).reduce((a,o)=>An(a,o),Mt):vp(e):Mt,[e,s])}function zd(e,s){s===void 0&&(s=[]);const n=x.useRef(null);return x.useEffect(()=>{n.current=null},s),x.useEffect(()=>{const i=e!==Mt;i&&!n.current&&(n.current=e),!i&&n.current&&(n.current=null)},[e]),n.current?Fi(e,n.current):Mt}function Vv(e){x.useEffect(()=>{if(!Sa)return;const s=e.map(n=>{let{sensor:i}=n;return i.setup==null?void 0:i.setup()});return()=>{for(const n of s)n?.()}},e.map(s=>{let{sensor:n}=s;return n}))}function Bv(e,s){return x.useMemo(()=>e.reduce((n,i)=>{let{eventName:r,handler:a}=i;return n[r]=o=>{a(o,s)},n},{}),[e,s])}function zp(e){return x.useMemo(()=>e?hv(e):null,[e])}const Sd=[];function Uv(e,s){s===void 0&&(s=Hn);const[n]=e,i=zp(n?nt(n):null),[r,a]=x.useState(Sd);function o(){a(()=>e.length?e.map(c=>bp(c)?i:new Kl(s(c),c)):Sd)}const l=Ta({callback:o});return Yt(()=>{l?.disconnect(),o(),e.forEach(c=>l?.observe(c))},[e]),r}function Wv(e){if(!e)return null;if(e.children.length>1)return e;const s=e.children[0];return ar(s)?s:e}function Kv(e){let{measure:s}=e;const[n,i]=x.useState(null),r=x.useCallback(d=>{for(const{target:m}of d)if(ar(m)){i(u=>{const h=s(m);return u?{...u,width:h.width,height:h.height}:h});break}},[s]),a=Ta({callback:r}),o=x.useCallback(d=>{const m=Wv(d);a?.disconnect(),m&&a?.observe(m),i(m?s(m):null)},[s,a]),[l,c]=Xr(o);return x.useMemo(()=>({nodeRef:l,rect:n,setRef:c}),[n,l,c])}const Gv=[{sensor:Ql,options:{}},{sensor:Gl,options:{}}],Hv={current:{}},$r={draggable:{measure:yd},droppable:{measure:yd,strategy:qi.WhileDragging,frequency:Vo.Optimized},dragOverlay:{measure:Hn}};class ki extends Map{get(s){var n;return s!=null&&(n=super.get(s))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(s=>{let{disabled:n}=s;return!n})}getNodeFor(s){var n,i;return(n=(i=this.get(s))==null?void 0:i.node.current)!=null?n:void 0}}const Qv={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new ki,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:ea},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:$r,measureDroppableContainers:ea,windowRect:null,measuringScheduled:!1},Yv={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:ea,draggableNodes:new Map,over:null,measureDroppableContainers:ea},Aa=x.createContext(Yv),Sp=x.createContext(Qv);function Zv(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new ki}}}function Jv(e,s){switch(s.type){case Te.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:s.initialCoordinates,active:s.active}};case Te.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:s.coordinates.x-e.draggable.initialCoordinates.x,y:s.coordinates.y-e.draggable.initialCoordinates.y}}};case Te.DragEnd:case Te.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Te.RegisterDroppable:{const{element:n}=s,{id:i}=n,r=new ki(e.droppable.containers);return r.set(i,n),{...e,droppable:{...e.droppable,containers:r}}}case Te.SetDroppableDisabled:{const{id:n,key:i,disabled:r}=s,a=e.droppable.containers.get(n);if(!a||i!==a.key)return e;const o=new ki(e.droppable.containers);return o.set(n,{...a,disabled:r}),{...e,droppable:{...e.droppable,containers:o}}}case Te.UnregisterDroppable:{const{id:n,key:i}=s,r=e.droppable.containers.get(n);if(!r||i!==r.key)return e;const a=new ki(e.droppable.containers);return a.delete(n),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function Xv(e){let{disabled:s}=e;const{active:n,activatorEvent:i,draggableNodes:r}=x.useContext(Aa),a=Ro(i),o=Ro(n?.id);return x.useEffect(()=>{if(!s&&!i&&a&&o!=null){if(!Wl(a)||document.activeElement===a.target)return;const l=r.get(o);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const m of[c.current,d.current]){if(!m)continue;const u=Ww(m);if(u){u.focus();break}}})}},[i,s,r,o,a]),null}function e0(e,s){let{transform:n,...i}=s;return e!=null&&e.length?e.reduce((r,a)=>a({transform:r,...i}),n):n}function t0(e){return x.useMemo(()=>({draggable:{...$r.draggable,...e?.draggable},droppable:{...$r.droppable,...e?.droppable},dragOverlay:{...$r.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function s0(e){let{activeNode:s,measure:n,initialRect:i,config:r=!0}=e;const a=x.useRef(!1),{x:o,y:l}=typeof r=="boolean"?{x:r,y:r}:r;Yt(()=>{if(!o&&!l||!s){a.current=!1;return}if(a.current||!i)return;const d=s?.node.current;if(!d||d.isConnected===!1)return;const m=n(d),u=xp(m,i);if(o||(u.x=0),l||(u.y=0),a.current=!0,Math.abs(u.x)>0||Math.abs(u.y)>0){const h=gp(d);h&&h.scrollBy({top:u.y,left:u.x})}},[s,o,l,i,n])}const Cp=x.createContext({...Mt,scaleX:1,scaleY:1});var ws;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ws||(ws={}));const n0=x.memo(function(s){var n,i,r,a;let{id:o,accessibility:l,autoScroll:c=!0,children:d,sensors:m=Gv,collisionDetection:u=av,measuring:h,modifiers:p,...g}=s;const f=x.useReducer(Jv,void 0,Zv),[y,b]=f,[j,w]=Zw(),[S,k]=x.useState(ws.Uninitialized),z=S===ws.Initialized,{draggable:{active:N,nodes:C,translate:A},droppable:{containers:v}}=y,P=N!=null?C.get(N):null,D=x.useRef({initial:null,translated:null}),_=x.useMemo(()=>{var Ue;return N!=null?{id:N,data:(Ue=P?.data)!=null?Ue:Hv,rect:D}:null},[N,P]),E=x.useRef(null),[X,Be]=x.useState(null),[Q,J]=x.useState(null),$=Ri(g,Object.values(g)),me=lr("DndDescribedBy",o),Ee=x.useMemo(()=>v.getEnabled(),[v]),xe=t0(h),{droppableRects:it,measureDroppableContainers:At,measuringScheduled:ps}=Mv(Ee,{dragging:z,dependencies:[A.x,A.y],config:xe.droppable}),De=_v(C,N),_e=x.useMemo(()=>Q?Fo(Q):null,[Q]),Pt=$g(),ns=Lv(De,xe.draggable.measure);s0({activeNode:N!=null?C.get(N):null,config:Pt.layoutShiftCompensation,initialRect:ns,measure:xe.draggable.measure});const ie=Nd(De,xe.draggable.measure,ns),li=Nd(De?De.parentElement:null),Ft=x.useRef({activatorEvent:null,active:null,activeNode:De,collisionRect:null,collisions:null,droppableRects:it,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:v,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ln=v.getNodeFor((n=Ft.current.over)==null?void 0:n.id),is=Kv({measure:xe.dragOverlay.measure}),cn=(i=is.nodeRef.current)!=null?i:De,dn=z?(r=is.rect)!=null?r:ie:null,Qc=!!(is.nodeRef.current&&is.rect),Yc=Fv(Qc?null:ie),Ya=zp(cn?nt(cn):null),fs=$v(z?ln??De:null),Nr=Uv(fs),kr=e0(p,{transform:{x:A.x-Yc.x,y:A.y-Yc.y,scaleX:1,scaleY:1},activatorEvent:Q,active:_,activeNodeRect:ie,containerNodeRect:li,draggingNodeRect:dn,over:Ft.current.over,overlayNodeRect:is.rect,scrollableAncestors:fs,scrollableAncestorRects:Nr,windowRect:Ya}),Zc=_e?An(_e,A):null,Jc=qv(fs),_g=zd(Jc),Ig=zd(Jc,[ie]),un=An(kr,_g),mn=dn?cv(dn,kr):null,ci=_&&mn?u({active:_,collisionRect:mn,droppableRects:it,droppableContainers:Ee,pointerCoordinates:Zc}):null,Xc=fp(ci,"id"),[xs,ed]=x.useState(null),Mg=Qc?kr:An(kr,Ig),Lg=ov(Mg,(a=xs?.rect)!=null?a:null,ie),Za=x.useRef(null),td=x.useCallback((Ue,rt)=>{let{sensor:at,options:gs}=rt;if(E.current==null)return;const gt=C.get(E.current);if(!gt)return;const ot=Ue.nativeEvent,$t=new at({active:E.current,activeNode:gt,event:ot,options:gs,context:Ft,onAbort(Re){if(!C.get(Re))return;const{onDragAbort:qt}=$.current,rs={id:Re};qt?.(rs),j({type:"onDragAbort",event:rs})},onPending(Re,ys,qt,rs){if(!C.get(Re))return;const{onDragPending:ui}=$.current,js={id:Re,constraint:ys,initialCoordinates:qt,offset:rs};ui?.(js),j({type:"onDragPending",event:js})},onStart(Re){const ys=E.current;if(ys==null)return;const qt=C.get(ys);if(!qt)return;const{onDragStart:rs}=$.current,di={activatorEvent:ot,active:{id:ys,data:qt.data,rect:D}};gi.unstable_batchedUpdates(()=>{rs?.(di),k(ws.Initializing),b({type:Te.DragStart,initialCoordinates:Re,active:ys}),j({type:"onDragStart",event:di}),Be(Za.current),J(ot)})},onMove(Re){b({type:Te.DragMove,coordinates:Re})},onEnd:hn(Te.DragEnd),onCancel:hn(Te.DragCancel)});Za.current=$t;function hn(Re){return async function(){const{active:qt,collisions:rs,over:di,scrollAdjustedTranslate:ui}=Ft.current;let js=null;if(qt&&ui){const{cancelDrop:mi}=$.current;js={activatorEvent:ot,active:qt,collisions:rs,delta:ui,over:di},Re===Te.DragEnd&&typeof mi=="function"&&await Promise.resolve(mi(js))&&(Re=Te.DragCancel)}E.current=null,gi.unstable_batchedUpdates(()=>{b({type:Re}),k(ws.Uninitialized),ed(null),Be(null),J(null),Za.current=null;const mi=Re===Te.DragEnd?"onDragEnd":"onDragCancel";if(js){const Ja=$.current[mi];Ja?.(js),j({type:mi,event:js})}})}}},[C]),Og=x.useCallback((Ue,rt)=>(at,gs)=>{const gt=at.nativeEvent,ot=C.get(gs);if(E.current!==null||!ot||gt.dndKit||gt.defaultPrevented)return;const $t={active:ot};Ue(at,rt.options,$t)===!0&&(gt.dndKit={capturedBy:rt.sensor},E.current=gs,td(at,rt))},[C,td]),sd=Iv(m,Og);Vv(m),Yt(()=>{ie&&S===ws.Initializing&&k(ws.Initialized)},[ie,S]),x.useEffect(()=>{const{onDragMove:Ue}=$.current,{active:rt,activatorEvent:at,collisions:gs,over:gt}=Ft.current;if(!rt||!at)return;const ot={active:rt,activatorEvent:at,collisions:gs,delta:{x:un.x,y:un.y},over:gt};gi.unstable_batchedUpdates(()=>{Ue?.(ot),j({type:"onDragMove",event:ot})})},[un.x,un.y]),x.useEffect(()=>{const{active:Ue,activatorEvent:rt,collisions:at,droppableContainers:gs,scrollAdjustedTranslate:gt}=Ft.current;if(!Ue||E.current==null||!rt||!gt)return;const{onDragOver:ot}=$.current,$t=gs.get(Xc),hn=$t&&$t.rect.current?{id:$t.id,rect:$t.rect.current,data:$t.data,disabled:$t.disabled}:null,Re={active:Ue,activatorEvent:rt,collisions:at,delta:{x:gt.x,y:gt.y},over:hn};gi.unstable_batchedUpdates(()=>{ed(hn),ot?.(Re),j({type:"onDragOver",event:Re})})},[Xc]),Yt(()=>{Ft.current={activatorEvent:Q,active:_,activeNode:De,collisionRect:mn,collisions:ci,droppableRects:it,draggableNodes:C,draggingNode:cn,draggingNodeRect:dn,droppableContainers:v,over:xs,scrollableAncestors:fs,scrollAdjustedTranslate:un},D.current={initial:dn,translated:mn}},[_,De,ci,mn,C,cn,dn,it,v,xs,fs,un]),Pv({...Pt,delta:A,draggingRect:mn,pointerCoordinates:Zc,scrollableAncestors:fs,scrollableAncestorRects:Nr});const Rg=x.useMemo(()=>({active:_,activeNode:De,activeNodeRect:ie,activatorEvent:Q,collisions:ci,containerNodeRect:li,dragOverlay:is,draggableNodes:C,droppableContainers:v,droppableRects:it,over:xs,measureDroppableContainers:At,scrollableAncestors:fs,scrollableAncestorRects:Nr,measuringConfiguration:xe,measuringScheduled:ps,windowRect:Ya}),[_,De,ie,Q,ci,li,is,C,v,it,xs,At,fs,Nr,xe,ps,Ya]),Fg=x.useMemo(()=>({activatorEvent:Q,activators:sd,active:_,activeNodeRect:ie,ariaDescribedById:{draggable:me},dispatch:b,draggableNodes:C,over:xs,measureDroppableContainers:At}),[Q,sd,_,ie,b,me,C,xs,At]);return G.createElement(mp.Provider,{value:w},G.createElement(Aa.Provider,{value:Fg},G.createElement(Sp.Provider,{value:Rg},G.createElement(Cp.Provider,{value:Lg},d)),G.createElement(Xv,{disabled:l?.restoreFocus===!1})),G.createElement(ev,{...l,hiddenTextDescribedById:me}));function $g(){const Ue=X?.autoScrollEnabled===!1,rt=typeof c=="object"?c.enabled===!1:c===!1,at=z&&!Ue&&!rt;return typeof c=="object"?{...c,enabled:at}:{enabled:at}}}),i0=x.createContext(null),Cd="button",r0="Draggable";function a0(e){let{id:s,data:n,disabled:i=!1,attributes:r}=e;const a=lr(r0),{activators:o,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:m,draggableNodes:u,over:h}=x.useContext(Aa),{role:p=Cd,roleDescription:g="draggable",tabIndex:f=0}=r??{},y=c?.id===s,b=x.useContext(y?Cp:i0),[j,w]=Xr(),[S,k]=Xr(),z=Bv(o,s),N=Ri(n);Yt(()=>(u.set(s,{id:s,key:a,node:j,activatorNode:S,data:N}),()=>{const A=u.get(s);A&&A.key===a&&u.delete(s)}),[u,s]);const C=x.useMemo(()=>({role:p,tabIndex:f,"aria-disabled":i,"aria-pressed":y&&p===Cd?!0:void 0,"aria-roledescription":g,"aria-describedby":m.draggable}),[i,p,f,y,g,m.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:C,isDragging:y,listeners:i?void 0:z,node:j,over:h,setNodeRef:w,setActivatorNodeRef:k,transform:b}}function o0(){return x.useContext(Sp)}const l0="Droppable",c0={timeout:25};function d0(e){let{data:s,disabled:n=!1,id:i,resizeObserverConfig:r}=e;const a=lr(l0),{active:o,dispatch:l,over:c,measureDroppableContainers:d}=x.useContext(Aa),m=x.useRef({disabled:n}),u=x.useRef(!1),h=x.useRef(null),p=x.useRef(null),{disabled:g,updateMeasurementsFor:f,timeout:y}={...c0,...r},b=Ri(f??i),j=x.useCallback(()=>{if(!u.current){u.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{d(Array.isArray(b.current)?b.current:[b.current]),p.current=null},y)},[y]),w=Ta({callback:j,disabled:g||!o}),S=x.useCallback((C,A)=>{w&&(A&&(w.unobserve(A),u.current=!1),C&&w.observe(C))},[w]),[k,z]=Xr(S),N=Ri(s);return x.useEffect(()=>{!w||!k.current||(w.disconnect(),u.current=!1,w.observe(k.current))},[k,w]),x.useEffect(()=>(l({type:Te.RegisterDroppable,element:{id:i,key:a,disabled:n,node:k,rect:h,data:N}}),()=>l({type:Te.UnregisterDroppable,key:a,id:i})),[i]),x.useEffect(()=>{n!==m.current.disabled&&(l({type:Te.SetDroppableDisabled,id:i,key:a,disabled:n}),m.current.disabled=n)},[i,a,n,l]),{active:o,rect:h,isOver:c?.id===i,node:k,over:c,setNodeRef:z}}function Yl(e,s,n){const i=e.slice();return i.splice(n<0?i.length+n:n,0,i.splice(s,1)[0]),i}function u0(e,s){return e.reduce((n,i,r)=>{const a=s.get(i);return a&&(n[r]=a),n},Array(e.length))}function Cr(e){return e!==null&&e>=0}function m0(e,s){if(e===s)return!0;if(e.length!==s.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==s[n])return!1;return!0}function h0(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Tp=e=>{let{rects:s,activeIndex:n,overIndex:i,index:r}=e;const a=Yl(s,i,n),o=s[r],l=a[r];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},Tr={scaleX:1,scaleY:1},p0=e=>{var s;let{activeIndex:n,activeNodeRect:i,index:r,rects:a,overIndex:o}=e;const l=(s=a[n])!=null?s:i;if(!l)return null;if(r===n){const d=a[o];return d?{x:0,y:n<o?d.top+d.height-(l.top+l.height):d.top-l.top,...Tr}:null}const c=f0(a,r,n);return r>n&&r<=o?{x:0,y:-l.height-c,...Tr}:r<n&&r>=o?{x:0,y:l.height+c,...Tr}:{x:0,y:0,...Tr}};function f0(e,s,n){const i=e[s],r=e[s-1],a=e[s+1];return i?n<s?r?i.top-(r.top+r.height):a?a.top-(i.top+i.height):0:a?a.top-(i.top+i.height):r?i.top-(r.top+r.height):0:0}const Ap="Sortable",Pp=G.createContext({activeIndex:-1,containerId:Ap,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Tp,disabled:{draggable:!1,droppable:!1}});function x0(e){let{children:s,id:n,items:i,strategy:r=Tp,disabled:a=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:m}=o0(),u=lr(Ap,n),h=l.rect!==null,p=x.useMemo(()=>i.map(z=>typeof z=="object"&&"id"in z?z.id:z),[i]),g=o!=null,f=o?p.indexOf(o.id):-1,y=d?p.indexOf(d.id):-1,b=x.useRef(p),j=!m0(p,b.current),w=y!==-1&&f===-1||j,S=h0(a);Yt(()=>{j&&g&&m(p)},[j,p,g,m]),x.useEffect(()=>{b.current=p},[p]);const k=x.useMemo(()=>({activeIndex:f,containerId:u,disabled:S,disableTransforms:w,items:p,overIndex:y,useDragOverlay:h,sortedRects:u0(p,c),strategy:r}),[f,u,S.draggable,S.droppable,w,p,y,c,h,r]);return G.createElement(Pp.Provider,{value:k},s)}const g0=e=>{let{id:s,items:n,activeIndex:i,overIndex:r}=e;return Yl(n,i,r).indexOf(s)},y0=e=>{let{containerId:s,isSorting:n,wasDragging:i,index:r,items:a,newIndex:o,previousItems:l,previousContainerId:c,transition:d}=e;return!d||!i||l!==a&&r===o?!1:n?!0:o!==r&&s===c},j0={duration:200,easing:"ease"},Ep="transform",b0=$i.Transition.toString({property:Ep,duration:0,easing:"linear"}),w0={roleDescription:"sortable"};function v0(e){let{disabled:s,index:n,node:i,rect:r}=e;const[a,o]=x.useState(null),l=x.useRef(n);return Yt(()=>{if(!s&&n!==l.current&&i.current){const c=r.current;if(c){const d=Hn(i.current,{ignoreTransform:!0}),m={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(m.x||m.y)&&o(m)}}n!==l.current&&(l.current=n)},[s,n,i,r]),x.useEffect(()=>{a&&o(null)},[a]),a}function N0(e){let{animateLayoutChanges:s=y0,attributes:n,disabled:i,data:r,getNewIndex:a=g0,id:o,strategy:l,resizeObserverConfig:c,transition:d=j0}=e;const{items:m,containerId:u,activeIndex:h,disabled:p,disableTransforms:g,sortedRects:f,overIndex:y,useDragOverlay:b,strategy:j}=x.useContext(Pp),w=k0(i,p),S=m.indexOf(o),k=x.useMemo(()=>({sortable:{containerId:u,index:S,items:m},...r}),[u,r,S,m]),z=x.useMemo(()=>m.slice(m.indexOf(o)),[m,o]),{rect:N,node:C,isOver:A,setNodeRef:v}=d0({id:o,data:k,disabled:w.droppable,resizeObserverConfig:{updateMeasurementsFor:z,...c}}),{active:P,activatorEvent:D,activeNodeRect:_,attributes:E,setNodeRef:X,listeners:Be,isDragging:Q,over:J,setActivatorNodeRef:$,transform:me}=a0({id:o,data:k,attributes:{...w0,...n},disabled:w.draggable}),Ee=qw(v,X),xe=!!P,it=xe&&!g&&Cr(h)&&Cr(y),At=!b&&Q,ps=At&&it?me:null,_e=it?ps??(l??j)({rects:f,activeNodeRect:_,activeIndex:h,overIndex:y,index:S}):null,Pt=Cr(h)&&Cr(y)?a({id:o,items:m,activeIndex:h,overIndex:y}):S,ns=P?.id,ie=x.useRef({activeId:ns,items:m,newIndex:Pt,containerId:u}),li=m!==ie.current.items,Ft=s({active:P,containerId:u,isDragging:Q,isSorting:xe,id:o,index:S,items:m,newIndex:ie.current.newIndex,previousItems:ie.current.items,previousContainerId:ie.current.containerId,transition:d,wasDragging:ie.current.activeId!=null}),ln=v0({disabled:!Ft,index:S,node:C,rect:N});return x.useEffect(()=>{xe&&ie.current.newIndex!==Pt&&(ie.current.newIndex=Pt),u!==ie.current.containerId&&(ie.current.containerId=u),m!==ie.current.items&&(ie.current.items=m)},[xe,Pt,u,m]),x.useEffect(()=>{if(ns===ie.current.activeId)return;if(ns!=null&&ie.current.activeId==null){ie.current.activeId=ns;return}const cn=setTimeout(()=>{ie.current.activeId=ns},50);return()=>clearTimeout(cn)},[ns]),{active:P,activeIndex:h,attributes:E,data:k,rect:N,index:S,newIndex:Pt,items:m,isOver:A,isSorting:xe,isDragging:Q,listeners:Be,node:C,overIndex:y,over:J,setNodeRef:Ee,setActivatorNodeRef:$,setDroppableNodeRef:v,setDraggableNodeRef:X,transform:ln??_e,transition:is()};function is(){if(ln||li&&ie.current.newIndex===S)return b0;if(!(At&&!Wl(D)||!d)&&(xe||Ft))return $i.Transition.toString({...d,property:Ep})}}function k0(e,s){var n,i;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:s.draggable,droppable:(i=e?.droppable)!=null?i:s.droppable}}function sa(e){if(!e)return!1;const s=e.data.current;return!!(s&&"sortable"in s&&typeof s.sortable=="object"&&"containerId"in s.sortable&&"items"in s.sortable&&"index"in s.sortable)}const z0=[ee.Down,ee.Right,ee.Up,ee.Left],S0=(e,s)=>{let{context:{active:n,collisionRect:i,droppableRects:r,droppableContainers:a,over:o,scrollableAncestors:l}}=s;if(z0.includes(e.code)){if(e.preventDefault(),!n||!i)return;const c=[];a.getEnabled().forEach(u=>{if(!u||u!=null&&u.disabled)return;const h=r.get(u.id);if(h)switch(e.code){case ee.Down:i.top<h.top&&c.push(u);break;case ee.Up:i.top>h.top&&c.push(u);break;case ee.Left:i.left>h.left&&c.push(u);break;case ee.Right:i.left<h.left&&c.push(u);break}});const d=iv({collisionRect:i,droppableRects:r,droppableContainers:c});let m=fp(d,"id");if(m===o?.id&&d.length>1&&(m=d[1].id),m!=null){const u=a.get(n.id),h=a.get(m),p=h?r.get(h.id):null,g=h?.node.current;if(g&&p&&u&&h){const y=Ca(g).some((z,N)=>l[N]!==z),b=Dp(u,h),j=C0(u,h),w=y||!b?{x:0,y:0}:{x:j?i.width-p.width:0,y:j?i.height-p.height:0},S={x:p.left,y:p.top};return w.x&&w.y?S:Fi(S,w)}}}};function Dp(e,s){return!sa(e)||!sa(s)?!1:e.data.current.sortable.containerId===s.data.current.sortable.containerId}function C0(e,s){return!sa(e)||!sa(s)||!Dp(e,s)?!1:e.data.current.sortable.index<s.data.current.sortable.index}const T0=()=>t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),A0=({course:e,topicsCount:s,activitiesCount:n,accessCount:i})=>t.jsxs(be,{variant:"2-2-4",children:[t.jsxs(R,{children:[t.jsx(W,{className:"pb-2",children:t.jsx(U,{className:"text-sm font-medium",children:"Status"})}),t.jsx(F,{children:t.jsx(ne,{variant:e?.is_published?"default":"secondary",children:e?.is_published?"Opublikowany":"Szkic"})})]}),t.jsxs(R,{children:[t.jsx(W,{className:"pb-2",children:t.jsx(U,{className:"text-sm font-medium",children:"Tematy"})}),t.jsx(F,{children:t.jsx("div",{className:"text-2xl font-bold",children:s})})]}),t.jsxs(R,{children:[t.jsx(W,{className:"pb-2",children:t.jsx(U,{className:"text-sm font-medium",children:"Aktywności"})}),t.jsx(F,{children:t.jsx("div",{className:"text-2xl font-bold",children:n})})]}),t.jsxs(R,{children:[t.jsx(W,{className:"pb-2",children:t.jsx(U,{className:"text-sm font-medium",children:"Uczestników"})}),t.jsx(F,{children:t.jsx("div",{className:"text-2xl font-bold",children:i})})]})]}),P0=({id:e,disabled:s=!1,children:n})=>{const{attributes:i,listeners:r,setNodeRef:a,transform:o,transition:l,isDragging:c}=N0({id:e,disabled:s}),d={transform:$i.Transform.toString(o),transition:l,opacity:c?.5:1,cursor:c?"grabbing":"grab"},m=s?{}:{...i,...r,style:{cursor:c?"grabbing":"grab"}};return t.jsx("div",{ref:a,style:d,className:c?"z-50":"",children:n({dragHandleProps:m,isDragging:c})})},Td=({items:e,renderItem:s,onReorder:n,className:i="space-y-2",disabled:r=!1})=>{const[a,o]=x.useState(e),[l,c]=x.useState(null),[d,m]=x.useState(null);x.useEffect(()=>{if(!d)o(e);else{const g=a.map(f=>{const y=e.find(b=>b.id===f.id);return y?{...y,position:f.position}:f});o(g)}},[e]);const u=tv(fd(Ql,{activationConstraint:{distance:8}}),fd(Gl,{coordinateGetter:S0})),h=g=>{c(Number(g.active.id))},p=g=>{const{active:f,over:y}=g;if(c(null),y&&f.id!==y.id){const b=a.findIndex(w=>w.id===Number(f.id)),j=a.findIndex(w=>w.id===Number(y.id));if(b!==-1&&j!==-1&&b!==j){let w;const S=a[b];if(j===0)w=a[0].position/2;else if(j===a.length-1)w=a[a.length-1].position+1e3;else if(b<j){const N=a[j],C=j+1<a.length?a[j+1]:null;C?w=(N.position+C.position)/2:w=N.position+1e3}else{const N=j>0?a[j-1]:null,C=a[j];N?w=(N.position+C.position)/2:w=C.position/2}const z=Yl(a,b,j).map(N=>N.id===S.id?{...N,position:w}:N);o(z),m({id:S.id,position:w}),n(S.id,w),setTimeout(()=>m(null),2e3)}}};return t.jsx(n0,{sensors:u,collisionDetection:nv,onDragStart:h,onDragEnd:p,children:t.jsx(x0,{items:a.map(g=>g.id),strategy:p0,children:t.jsx("div",{className:i,children:a.map((g,f)=>t.jsx(P0,{id:g.id,disabled:r||d!==null&&d.id!==g.id,children:y=>s(g,f,y.dragHandleProps)},g.id))})})})},E0=()=>{const{list:e,edit:s}=Ve(),{id:n}=Ze(),[i,r]=pa(),{navigateWithReturn:a,navigateToWizard:o}=Ew(),{course:l,topics:c,stats:d,isLoading:m,refetchTopics:u,refetchActivities:h,getActivitiesForTopic:p}=Dw(n),{togglePublish:g}=Oo("topics"),{togglePublish:f}=Oo("activities"),{updatePosition:y,isUpdating:b}=hd("topics"),{updatePosition:j,isUpdating:w}=hd("activities"),{mutate:S}=In(),{mutate:k}=In(),z=i.get("expanded");if(m)return t.jsx(T0,{});if(!l)return t.jsx(q,{children:t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-muted-foreground",children:"Nie znaleziono kursu"})})});const N=D=>{z===D.toString()?(i.delete("expanded"),r(i)):r({expanded:D.toString()})},C=(D,_)=>{confirm(`Czy na pewno chcesz usunąć temat "${_}" wraz ze wszystkimi aktywnościami?`)&&S({resource:"topics",id:D},{onSuccess:()=>{O.success("Temat został usunięty"),u(),h(),z===D.toString()&&(i.delete("expanded"),r(i))}})},A=(D,_)=>{confirm(`Czy na pewno chcesz usunąć aktywność "${_}"?`)&&k({resource:"activities",id:D},{onSuccess:()=>{O.success("Aktywność została usunięta"),h(),u()}})},v=async(D,_)=>{try{await y(D,_)}catch(E){console.error("Failed to reorder topic:",E)}},P=async(D,_)=>{try{await j(D,_)}catch(E){console.error("Failed to reorder activity:",E)}};return t.jsxs(q,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("courses"),children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Szczegóły kursu"}),t.jsxs(T,{onClick:()=>s("courses",l?.id??0),size:"sm",children:[t.jsx(Lt,{className:"w-4 h-4 mr-2"}),"Edytuj kurs"]})]}),t.jsx($w,{course:l})]}),t.jsx(A0,{course:l,topicsCount:d.topicsCount,activitiesCount:d.activitiesCount,accessCount:d.accessCount}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsxs(I,{children:[t.jsxs(U,{className:"flex items-center gap-2",children:["Struktura kursu",(b||w)&&t.jsxs("span",{className:"text-sm font-normal text-muted-foreground flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Zapisywanie..."]})]}),t.jsxs(T,{size:"sm",onClick:()=>a(`/topics/create?course_id=${n}`),children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Dodaj temat"]})]})}),t.jsx(F,{children:c.length>0?t.jsx(Td,{items:c,onReorder:v,disabled:b||w,renderItem:(D,_,E)=>{const X=p(D.id),Be=z===D.id.toString();return t.jsx(Rw,{topic:{...D,position:_+1},isExpanded:Be,onToggle:()=>N(D.id),onDelete:C,onEdit:(Q,J)=>a(`/${Q}/edit/${J}`),onTogglePublish:(Q,J,$)=>g(Q,J,$,u),activitiesCount:X.length,onNavigateToWizard:o,courseId:Number(l?.id),courseTitle:l?.title,dragHandleProps:E,children:X.length>0?t.jsx(Td,{items:X,onReorder:P,disabled:w,renderItem:(Q,J,$)=>t.jsx(Fw,{activity:{...Q,position:J+1},topicPosition:_+1,onDelete:A,onEdit:(me,Ee)=>a(`/${me}/edit/${Ee}`),onTogglePublish:(me,Ee,xe)=>f(me,Ee,xe,h),dragHandleProps:$},Q.id)}):t.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[t.jsx("p",{children:"Brak aktywności w tym temacie"}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center mt-4",children:[t.jsxs(T,{size:"sm",variant:"outline",onClick:()=>a(`/activities/create?topic_id=${D.id}`),children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Dodaj ręcznie"]}),t.jsxs(T,{size:"sm",onClick:()=>o("/educational-material/step1",{courseId:l?.id,courseTitle:l?.title,topicId:D.id,topicTitle:D.title}),children:[t.jsx(ks,{className:"w-4 h-4 mr-2"}),"Generuj materiał z AI"]}),t.jsxs(T,{size:"sm",variant:"secondary",onClick:()=>o("/quiz-wizard/step1",{courseId:l?.id,courseTitle:l?.title,topicId:D.id,topicTitle:D.title}),children:[t.jsx(Mn,{className:"w-4 h-4 mr-2"}),"Generuj quiz z AI"]})]})]})},D.id)}}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(ft,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Brak tematów w tym kursie"}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center mt-4",children:[t.jsxs(T,{onClick:()=>a(`/topics/create?course_id=${n}`),children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Dodaj pierwszy temat"]}),t.jsxs(T,{variant:"secondary",onClick:()=>o("/course-structure/step1",{courseId:l?.id,courseTitle:l?.title,mode:"extend"}),children:[t.jsx(Hs,{className:"w-4 h-4 mr-2"}),"Wygeneruj strukturę z AI"]})]})]})})]}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Grupy z dostępem"})}),t.jsx(F,{children:t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(Ye,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Lista grup (do implementacji)"})]})})]}),t.jsxs(R,{className:"border-dashed border-2 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-950/20 dark:to-blue-950/20",children:[t.jsx(W,{children:t.jsxs(U,{className:"flex items-center gap-2",children:[t.jsx(ks,{className:"w-5 h-5 text-purple-600"}),"Szybkie akcje AI"]})}),t.jsx(F,{children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[t.jsx(T,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white dark:bg-background",onClick:()=>o("/course-structure/step1"),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(Hs,{className:"w-5 h-5 text-indigo-600 mt-0.5"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:"Rozbuduj strukturę kursu"}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"Dodaj nowe tematy z AI"})]})]})}),t.jsx(T,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white dark:bg-background",onClick:()=>o("/educational-material/step1",{courseId:l?.id,courseTitle:l?.title}),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(Wy,{className:"w-5 h-5 text-purple-600 mt-0.5"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:"Generuj materiał"}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"Stwórz treści z AI"})]})]})}),t.jsx(T,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white dark:bg-background",onClick:()=>o("/quiz-wizard/step1",{courseId:l?.id,courseTitle:l?.title}),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(Mn,{className:"w-5 h-5 text-blue-600 mt-0.5"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:"Stwórz quiz"}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"Quiz sprawdzający z AI"})]})]})})]})})]})]})},D0=[t.jsx(L,{path:"/courses",element:t.jsx(_w,{})},"courses-list"),t.jsx(L,{path:"/courses/create",element:t.jsx(Mw,{})},"courses-create"),t.jsx(L,{path:"/courses/edit/:id",element:t.jsx(Ow,{})},"courses-edit"),t.jsx(L,{path:"/courses/show/:id",element:t.jsx(E0,{})},"courses-show")],_0=()=>{const{show:e}=Ve(),s=Z(),[n]=pa(),i=n.get("course_id"),{data:r}=Oe({resource:"courses",id:i,queryOptions:{enabled:!!i}}),{data:a,isLoading:o}=Ae({resource:"topics",filters:[{field:"course_id",operator:"eq",value:i}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!i}}),{refineCore:{onFinish:l},register:c,handleSubmit:d,setValue:m,watch:u,formState:{errors:h,isSubmitting:p}}=Jt({defaultValues:{course_id:i?parseInt(i):void 0,is_published:!1,position:1},refineCoreProps:{successNotification:()=>({message:"Temat został utworzony",type:"success"}),redirect:!1,onMutationSuccess:()=>{i?e("courses",i):s("/courses")}}});x.useEffect(()=>{if(!o&&a&&a.data.length>0){const f=a.data[0].position+1;m("position",f)}},[a,o,m]);const g=()=>{i?e("courses",i):s("/courses")};return t.jsxs(q,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:g,children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),"Powrót do kursu"]}),t.jsx(I,{children:t.jsx(ce,{title:"Dodaj temat",description:r?.data?`Do kursu: ${r.data.title}`:"Utwórz nowy temat"})}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Informacje o temacie"})}),t.jsx(F,{children:t.jsxs(es,{onSubmit:d(l),children:[t.jsx("input",{type:"hidden",...c("course_id")}),t.jsx(H,{label:"Tytuł tematu",htmlFor:"title",error:h.title?.message,required:!0,children:t.jsx(B,{id:"title",placeholder:"np. Wprowadzenie do zmiennych",...c("title",{required:"Tytuł tematu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),t.jsx(H,{label:"Pozycja",htmlFor:"position",error:h.position?.message,required:!0,children:t.jsx(B,{id:"position",type:"number",min:"1",disabled:!0,className:"bg-muted",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),t.jsx(H,{label:"Status publikacji",children:t.jsxs(I,{variant:"start",children:[t.jsx(Ot,{checked:u("is_published")||!1,onCheckedChange:f=>m("is_published",f)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj temat od razu"})]})}),t.jsxs(ts,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:g,children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:p||!i,children:p?"Tworzenie...":"Utwórz temat"})]})]})})]})]})},Xs=({variant:e="outline",size:s="sm",children:n="Powrót do kursu"})=>{const i=Z(),r=wl(),a=()=>{const l=new URLSearchParams(r.search).get("returnUrl");i(l?decodeURIComponent(l):-1)};return t.jsxs(T,{variant:e,size:s,onClick:a,children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),n]})},I0=()=>{const{show:e}=Ve(),{id:s}=Ze(),n=Z(),{data:i,isLoading:r}=Oe({resource:"topics",id:s,liveMode:"off"}),a=i?.data,o=a?.course_id,{refineCore:{onFinish:l},register:c,handleSubmit:d,setValue:m,watch:u,formState:{errors:h,isSubmitting:p}}=Jt({refineCoreProps:{resource:"topics",id:s,liveMode:"off",successNotification:()=>({message:"Temat został zaktualizowany",type:"success"}),redirect:!1,onMutationSuccess:()=>{const f=sessionStorage.getItem("returnUrl");f?(sessionStorage.removeItem("returnUrl"),n(f)):o&&n(`/courses/show/${o}?expanded=${s}`)}}}),g=()=>{const f=sessionStorage.getItem("returnUrl");f?(sessionStorage.removeItem("returnUrl"),n(f)):o?n(`/courses/show/${o}?expanded=${s}`):e("courses","")};return r?t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):t.jsxs(q,{children:[t.jsx(Xs,{}),t.jsx(I,{children:t.jsx(ce,{title:"Edytuj temat",description:`Edycja: ${a?.title}`})}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Informacje o temacie"})}),t.jsx(F,{children:t.jsxs(es,{onSubmit:d(l),children:[t.jsx(H,{label:"Tytuł tematu",htmlFor:"title",error:h.title?.message,required:!0,children:t.jsx(B,{id:"title",placeholder:"np. Wprowadzenie do zmiennych",...c("title",{required:"Tytuł tematu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),t.jsx(H,{label:"Pozycja",htmlFor:"position",error:h.position?.message,required:!0,children:t.jsx(B,{id:"position",type:"number",min:"1",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),t.jsx(H,{label:"Status publikacji",children:t.jsxs(I,{variant:"start",children:[t.jsx(Ot,{checked:u("is_published")||!1,onCheckedChange:f=>m("is_published",f)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Temat jest opublikowany"})]})}),t.jsxs(ts,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:g,children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:p,children:p?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},M0=[t.jsx(L,{path:"/topics/create",element:t.jsx(_0,{})},"topics-create"),t.jsx(L,{path:"/topics/edit/:id",element:t.jsx(I0,{})},"topics-edit")],L0=()=>{const{show:e}=Ve(),s=Z(),[n]=pa(),i=n.get("topic_id"),{data:r}=Oe({resource:"topics",id:i,meta:{select:"*, courses(*)"},queryOptions:{enabled:!!i}}),{data:a,isLoading:o}=Ae({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:i}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!i}}),{refineCore:{onFinish:l},register:c,handleSubmit:d,setValue:m,watch:u,formState:{errors:h,isSubmitting:p}}=Jt({defaultValues:{topic_id:i?parseInt(i):void 0,type:"material",is_published:!1,position:1,passing_score:70},refineCoreProps:{successNotification:!1,redirect:!1,onMutationSuccess:y=>{const b=r?.data?.course_id,j=y.data.type;if(O.success("Aktywność została utworzona"),j==="quiz")O.info("Dodaj pytania do quizu"),s(`/questions/manage/${y.data.id}`);else{const w=sessionStorage.getItem("returnUrl");w?(sessionStorage.removeItem("returnUrl"),s(w)):s(b?`/courses/show/${b}?expanded=${i}`:"/courses")}}}}),g=u("type");x.useEffect(()=>{if(!o&&a&&a.data.length>0){const y=a.data[0].position+1;m("position",y)}},[a,o,m]);const f=()=>{const y=sessionStorage.getItem("returnUrl");y?(sessionStorage.removeItem("returnUrl"),s(y)):r?.data?.course_id?s(`/courses/show/${r.data.course_id}?expanded=${i}`):s("/courses")};return r?.data?.course_id,i?t.jsxs(q,{children:[t.jsx(Xs,{}),t.jsx(I,{children:t.jsx(ce,{title:"Dodaj aktywność",description:r?.data?t.jsxs("div",{children:[t.jsx("div",{className:"text-lg",children:r.data.courses?.title}),t.jsxs("div",{className:"text-sm text-muted-foreground",children:["Temat ",r.data.position,": ",r.data.title]})]}):"Utwórz nowy materiał lub quiz"})}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Informacje o aktywności"})}),t.jsx(F,{children:t.jsxs(es,{onSubmit:d(l),children:[t.jsx("input",{type:"hidden",...c("topic_id")}),t.jsxs(be,{variant:"1-2-2",children:[t.jsx(H,{label:"Typ aktywności",error:h.type?.message,required:!0,children:t.jsxs(ze,{value:g,onValueChange:y=>m("type",y),children:[t.jsx(ve,{children:t.jsx(Se,{placeholder:"Wybierz typ"})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"material",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ft,{className:"w-4 h-4"}),"Materiał"]})}),t.jsx(V,{value:"quiz",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(st,{className:"w-4 h-4"}),"Quiz"]})})]})]})}),t.jsx(H,{label:"Tytuł",htmlFor:"title",error:h.title?.message,required:!0,children:t.jsx(B,{id:"title",placeholder:g==="quiz"?"np. Test wiedzy z rozdziału":"np. Wprowadzenie do tematu",...c("title",{required:"Tytuł jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),t.jsx(H,{label:"Pozycja w temacie",htmlFor:"position",error:h.position?.message,required:!0,children:t.jsx(B,{id:"position",type:"number",min:"1",disabled:!0,className:"bg-muted",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),t.jsx(H,{label:"Czas trwania (min)",htmlFor:"duration_min",hint:"Szacowany czas potrzebny na ukończenie",children:t.jsx(B,{id:"duration_min",type:"number",min:"1",placeholder:"np. 15",...c("duration_min",{min:{value:1,message:"Czas musi być większy od 0"},valueAsNumber:!0})})})]}),g==="material"&&t.jsx(H,{label:"Treść materiału",htmlFor:"content",error:h.content?.message,required:!0,hint:"Możesz używać formatowania Markdown",children:t.jsx(St,{id:"content",placeholder:"Wprowadź treść materiału edukacyjnego...",rows:10,...c("content",{required:g==="material"?"Treść jest wymagana dla materiału":!1})})}),g==="quiz"&&t.jsxs(t.Fragment,{children:[t.jsxs(be,{variant:"1-1-1",children:[t.jsx(H,{label:"Próg zaliczenia (%)",htmlFor:"passing_score",error:h.passing_score?.message,hint:"Minimalny wynik do zaliczenia",children:t.jsx(B,{id:"passing_score",type:"number",min:"0",max:"100",...c("passing_score",{min:{value:0,message:"Wartość minimalna to 0"},max:{value:100,message:"Wartość maksymalna to 100"},valueAsNumber:!0})})}),t.jsx(H,{label:"Limit czasu (min)",htmlFor:"time_limit",hint:"Pozostaw puste dla braku limitu",children:t.jsx(B,{id:"time_limit",type:"number",min:"1",placeholder:"Brak limitu",...c("time_limit",{min:{value:1,message:"Limit musi być większy od 0"},valueAsNumber:!0})})}),t.jsx(H,{label:"Maksymalna liczba prób",htmlFor:"max_attempts",hint:"Pozostaw puste dla nieograniczonej liczby",children:t.jsx(B,{id:"max_attempts",type:"number",min:"1",placeholder:"Bez limitu",...c("max_attempts",{min:{value:1,message:"Minimum 1 próba"},valueAsNumber:!0})})})]}),t.jsx("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950 rounded-lg border border-blue-200 dark:border-blue-800",children:t.jsxs("p",{className:"text-sm",children:[t.jsx("strong",{className:"text-blue-700 dark:text-blue-300",children:"💡 Wskazówka:"})," ",t.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"Po utworzeniu quizu zostaniesz przekierowany do ekranu dodawania pytań."})]})})]}),t.jsx(H,{label:"Status publikacji",children:t.jsxs(I,{variant:"start",children:[t.jsx(Ot,{checked:u("is_published")||!1,onCheckedChange:y=>m("is_published",y)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj aktywność od razu (uczniowie będą mogli ją zobaczyć)"})]})}),t.jsxs(ts,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:f,disabled:p,children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:p||!i,children:p?"Tworzenie...":g==="quiz"?"Utwórz i dodaj pytania":"Utwórz aktywność"})]})]})})]})]}):t.jsx(q,{children:t.jsx(R,{children:t.jsxs(F,{className:"text-center py-12",children:[t.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-4",children:"Nie wybrano tematu"}),t.jsx(T,{onClick:()=>s("/courses"),children:"Przejdź do kursów"})]})})})},O0=()=>{const{list:e}=Ve(),{id:s}=Ze(),n=Z(),{data:i,isLoading:r}=Oe({resource:"activities",id:s,liveMode:"off",meta:{select:"*, topics(*, courses(*))"}}),{data:a}=Oe({resource:"questions",id:s,meta:{select:"count",filter:`activity_id.eq.${s}`},queryOptions:{enabled:!!s&&i?.data?.type==="quiz"}}),{refineCore:{onFinish:o,formLoading:l},register:c,handleSubmit:d,setValue:m,watch:u,reset:h,formState:{errors:p,isSubmitting:g}}=Jt({refineCoreProps:{resource:"activities",id:s,liveMode:"off",redirect:!1,successNotification:!1,onMutationSuccess:()=>{const A=i?.data?.topics?.course_id,v=i?.data?.topic_id;O.success("Aktywność została zaktualizowana");const P=sessionStorage.getItem("returnUrl");P?(sessionStorage.removeItem("returnUrl"),n(P)):A?n(`/courses/show/${A}?expanded=${v}`):e("activities")},onMutationError:A=>{console.error("Błąd podczas aktualizacji:",A),A?.code==="PGRST204"?O.error("Błąd konfiguracji - skontaktuj się z administratorem"):A?.code==="23505"?O.error("Aktywność o tej pozycji już istnieje w tym temacie"):A?.code==="23503"?O.error("Nieprawidłowe powiązanie z tematem"):A?.message?O.error(`Błąd: ${A.message}`):O.error("Wystąpił nieoczekiwany błąd. Spróbuj ponownie.")}}});x.useEffect(()=>{if(i?.data){const{topics:A,_count:v,questions:P,...D}=i.data;h(D)}},[i,h]);const f=u("type")||i?.data?.type||"material";if(r||l)return t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const y=i?.data,b=y?.topics,j=b?.courses,w=j?.id,S=y?.topic_id,k=()=>{const A=sessionStorage.getItem("returnUrl");A?(sessionStorage.removeItem("returnUrl"),n(A)):w?n(`/courses/show/${w}?expanded=${S}`):e("activities")},z=()=>f==="quiz"?t.jsx(st,{className:"w-6 h-6 text-blue-500"}):t.jsx(ft,{className:"w-6 h-6 text-green-500"}),N=()=>{const A=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",A),n(`/questions/manage/${y?.id}`)},C=a?.data?.[0]?.count||0;return t.jsxs(q,{children:[t.jsx(Xs,{}),t.jsxs(I,{children:[t.jsx(ce,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[z(),"Edytuj aktywność"]}),description:t.jsxs("div",{children:[t.jsx("div",{className:"text-lg font-medium",children:y?.title}),t.jsxs("div",{className:"text-sm text-muted-foreground",children:[j?.title," → Temat ",b?.position,": ",b?.title]})]})}),f==="quiz"&&t.jsxs(T,{onClick:N,variant:"outline",children:[t.jsx(Qs,{className:"w-4 h-4 mr-2"}),"Zarządzaj pytaniami (",C,")"]})]}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Informacje o aktywności"})}),t.jsx(F,{children:t.jsxs(es,{onSubmit:d(o),children:[t.jsxs(be,{variant:"1-2-2",children:[t.jsxs(H,{label:"Typ aktywności",error:p.type?.message,required:!0,children:[t.jsxs(ze,{value:f,disabled:!0,children:[t.jsx(ve,{className:"bg-muted",children:t.jsx(Se,{placeholder:"Wybierz typ"})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"material",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ft,{className:"w-4 h-4"}),"Materiał"]})}),t.jsx(V,{value:"quiz",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(st,{className:"w-4 h-4"}),"Quiz"]})})]})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Typ aktywności nie może być zmieniony"})]}),t.jsx(H,{label:"Tytuł",htmlFor:"title",error:p.title?.message,required:!0,children:t.jsx(B,{id:"title",placeholder:f==="quiz"?"np. Test wiedzy":"np. Wprowadzenie",...c("title",{required:"Tytuł jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),t.jsx(H,{label:"Pozycja w temacie",htmlFor:"position",error:p.position?.message,required:!0,children:t.jsx(B,{id:"position",type:"number",min:"1",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),t.jsx(H,{label:"Czas trwania (min)",htmlFor:"duration_min",hint:"Szacowany czas potrzebny na ukończenie",children:t.jsx(B,{id:"duration_min",type:"number",min:"1",placeholder:"np. 15",...c("duration_min",{min:{value:1,message:"Czas musi być większy od 0"},valueAsNumber:!0})})})]}),f==="material"&&t.jsx(H,{label:"Treść materiału",htmlFor:"content",error:p.content?.message,required:!0,hint:"Możesz używać formatowania Markdown",children:t.jsx(St,{id:"content",placeholder:"Wprowadź treść materiału...",rows:10,...c("content",{required:f==="material"?"Treść jest wymagana dla materiału":!1})})}),f==="quiz"&&t.jsxs(t.Fragment,{children:[t.jsxs(be,{variant:"1-1-1",children:[t.jsx(H,{label:"Próg zaliczenia (%)",htmlFor:"passing_score",error:p.passing_score?.message,hint:"Minimalny wynik do zaliczenia",children:t.jsx(B,{id:"passing_score",type:"number",min:"0",max:"100",...c("passing_score",{min:{value:0,message:"Wartość minimalna to 0"},max:{value:100,message:"Wartość maksymalna to 100"},valueAsNumber:!0})})}),t.jsx(H,{label:"Limit czasu (min)",htmlFor:"time_limit",hint:"Pozostaw puste dla braku limitu",children:t.jsx(B,{id:"time_limit",type:"number",min:"1",placeholder:"Brak limitu",...c("time_limit",{min:{value:1,message:"Limit musi być większy od 0"},valueAsNumber:!0})})}),t.jsx(H,{label:"Maksymalna liczba prób",htmlFor:"max_attempts",hint:"Pozostaw puste dla nieograniczonej liczby",children:t.jsx(B,{id:"max_attempts",type:"number",min:"1",placeholder:"Bez limitu",...c("max_attempts",{min:{value:1,message:"Minimum 1 próba"},valueAsNumber:!0})})})]}),C>0&&t.jsx(R,{className:"mt-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800",children:t.jsx(F,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm font-medium",children:["Ten quiz zawiera ",C," ",C===1?"pytanie":"pytań"]}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Możesz zarządzać pytaniami klikając przycisk powyżej"})]}),t.jsx(ne,{variant:"outline",className:"text-lg px-3 py-1",children:C})]})})})]}),t.jsx(H,{label:"Status publikacji",children:t.jsxs(I,{variant:"start",children:[t.jsx(Ot,{checked:u("is_published")||!1,onCheckedChange:A=>m("is_published",A)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Aktywność jest opublikowana (uczniowie mogą ją zobaczyć)"})]})}),t.jsxs(ts,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:k,disabled:g,children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:g,children:g?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})};function Ad(e,s){const n=String(e);if(typeof s!="string")throw new TypeError("Expected character");let i=0,r=n.indexOf(s);for(;r!==-1;)i++,r=n.indexOf(s,r+s.length);return i}function R0(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function F0(e,s,n){const r=Fm((n||{}).ignore||[]),a=$0(s);let o=-1;for(;++o<a.length;)Ty(e,"text",l);function l(d,m){let u=-1,h;for(;++u<m.length;){const p=m[u],g=h?h.children:void 0;if(r(p,g?g.indexOf(p):void 0,h))return;h=p}if(h)return c(d,m)}function c(d,m){const u=m[m.length-1],h=a[o][0],p=a[o][1];let g=0;const y=u.children.indexOf(d);let b=!1,j=[];h.lastIndex=0;let w=h.exec(d.value);for(;w;){const S=w.index,k={index:w.index,input:w.input,stack:[...m,d]};let z=p(...w,k);if(typeof z=="string"&&(z=z.length>0?{type:"text",value:z}:void 0),z===!1?h.lastIndex=S+1:(g!==S&&j.push({type:"text",value:d.value.slice(g,S)}),Array.isArray(z)?j.push(...z):z&&j.push(z),g=S+w[0].length,b=!0),!h.global)break;w=h.exec(d.value)}return b?(g<d.value.length&&j.push({type:"text",value:d.value.slice(g)}),u.children.splice(y,1,...j)):j=[d],y+j.length}}function $0(e){const s=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!e[0]||Array.isArray(e[0])?e:[e];let i=-1;for(;++i<n.length;){const r=n[i];s.push([q0(r[0]),V0(r[1])])}return s}function q0(e){return typeof e=="string"?new RegExp(R0(e),"g"):e}function V0(e){return typeof e=="function"?e:function(){return e}}const ro="phrasing",ao=["autolink","link","image","label"];function B0(){return{transforms:[Y0],enter:{literalAutolink:W0,literalAutolinkEmail:oo,literalAutolinkHttp:oo,literalAutolinkWww:oo},exit:{literalAutolink:Q0,literalAutolinkEmail:H0,literalAutolinkHttp:K0,literalAutolinkWww:G0}}}function U0(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:ro,notInConstruct:ao},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:ro,notInConstruct:ao},{character:":",before:"[ps]",after:"\\/",inConstruct:ro,notInConstruct:ao}]}}function W0(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function oo(e){this.config.enter.autolinkProtocol.call(this,e)}function K0(e){this.config.exit.autolinkProtocol.call(this,e)}function G0(e){this.config.exit.data.call(this,e);const s=this.stack[this.stack.length-1];Bn(s.type==="link"),s.url="http://"+this.sliceSerialize(e)}function H0(e){this.config.exit.autolinkEmail.call(this,e)}function Q0(e){this.exit(e)}function Y0(e){F0(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,Z0],[/(?<=^|\s|\p{P}|\p{S})([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/gu,J0]],{ignore:["link","linkReference"]})}function Z0(e,s,n,i,r){let a="";if(!_p(r)||(/^w/i.test(s)&&(n=s+n,s="",a="http://"),!X0(n)))return!1;const o=eN(n+i);if(!o[0])return!1;const l={type:"link",title:null,url:a+s+o[0],children:[{type:"text",value:s+o[0]}]};return o[1]?[l,{type:"text",value:o[1]}]:l}function J0(e,s,n,i){return!_p(i,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+s+"@"+n,children:[{type:"text",value:s+"@"+n}]}}function X0(e){const s=e.split(".");return!(s.length<2||s[s.length-1]&&(/_/.test(s[s.length-1])||!/[a-zA-Z\d]/.test(s[s.length-1]))||s[s.length-2]&&(/_/.test(s[s.length-2])||!/[a-zA-Z\d]/.test(s[s.length-2])))}function eN(e){const s=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!s)return[e,void 0];e=e.slice(0,s.index);let n=s[0],i=n.indexOf(")");const r=Ad(e,"(");let a=Ad(e,")");for(;i!==-1&&r>a;)e+=n.slice(0,i+1),n=n.slice(i+1),i=n.indexOf(")"),a++;return[e,n]}function _p(e,s){const n=e.input.charCodeAt(e.index-1);return(e.index===0||_n(n)||vl(n))&&(!s||n!==47)}Ip.peek=cN;function tN(){this.buffer()}function sN(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function nN(){this.buffer()}function iN(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function rN(e){const s=this.resume(),n=this.stack[this.stack.length-1];Bn(n.type==="footnoteReference"),n.identifier=Xi(this.sliceSerialize(e)).toLowerCase(),n.label=s}function aN(e){this.exit(e)}function oN(e){const s=this.resume(),n=this.stack[this.stack.length-1];Bn(n.type==="footnoteDefinition"),n.identifier=Xi(this.sliceSerialize(e)).toLowerCase(),n.label=s}function lN(e){this.exit(e)}function cN(){return"["}function Ip(e,s,n,i){const r=n.createTracker(i);let a=r.move("[^");const o=n.enter("footnoteReference"),l=n.enter("reference");return a+=r.move(n.safe(n.associationId(e),{after:"]",before:a})),l(),o(),a+=r.move("]"),a}function dN(){return{enter:{gfmFootnoteCallString:tN,gfmFootnoteCall:sN,gfmFootnoteDefinitionLabelString:nN,gfmFootnoteDefinition:iN},exit:{gfmFootnoteCallString:rN,gfmFootnoteCall:aN,gfmFootnoteDefinitionLabelString:oN,gfmFootnoteDefinition:lN}}}function uN(e){let s=!1;return e&&e.firstLineBlank&&(s=!0),{handlers:{footnoteDefinition:n,footnoteReference:Ip},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(i,r,a,o){const l=a.createTracker(o);let c=l.move("[^");const d=a.enter("footnoteDefinition"),m=a.enter("label");return c+=l.move(a.safe(a.associationId(i),{before:c,after:"]"})),m(),c+=l.move("]:"),i.children&&i.children.length>0&&(l.shift(4),c+=l.move((s?`
`:" ")+a.indentLines(a.containerFlow(i,l.current()),s?Mp:mN))),d(),c}}function mN(e,s,n){return s===0?e:Mp(e,s,n)}function Mp(e,s,n){return(n?"":"    ")+e}const hN=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];Lp.peek=yN;function pN(){return{canContainEols:["delete"],enter:{strikethrough:xN},exit:{strikethrough:gN}}}function fN(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:hN}],handlers:{delete:Lp}}}function xN(e){this.enter({type:"delete",children:[]},e)}function gN(e){this.exit(e)}function Lp(e,s,n,i){const r=n.createTracker(i),a=n.enter("strikethrough");let o=r.move("~~");return o+=n.containerPhrasing(e,{...r.current(),before:o,after:"~"}),o+=r.move("~~"),a(),o}function yN(){return"~"}function jN(e){return e.length}function bN(e,s){const n=s||{},i=(n.align||[]).concat(),r=n.stringLength||jN,a=[],o=[],l=[],c=[];let d=0,m=-1;for(;++m<e.length;){const f=[],y=[];let b=-1;for(e[m].length>d&&(d=e[m].length);++b<e[m].length;){const j=wN(e[m][b]);if(n.alignDelimiters!==!1){const w=r(j);y[b]=w,(c[b]===void 0||w>c[b])&&(c[b]=w)}f.push(j)}o[m]=f,l[m]=y}let u=-1;if(typeof i=="object"&&"length"in i)for(;++u<d;)a[u]=Pd(i[u]);else{const f=Pd(i);for(;++u<d;)a[u]=f}u=-1;const h=[],p=[];for(;++u<d;){const f=a[u];let y="",b="";f===99?(y=":",b=":"):f===108?y=":":f===114&&(b=":");let j=n.alignDelimiters===!1?1:Math.max(1,c[u]-y.length-b.length);const w=y+"-".repeat(j)+b;n.alignDelimiters!==!1&&(j=y.length+j+b.length,j>c[u]&&(c[u]=j),p[u]=j),h[u]=w}o.splice(1,0,h),l.splice(1,0,p),m=-1;const g=[];for(;++m<o.length;){const f=o[m],y=l[m];u=-1;const b=[];for(;++u<d;){const j=f[u]||"";let w="",S="";if(n.alignDelimiters!==!1){const k=c[u]-(y[u]||0),z=a[u];z===114?w=" ".repeat(k):z===99?k%2?(w=" ".repeat(k/2+.5),S=" ".repeat(k/2-.5)):(w=" ".repeat(k/2),S=w):S=" ".repeat(k)}n.delimiterStart!==!1&&!u&&b.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&j==="")&&(n.delimiterStart!==!1||u)&&b.push(" "),n.alignDelimiters!==!1&&b.push(w),b.push(j),n.alignDelimiters!==!1&&b.push(S),n.padding!==!1&&b.push(" "),(n.delimiterEnd!==!1||u!==d-1)&&b.push("|")}g.push(n.delimiterEnd===!1?b.join("").replace(/ +$/,""):b.join(""))}return g.join(`
`)}function wN(e){return e==null?"":String(e)}function Pd(e){const s=typeof e=="string"?e.codePointAt(0):0;return s===67||s===99?99:s===76||s===108?108:s===82||s===114?114:0}function vN(e,s,n,i){const r=n.enter("blockquote"),a=n.createTracker(i);a.move("> "),a.shift(2);const o=n.indentLines(n.containerFlow(e,a.current()),NN);return r(),o}function NN(e,s,n){return">"+(n?"":" ")+e}function kN(e,s){return Ed(e,s.inConstruct,!0)&&!Ed(e,s.notInConstruct,!1)}function Ed(e,s,n){if(typeof s=="string"&&(s=[s]),!s||s.length===0)return n;let i=-1;for(;++i<s.length;)if(e.includes(s[i]))return!0;return!1}function Dd(e,s,n,i){let r=-1;for(;++r<n.unsafe.length;)if(n.unsafe[r].character===`
`&&kN(n.stack,n.unsafe[r]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function zN(e,s){const n=String(e);let i=n.indexOf(s),r=i,a=0,o=0;if(typeof s!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===r?++a>o&&(o=a):a=1,r=i+s.length,i=n.indexOf(s,r);return o}function SN(e,s){return!!(s.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function CN(e){const s=e.options.fence||"`";if(s!=="`"&&s!=="~")throw new Error("Cannot serialize code with `"+s+"` for `options.fence`, expected `` ` `` or `~`");return s}function TN(e,s,n,i){const r=CN(n),a=e.value||"",o=r==="`"?"GraveAccent":"Tilde";if(SN(e,n)){const u=n.enter("codeIndented"),h=n.indentLines(a,AN);return u(),h}const l=n.createTracker(i),c=r.repeat(Math.max(zN(a,r)+1,3)),d=n.enter("codeFenced");let m=l.move(c);if(e.lang){const u=n.enter(`codeFencedLang${o}`);m+=l.move(n.safe(e.lang,{before:m,after:" ",encode:["`"],...l.current()})),u()}if(e.lang&&e.meta){const u=n.enter(`codeFencedMeta${o}`);m+=l.move(" "),m+=l.move(n.safe(e.meta,{before:m,after:`
`,encode:["`"],...l.current()})),u()}return m+=l.move(`
`),a&&(m+=l.move(a+`
`)),m+=l.move(c),d(),m}function AN(e,s,n){return(n?"":"    ")+e}function Zl(e){const s=e.options.quote||'"';if(s!=='"'&&s!=="'")throw new Error("Cannot serialize title with `"+s+"` for `options.quote`, expected `\"`, or `'`");return s}function PN(e,s,n,i){const r=Zl(n),a=r==='"'?"Quote":"Apostrophe",o=n.enter("definition");let l=n.enter("label");const c=n.createTracker(i);let d=c.move("[");return d+=c.move(n.safe(n.associationId(e),{before:d,after:"]",...c.current()})),d+=c.move("]: "),l(),!e.url||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),d+=c.move("<"),d+=c.move(n.safe(e.url,{before:d,after:">",...c.current()})),d+=c.move(">")):(l=n.enter("destinationRaw"),d+=c.move(n.safe(e.url,{before:d,after:e.title?" ":`
`,...c.current()}))),l(),e.title&&(l=n.enter(`title${a}`),d+=c.move(" "+r),d+=c.move(n.safe(e.title,{before:d,after:r,...c.current()})),d+=c.move(r),l()),o(),d}function EN(e){const s=e.options.emphasis||"*";if(s!=="*"&&s!=="_")throw new Error("Cannot serialize emphasis with `"+s+"` for `options.emphasis`, expected `*`, or `_`");return s}function Vi(e){return"&#x"+e.toString(16).toUpperCase()+";"}function na(e,s,n){const i=Qr(e),r=Qr(s);return i===void 0?r===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}Op.peek=DN;function Op(e,s,n,i){const r=EN(n),a=n.enter("emphasis"),o=n.createTracker(i),l=o.move(r);let c=o.move(n.containerPhrasing(e,{after:r,before:l,...o.current()}));const d=c.charCodeAt(0),m=na(i.before.charCodeAt(i.before.length-1),d,r);m.inside&&(c=Vi(d)+c.slice(1));const u=c.charCodeAt(c.length-1),h=na(i.after.charCodeAt(0),u,r);h.inside&&(c=c.slice(0,-1)+Vi(u));const p=o.move(r);return a(),n.attentionEncodeSurroundingInfo={after:h.outside,before:m.outside},l+c+p}function DN(e,s,n){return n.options.emphasis||"*"}function _N(e,s){let n=!1;return Ay(e,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return n=!0,Py}),!!((!e.depth||e.depth<3)&&$m(e)&&(s.options.setext||n))}function IN(e,s,n,i){const r=Math.max(Math.min(6,e.depth||1),1),a=n.createTracker(i);if(_N(e,n)){const m=n.enter("headingSetext"),u=n.enter("phrasing"),h=n.containerPhrasing(e,{...a.current(),before:`
`,after:`
`});return u(),m(),h+`
`+(r===1?"=":"-").repeat(h.length-(Math.max(h.lastIndexOf("\r"),h.lastIndexOf(`
`))+1))}const o="#".repeat(r),l=n.enter("headingAtx"),c=n.enter("phrasing");a.move(o+" ");let d=n.containerPhrasing(e,{before:"# ",after:`
`,...a.current()});return/^[\t ]/.test(d)&&(d=Vi(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,n.options.closeAtx&&(d+=" "+o),c(),l(),d}Rp.peek=MN;function Rp(e){return e.value||""}function MN(){return"<"}Fp.peek=LN;function Fp(e,s,n,i){const r=Zl(n),a=r==='"'?"Quote":"Apostrophe",o=n.enter("image");let l=n.enter("label");const c=n.createTracker(i);let d=c.move("![");return d+=c.move(n.safe(e.alt,{before:d,after:"]",...c.current()})),d+=c.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),d+=c.move("<"),d+=c.move(n.safe(e.url,{before:d,after:">",...c.current()})),d+=c.move(">")):(l=n.enter("destinationRaw"),d+=c.move(n.safe(e.url,{before:d,after:e.title?" ":")",...c.current()}))),l(),e.title&&(l=n.enter(`title${a}`),d+=c.move(" "+r),d+=c.move(n.safe(e.title,{before:d,after:r,...c.current()})),d+=c.move(r),l()),d+=c.move(")"),o(),d}function LN(){return"!"}$p.peek=ON;function $p(e,s,n,i){const r=e.referenceType,a=n.enter("imageReference");let o=n.enter("label");const l=n.createTracker(i);let c=l.move("![");const d=n.safe(e.alt,{before:c,after:"]",...l.current()});c+=l.move(d+"]["),o();const m=n.stack;n.stack=[],o=n.enter("reference");const u=n.safe(n.associationId(e),{before:c,after:"]",...l.current()});return o(),n.stack=m,a(),r==="full"||!d||d!==u?c+=l.move(u+"]"):r==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function ON(){return"!"}qp.peek=RN;function qp(e,s,n){let i=e.value||"",r="`",a=-1;for(;new RegExp("(^|[^`])"+r+"([^`]|$)").test(i);)r+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++a<n.unsafe.length;){const o=n.unsafe[a],l=n.compilePattern(o);let c;if(o.atBreak)for(;c=l.exec(i);){let d=c.index;i.charCodeAt(d)===10&&i.charCodeAt(d-1)===13&&d--,i=i.slice(0,d)+" "+i.slice(c.index+1)}}return r+i+r}function RN(){return"`"}function Vp(e,s){const n=$m(e);return!!(!s.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}Bp.peek=FN;function Bp(e,s,n,i){const r=Zl(n),a=r==='"'?"Quote":"Apostrophe",o=n.createTracker(i);let l,c;if(Vp(e,n)){const m=n.stack;n.stack=[],l=n.enter("autolink");let u=o.move("<");return u+=o.move(n.containerPhrasing(e,{before:u,after:">",...o.current()})),u+=o.move(">"),l(),n.stack=m,u}l=n.enter("link"),c=n.enter("label");let d=o.move("[");return d+=o.move(n.containerPhrasing(e,{before:d,after:"](",...o.current()})),d+=o.move("]("),c(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(c=n.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(n.safe(e.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(c=n.enter("destinationRaw"),d+=o.move(n.safe(e.url,{before:d,after:e.title?" ":")",...o.current()}))),c(),e.title&&(c=n.enter(`title${a}`),d+=o.move(" "+r),d+=o.move(n.safe(e.title,{before:d,after:r,...o.current()})),d+=o.move(r),c()),d+=o.move(")"),l(),d}function FN(e,s,n){return Vp(e,n)?"<":"["}Up.peek=$N;function Up(e,s,n,i){const r=e.referenceType,a=n.enter("linkReference");let o=n.enter("label");const l=n.createTracker(i);let c=l.move("[");const d=n.containerPhrasing(e,{before:c,after:"]",...l.current()});c+=l.move(d+"]["),o();const m=n.stack;n.stack=[],o=n.enter("reference");const u=n.safe(n.associationId(e),{before:c,after:"]",...l.current()});return o(),n.stack=m,a(),r==="full"||!d||d!==u?c+=l.move(u+"]"):r==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function $N(){return"["}function Jl(e){const s=e.options.bullet||"*";if(s!=="*"&&s!=="+"&&s!=="-")throw new Error("Cannot serialize items with `"+s+"` for `options.bullet`, expected `*`, `+`, or `-`");return s}function qN(e){const s=Jl(e),n=e.options.bulletOther;if(!n)return s==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===s)throw new Error("Expected `bullet` (`"+s+"`) and `bulletOther` (`"+n+"`) to be different");return n}function VN(e){const s=e.options.bulletOrdered||".";if(s!=="."&&s!==")")throw new Error("Cannot serialize items with `"+s+"` for `options.bulletOrdered`, expected `.` or `)`");return s}function Wp(e){const s=e.options.rule||"*";if(s!=="*"&&s!=="-"&&s!=="_")throw new Error("Cannot serialize rules with `"+s+"` for `options.rule`, expected `*`, `-`, or `_`");return s}function BN(e,s,n,i){const r=n.enter("list"),a=n.bulletCurrent;let o=e.ordered?VN(n):Jl(n);const l=e.ordered?o==="."?")":".":qN(n);let c=s&&n.bulletLastUsed?o===n.bulletLastUsed:!1;if(!e.ordered){const m=e.children?e.children[0]:void 0;if((o==="*"||o==="-")&&m&&(!m.children||!m.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(c=!0),Wp(n)===o&&m){let u=-1;for(;++u<e.children.length;){const h=e.children[u];if(h&&h.type==="listItem"&&h.children&&h.children[0]&&h.children[0].type==="thematicBreak"){c=!0;break}}}}c&&(o=l),n.bulletCurrent=o;const d=n.containerFlow(e,i);return n.bulletLastUsed=o,n.bulletCurrent=a,r(),d}function UN(e){const s=e.options.listItemIndent||"one";if(s!=="tab"&&s!=="one"&&s!=="mixed")throw new Error("Cannot serialize items with `"+s+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return s}function WN(e,s,n,i){const r=UN(n);let a=n.bulletCurrent||Jl(n);s&&s.type==="list"&&s.ordered&&(a=(typeof s.start=="number"&&s.start>-1?s.start:1)+(n.options.incrementListMarker===!1?0:s.children.indexOf(e))+a);let o=a.length+1;(r==="tab"||r==="mixed"&&(s&&s.type==="list"&&s.spread||e.spread))&&(o=Math.ceil(o/4)*4);const l=n.createTracker(i);l.move(a+" ".repeat(o-a.length)),l.shift(o);const c=n.enter("listItem"),d=n.indentLines(n.containerFlow(e,l.current()),m);return c(),d;function m(u,h,p){return h?(p?"":" ".repeat(o))+u:(p?a:a+" ".repeat(o-a.length))+u}}function KN(e,s,n,i){const r=n.enter("paragraph"),a=n.enter("phrasing"),o=n.containerPhrasing(e,i);return a(),r(),o}const GN=Fm(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function HN(e,s,n,i){return(e.children.some(function(o){return GN(o)})?n.containerPhrasing:n.containerFlow).call(n,e,i)}function QN(e){const s=e.options.strong||"*";if(s!=="*"&&s!=="_")throw new Error("Cannot serialize strong with `"+s+"` for `options.strong`, expected `*`, or `_`");return s}Kp.peek=YN;function Kp(e,s,n,i){const r=QN(n),a=n.enter("strong"),o=n.createTracker(i),l=o.move(r+r);let c=o.move(n.containerPhrasing(e,{after:r,before:l,...o.current()}));const d=c.charCodeAt(0),m=na(i.before.charCodeAt(i.before.length-1),d,r);m.inside&&(c=Vi(d)+c.slice(1));const u=c.charCodeAt(c.length-1),h=na(i.after.charCodeAt(0),u,r);h.inside&&(c=c.slice(0,-1)+Vi(u));const p=o.move(r+r);return a(),n.attentionEncodeSurroundingInfo={after:h.outside,before:m.outside},l+c+p}function YN(e,s,n){return n.options.strong||"*"}function ZN(e,s,n,i){return n.safe(e.value,i)}function JN(e){const s=e.options.ruleRepetition||3;if(s<3)throw new Error("Cannot serialize rules with repetition `"+s+"` for `options.ruleRepetition`, expected `3` or more");return s}function XN(e,s,n){const i=(Wp(n)+(n.options.ruleSpaces?" ":"")).repeat(JN(n));return n.options.ruleSpaces?i.slice(0,-1):i}const Gp={blockquote:vN,break:Dd,code:TN,definition:PN,emphasis:Op,hardBreak:Dd,heading:IN,html:Rp,image:Fp,imageReference:$p,inlineCode:qp,link:Bp,linkReference:Up,list:BN,listItem:WN,paragraph:KN,root:HN,strong:Kp,text:ZN,thematicBreak:XN};function ek(){return{enter:{table:tk,tableData:_d,tableHeader:_d,tableRow:nk},exit:{codeText:ik,table:sk,tableData:lo,tableHeader:lo,tableRow:lo}}}function tk(e){const s=e._align;this.enter({type:"table",align:s.map(function(n){return n==="none"?null:n}),children:[]},e),this.data.inTable=!0}function sk(e){this.exit(e),this.data.inTable=void 0}function nk(e){this.enter({type:"tableRow",children:[]},e)}function lo(e){this.exit(e)}function _d(e){this.enter({type:"tableCell",children:[]},e)}function ik(e){let s=this.resume();this.data.inTable&&(s=s.replace(/\\([\\|])/g,rk));const n=this.stack[this.stack.length-1];Bn(n.type==="inlineCode"),n.value=s,this.exit(e)}function rk(e,s){return s==="|"?s:e}function ak(e){const s=e||{},n=s.tableCellPadding,i=s.tablePipeAlign,r=s.stringLength,a=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:h,table:o,tableCell:c,tableRow:l}};function o(p,g,f,y){return d(m(p,f,y),p.align)}function l(p,g,f,y){const b=u(p,f,y),j=d([b]);return j.slice(0,j.indexOf(`
`))}function c(p,g,f,y){const b=f.enter("tableCell"),j=f.enter("phrasing"),w=f.containerPhrasing(p,{...y,before:a,after:a});return j(),b(),w}function d(p,g){return bN(p,{align:g,alignDelimiters:i,padding:n,stringLength:r})}function m(p,g,f){const y=p.children;let b=-1;const j=[],w=g.enter("table");for(;++b<y.length;)j[b]=u(y[b],g,f);return w(),j}function u(p,g,f){const y=p.children;let b=-1;const j=[],w=g.enter("tableRow");for(;++b<y.length;)j[b]=c(y[b],p,g,f);return w(),j}function h(p,g,f){let y=Gp.inlineCode(p,g,f);return f.stack.includes("tableCell")&&(y=y.replace(/\|/g,"\\$&")),y}}function ok(){return{exit:{taskListCheckValueChecked:Id,taskListCheckValueUnchecked:Id,paragraph:ck}}}function lk(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:dk}}}function Id(e){const s=this.stack[this.stack.length-2];Bn(s.type==="listItem"),s.checked=e.type==="taskListCheckValueChecked"}function ck(e){const s=this.stack[this.stack.length-2];if(s&&s.type==="listItem"&&typeof s.checked=="boolean"){const n=this.stack[this.stack.length-1];Bn(n.type==="paragraph");const i=n.children[0];if(i&&i.type==="text"){const r=s.children;let a=-1,o;for(;++a<r.length;){const l=r[a];if(l.type==="paragraph"){o=l;break}}o===n&&(i.value=i.value.slice(1),i.value.length===0?n.children.shift():n.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,n.position.start=Object.assign({},i.position.start)))}}this.exit(e)}function dk(e,s,n,i){const r=e.children[0],a=typeof e.checked=="boolean"&&r&&r.type==="paragraph",o="["+(e.checked?"x":" ")+"] ",l=n.createTracker(i);a&&l.move(o);let c=Gp.listItem(e,s,n,{...i,...l.current()});return a&&(c=c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,d)),c;function d(m){return m+o}}function uk(){return[B0(),dN(),pN(),ek(),ok()]}function mk(e){return{extensions:[U0(),uN(e),fN(),ak(e),lk()]}}const hk={tokenize:jk,partial:!0},Hp={tokenize:bk,partial:!0},Qp={tokenize:wk,partial:!0},Yp={tokenize:vk,partial:!0},pk={tokenize:Nk,partial:!0},Zp={name:"wwwAutolink",tokenize:gk,previous:Xp},Jp={name:"protocolAutolink",tokenize:yk,previous:ef},hs={name:"emailAutolink",tokenize:xk,previous:tf},ss={};function fk(){return{text:ss}}let Fs=48;for(;Fs<123;)ss[Fs]=hs,Fs++,Fs===58?Fs=65:Fs===91&&(Fs=97);ss[43]=hs;ss[45]=hs;ss[46]=hs;ss[95]=hs;ss[72]=[hs,Jp];ss[104]=[hs,Jp];ss[87]=[hs,Zp];ss[119]=[hs,Zp];function xk(e,s,n){const i=this;let r,a;return o;function o(u){return!Bo(u)||!tf.call(i,i.previous)||Xl(i.events)?n(u):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),l(u))}function l(u){return Bo(u)?(e.consume(u),l):u===64?(e.consume(u),c):n(u)}function c(u){return u===46?e.check(pk,m,d)(u):u===45||u===95||Nl(u)?(a=!0,e.consume(u),c):m(u)}function d(u){return e.consume(u),r=!0,c}function m(u){return a&&r&&Ei(i.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),s(u)):n(u)}}function gk(e,s,n){const i=this;return r;function r(o){return o!==87&&o!==119||!Xp.call(i,i.previous)||Xl(i.events)?n(o):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(hk,e.attempt(Hp,e.attempt(Qp,a),n),n)(o))}function a(o){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),s(o)}}function yk(e,s,n){const i=this;let r="",a=!1;return o;function o(u){return(u===72||u===104)&&ef.call(i,i.previous)&&!Xl(i.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),r+=String.fromCodePoint(u),e.consume(u),l):n(u)}function l(u){if(Ei(u)&&r.length<5)return r+=String.fromCodePoint(u),e.consume(u),l;if(u===58){const h=r.toLowerCase();if(h==="http"||h==="https")return e.consume(u),c}return n(u)}function c(u){return u===47?(e.consume(u),a?d:(a=!0,c)):n(u)}function d(u){return u===null||Ey(u)||pt(u)||_n(u)||vl(u)?n(u):e.attempt(Hp,e.attempt(Qp,m),n)(u)}function m(u){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),s(u)}}function jk(e,s,n){let i=0;return r;function r(o){return(o===87||o===119)&&i<3?(i++,e.consume(o),r):o===46&&i===3?(e.consume(o),a):n(o)}function a(o){return o===null?n(o):s(o)}}function bk(e,s,n){let i,r,a;return o;function o(d){return d===46||d===95?e.check(Yp,c,l)(d):d===null||pt(d)||_n(d)||d!==45&&vl(d)?c(d):(a=!0,e.consume(d),o)}function l(d){return d===95?i=!0:(r=i,i=void 0),e.consume(d),o}function c(d){return r||i||!a?n(d):s(d)}}function wk(e,s){let n=0,i=0;return r;function r(o){return o===40?(n++,e.consume(o),r):o===41&&i<n?a(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?e.check(Yp,s,a)(o):o===null||pt(o)||_n(o)?s(o):(e.consume(o),r)}function a(o){return o===41&&i++,e.consume(o),r}}function vk(e,s,n){return i;function i(l){return l===33||l===34||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===63||l===95||l===126?(e.consume(l),i):l===38?(e.consume(l),a):l===93?(e.consume(l),r):l===60||l===null||pt(l)||_n(l)?s(l):n(l)}function r(l){return l===null||l===40||l===91||pt(l)||_n(l)?s(l):i(l)}function a(l){return Ei(l)?o(l):n(l)}function o(l){return l===59?(e.consume(l),i):Ei(l)?(e.consume(l),o):n(l)}}function Nk(e,s,n){return i;function i(a){return e.consume(a),r}function r(a){return Nl(a)?n(a):s(a)}}function Xp(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||pt(e)}function ef(e){return!Ei(e)}function tf(e){return!(e===47||Bo(e))}function Bo(e){return e===43||e===45||e===46||e===95||Nl(e)}function Xl(e){let s=e.length,n=!1;for(;s--;){const i=e[s][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){n=!0;break}if(i._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const kk={tokenize:Dk,partial:!0};function zk(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:Ak,continuation:{tokenize:Pk},exit:Ek}},text:{91:{name:"gfmFootnoteCall",tokenize:Tk},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:Sk,resolveTo:Ck}}}}function Sk(e,s,n){const i=this;let r=i.events.length;const a=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o;for(;r--;){const c=i.events[r][1];if(c.type==="labelImage"){o=c;break}if(c.type==="gfmFootnoteCall"||c.type==="labelLink"||c.type==="label"||c.type==="image"||c.type==="link")break}return l;function l(c){if(!o||!o._balanced)return n(c);const d=Xi(i.sliceSerialize({start:o.end,end:i.now()}));return d.codePointAt(0)!==94||!a.includes(d.slice(1))?n(c):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(c),e.exit("gfmFootnoteCallLabelMarker"),s(c))}}function Ck(e,s){let n=e.length;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},r={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};r.end.column++,r.end.offset++,r.end._bufferIndex++;const a={type:"gfmFootnoteCallString",start:Object.assign({},r.end),end:Object.assign({},e[e.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},a.start),end:Object.assign({},a.end)},l=[e[n+1],e[n+2],["enter",i,s],e[n+3],e[n+4],["enter",r,s],["exit",r,s],["enter",a,s],["enter",o,s],["exit",o,s],["exit",a,s],e[e.length-2],e[e.length-1],["exit",i,s]];return e.splice(n,e.length-n+1,...l),e}function Tk(e,s,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let a=0,o;return l;function l(u){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),c}function c(u){return u!==94?n(u):(e.enter("gfmFootnoteCallMarker"),e.consume(u),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",d)}function d(u){if(a>999||u===93&&!o||u===null||u===91||pt(u))return n(u);if(u===93){e.exit("chunkString");const h=e.exit("gfmFootnoteCallString");return r.includes(Xi(i.sliceSerialize(h)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),s):n(u)}return pt(u)||(o=!0),a++,e.consume(u),u===92?m:d}function m(u){return u===91||u===92||u===93?(e.consume(u),a++,d):d(u)}}function Ak(e,s,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let a,o=0,l;return c;function c(g){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),d}function d(g){return g===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",m):n(g)}function m(g){if(o>999||g===93&&!l||g===null||g===91||pt(g))return n(g);if(g===93){e.exit("chunkString");const f=e.exit("gfmFootnoteDefinitionLabelString");return a=Xi(i.sliceSerialize(f)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),h}return pt(g)||(l=!0),o++,e.consume(g),g===92?u:m}function u(g){return g===91||g===92||g===93?(e.consume(g),o++,m):m(g)}function h(g){return g===58?(e.enter("definitionMarker"),e.consume(g),e.exit("definitionMarker"),r.includes(a)||r.push(a),Ns(e,p,"gfmFootnoteDefinitionWhitespace")):n(g)}function p(g){return s(g)}}function Pk(e,s,n){return e.check(Dy,s,e.attempt(kk,s,n))}function Ek(e){e.exit("gfmFootnoteDefinition")}function Dk(e,s,n){const i=this;return Ns(e,r,"gfmFootnoteDefinitionIndent",5);function r(a){const o=i.events[i.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?s(a):n(a)}}function _k(e){let n=(e||{}).singleTilde;const i={name:"strikethrough",tokenize:a,resolveAll:r};return n==null&&(n=!0),{text:{126:i},insideSpan:{null:[i]},attentionMarkers:{null:[126]}};function r(o,l){let c=-1;for(;++c<o.length;)if(o[c][0]==="enter"&&o[c][1].type==="strikethroughSequenceTemporary"&&o[c][1]._close){let d=c;for(;d--;)if(o[d][0]==="exit"&&o[d][1].type==="strikethroughSequenceTemporary"&&o[d][1]._open&&o[c][1].end.offset-o[c][1].start.offset===o[d][1].end.offset-o[d][1].start.offset){o[c][1].type="strikethroughSequence",o[d][1].type="strikethroughSequence";const m={type:"strikethrough",start:Object.assign({},o[d][1].start),end:Object.assign({},o[c][1].end)},u={type:"strikethroughText",start:Object.assign({},o[d][1].end),end:Object.assign({},o[c][1].start)},h=[["enter",m,l],["enter",o[d][1],l],["exit",o[d][1],l],["enter",u,l]],p=l.parser.constructs.insideSpan.null;p&&Xa(h,h.length,0,_y(p,o.slice(d+1,c),l)),Xa(h,h.length,0,[["exit",u,l],["enter",o[c][1],l],["exit",o[c][1],l],["exit",m,l]]),Xa(o,d-1,c-d+3,h),c=d+h.length-2;break}}for(c=-1;++c<o.length;)o[c][1].type==="strikethroughSequenceTemporary"&&(o[c][1].type="data");return o}function a(o,l,c){const d=this.previous,m=this.events;let u=0;return h;function h(g){return d===126&&m[m.length-1][1].type!=="characterEscape"?c(g):(o.enter("strikethroughSequenceTemporary"),p(g))}function p(g){const f=Qr(d);if(g===126)return u>1?c(g):(o.consume(g),u++,p);if(u<2&&!n)return c(g);const y=o.exit("strikethroughSequenceTemporary"),b=Qr(g);return y._open=!b||b===2&&!!f,y._close=!f||f===2&&!!b,l(g)}}}class Ik{constructor(){this.map=[]}add(s,n,i){Mk(this,s,n,i)}consume(s){if(this.map.sort(function(a,o){return a[0]-o[0]}),this.map.length===0)return;let n=this.map.length;const i=[];for(;n>0;)n-=1,i.push(s.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),s.length=this.map[n][0];i.push(s.slice()),s.length=0;let r=i.pop();for(;r;){for(const a of r)s.push(a);r=i.pop()}this.map.length=0}}function Mk(e,s,n,i){let r=0;if(!(n===0&&i.length===0)){for(;r<e.map.length;){if(e.map[r][0]===s){e.map[r][1]+=n,e.map[r][2].push(...i);return}r+=1}e.map.push([s,n,i])}}function Lk(e,s){let n=!1;const i=[];for(;s<e.length;){const r=e[s];if(n){if(r[0]==="enter")r[1].type==="tableContent"&&i.push(e[s+1][1].type==="tableDelimiterMarker"?"left":"none");else if(r[1].type==="tableContent"){if(e[s-1][1].type==="tableDelimiterMarker"){const a=i.length-1;i[a]=i[a]==="left"?"center":"right"}}else if(r[1].type==="tableDelimiterRow")break}else r[0]==="enter"&&r[1].type==="tableDelimiterRow"&&(n=!0);s+=1}return i}function Ok(){return{flow:{null:{name:"table",tokenize:Rk,resolveAll:Fk}}}}function Rk(e,s,n){const i=this;let r=0,a=0,o;return l;function l(v){let P=i.events.length-1;for(;P>-1;){const E=i.events[P][1].type;if(E==="lineEnding"||E==="linePrefix")P--;else break}const D=P>-1?i.events[P][1].type:null,_=D==="tableHead"||D==="tableRow"?z:c;return _===z&&i.parser.lazy[i.now().line]?n(v):_(v)}function c(v){return e.enter("tableHead"),e.enter("tableRow"),d(v)}function d(v){return v===124||(o=!0,a+=1),m(v)}function m(v){return v===null?n(v):yi(v)?a>1?(a=0,i.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),p):n(v):xn(v)?Ns(e,m,"whitespace")(v):(a+=1,o&&(o=!1,r+=1),v===124?(e.enter("tableCellDivider"),e.consume(v),e.exit("tableCellDivider"),o=!0,m):(e.enter("data"),u(v)))}function u(v){return v===null||v===124||pt(v)?(e.exit("data"),m(v)):(e.consume(v),v===92?h:u)}function h(v){return v===92||v===124?(e.consume(v),u):u(v)}function p(v){return i.interrupt=!1,i.parser.lazy[i.now().line]?n(v):(e.enter("tableDelimiterRow"),o=!1,xn(v)?Ns(e,g,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(v):g(v))}function g(v){return v===45||v===58?y(v):v===124?(o=!0,e.enter("tableCellDivider"),e.consume(v),e.exit("tableCellDivider"),f):k(v)}function f(v){return xn(v)?Ns(e,y,"whitespace")(v):y(v)}function y(v){return v===58?(a+=1,o=!0,e.enter("tableDelimiterMarker"),e.consume(v),e.exit("tableDelimiterMarker"),b):v===45?(a+=1,b(v)):v===null||yi(v)?S(v):k(v)}function b(v){return v===45?(e.enter("tableDelimiterFiller"),j(v)):k(v)}function j(v){return v===45?(e.consume(v),j):v===58?(o=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(v),e.exit("tableDelimiterMarker"),w):(e.exit("tableDelimiterFiller"),w(v))}function w(v){return xn(v)?Ns(e,S,"whitespace")(v):S(v)}function S(v){return v===124?g(v):v===null||yi(v)?!o||r!==a?k(v):(e.exit("tableDelimiterRow"),e.exit("tableHead"),s(v)):k(v)}function k(v){return n(v)}function z(v){return e.enter("tableRow"),N(v)}function N(v){return v===124?(e.enter("tableCellDivider"),e.consume(v),e.exit("tableCellDivider"),N):v===null||yi(v)?(e.exit("tableRow"),s(v)):xn(v)?Ns(e,N,"whitespace")(v):(e.enter("data"),C(v))}function C(v){return v===null||v===124||pt(v)?(e.exit("data"),N(v)):(e.consume(v),v===92?A:C)}function A(v){return v===92||v===124?(e.consume(v),C):C(v)}}function Fk(e,s){let n=-1,i=!0,r=0,a=[0,0,0,0],o=[0,0,0,0],l=!1,c=0,d,m,u;const h=new Ik;for(;++n<e.length;){const p=e[n],g=p[1];p[0]==="enter"?g.type==="tableHead"?(l=!1,c!==0&&(Md(h,s,c,d,m),m=void 0,c=0),d={type:"table",start:Object.assign({},g.start),end:Object.assign({},g.end)},h.add(n,0,[["enter",d,s]])):g.type==="tableRow"||g.type==="tableDelimiterRow"?(i=!0,u=void 0,a=[0,0,0,0],o=[0,n+1,0,0],l&&(l=!1,m={type:"tableBody",start:Object.assign({},g.start),end:Object.assign({},g.end)},h.add(n,0,[["enter",m,s]])),r=g.type==="tableDelimiterRow"?2:m?3:1):r&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")?(i=!1,o[2]===0&&(a[1]!==0&&(o[0]=o[1],u=Ar(h,s,a,r,void 0,u),a=[0,0,0,0]),o[2]=n)):g.type==="tableCellDivider"&&(i?i=!1:(a[1]!==0&&(o[0]=o[1],u=Ar(h,s,a,r,void 0,u)),a=o,o=[a[1],n,0,0])):g.type==="tableHead"?(l=!0,c=n):g.type==="tableRow"||g.type==="tableDelimiterRow"?(c=n,a[1]!==0?(o[0]=o[1],u=Ar(h,s,a,r,n,u)):o[1]!==0&&(u=Ar(h,s,o,r,n,u)),r=0):r&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")&&(o[3]=n)}for(c!==0&&Md(h,s,c,d,m),h.consume(s.events),n=-1;++n<s.events.length;){const p=s.events[n];p[0]==="enter"&&p[1].type==="table"&&(p[1]._align=Lk(s.events,n))}return e}function Ar(e,s,n,i,r,a){const o=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",l="tableContent";n[0]!==0&&(a.end=Object.assign({},gn(s.events,n[0])),e.add(n[0],0,[["exit",a,s]]));const c=gn(s.events,n[1]);if(a={type:o,start:Object.assign({},c),end:Object.assign({},c)},e.add(n[1],0,[["enter",a,s]]),n[2]!==0){const d=gn(s.events,n[2]),m=gn(s.events,n[3]),u={type:l,start:Object.assign({},d),end:Object.assign({},m)};if(e.add(n[2],0,[["enter",u,s]]),i!==2){const h=s.events[n[2]],p=s.events[n[3]];if(h[1].end=Object.assign({},p[1].end),h[1].type="chunkText",h[1].contentType="text",n[3]>n[2]+1){const g=n[2]+1,f=n[3]-n[2]-1;e.add(g,f,[])}}e.add(n[3]+1,0,[["exit",u,s]])}return r!==void 0&&(a.end=Object.assign({},gn(s.events,r)),e.add(r,0,[["exit",a,s]]),a=void 0),a}function Md(e,s,n,i,r){const a=[],o=gn(s.events,n);r&&(r.end=Object.assign({},o),a.push(["exit",r,s])),i.end=Object.assign({},o),a.push(["exit",i,s]),e.add(n+1,0,a)}function gn(e,s){const n=e[s],i=n[0]==="enter"?"start":"end";return n[1][i]}const $k={name:"tasklistCheck",tokenize:Vk};function qk(){return{text:{91:$k}}}function Vk(e,s,n){const i=this;return r;function r(c){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?n(c):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),a)}function a(c){return pt(c)?(e.enter("taskListCheckValueUnchecked"),e.consume(c),e.exit("taskListCheckValueUnchecked"),o):c===88||c===120?(e.enter("taskListCheckValueChecked"),e.consume(c),e.exit("taskListCheckValueChecked"),o):n(c)}function o(c){return c===93?(e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),l):n(c)}function l(c){return yi(c)?s(c):xn(c)?e.check({tokenize:Bk},s,n)(c):n(c)}}function Bk(e,s,n){return Ns(e,i,"whitespace");function i(r){return r===null?n(r):s(r)}}function Uk(e){return Iy([fk(),zk(),_k(e),Ok(),qk()])}const Wk={};function Uo(e){const s=this,n=e||Wk,i=s.data(),r=i.micromarkExtensions||(i.micromarkExtensions=[]),a=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),o=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);r.push(Uk(n)),a.push(uk()),o.push(mk(n))}const Kk=({activity:e})=>t.jsxs("div",{className:"grid gap-6 lg:grid-cols-[1fr,300px]",children:[t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Treść materiału"})}),t.jsx(F,{children:e.content?t.jsx("div",{className:"prose max-w-none",children:t.jsx(Cn,{remarkPlugins:[Uo],children:e.content})}):t.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[t.jsx(ft,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Brak treści materiału"})]})})]}),t.jsx("div",{className:"space-y-4",children:t.jsxs(R,{children:[t.jsx(W,{className:"pb-3",children:t.jsx(U,{className:"text-base",children:"Informacje"})}),t.jsxs(F,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[t.jsx(Qt,{className:"w-4 h-4"}),"Czas trwania"]}),t.jsxs("p",{className:"font-medium",children:[e.duration_min||"-"," minut"]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[t.jsx(Ky,{className:"w-4 h-4"}),"Pozycja w temacie"]}),t.jsx("p",{className:"font-medium",children:e.position})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[t.jsx(Ps,{className:"w-4 h-4"}),"Data utworzenia"]}),t.jsx("p",{className:"font-medium",children:new Date(e.created_at).toLocaleDateString("pl-PL")})]}),e.updated_at&&t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[t.jsx(Ps,{className:"w-4 h-4"}),"Ostatnia aktualizacja"]}),t.jsx("p",{className:"font-medium",children:new Date(e.updated_at).toLocaleDateString("pl-PL")})]})]})]})})]}),Gk=({activity:e,questionsCount:s,questionsData:n,questionsLoading:i,onNavigateToQuestions:r})=>{const a=n?.reduce((l,c)=>l+(c.points||0),0)||0,o=Math.ceil((e.passing_score||70)/100*a);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Parametry quizu"})}),t.jsx(F,{children:t.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[t.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(Qt,{className:"w-4 h-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Czas trwania"})]}),t.jsxs("p",{className:"text-2xl font-bold",children:[e.duration_min||"-"," min"]})]}),t.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(Ss,{className:"w-4 h-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Próg zaliczenia"})]}),t.jsxs("p",{className:"text-2xl font-bold",children:[e.passing_score||70,"%"]})]}),t.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(Gy,{className:"w-4 h-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Limit czasu"})]}),t.jsx("p",{className:"text-2xl font-bold",children:e.time_limit?`${e.time_limit} min`:"Brak"})]}),t.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(ja,{className:"w-4 h-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Liczba prób"})]}),t.jsx("p",{className:"text-2xl font-bold",children:e.max_attempts||"Bez limitu"})]})]})})]}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsxs(U,{className:"flex items-center justify-between",children:[t.jsxs("span",{children:["Pytania (",s,")"]}),s>0&&t.jsxs(T,{size:"sm",variant:"outline",onClick:()=>r(e.id),children:[t.jsx(Lt,{className:"w-3 h-3 mr-1"}),"Zarządzaj"]})]})}),t.jsx(F,{children:s===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(st,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground/30"}),t.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-2",children:"Ten quiz nie ma jeszcze pytań"}),t.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Dodaj pytania, aby uczniowie mogli rozwiązać quiz"}),t.jsxs(T,{onClick:()=>r(e.id),children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Dodaj pierwsze pytanie"]})]}):i?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):t.jsx("div",{className:"space-y-2",children:n?.map((l,c)=>t.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-sm font-semibold",children:c+1}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.type==="single_choice"&&t.jsxs(ne,{variant:"outline",className:"text-xs",children:[t.jsx(Hy,{className:"w-3 h-3 mr-1"}),"Jednokrotny wybór"]}),l.type==="multiple_choice"&&t.jsxs(ne,{variant:"outline",className:"text-xs",children:[t.jsx(Qs,{className:"w-3 h-3 mr-1"}),"Wielokrotny wybór"]}),l.type==="true_false"&&t.jsxs(ne,{variant:"outline",className:"text-xs",children:[t.jsx(Cl,{className:"w-3 h-3 mr-1"}),"Prawda/Fałsz"]}),t.jsxs(ne,{variant:"secondary",className:"text-xs",children:[l.points," pkt"]})]}),t.jsx("p",{className:"text-sm font-medium line-clamp-2",children:l.content}),l.explanation&&t.jsxs("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-1",children:[t.jsx("span",{className:"font-medium",children:"Wyjaśnienie:"})," ",l.explanation]})]})]},l.id))})})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.jsxs(R,{children:[t.jsx(W,{className:"pb-3",children:t.jsx(U,{className:"text-base",children:"Statystyki"})}),t.jsx(F,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Liczba pytań"}),t.jsx("span",{className:"font-medium",children:s})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Maksymalna liczba punktów"}),t.jsx("span",{className:"font-medium",children:a})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Wymagane punkty do zaliczenia"}),t.jsx("span",{className:"font-medium",children:o})]})]})})]}),t.jsxs(R,{children:[t.jsx(W,{className:"pb-3",children:t.jsx(U,{className:"text-base",children:"Informacje"})}),t.jsx(F,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Pozycja w temacie"}),t.jsx("span",{className:"font-medium",children:e.position})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Data utworzenia"}),t.jsx("span",{className:"font-medium",children:new Date(e.created_at).toLocaleDateString("pl-PL")})]}),e.updated_at&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Ostatnia aktualizacja"}),t.jsx("span",{className:"font-medium",children:new Date(e.updated_at).toLocaleDateString("pl-PL")})]})]})})]})]})]})},Hk=()=>{const{edit:e}=Ve(),{id:s}=Ze(),n=Z(),{data:i,isLoading:r}=Oe({resource:"activities",id:s,meta:{select:"*, topics(*, courses(*)), questions:questions(count)"}}),{data:a,isLoading:o}=Ae({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(s)}],sorters:[{field:"position",order:"asc"}],queryOptions:{enabled:i?.data?.type==="quiz"&&!!s}});if(r)return t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const l=i?.data;if(!l)return t.jsx(q,{children:t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-muted-foreground",children:"Nie znaleziono aktywności"})})});const c=l.topics,d=c?.courses,m=l.questions?.[0]?.count||l._count?.questions||0,u=()=>{const f=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",f),e("activities",l.id??"")},h=f=>{const y=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",y),n(f)},p=()=>l.type==="quiz"?t.jsx(st,{className:"w-5 h-5"}):t.jsx(ft,{className:"w-5 h-5"}),g=()=>l.type==="quiz"?"text-blue-500":"text-green-500";return t.jsxs(q,{children:[t.jsx(Xs,{}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[d?.title," → Temat ",c?.position,": ",c?.title]}),t.jsxs(I,{children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`p-2 rounded-lg bg-muted ${g()}`,children:p()}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:l.title}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx(ne,{variant:l.type==="quiz"?"default":"secondary",children:l.type==="quiz"?"Quiz":"Materiał"}),t.jsx(ne,{variant:l.is_published?"default":"outline",children:l.is_published?t.jsxs(t.Fragment,{children:[t.jsx(qe,{className:"w-3 h-3 mr-1"})," Opublikowany"]}):t.jsxs(t.Fragment,{children:[t.jsx(ya,{className:"w-3 h-3 mr-1"})," Szkic"]})})]})]})]}),t.jsxs("div",{className:"flex gap-2",children:[l.type==="quiz"&&t.jsxs(T,{variant:"outline",onClick:()=>h(`/questions/manage/${l.id}`),children:[t.jsx(Qs,{className:"w-4 h-4 mr-2"}),"Zarządzaj pytaniami (",m,")"]}),t.jsxs(T,{onClick:u,children:[t.jsx(Lt,{className:"w-4 h-4 mr-2"}),"Edytuj"]})]})]})]}),l.type==="material"?t.jsx(Kk,{activity:l}):t.jsx(Gk,{activity:l,questionsCount:m,questionsData:a?.data,questionsLoading:o,onNavigateToQuestions:f=>h(`/questions/manage/${f}`)})]})},Qk=[t.jsx(L,{path:"/activities/create",element:t.jsx(L0,{})},"activities-create"),t.jsx(L,{path:"/activities/edit/:id",element:t.jsx(O0,{})},"activities-edit"),t.jsx(L,{path:"/activities/show/:id",element:t.jsx(Hk,{})},"activities-show")],Yk=()=>{const{create:e,edit:s,show:n}=Ve(),i=Z(),{mutate:r}=In(),{tableQuery:{data:a,isLoading:o,isError:l,refetch:c},current:d,setCurrent:m,pageSize:u,setFilters:h}=fa({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, group_members(count), course_access(count)"}}),p=ba({isLoading:o,isError:l});if(p)return p;const g=(j,w)=>{confirm(`Czy na pewno chcesz usunąć grupę "${w}"? Ta akcja usunie również wszystkie przypisania uczniów i kursów.`)&&r({resource:"groups",id:j},{onSuccess:()=>{O.success("Grupa została usunięta"),c()},onError:()=>{O.error("Błąd podczas usuwania grupy")}})},f=(j,w)=>{w?.stopPropagation(),i(`/groups/${j}/assign-courses`)},y=(j,w)=>{w?.stopPropagation(),i(`/groups/${j}/assign-students`)},b=j=>!j||!Array.isArray(j)||j.length===0?0:j[0].count||0;return t.jsxs(q,{children:[t.jsxs(I,{children:[t.jsx(ce,{title:"Grupy",description:"Zarządzaj grupami uczniów i przypisuj im kursy"}),t.jsxs(T,{onClick:()=>e("groups"),children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Dodaj grupę"]})]}),t.jsx(I,{children:t.jsx(B,{placeholder:"Szukaj grup...",className:"max-w-sm",onChange:j=>{h([{field:"name",operator:"contains",value:j.target.value}])}})}),a?.data?.length===0?t.jsx(R,{className:"border-dashed border-2",children:t.jsxs(F,{className:"text-center py-12",children:[t.jsx(Ye,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Brak grup"}),t.jsx("p",{className:"text-muted-foreground mb-6",children:"Utwórz pierwszą grupę, aby móc przypisywać uczniów do kursów"}),t.jsxs(T,{onClick:()=>e("groups"),children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Utwórz pierwszą grupę"]})]})}):t.jsx(be,{children:a?.data?.map(j=>{const w=b(j.group_members),S=b(j.course_access);return t.jsxs(R,{className:"cursor-pointer transition-all hover:shadow-lg hover:border-primary/50 relative overflow-hidden",onClick:k=>{!k.target.closest('[role="menu"]')&&!k.target.closest(".quick-action")&&n("groups",j.id)},children:[!j.is_active&&t.jsx("div",{className:"absolute inset-0 bg-muted/50 z-10 pointer-events-none"}),t.jsx(W,{children:t.jsxs(I,{children:[t.jsxs(U,{className:"flex items-center gap-2",children:[t.jsx(Ye,{className:"w-5 h-5 text-primary"}),t.jsx("span",{className:"truncate",children:j.name})]}),t.jsxs(On,{children:[t.jsx(Rn,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"sm",onClick:k=>k.stopPropagation(),className:"relative z-20",children:t.jsx(tr,{className:"h-4 w-4"})})}),t.jsxs(Js,{align:"end",children:[t.jsxs(ae,{onClick:()=>n("groups",j.id),children:[t.jsx(qe,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),t.jsxs(ae,{onClick:()=>s("groups",j.id),children:[t.jsx(Lt,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),t.jsx(Nt,{}),t.jsxs(ae,{onClick:k=>y(j.id,k),className:"text-blue-600 focus:text-blue-600",children:[t.jsx(Ln,{className:"mr-2 h-4 w-4"}),"Dodaj uczniów"]}),t.jsxs(ae,{onClick:k=>f(j.id,k),className:"text-green-600 focus:text-green-600",children:[t.jsx(Me,{className:"mr-2 h-4 w-4"}),"Przypisz kursy"]}),t.jsx(Nt,{}),t.jsxs(ae,{onClick:()=>g(j.id,j.name),className:"text-red-600 focus:text-red-600",children:[t.jsx(ds,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})}),t.jsx(F,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(Ps,{className:"w-4 h-4"}),t.jsxs("span",{children:["Rok akademicki: ",j.academic_year]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-2 bg-background rounded-md",children:t.jsx(Ye,{className:"w-4 h-4 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Uczniowie"}),t.jsx("p",{className:"text-lg font-semibold",children:w})]})]})}),t.jsx("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-2 bg-background rounded-md",children:t.jsx(Me,{className:"w-4 h-4 text-green-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Kursy"}),t.jsx("p",{className:"text-lg font-semibold",children:S})]})]})})]}),t.jsxs("div",{className:"flex items-center justify-between pt-2",children:[t.jsx(ne,{variant:j.is_active?"default":"secondary",className:j.is_active?"bg-green-600":"",children:j.is_active?"Aktywna":"Nieaktywna"}),t.jsxs("div",{className:"flex gap-1",children:[w===0&&t.jsx(T,{size:"sm",variant:"ghost",className:"h-8 px-2 quick-action text-blue-600 hover:text-blue-700 hover:bg-blue-50",onClick:k=>y(j.id,k),title:"Dodaj uczniów",children:t.jsx(Ln,{className:"h-4 w-4"})}),t.jsxs(T,{size:"sm",variant:"ghost",className:"h-8 px-2 quick-action text-green-600 hover:text-green-700 hover:bg-green-50",onClick:k=>f(j.id,k),title:"Przypisz kursy",children:[t.jsx(Me,{className:"h-4 w-4"}),t.jsx(Ge,{className:"h-3 w-3 ml-1"})]})]})]})]})})]},j.id)})}),t.jsx(wa,{current:d,pageSize:u,total:a?.total||0,setCurrent:m,itemName:"grup"})]})},Zk=()=>{const{list:e}=Ve(),{data:s}=Tt(),{refineCore:{onFinish:n},register:i,handleSubmit:r,setValue:a,watch:o,formState:{errors:l,isSubmitting:c}}=Jt({defaultValues:{name:"",vendor_id:s?.vendor_id||0,is_active:!0,academic_year:new Date().getFullYear().toString()+"/"+(new Date().getFullYear()+1).toString()}});return t.jsxs(q,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("groups"),children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsx(I,{children:t.jsx(ce,{title:"Dodaj grupę",description:"Utwórz nową grupę uczniów"})}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Informacje o grupie"})}),t.jsx(F,{children:t.jsxs(es,{onSubmit:r(n),children:[t.jsx(H,{label:"Nazwa grupy",htmlFor:"name",error:l.name?.message?.toString(),required:!0,children:t.jsx(B,{id:"name",placeholder:"np. Klasa 1A",...i("name",{required:"Nazwa grupy jest wymagana",minLength:{value:2,message:"Nazwa musi mieć minimum 2 znaki"}})})}),t.jsx(H,{label:"Rok akademicki",htmlFor:"academic_year",error:l.academic_year?.message?.toString(),required:!0,children:t.jsx(B,{id:"academic_year",placeholder:"np. 2024/2025",...i("academic_year",{required:"Rok akademicki jest wymagany",pattern:{value:/^\d{4}\/\d{4}$/,message:"Format: RRRR/RRRR (np. 2024/2025)"}})})}),t.jsx(H,{label:"Status grupy",children:t.jsxs(I,{variant:"start",children:[t.jsx(Ot,{checked:o("is_active"),onCheckedChange:d=>a("is_active",d)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Grupa aktywna"})]})}),t.jsxs(ts,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:()=>e("groups"),children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:c,children:c?"Tworzenie...":"Utwórz grupę"})]})]})})]})]})},Jk=()=>{const{list:e}=Ve(),{id:s}=Ze(),{data:n,isLoading:i}=Oe({resource:"groups",id:s,liveMode:"off"}),{refineCore:{onFinish:r},register:a,handleSubmit:o,setValue:l,watch:c,reset:d,formState:{errors:m,isSubmitting:u}}=Jt({refineCoreProps:{resource:"groups",id:s,redirect:"list",liveMode:"off"}});return x.useEffect(()=>{n?.data&&d({name:n.data.name,academic_year:n.data.academic_year,is_active:n.data.is_active,vendor_id:n.data.vendor_id})},[n,d]),i?t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):t.jsxs(q,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("groups"),children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsx(I,{children:t.jsx(ce,{title:"Edytuj grupę",description:`Edycja: ${n?.data?.name}`})}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Informacje o grupie"})}),t.jsx(F,{children:t.jsxs(es,{onSubmit:o(r),children:[t.jsx(H,{label:"Nazwa grupy",htmlFor:"name",error:m.name?.message,required:!0,children:t.jsx(B,{id:"name",placeholder:"np. Klasa 1A",...a("name",{required:"Nazwa grupy jest wymagana",minLength:{value:2,message:"Nazwa musi mieć minimum 2 znaki"}})})}),t.jsx(H,{label:"Rok akademicki",htmlFor:"academic_year",error:m.academic_year?.message,required:!0,children:t.jsx(B,{id:"academic_year",placeholder:"np. 2024/2025",...a("academic_year",{required:"Rok akademicki jest wymagany",pattern:{value:/^\d{4}\/\d{4}$/,message:"Format: RRRR/RRRR (np. 2024/2025)"}})})}),t.jsx(H,{label:"Status grupy",children:t.jsxs(I,{variant:"start",children:[t.jsx(Ot,{checked:c("is_active"),onCheckedChange:h=>l("is_active",h)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Grupa aktywna"})]})}),t.jsxs(ts,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:()=>e("groups"),children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:u,children:u?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},Xk=()=>{const{list:e,edit:s,show:n}=Ve(),{id:i}=Ze(),r=Z(),a=Um(),{data:o,isLoading:l}=Oe({resource:"groups",id:i,liveMode:"off"}),{data:c,isLoading:d}=Ae({resource:"group_members",filters:[{field:"group_id",operator:"eq",value:i}],meta:{select:"*, users(*)"},queryOptions:{enabled:!!i},liveMode:"off"}),{data:m,isLoading:u}=Ae({resource:"course_access",filters:[{field:"group_id",operator:"eq",value:i}],meta:{select:"*, courses(*)"},queryOptions:{enabled:!!i},liveMode:"off"}),h=async(b,j)=>{if(confirm(`Czy na pewno chcesz odpiąć kurs "${j}" od tej grupy?`))try{const{error:w}=await te.from("course_access").delete().eq("course_id",b).eq("group_id",parseInt(i));if(w)throw w;O.success("Kurs został odpięty od grupy"),a({resource:"course_access",invalidates:["list"]})}catch(w){console.error("Error removing course:",w),O.error("Błąd podczas odpinania kursu")}},p=async(b,j)=>{if(confirm(`Czy na pewno chcesz usunąć "${j}" z tej grupy?`))try{const{error:w}=await te.from("group_members").delete().eq("user_id",b).eq("group_id",parseInt(i));if(w)throw w;O.success("Uczeń został usunięty z grupy"),a({resource:"group_members",invalidates:["list"]})}catch(w){console.error("Error removing member:",w),O.error("Błąd podczas usuwania ucznia z grupy")}};if(l||d||u)return t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const g=o?.data,f=c?.total||0,y=m?.total||0;return t.jsxs(q,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("groups"),children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsxs(I,{children:[t.jsxs("div",{children:[t.jsx(ce,{title:g?.name,description:`Rok akademicki: ${g?.academic_year}`}),!g?.is_active&&t.jsx(ne,{variant:"secondary",className:"mt-2",children:"Grupa nieaktywna"})]}),t.jsxs(T,{onClick:()=>s("groups",g?.id??""),children:[t.jsx(Lt,{className:"w-4 h-4 mr-2"}),"Edytuj grupę"]})]}),!g?.is_active&&t.jsxs(Es,{children:[t.jsx(Cl,{className:"h-4 w-4"}),t.jsx(Ds,{children:"Ta grupa jest nieaktywna. Uczniowie nie mają dostępu do przypisanych kursów."})]}),t.jsxs(be,{variant:"2-2-4",children:[t.jsxs(R,{children:[t.jsx(W,{className:"pb-2",children:t.jsx(U,{className:"text-sm font-medium",children:"Status"})}),t.jsx(F,{children:t.jsx(ne,{variant:g?.is_active?"default":"secondary",className:g?.is_active?"bg-green-600":"",children:g?.is_active?"Aktywna":"Nieaktywna"})})]}),t.jsxs(R,{children:[t.jsx(W,{className:"pb-2",children:t.jsx(U,{className:"text-sm font-medium",children:"Uczniowie"})}),t.jsx(F,{children:t.jsx("div",{className:"text-2xl font-bold",children:f})})]}),t.jsxs(R,{children:[t.jsx(W,{className:"pb-2",children:t.jsx(U,{className:"text-sm font-medium",children:"Kursy"})}),t.jsx(F,{children:t.jsx("div",{className:"text-2xl font-bold",children:y})})]}),t.jsxs(R,{children:[t.jsx(W,{className:"pb-2",children:t.jsx(U,{className:"text-sm font-medium",children:"Utworzono"})}),t.jsx(F,{children:t.jsx("div",{className:"text-sm",children:new Date(g?.created_at).toLocaleDateString("pl-PL")})})]})]}),t.jsxs(be,{variant:"1-2-2",children:[t.jsxs(R,{children:[t.jsx(W,{children:t.jsxs(I,{children:[t.jsx(U,{children:"Uczniowie grupy"}),t.jsxs(T,{size:"sm",onClick:()=>r(`/groups/${i}/assign-students`),children:[t.jsx(Ln,{className:"w-4 h-4 mr-2"}),"Dodaj ucznia"]})]})}),t.jsx(F,{children:c?.data?.length?t.jsx("div",{className:"space-y-2",children:c.data.map(b=>t.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/30 transition-all duration-200 group",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex gap-3 flex-1 min-w-0",children:[t.jsx("div",{className:"h-10 w-10 rounded-full bg-muted/50 flex items-center justify-center flex-shrink-0",children:t.jsx(Ye,{className:"h-5 w-5 text-muted-foreground"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-medium text-base leading-tight truncate pr-2",children:b.users?.full_name}),t.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[t.jsx(sr,{className:"h-3.5 w-3.5 text-muted-foreground"}),t.jsx("p",{className:"text-sm text-muted-foreground truncate",children:b.users?.email})]})]})]}),t.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx(Vt,{children:t.jsxs(Bt,{children:[t.jsx(Ut,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>n("users",b.user_id),children:t.jsx(ad,{className:"h-4 w-4"})})}),t.jsx(_t,{children:t.jsx("p",{children:"Zobacz profil"})})]})}),t.jsx(Vt,{children:t.jsxs(Bt,{children:[t.jsx(Ut,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-red-50",onClick:()=>p(b.user_id,b.users?.full_name),children:t.jsx(ds,{className:"h-4 w-4 text-red-600"})})}),t.jsx(_t,{children:t.jsx("p",{children:"Usuń z grupy"})})]})})]})]})},b.user_id))}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(Ye,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Brak uczniów w grupie"}),t.jsxs(T,{size:"sm",variant:"outline",className:"mt-4",onClick:()=>r(`/groups/${i}/assign-students`),children:[t.jsx(Ln,{className:"w-4 h-4 mr-2"}),"Dodaj pierwszego ucznia"]})]})})]}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsxs(I,{children:[t.jsx(U,{children:"Przypisane kursy"}),t.jsxs(T,{size:"sm",onClick:()=>r(`/groups/${i}/assign-courses`),children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Przypisz kurs"]})]})}),t.jsx(F,{children:m?.data?.length?t.jsx("div",{className:"space-y-2",children:m.data.map(b=>t.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/30 transition-all duration-200 group",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex gap-3 flex-1 min-w-0",children:[t.jsx("div",{className:"flex-shrink-0 mt-0.5",children:b.courses?.icon_emoji?t.jsx("div",{className:"h-10 w-10 rounded-lg bg-muted/50 flex items-center justify-center",children:t.jsx("span",{className:"text-xl",children:b.courses.icon_emoji})}):t.jsx("div",{className:"h-10 w-10 rounded-lg bg-muted/50 flex items-center justify-center",children:t.jsx(Me,{className:"h-5 w-5 text-muted-foreground"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-medium text-base leading-tight truncate pr-2",children:b.courses?.title}),t.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[t.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[t.jsx(Ps,{className:"h-3.5 w-3.5"}),t.jsx("span",{children:new Date(b.assigned_at).toLocaleDateString("pl-PL")})]}),t.jsx(ne,{variant:b.courses?.is_published?"default":"secondary",className:`text-xs ${b.courses?.is_published?"bg-green-100 text-green-700 hover:bg-green-100":""}`,children:b.courses?.is_published?"Opublikowany":"Szkic"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx(Vt,{children:t.jsxs(Bt,{children:[t.jsx(Ut,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>n("courses",b.course_id),children:t.jsx(ad,{className:"h-4 w-4"})})}),t.jsx(_t,{children:t.jsx("p",{children:"Zobacz kurs"})})]})}),t.jsx(Vt,{children:t.jsxs(Bt,{children:[t.jsx(Ut,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-red-50",onClick:()=>h(b.course_id,b.courses?.title),children:t.jsx(ds,{className:"h-4 w-4 text-red-600"})})}),t.jsx(_t,{children:t.jsx("p",{children:"Odepnij kurs"})})]})})]})]})},b.course_id))}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(Me,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Brak przypisanych kursów"}),t.jsxs(T,{size:"sm",variant:"outline",className:"mt-4",onClick:()=>r(`/groups/${i}/assign-courses`),children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Przypisz pierwszy kurs"]})]})})]})]})]})},ez=()=>{const{id:e}=Ze(),s=Z(),[n,i]=x.useState([]),[r,a]=x.useState(""),[o,l]=x.useState(!1),{data:c,isLoading:d}=Oe({resource:"groups",id:e}),{data:m,isLoading:u}=Ae({resource:"courses",pagination:{mode:"off"},meta:{select:"*, topics(count)"}}),{data:h,isLoading:p}=Ae({resource:"course_access",filters:[{field:"group_id",operator:"eq",value:parseInt(e)}],pagination:{mode:"off"},meta:{select:"course_id, group_id"}}),{mutate:g,isLoading:f}=cs(),y=async()=>{if(n.length===0){O.error("Wybierz przynajmniej jeden kurs");return}try{const v=n.map(P=>g({resource:"course_access",values:{course_id:P,group_id:parseInt(e)}},{onSuccess:()=>{console.log(`Course ${P} assigned successfully`)},onError:D=>{console.error("Error assigning course:",P,D)}}));await Promise.all(v),O.success(`Przypisano ${n.length} ${n.length===1?"kurs":"kursów"} do grupy`),s(`/groups/show/${e}`)}catch(v){O.error("Błąd podczas przypisywania kursów"),console.error("Error details:",v)}};if(d||u||p)return t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const b=c?.data,j=h?.data?.map(v=>v.course_id)||[];let w=m?.data?.filter(v=>!j.includes(v.id))||[];o&&(w=w.filter(v=>v.is_published));const S=w.filter(v=>v.title.toLowerCase().includes(r.toLowerCase())||v.description?.toLowerCase().includes(r.toLowerCase())),k=v=>{i(P=>P.includes(v)?P.filter(D=>D!==v):[...P,v])},z=()=>{i(S.map(v=>v.id))},N=()=>{i([])},C=w.filter(v=>v.is_published).length,A=w.length-C;return t.jsxs(q,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>s(`/groups/show/${e}`),children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),"Powrót do grupy"]}),t.jsx(I,{children:t.jsx(ce,{title:"Przypisz kursy",description:`Przypisywanie kursów do grupy: ${b?.name}`})}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsxs(I,{children:[t.jsxs("div",{children:[t.jsx(U,{children:"Dostępne kursy"}),w.length>0&&t.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[C," opublikowanych, ",A," szkiców"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>l(!o),className:o?"bg-primary text-primary-foreground":"",children:[t.jsx(qe,{className:"w-4 h-4 mr-2"}),"Tylko opublikowane"]}),t.jsxs(T,{variant:"outline",size:"sm",onClick:z,disabled:S.length===0,children:[t.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Zaznacz wszystkie"]}),t.jsxs(T,{variant:"outline",size:"sm",onClick:N,disabled:n.length===0,children:[t.jsx(xt,{className:"w-4 h-4 mr-2"}),"Odznacz wszystkie"]})]})]})}),t.jsxs(F,{children:[t.jsxs("div",{className:"relative mb-4",children:[t.jsx(Qm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),t.jsx(B,{placeholder:"Szukaj kursów po nazwie lub opisie...",value:r,onChange:v=>a(v.target.value),className:"pl-10"})]}),S.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:w.length===0?t.jsxs(t.Fragment,{children:[t.jsx(Me,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{className:"font-medium mb-1",children:"Wszystkie kursy są już przypisane"}),t.jsx("p",{className:"text-sm",children:"Ta grupa ma dostęp do wszystkich dostępnych kursów"}),t.jsx(T,{size:"sm",variant:"outline",className:"mt-4",onClick:()=>s("/courses"),children:"Przejdź do listy kursów"})]}):t.jsxs(t.Fragment,{children:[t.jsx(Me,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Nie znaleziono kursów spełniających kryteria"})]})}):t.jsx("div",{className:"space-y-2",children:S.map(v=>{const P=v._count?.topics||0;return t.jsxs("div",{className:`
                      flex items-center space-x-3 p-3 border rounded-lg 
                      cursor-pointer transition-all
                      ${n.includes(v.id)?"border-primary bg-primary/5":"hover:bg-muted/50"}
                    `,onClick:()=>k(v.id),children:[t.jsx(ht,{checked:n.includes(v.id),onCheckedChange:()=>k(v.id),onClick:D=>D.stopPropagation()}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[v.icon_emoji&&t.jsx("span",{className:"text-xl",children:v.icon_emoji}),t.jsx("span",{className:"font-medium",children:v.title}),t.jsx(ne,{variant:v.is_published?"default":"secondary",className:"text-xs",children:v.is_published?"Opublikowany":"Szkic"})]}),v.description&&t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:v.description}),t.jsx("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:t.jsxs("span",{children:[P," ",P===1?"temat":"tematów"]})})]}),t.jsx(Vt,{children:t.jsxs(Bt,{children:[t.jsx(Ut,{asChild:!0,children:t.jsx(T,{size:"sm",variant:"ghost",onClick:D=>{D.stopPropagation(),s(`/courses/show/${v.id}`)},children:t.jsx(qe,{className:"h-4 w-4"})})}),t.jsx(_t,{children:t.jsx("p",{children:"Zobacz kurs"})})]})})]},v.id)})}),n.length>0&&t.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[t.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:["Wybrano ",n.length," kursów do przypisania"]}),t.jsxs(I,{children:[t.jsx(T,{variant:"outline",onClick:()=>s(`/groups/show/${e}`),children:"Anuluj"}),t.jsx(T,{onClick:y,disabled:f,children:f?"Przypisywanie...":"Przypisz kursy"})]})]})]})]})]})},tz=()=>{const{id:e}=Ze(),s=Z(),[n,i]=x.useState([]),[r,a]=x.useState(""),{data:o,isLoading:l}=Oe({resource:"groups",id:e}),{data:c,isLoading:d}=Ae({resource:"users",filters:[{field:"role",operator:"eq",value:"student"}],pagination:{mode:"off"}}),{data:m,isLoading:u}=Ae({resource:"group_members",filters:[{field:"group_id",operator:"eq",value:parseInt(e)}],pagination:{mode:"off"},meta:{select:"user_id, group_id"}}),{mutate:h,isLoading:p}=cs(),g=async()=>{if(n.length===0){O.error("Wybierz przynajmniej jednego ucznia");return}try{const z=n.map(N=>h({resource:"group_members",values:{user_id:N,group_id:parseInt(e)}},{onSuccess:()=>{console.log(`Student ${N} assigned successfully`)},onError:C=>{console.error("Error assigning student:",N,C)}}));await Promise.all(z),O.success(`Dodano ${n.length} uczniów do grupy`),s(`/groups/show/${e}`)}catch(z){O.error("Błąd podczas dodawania uczniów"),console.error("Error details:",z)}};if(l||d||u)return t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const f=o?.data,y=m?.data?.map(z=>z.user_id)||[],b=c?.data?.filter(z=>!y.includes(z.id))||[],j=b.filter(z=>z.full_name.toLowerCase().includes(r.toLowerCase())||z.email.toLowerCase().includes(r.toLowerCase())),w=z=>{i(N=>N.includes(z)?N.filter(C=>C!==z):[...N,z])},S=()=>{i(j.map(z=>z.id))},k=()=>{i([])};return t.jsxs(q,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>s(`/groups/show/${e}`),children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),"Powrót do grupy"]}),t.jsx(I,{children:t.jsx(ce,{title:"Dodaj uczniów",description:`Dodawanie uczniów do grupy: ${f?.name}`})}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsxs(I,{children:[t.jsx(U,{children:"Dostępni uczniowie"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:S,disabled:j.length===0,children:[t.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Zaznacz wszystkich"]}),t.jsxs(T,{variant:"outline",size:"sm",onClick:k,disabled:n.length===0,children:[t.jsx(xt,{className:"w-4 h-4 mr-2"}),"Odznacz wszystkich"]})]})]})}),t.jsxs(F,{children:[t.jsx(B,{placeholder:"Szukaj uczniów...",value:r,onChange:z=>a(z.target.value),className:"mb-4"}),j.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:b.length===0?t.jsxs(t.Fragment,{children:[t.jsx(Ln,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Wszyscy uczniowie są już w tej grupie"})]}):t.jsxs(t.Fragment,{children:[t.jsx(Ln,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Nie znaleziono uczniów"})]})}):t.jsx("div",{className:"space-y-2",children:j.map(z=>t.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-muted/50 cursor-pointer",onClick:()=>w(z.id),children:[t.jsx(ht,{checked:n.includes(z.id),onCheckedChange:()=>w(z.id),onClick:N=>N.stopPropagation()}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium",children:z.full_name}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(sr,{className:"w-3 h-3"}),z.email]})]}),t.jsx(ne,{variant:"secondary",className:"text-xs",children:"Uczeń"})]},z.id))}),n.length>0&&t.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[t.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:["Wybrano ",n.length," uczniów do dodania"]}),t.jsxs(I,{children:[t.jsx(T,{variant:"outline",onClick:()=>s(`/groups/show/${e}`),children:"Anuluj"}),t.jsx(T,{onClick:g,disabled:p,children:p?"Dodawanie...":"Dodaj uczniów"})]})]})]})]})]})},sz=[t.jsx(L,{path:"/groups",element:t.jsx(Yk,{})},"groups-list"),t.jsx(L,{path:"/groups/create",element:t.jsx(Zk,{})},"groups-create"),t.jsx(L,{path:"/groups/edit/:id",element:t.jsx(Jk,{})},"groups-edit"),t.jsx(L,{path:"/groups/show/:id",element:t.jsx(Xk,{})},"groups-show"),t.jsx(L,{path:"/groups/:id/assign-courses",element:t.jsx(ez,{})},"groups-assign-courses"),t.jsx(L,{path:"/groups/:id/assign-students",element:t.jsx(tz,{})},"groups-assign-students")],nz=()=>{const{create:e,edit:s,show:n}=Ve(),{mutate:i}=In(),[r,a]=x.useState("all"),{tableQuery:{data:o,isLoading:l,isError:c},current:d,setCurrent:m,pageSize:u,setFilters:h}=fa({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, user_stats(total_points, current_level)"}}),p=ba({isLoading:l,isError:c});if(p)return p;const g=(j,w)=>{confirm(`Czy na pewno chcesz usunąć użytkownika "${w}"?`)&&i({resource:"users",id:j})},f=j=>{const w=[];j&&w.push({operator:"or",value:[{field:"full_name",operator:"contains",value:j},{field:"email",operator:"contains",value:j}]}),r!=="all"&&w.push({field:"role",operator:"eq",value:r}),h(w)},y=j=>{switch(j){case"admin":return t.jsx(Tl,{className:"w-3 h-3"});case"teacher":return t.jsx(As,{className:"w-3 h-3"});default:return t.jsx(Qy,{className:"w-3 h-3"})}},b=j=>{switch(j){case"admin":return"destructive";case"teacher":return"default";default:return"secondary"}};return t.jsxs(q,{children:[t.jsxs(I,{children:[t.jsx(ce,{title:"Użytkownicy",description:"Zarządzaj użytkownikami systemu"}),t.jsxs(T,{onClick:()=>e("users"),children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Dodaj użytkownika"]})]}),t.jsxs(I,{className:"gap-4",children:[t.jsxs("div",{className:"relative flex-1 max-w-sm",children:[t.jsx(Qm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),t.jsx(B,{placeholder:"Szukaj po nazwie lub email...",className:"pl-10",onChange:j=>f(j.target.value)})]}),t.jsxs(ze,{value:r,onValueChange:j=>{a(j),f("")},children:[t.jsx(ve,{className:"w-[180px]",children:t.jsx(Se,{placeholder:"Filtruj po roli"})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"all",children:"Wszystkie role"}),t.jsx(V,{value:"student",children:"Studenci"}),t.jsx(V,{value:"teacher",children:"Nauczyciele"}),t.jsx(V,{value:"admin",children:"Administratorzy"})]})]})]}),t.jsx("div",{className:"space-y-4",children:o?.data?.map(j=>t.jsx(R,{children:t.jsx(F,{className:"p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center",children:t.jsx(Ye,{className:"h-6 w-6 text-muted-foreground"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:j.full_name}),t.jsx("p",{className:"text-sm text-muted-foreground",children:j.email})]}),t.jsxs(ne,{variant:b(j.role),children:[y(j.role),t.jsx("span",{className:"ml-1 capitalize",children:j.role})]}),t.jsx(ne,{variant:j.is_active?"outline":"secondary",children:j.is_active?"Aktywny":"Nieaktywny"})]}),t.jsxs("div",{className:"flex items-center gap-6",children:[j.user_stats&&t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Punkty"}),t.jsx("p",{className:"font-semibold",children:j.user_stats.total_points})]}),t.jsxs(On,{children:[t.jsx(Rn,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"sm",children:t.jsx(tr,{className:"h-4 w-4"})})}),t.jsxs(Js,{align:"end",children:[t.jsxs(ae,{onClick:()=>n("users",j.id),children:[t.jsx(qe,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),t.jsxs(ae,{onClick:()=>s("users",j.id),children:[t.jsx(Lt,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),t.jsxs(ae,{onClick:()=>g(j.id,j.full_name),className:"text-red-600",children:[t.jsx(ds,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})]})})},j.id))}),t.jsx(wa,{current:d,pageSize:u,total:o?.total||0,setCurrent:m,itemName:"użytkowników"})]})},iz=()=>{const{list:e}=Ve(),{data:s}=Tt(),{refineCore:{onFinish:n},register:i,handleSubmit:r,setValue:a,watch:o,formState:{errors:l,isSubmitting:c}}=Jt({defaultValues:{full_name:"",email:"",vendor_id:s?.vendor_id||0,role:"student",is_active:!0}});return t.jsxs(q,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("users"),children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsx(I,{children:t.jsx(ce,{title:"Dodaj użytkownika",description:"Utwórz nowe konto użytkownika"})}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Dane użytkownika"})}),t.jsx(F,{children:t.jsxs(es,{onSubmit:r(n),children:[t.jsxs(be,{variant:"1-2-2",children:[t.jsx(H,{label:"Imię i nazwisko",htmlFor:"full_name",error:l.full_name?.message?.toString(),required:!0,children:t.jsx(B,{id:"full_name",placeholder:"np. Jan Kowalski",...i("full_name",{required:"Imię i nazwisko są wymagane",minLength:{value:3,message:"Minimum 3 znaki"}})})}),t.jsx(H,{label:"Email",htmlFor:"email",error:l.email?.message?.toString(),required:!0,children:t.jsx(B,{id:"email",type:"email",placeholder:"np. jan.kowalski@example.com",...i("email",{required:"Email jest wymagany",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Nieprawidłowy format email"}})})}),t.jsx(H,{label:"Rola",error:l.role?.message?.toString(),required:!0,children:t.jsxs(ze,{value:o("role"),onValueChange:d=>a("role",d),children:[t.jsx(ve,{children:t.jsx(Se,{placeholder:"Wybierz rolę"})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"student",children:"Student"}),t.jsx(V,{value:"teacher",children:"Nauczyciel"}),t.jsx(V,{value:"admin",children:"Administrator"})]})]})})]}),t.jsx(H,{label:"Status konta",children:t.jsxs(I,{variant:"start",children:[t.jsx(Ot,{checked:o("is_active"),onCheckedChange:d=>a("is_active",d)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Konto aktywne (użytkownik może się zalogować)"})]})}),t.jsxs(ts,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:()=>e("users"),children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:c,children:c?"Tworzenie...":"Utwórz użytkownika"})]})]})})]})]})},rz=()=>{const{list:e}=Ve(),{id:s}=Ze(),{data:n,isLoading:i}=Oe({resource:"users",id:s,liveMode:"off"}),{refineCore:{onFinish:r},register:a,handleSubmit:o,setValue:l,watch:c,reset:d,formState:{errors:m,isSubmitting:u}}=Jt({refineCoreProps:{resource:"users",id:s,redirect:"list",liveMode:"off"}});return x.useEffect(()=>{n?.data&&d({full_name:n.data.full_name,email:n.data.email,role:n.data.role,is_active:n.data.is_active,vendor_id:n.data.vendor_id})},[n,d]),i?t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):t.jsxs(q,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("users"),children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsx(I,{children:t.jsx(ce,{title:"Edytuj użytkownika",description:`Edycja: ${n?.data?.full_name}`})}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Dane użytkownika"})}),t.jsx(F,{children:t.jsxs(es,{onSubmit:o(r),children:[t.jsxs(be,{variant:"1-2-2",children:[t.jsx(H,{label:"Imię i nazwisko",htmlFor:"full_name",error:m.full_name?.message,required:!0,children:t.jsx(B,{id:"full_name",placeholder:"np. Jan Kowalski",...a("full_name",{required:"Imię i nazwisko są wymagane",minLength:{value:3,message:"Minimum 3 znaki"}})})}),t.jsx(H,{label:"Email",htmlFor:"email",error:m.email?.message,required:!0,children:t.jsx(B,{id:"email",type:"email",placeholder:"np. jan.kowalski@example.com",...a("email",{required:"Email jest wymagany",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Nieprawidłowy format email"}}),disabled:!0})}),t.jsx(H,{label:"Rola",error:m.role?.message,required:!0,children:t.jsxs(ze,{value:c("role")||"student",onValueChange:h=>l("role",h),children:[t.jsx(ve,{children:t.jsx(Se,{placeholder:"Wybierz rolę"})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"student",children:"Student"}),t.jsx(V,{value:"teacher",children:"Nauczyciel"}),t.jsx(V,{value:"admin",children:"Administrator"})]})]})})]}),t.jsx(H,{label:"Status konta",children:t.jsxs(I,{variant:"start",children:[t.jsx(Ot,{checked:c("is_active")??!0,onCheckedChange:h=>l("is_active",h)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Konto aktywne (użytkownik może się zalogować)"})]})}),t.jsxs(ts,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:()=>e("users"),children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:u,children:u?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},az=()=>{const{list:e,edit:s}=Ve(),{id:n}=Ze(),{data:i,isLoading:r}=Oe({resource:"users",id:n,meta:{select:"*, user_stats(*)"}}),{data:a}=Ae({resource:"activity_progress",filters:[{field:"user_id",operator:"eq",value:n}]});if(r)return t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const o=i?.data,l=o?.user_stats?.[0]||{},c=d=>{switch(d){case"admin":return t.jsx(Tl,{className:"w-4 h-4"});case"teacher":return t.jsx(Me,{className:"w-4 h-4"});default:return t.jsx(Mi,{className:"w-4 h-4"})}};return t.jsxs(q,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("users"),children:[t.jsx(je,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsxs(I,{children:[t.jsx(ce,{title:o?.full_name,description:o?.email}),t.jsxs(T,{onClick:()=>s("users",o?.id??""),children:[t.jsx(Lt,{className:"w-4 h-4 mr-2"}),"Edytuj użytkownika"]})]}),t.jsxs(be,{children:[t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Informacje podstawowe"})}),t.jsx(F,{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Imię i nazwisko"}),t.jsx("p",{className:"text-lg",children:o?.full_name})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),t.jsxs("p",{className:"text-lg flex items-center gap-2",children:[t.jsx(sr,{className:"w-4 h-4"}),o?.email]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Rola"}),t.jsxs(ne,{variant:"default",className:"mt-1",children:[c(o?.role),t.jsx("span",{className:"ml-1 capitalize",children:o?.role})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),t.jsx(ne,{variant:o?.is_active?"outline":"secondary",className:"mt-1",children:o?.is_active?"Aktywny":"Nieaktywny"})]})]})})]}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Statystyki gamifikacji"})}),t.jsx(F,{children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[t.jsx(dt,{className:"w-8 h-8 mx-auto mb-2 text-yellow-500"}),t.jsx("p",{className:"text-2xl font-bold",children:l.total_points||0}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Punkty"})]}),t.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[t.jsx(Ss,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),t.jsx("p",{className:"text-2xl font-bold",children:l.current_level||1}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Poziom"})]}),t.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[t.jsx(Gm,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),t.jsx("p",{className:"text-2xl font-bold",children:l.daily_streak||0}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Dni z rzędu"})]}),t.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[t.jsx(Qt,{className:"w-8 h-8 mx-auto mb-2 text-purple-500"}),t.jsx("p",{className:"text-2xl font-bold",children:Math.round((l.total_time_spent||0)/60)}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Godzin nauki"})]})]})})]}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Postępy w nauce"})}),t.jsx(F,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Ukończone quizy"}),t.jsx("span",{className:"font-bold",children:l.quizzes_completed||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Wyniki perfekcyjne"}),t.jsx("span",{className:"font-bold",children:l.perfect_scores||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Ukończone aktywności"}),t.jsx("span",{className:"font-bold",children:a?.data?.filter(d=>d.completed_at).length||0})]})]})})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{className:"text-lg",children:"Daty"})}),t.jsxs(F,{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Utworzono"}),t.jsx("p",{className:"text-sm font-medium",children:new Date(o?.created_at).toLocaleDateString("pl-PL")})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Ostatnia aktywność"}),t.jsx("p",{className:"text-sm font-medium",children:l.last_active?new Date(l.last_active).toLocaleDateString("pl-PL"):"Brak aktywności"})]})]})]}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{className:"text-lg",children:"Idle Game"})}),t.jsxs(F,{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm",children:"Punkty/h"}),t.jsx("span",{className:"font-bold",children:l.idle_points_rate||1})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Ostatnie odebranie"}),t.jsx("p",{className:"text-sm font-medium",children:l.last_idle_claim?new Date(l.last_idle_claim).toLocaleString("pl-PL"):"Nigdy"})]})]})]})]})]})]})},oz=[t.jsx(L,{path:"/users",element:t.jsx(nz,{})},"users-list"),t.jsx(L,{path:"/users/create",element:t.jsx(iz,{})},"users-create"),t.jsx(L,{path:"/users/edit/:id",element:t.jsx(rz,{})},"users-edit"),t.jsx(L,{path:"/users/show/:id",element:t.jsx(az,{})},"users-show")],lz=()=>{const{tableQuery:{data:e,isLoading:s,isError:n},current:i,setCurrent:r,pageSize:a,setFilters:o}=fa({sorters:{initial:[{field:"created_at",order:"desc"}]}}),l=ba({isLoading:s,isError:n});return l||t.jsxs(q,{children:[t.jsx(ce,{title:"Organizacje",description:"Lista wszystkich organizacji w systemie"}),t.jsx(I,{children:t.jsx(B,{placeholder:"Szukaj organizacji...",className:"max-w-sm",onChange:c=>{o([{operator:"or",value:[{field:"name",operator:"contains",value:c.target.value},{field:"subdomain",operator:"contains",value:c.target.value}]}])}})}),t.jsx(be,{children:e?.data?.map(c=>t.jsxs(R,{children:[t.jsx(W,{children:t.jsxs(I,{children:[t.jsxs(U,{className:"flex items-center gap-2",children:[t.jsx(Yy,{className:"w-5 h-5"}),c.name]}),t.jsx(ne,{variant:c.is_active?"default":"secondary",children:c.is_active?"Aktywna":"Nieaktywna"})]})}),t.jsxs(F,{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(Zy,{className:"w-3 h-3"}),t.jsxs("span",{children:[c.subdomain,".example.com"]})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(Ps,{className:"w-3 h-3"}),t.jsxs("span",{children:["Utworzono: ",new Date(c.created_at).toLocaleDateString("pl-PL")]})]})]})]},c.id))}),t.jsx(wa,{current:i,pageSize:a,total:e?.total||0,setCurrent:r,itemName:"organizacji"})]})},cz=[t.jsx(L,{path:"/vendors",element:t.jsx(lz,{})},"vendors-list")],dz=()=>{const[e,s]=x.useState("users"),[n,i]=x.useState("month"),[r,a]=x.useState(!1),o=async()=>{a(!0);try{alert("Funkcja generowania raportów będzie dostępna wkrótce")}catch(c){console.error("Error generating report:",c)}finally{a(!1)}},l=[{id:"users",name:"Raport użytkowników",description:"Statystyki użytkowników, postępy, aktywność",icon:Ye},{id:"courses",name:"Raport kursów",description:"Popularność kursów, wskaźniki ukończenia",icon:Me},{id:"gamification",name:"Raport gamifikacji",description:"Punkty, poziomy, rankingi",icon:Di},{id:"activity",name:"Raport aktywności",description:"Logi, czas nauki, częstotliwość",icon:Gs}];return t.jsxs(q,{children:[t.jsx(ce,{title:"Raporty",description:"Generuj raporty i analizy systemu"}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Generator raportów"})}),t.jsxs(F,{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"Typ raportu"}),t.jsxs(ze,{value:e,onValueChange:s,children:[t.jsx(ve,{children:t.jsx(Se,{})}),t.jsx(Ne,{children:l.map(c=>t.jsx(V,{value:c.id,children:c.name},c.id))})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"Zakres czasowy"}),t.jsxs(ze,{value:n,onValueChange:i,children:[t.jsx(ve,{children:t.jsx(Se,{})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"week",children:"Ostatni tydzień"}),t.jsx(V,{value:"month",children:"Ostatni miesiąc"}),t.jsx(V,{value:"quarter",children:"Ostatni kwartał"}),t.jsx(V,{value:"year",children:"Ostatni rok"}),t.jsx(V,{value:"all",children:"Wszystkie dane"})]})]})]})]}),t.jsx("div",{className:"p-4 border rounded-lg bg-muted/50",children:l.find(c=>c.id===e)&&t.jsxs("div",{className:"flex items-start gap-3",children:[(()=>{const c=l.find(d=>d.id===e).icon;return t.jsx(c,{className:"w-5 h-5 mt-0.5 text-muted-foreground"})})(),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium",children:l.find(c=>c.id===e).name}),t.jsx("p",{className:"text-sm text-muted-foreground",children:l.find(c=>c.id===e).description})]})]})}),t.jsxs(T,{onClick:o,disabled:r,className:"w-full",children:[t.jsx(Jy,{className:"w-4 h-4 mr-2"}),r?"Generowanie...":"Generuj raport"]})]})]}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Ostatnie raporty"})}),t.jsx(F,{children:t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(ft,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Brak wygenerowanych raportów"}),t.jsx("p",{className:"text-sm mt-1",children:"Wygenerowane raporty będą wyświetlane tutaj"})]})})]})]})},uz=[t.jsx(L,{path:"/reports",element:t.jsx(dz,{})},"reports")],mz={id:"course-structure-wizard",title:"Kreator struktury kursu",schema:{step1:{title:"Podstawowe informacje o kursie",type:"object",properties:{courseType:{type:"select",title:"Typ kursu",options:[{value:"matura",label:"Kurs maturalny"},{value:"academic",label:"Kurs akademicki"},{value:"professional",label:"Kurs zawodowy"},{value:"hobby",label:"Kurs hobbystyczny"},{value:"certification",label:"Kurs certyfikacyjny"}]},subject:{type:"text",title:"Przedmiot/Dziedzina",placeholder:"np. Matematyka, Programowanie Python, Język angielski"},level:{type:"select",title:"Poziom kursu",options:[{value:"basic",label:"Podstawowy"},{value:"extended",label:"Rozszerzony"},{value:"beginner",label:"Początkujący"},{value:"intermediate",label:"Średniozaawansowany"},{value:"advanced",label:"Zaawansowany"}]},duration:{type:"select",title:"Planowany czas trwania",options:[{value:"1month",label:"1 miesiąc"},{value:"3months",label:"3 miesiące"},{value:"6months",label:"6 miesięcy"},{value:"1year",label:"1 rok"},{value:"2years",label:"2 lata"}]}},required:["courseType","subject","level","duration"]},step2:{title:"Analiza wymagań",type:"object",properties:{courseTitle:{type:"text",title:"Proponowany tytuł kursu",readOnly:!0},description:{type:"textarea",title:"Opis kursu",readOnly:!0},objectives:{type:"tags",title:"Cele kursu",readOnly:!0},targetAudience:{type:"text",title:"Grupa docelowa",readOnly:!0},prerequisites:{type:"tags",title:"Wymagania wstępne",readOnly:!0},estimatedHours:{type:"number",title:"Szacowana liczba godzin",readOnly:!0},topicsCount:{type:"number",title:"Liczba głównych tematów",readOnly:!0}}},step3:{title:"Dostosowanie struktury",type:"object",properties:{courseTitle:{type:"text",title:"Tytuł kursu",placeholder:"np. Matematyka - Przygotowanie do matury"},description:{type:"textarea",title:"Opis kursu",rows:4},topicsPerWeek:{type:"number",title:"Liczba tematów na tydzień",min:1,max:7},includeExercises:{type:"checkbox",title:"Dodaj ćwiczenia do każdego tematu"},includeQuizzes:{type:"checkbox",title:"Dodaj quizy sprawdzające"},quizFrequency:{type:"select",title:"Częstotliwość quizów",options:[{value:"after_each",label:"Po każdym temacie"},{value:"weekly",label:"Co tydzień"},{value:"biweekly",label:"Co dwa tygodnie"},{value:"monthly",label:"Co miesiąc"},{value:"chapter_end",label:"Na koniec działu"}]}},required:["courseTitle","description","topicsPerWeek"]},step4:{title:"Podgląd struktury",type:"object",properties:{structure:{type:"array",title:"Struktura kursu",readOnly:!0}}},step5:{title:"Tworzenie kursu",type:"object",properties:{courseName:{type:"text",title:"Ostateczna nazwa kursu"},iconEmoji:{type:"text",title:"Emoji ikona",placeholder:"np. 📚 📐 🎓"},isPublished:{type:"checkbox",title:"Opublikuj od razu"}},required:["courseName"]}}},hz={id:"analyze-course-requirements",name:"Analiza wymagań kursu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od projektowania kursów edukacyjnych i programów nauczania.",user:`
Przeanalizuj wymagania dla kursu:
Typ: {{courseType}}
Przedmiot: {{subject}}
Poziom: {{level}}
Czas trwania: {{duration}}

Wygeneruj JSON:
{
  "courseTitle": "<tytuł kursu odpowiedni do typu i poziomu>",
  "description": "<szczegółowy opis kursu 100-200 słów>",
  "objectives": ["cel1", "cel2", "cel3", "cel4", "cel5"],
  "targetAudience": "<opis grupy docelowej>",
  "prerequisites": ["wymaganie1", "wymaganie2"],
  "estimatedHours": <liczba godzin>,
  "topicsCount": <liczba głównych tematów>
}

Wymagania:
- Dla kursów maturalnych: zgodność z podstawą programową
- CourseTitle: profesjonalny i opisowy
- Description: zawiera zakres materiału i metodykę
- Objectives: 5-8 konkretnych, mierzalnych celów
- Prerequisites: realistyczne wymagania (może być pusta tablica)
- EstimatedHours: realistyczna liczba godzin
- TopicsCount: odpowiednia liczba tematów do czasu trwania
    `,responseFormat:"json"},inputMapping:e=>({courseType:e.courseType,subject:e.subject,level:e.level,duration:e.duration}),outputMapping:(e,s)=>({...s,courseTitle:e.courseTitle,description:e.description,objectives:e.objectives,targetAudience:e.targetAudience,prerequisites:e.prerequisites,estimatedHours:e.estimatedHours,topicsCount:e.topicsCount}),validation:e=>!!(e.courseTitle&&e.description&&e.objectives&&e.topicsCount)},pz={id:"generate-course-structure",name:"Generowanie struktury kursu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia szczegółowych programów nauczania. Tworzysz logiczną, progresywną strukturę kursu.",user:`
    Stwórz szczegółową strukturę kursu:
    
    Tytuł: {{courseTitle}}
    Opis: {{description}}
    Przedmiot: {{subject}}
    Poziom: {{level}}
    Typ: {{courseType}}
    Cele: {{objectives}}
    Liczba tematów: {{topicsCount}}
    Tematy na tydzień: {{topicsPerWeek}}
    Ćwiczenia: {{includeExercises}}
    Quizy: {{includeQuizzes}}
    Częstotliwość quizów: {{quizFrequency}}
    
    WAŻNE: Wygeneruj KOMPLETNY JSON dla pierwszych 4 tygodni kursu. NIE UŻYWAJ komentarzy w JSON. NIE UŻYWAJ "...". Każdy tydzień musi być w pełni wypełniony.
    
    Wygeneruj JSON ze strukturą:
    {
      "structure": [
        {
          "weekNumber": 1,
          "topics": [
            {
              "title": "<tytuł tematu>",
              "description": "<opis tematu>",
              "objectives": ["cel1", "cel2"],
              "activities": [
                {
                  "type": "material",
                  "title": "<tytuł materiału>",
                  "duration": <czas w minutach>
                },
                {
                  "type": "quiz",
                  "title": "<tytuł quizu>",
                  "questionsCount": <liczba pytań>
                }
              ],
              "keywords": ["słowo1", "słowo2"]
            }
          ]
        }
      ],
      "summary": {
        "totalWeeks": 4,
        "totalTopics": <liczba tematów w 4 tygodniach>,
        "totalActivities": <suma wszystkich aktywności>,
        "totalQuizzes": <suma wszystkich quizów>
      }
    }
    
    Wymagania:
    - Wygeneruj DOKŁADNIE 4 tygodnie
    - Każdy tydzień ma {{topicsPerWeek}} tematów
    - Logiczna progresja trudności
    - Dla kursów maturalnych: zgodność z wymaganiami egzaminacyjnymi
    - Każdy temat ma jasno określone cele
    - Realistyczne czasy trwania (30-90 min na materiał)
    - Quizy dostosowane do poziomu (5-15 pytań)
    - NIE UŻYWAJ komentarzy ani "..." w JSON
        `,responseFormat:"json"},inputMapping:e=>({courseTitle:e.courseTitle,description:e.description,subject:e.subject,level:e.level,courseType:e.courseType,objectives:Array.isArray(e.objectives)?e.objectives.join(", "):e.objectives,topicsCount:e.topicsCount,topicsPerWeek:e.topicsPerWeek,includeExercises:e.includeExercises?"tak":"nie",includeQuizzes:e.includeQuizzes?"tak":"nie",quizFrequency:e.quizFrequency||"chapter_end"}),outputMapping:(e,s)=>({...s,structure:e.structure,summary:e.summary}),validation:e=>!!(e.structure&&Array.isArray(e.structure)&&e.structure.length>0)},jt={subject:{minLength:3,errorMessage:"Przedmiot jest wymagany (3-100 znaków)"},courseTitle:{minLength:5,errorMessage:"Tytuł jest wymagany (5-200 znaków)"},description:{minLength:50,errorMessage:"Opis jest wymagany (50-1000 znaków)"},topicsPerWeek:{min:1,max:7,errorMessage:"Liczba tematów na tydzień musi być między 1 a 7"}},Qn={steps:{1:{title:"Jaki kurs chcesz stworzyć?",description:"Określ typ, przedmiot i poziom - AI stworzy kompletną strukturę kursu",button:"Analizuj wymagania",loading:"Analizuję wymagania..."},2:{title:"Analiza wymagań kursu",description:"AI przeanalizowała wymagania i zaproponowała parametry kursu",success:"✓ Analiza zakończona pomyślnie"},3:{title:"Dostosuj strukturę kursu",description:"Określ tempo nauki i dodatkowe elementy kursu",button:"Generuj strukturę",loading:"Generuję strukturę...",loadingInfo:"⚡ AI tworzy szczegółowy plan kursu z podziałem na tygodnie..."},4:{title:"Podgląd struktury kursu",description:"AI przygotowała kompletną strukturę z harmonogramem",info:"💡 Po zapisaniu będziesz mógł dodawać materiały do utworzonych tematów."},5:{title:"Tworzenie kursu",description:"Ostatnie poprawki przed utworzeniem kursu",saveInfo:"💾 Zostanie utworzony kurs z pełną strukturą tematów. Materiały i quizy możesz dodać później.",button:"Utwórz kurs",loading:"Tworzę kurs...",success:"✓ Kurs został utworzony pomyślnie! Przekierowuję..."}},dashboard:{title:"Generator struktury kursu",description:"Twórz kompletne kursy z pomocą AI",wizardTitle:"Generator kursów AI",wizardDescription:"Stwórz pełną strukturę kursu w 5 krokach",features:["Automatyczna analiza wymagań","Generowanie harmonogramu","Podział na tygodnie i tematy","Sugestie materiałów i quizów","Zgodność z podstawą programową","Progresja poziomu trudności"]},errors:{subjectRequired:"Podaj przedmiot kursu",analysisError:"Błąd analizy wymagań:",generationError:"Błąd generowania struktury:",saveError:"Wystąpił błąd podczas tworzenia kursu",unexpectedError:"Wystąpił nieoczekiwany błąd"}},ut={dashboard:"/teacher/course-structure",step1:"/teacher/course-structure/step1",step2:"/teacher/course-structure/step2",step3:"/teacher/course-structure/step3",step4:"/teacher/course-structure/step4",step5:"/teacher/course-structure/step5",courses:"/teacher/courses"},Ld={matura:{defaultTopics:["Wprowadzenie i powtórka","Podstawowe zagadnienia","Zagadnienia rozszerzone","Zadania typu maturalnego","Próbne egzaminy","Powtórka przedegzaminacyjna"],defaultQuizFrequency:"weekly",includeExercises:!0,includeQuizzes:!0},academic:{defaultQuizFrequency:"biweekly",includeExercises:!0,includeQuizzes:!0},professional:{defaultQuizFrequency:"chapter_end",includeExercises:!0,includeQuizzes:!0},hobby:{defaultQuizFrequency:"monthly",includeExercises:!0,includeQuizzes:!1},certification:{defaultQuizFrequency:"after_each",includeExercises:!0,includeQuizzes:!0}},fz=()=>{const e=Z(),{getData:s}=Pe(),n=s("course-structure-wizard"),{dashboard:i}=Qn,r=n&&n.courseTitle;return t.jsxs(q,{children:[t.jsx(ce,{title:i.title,description:i.description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-blue-50 p-6 rounded-lg border border-indigo-200",children:[t.jsxs(I,{variant:"start",className:"mb-4",children:[t.jsx("div",{className:"p-3 bg-indigo-100 rounded-lg",children:t.jsx(Hs,{className:"w-8 h-8 text-indigo-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:i.wizardTitle}),t.jsx("p",{className:"text-gray-600",children:i.wizardDescription})]})]}),t.jsxs(be,{variant:"1-2-2",className:"gap-4",children:[t.jsx("div",{className:"space-y-2",children:i.features.slice(0,3).map((a,o)=>t.jsxs(I,{variant:"start",className:"text-sm text-gray-700",children:[t.jsx(Ce,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),t.jsx("span",{children:a})]},o))}),t.jsx("div",{className:"space-y-2",children:i.features.slice(3).map((a,o)=>t.jsxs(I,{variant:"start",className:"text-sm text-gray-700",children:[t.jsx(Ce,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),t.jsx("span",{children:a})]},o))})]}),t.jsx("div",{className:"mt-6",children:t.jsxs(T,{onClick:()=>e(ut.step1),className:"w-full md:w-auto",size:"lg",children:[t.jsx(Un,{className:"w-4 h-4 mr-2"}),"Stwórz strukturę kursu"]})})]}),r&&t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsxs(I,{variant:"between-center",className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ostatnia struktura"}),t.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Wygenerowana"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Tytuł kursu"}),t.jsx("p",{className:"font-medium text-gray-900",children:n.courseTitle})]}),n.subject&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Przedmiot"}),t.jsx("p",{className:"text-gray-900",children:n.subject})]}),n.summary&&t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Liczba tygodni"}),t.jsx("p",{className:"text-gray-900 font-medium",children:n.summary.totalWeeks})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Liczba tematów"}),t.jsx("p",{className:"text-gray-900 font-medium",children:n.summary.totalTopics})]})]})]}),t.jsxs(I,{variant:"start",className:"mt-6 gap-3",children:[t.jsxs(T,{variant:"outline",onClick:()=>e(ut.step4),children:[t.jsx(qe,{className:"w-4 h-4 mr-2"}),"Podgląd"]}),t.jsxs(T,{variant:"outline",onClick:()=>e(ut.step3),children:[t.jsx(Al,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),t.jsxs(T,{variant:"outline",onClick:()=>e(ut.step1),children:[t.jsx(ja,{className:"w-4 h-4 mr-2"}),"Nowa struktura"]})]})]}),t.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Zarządzanie kursami"}),t.jsxs(be,{variant:"1-2-3",className:"gap-4",children:[t.jsxs("button",{onClick:()=>e("/teacher/courses"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(I,{variant:"start",className:"mb-2",children:[t.jsx(Me,{className:"w-5 h-5 text-blue-600"}),t.jsx("span",{className:"font-medium",children:"Kursy"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Zobacz wszystkie kursy"})]}),t.jsxs("button",{onClick:()=>e("/teacher/educational-material"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(I,{variant:"start",className:"mb-2",children:[t.jsx(As,{className:"w-5 h-5 text-purple-600"}),t.jsx("span",{className:"font-medium",children:"Materiały"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Kreator materiałów"})]}),t.jsxs("button",{onClick:()=>e("/teacher/quiz-wizard"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(I,{variant:"start",className:"mb-2",children:[t.jsx(Ps,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{className:"font-medium",children:"Quizy"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Kreator quizów"})]})]})]})]})]})},cr=({step:e})=>{const s=Z();return t.jsxs(t.Fragment,{children:[t.jsx(T,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>s("/teacher/course-structure"),children:t.jsx(xt,{className:"h-5 w-5"})}),t.jsxs("div",{className:"p-8 space-y-12 text-zinc-800",children:[t.jsx("h1",{className:"text-6xl font-black",children:"COURSEFORGE"}),t.jsxs("h2",{className:"text-4xl",children:["Zaprojektujmy ",t.jsx("br",{}),t.jsx("span",{className:"font-bold",children:"strukturę kursu"})]}),t.jsxs("p",{children:["Krok ",e," z 5"]})]}),t.jsx(Xt,{className:"my-8"})]})},dr=({title:e,description:s})=>t.jsxs("header",{className:"mb-8",children:[t.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:e}),t.jsx("p",{className:"text-gray-600",children:s})]}),xz=()=>{const e=Z(),{register:s,setData:n}=Pe(),[i,r]=x.useState(""),[a,o]=x.useState(""),[l,c]=x.useState(""),[d,m]=x.useState(""),[u,h]=x.useState({}),p=Wn("course-structure-wizard","analyze-course-requirements"),{steps:g,errors:f}=Qn;x.useEffect(()=>(s(mz),p.registerOperation(hz),()=>{p.unregisterOperation()}),[]);const y=()=>{const j={};return i||(j.courseType="Wybierz typ kursu"),(!a.trim()||a.length<jt.subject.minLength)&&(j.subject=jt.subject.errorMessage),l||(j.level="Wybierz poziom kursu"),d||(j.duration="Wybierz czas trwania"),h(j),Object.keys(j).length===0},b=async()=>{if(y())try{const j={courseType:i,subject:a.trim(),level:l,duration:d};n("course-structure-wizard",j),await p.executeOperation(j),e(ut.step2)}catch(j){console.error(f.analysisError,j)}};return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(cr,{step:1}),t.jsxs("div",{className:"p-6",children:[t.jsx(dr,{title:g[1].title,description:g[1].description}),p.error&&t.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:t.jsxs("span",{className:"text-red-800 text-sm",children:[f.analysisError," ",p.error]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(se,{htmlFor:"courseType",children:"Typ kursu"}),t.jsxs(ze,{value:i,onValueChange:r,disabled:p.loading,children:[t.jsx(ve,{className:u.courseType?"border-red-300":"",children:t.jsx(Se,{placeholder:"Wybierz typ kursu..."})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"matura",children:"Kurs maturalny"}),t.jsx(V,{value:"academic",children:"Kurs akademicki"}),t.jsx(V,{value:"professional",children:"Kurs zawodowy"}),t.jsx(V,{value:"hobby",children:"Kurs hobbystyczny"}),t.jsx(V,{value:"certification",children:"Kurs certyfikacyjny"})]})]}),u.courseType&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.courseType})]}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"subject",children:"Przedmiot/Dziedzina"}),t.jsx(B,{id:"subject",type:"text",value:a,onChange:j=>o(j.target.value),placeholder:"np. Matematyka, Programowanie Python, Język angielski",disabled:p.loading,className:u.subject?"border-red-300":""}),u.subject&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.subject})]}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"level",children:"Poziom kursu"}),t.jsxs(ze,{value:l,onValueChange:c,disabled:p.loading,children:[t.jsx(ve,{className:u.level?"border-red-300":"",children:t.jsx(Se,{placeholder:"Wybierz poziom..."})}),t.jsx(Ne,{children:i==="matura"?t.jsxs(t.Fragment,{children:[t.jsx(V,{value:"basic",children:"Podstawowy"}),t.jsx(V,{value:"extended",children:"Rozszerzony"})]}):t.jsxs(t.Fragment,{children:[t.jsx(V,{value:"beginner",children:"Początkujący"}),t.jsx(V,{value:"intermediate",children:"Średniozaawansowany"}),t.jsx(V,{value:"advanced",children:"Zaawansowany"})]})})]}),u.level&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.level})]}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"duration",children:"Planowany czas trwania"}),t.jsxs(ze,{value:d,onValueChange:m,disabled:p.loading,children:[t.jsx(ve,{className:u.duration?"border-red-300":"",children:t.jsx(Se,{placeholder:"Wybierz czas trwania..."})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"1month",children:"1 miesiąc"}),t.jsx(V,{value:"3months",children:"3 miesiące"}),t.jsx(V,{value:"6months",children:"6 miesięcy"}),t.jsx(V,{value:"1year",children:"1 rok"}),t.jsx(V,{value:"2years",children:"2 lata"})]})]}),u.duration&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.duration})]}),t.jsx("button",{onClick:b,disabled:p.loading,className:"w-full h-12 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white font-medium rounded-lg flex items-center justify-center gap-2",children:p.loading?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),g[1].loading]}):g[1].button})]})]})]})})},gz=()=>{const e=Z(),{getData:s}=Pe(),n=s("course-structure-wizard"),{steps:i}=Qn;return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(cr,{step:2}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(dr,{title:i[2].title,description:i[2].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:t.jsx("span",{className:"text-green-800 text-sm",children:i[2].success})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Proponowany tytuł"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:n.courseTitle})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opis kursu"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 whitespace-pre-wrap",children:n.description})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cele kursu"}),t.jsx("div",{className:"space-y-2",children:n.objectives?.map((r,a)=>t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsxs("span",{className:"text-indigo-600 font-medium",children:[a+1,"."]}),t.jsx("span",{className:"text-gray-800",children:r})]},a))})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Grupa docelowa"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800",children:n.targetAudience})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wymagania wstępne"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:n.prerequisites?.length>0?t.jsx("ul",{className:"list-disc list-inside space-y-1",children:n.prerequisites.map((r,a)=>t.jsx("li",{className:"text-gray-800 text-sm",children:r},a))}):t.jsx("span",{className:"text-gray-500 text-sm",children:"Brak wymagań wstępnych"})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Szacowana liczba godzin"}),t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[n.estimatedHours," godzin"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Liczba głównych tematów"}),t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[n.topicsCount," tematów"]})]})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(ut.step1),children:"Wstecz"}),t.jsx(T,{onClick:()=>e(ut.step3),children:"Kontynuuj"})]})]})]})]})})},yz=()=>{const e=Z(),{getData:s,setData:n}=Pe(),i=s("course-structure-wizard"),[r,a]=x.useState(i.courseTitle||""),[o,l]=x.useState(i.description||""),[c,d]=x.useState(2),[m,u]=x.useState(!0),[h,p]=x.useState(!0),[g,f]=x.useState("weekly"),[y,b]=x.useState({}),j=Wn("course-structure-wizard","generate-course-structure"),{steps:w,errors:S}=Qn;x.useEffect(()=>{if(j.registerOperation(pz),i.courseType&&i.courseType in Ld){const N=i.courseType,C=Ld[N];u(C.includeExercises),p(C.includeQuizzes),f(C.defaultQuizFrequency)}return()=>{j.unregisterOperation()}},[]);const k=()=>{const N={};return(!r.trim()||r.length<jt.courseTitle.minLength)&&(N.courseTitle=jt.courseTitle.errorMessage),(!o.trim()||o.length<jt.description.minLength)&&(N.description=jt.description.errorMessage),(!c||c<jt.topicsPerWeek.min||c>jt.topicsPerWeek.max)&&(N.topicsPerWeek=jt.topicsPerWeek.errorMessage),b(N),Object.keys(N).length===0},z=async()=>{if(k())try{const N={...i,courseTitle:r.trim(),description:o.trim(),topicsPerWeek:c,includeExercises:m,includeQuizzes:h,quizFrequency:g};n("course-structure-wizard",N),await j.executeOperation(N),e(ut.step4)}catch(N){console.error(S.generationError,N)}};return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(cr,{step:3}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(dr,{title:w[3].title,description:w[3].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"courseTitle",children:["Tytuł kursu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"courseTitle",value:r,onChange:N=>a(N.target.value),placeholder:"np. Matematyka - Przygotowanie do matury",className:`mt-1 ${y.courseTitle?"border-red-300":""}`}),y.courseTitle&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:y.courseTitle})]}),t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"description",children:["Opis kursu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(St,{id:"description",value:o,onChange:N=>l(N.target.value),placeholder:"Szczegółowy opis kursu...",rows:4,className:`mt-1 ${y.description?"border-red-300":""}`}),y.description&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:y.description}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[o.length," / ",jt.description.minLength," ","znaków minimum"]})]}),t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"topicsPerWeek",children:["Liczba tematów na tydzień"," ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"topicsPerWeek",type:"number",value:c,onChange:N=>d(parseInt(N.target.value)||0),min:jt.topicsPerWeek.min,max:jt.topicsPerWeek.max,className:`mt-1 ${y.topicsPerWeek?"border-red-300":""}`}),y.topicsPerWeek&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:y.topicsPerWeek}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Określa tempo realizacji kursu"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ht,{id:"includeExercises",checked:m,onCheckedChange:N=>u(N)}),t.jsx("label",{htmlFor:"includeExercises",className:"text-sm cursor-pointer",children:"Dodaj ćwiczenia do każdego tematu"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ht,{id:"includeQuizzes",checked:h,onCheckedChange:N=>p(N)}),t.jsx("label",{htmlFor:"includeQuizzes",className:"text-sm cursor-pointer",children:"Dodaj quizy sprawdzające"})]}),h&&t.jsxs("div",{className:"ml-6",children:[t.jsx(se,{htmlFor:"quizFrequency",children:"Częstotliwość quizów"}),t.jsxs(ze,{value:g,onValueChange:f,children:[t.jsx(ve,{className:"mt-1",children:t.jsx(Se,{})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"after_each",children:"Po każdym temacie"}),t.jsx(V,{value:"weekly",children:"Co tydzień"}),t.jsx(V,{value:"biweekly",children:"Co dwa tygodnie"}),t.jsx(V,{value:"monthly",children:"Co miesiąc"}),t.jsx(V,{value:"chapter_end",children:"Na koniec działu"})]})]})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(ut.step2),children:"Wstecz"}),t.jsx(T,{onClick:z,disabled:j.loading,children:j.loading?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),w[3].loading]}):w[3].button})]})]}),j.loading&&t.jsx("div",{className:"mt-6 p-4 bg-indigo-50 border border-indigo-200 rounded-lg",children:t.jsx("span",{className:"text-indigo-800 text-sm",children:w[3].loadingInfo})})]})]})})},jz=()=>{const e=Z(),{getData:s}=Pe(),n=s("course-structure-wizard"),{steps:i}=Qn,r=a=>{switch(a){case"material":return t.jsx(ft,{className:"w-4 h-4"});case"quiz":return t.jsx(st,{className:"w-4 h-4"});default:return t.jsx(Me,{className:"w-4 h-4"})}};return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(cr,{step:4}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(dr,{title:t.jsxs(t.Fragment,{children:[t.jsx(qe,{className:"w-8 h-8 text-zinc-500"}),t.jsx("span",{children:i[4].title})]}),description:i[4].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold mb-3",children:n.courseTitle}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:n.description}),n.summary&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:n.summary.totalWeeks}),t.jsx("div",{className:"text-gray-600",children:"tygodni"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.summary.totalTopics}),t.jsx("div",{className:"text-gray-600",children:"tematów"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.summary.totalActivities}),t.jsx("div",{className:"text-gray-600",children:"aktywności"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.summary.totalQuizzes}),t.jsx("div",{className:"text-gray-600",children:"quizów"})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"font-semibold text-lg",children:"Struktura kursu"}),n.structure?.map((a,o)=>t.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"bg-indigo-50 px-4 py-3 flex items-center gap-2",children:[t.jsx(Ps,{className:"w-5 h-5 text-indigo-600"}),t.jsxs("h5",{className:"font-medium",children:["Tydzień ",a.weekNumber]}),t.jsxs(ne,{variant:"secondary",className:"ml-auto",children:[a.topics.length," ",a.topics.length===1?"temat":"tematów"]})]}),t.jsx("div",{className:"p-4 space-y-3",children:a.topics.map((l,c)=>t.jsxs("div",{className:"border-l-4 border-indigo-200 pl-4",children:[t.jsx("h6",{className:"font-medium text-gray-900",children:l.title}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.description}),l.objectives&&l.objectives.length>0&&t.jsxs("div",{className:"mt-2 space-y-1",children:[t.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Cele:"}),t.jsx("ul",{className:"text-xs text-gray-600 list-disc list-inside",children:l.objectives.map((d,m)=>t.jsx("li",{children:d},m))})]}),l.activities&&l.activities.length>0&&t.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:l.activities.map((d,m)=>t.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-100 rounded text-xs",children:[r(d.type),t.jsx("span",{children:d.title}),d.duration&&t.jsxs("span",{className:"text-gray-500",children:["(",d.duration," min)"]})]},m))}),l.keywords&&l.keywords.length>0&&t.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:l.keywords.map((d,m)=>t.jsx(ne,{variant:"outline",className:"text-xs",children:d},m))})]},c))})]},o))]})]}),t.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:t.jsx("p",{className:"text-indigo-800 text-sm",children:i[4].info})}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(ut.step3),children:"Wstecz"}),t.jsx(T,{onClick:()=>e(ut.step5),children:"Utwórz kurs"})]})]})]})})},bz=()=>{const e=Z(),{getData:s,setData:n}=Pe(),{mutate:i}=cs(),{mutate:r}=cs(),{data:a}=Tt(),o=s("course-structure-wizard"),[l,c]=x.useState(o.courseTitle||""),[d,m]=x.useState("📚"),[u,h]=x.useState(!1),[p,g]=x.useState(!1),[f,y]=x.useState(!1),{steps:b,errors:j}=Qn,w=async()=>{if(!l.trim()){O.error("Nazwa kursu jest wymagana");return}if(!a?.vendor_id){O.error("Brak informacji o vendor_id. Skontaktuj się z administratorem.");return}g(!0),y(!1);try{i({resource:"courses",values:{vendor_id:a.vendor_id,title:l.trim(),description:o.description,icon_emoji:d,is_published:u}},{onSuccess:async k=>{const z=k.data.id;let N=1;try{for(const C of o.structure)for(const A of C.topics)await new Promise((v,P)=>{r({resource:"topics",values:{course_id:z,title:A.title,position:N++,is_published:!1}},{onSuccess:v,onError:P})});n("course-structure-wizard",{...o,courseName:l.trim(),courseId:z,saved:!0}),g(!1),y(!0),setTimeout(()=>{e(`${ut.courses}/show/${z}`)},2e3)}catch(C){g(!1),console.error("Błąd podczas tworzenia tematów:",C),O.error("Wystąpił błąd podczas tworzenia struktury kursu")}},onError:k=>{g(!1),console.error(j.saveError,k),k?.code==="42501"?O.error("Brak uprawnień do tworzenia kursów. Sprawdź swoje uprawnienia."):k?.code==="23505"?O.error("Kurs o takiej nazwie już istnieje."):O.error(j.saveError)}})}catch(k){g(!1),console.error(j.unexpectedError,k),O.error(j.unexpectedError)}},S=()=>{switch(o.courseType){case"matura":return"🎓";case"academic":return"🏛️";case"professional":return"💼";case"hobby":return"🎨";case"certification":return"📜";default:return"📚"}};return G.useEffect(()=>{m(S())},[o.courseType]),t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative",children:[t.jsx(cr,{step:5}),t.jsxs("div",{className:"p-8",children:[t.jsx(dr,{title:t.jsxs(t.Fragment,{children:[t.jsx(Hs,{className:"w-8 h-8 text-indigo-500"}),t.jsx("span",{children:b[5].title})]}),description:b[5].description}),f&&t.jsx(Es,{className:"mb-6 bg-green-50 border-green-200",children:t.jsx(Ds,{className:"text-green-800",children:b[5].success})}),t.jsxs("form",{className:"space-y-6",onSubmit:k=>{k.preventDefault(),w()},children:[t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"courseName",children:["Nazwa kursu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"courseName",type:"text",value:l,onChange:k=>c(k.target.value),placeholder:"np. Matematyka - Kurs maturalny poziom rozszerzony",className:"mt-1"})]}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"iconEmoji",children:"Emoji ikona"}),t.jsxs("div",{className:"flex gap-2 mt-1",children:[t.jsx(B,{id:"iconEmoji",type:"text",value:d,onChange:k=>m(k.target.value),placeholder:"np. 📚 📐 🎓",className:"flex-1",maxLength:5}),t.jsx("div",{className:"flex gap-1",children:["📚","🎓","📐","🏛️","💼","🎨","📜","🚀"].map(k=>t.jsx(T,{type:"button",variant:"outline",size:"sm",onClick:()=>m(k),className:"w-10 h-10",children:k},k))})]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Wybierz emoji z listy lub wpisz własne"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ht,{id:"isPublished",checked:u,onCheckedChange:k=>h(k)}),t.jsx("label",{htmlFor:"isPublished",className:"text-sm cursor-pointer",children:"Opublikuj kurs od razu (uczniowie będą mogli go zobaczyć)"})]}),t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-medium mb-3",children:"Co zostanie utworzone:"}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-600",children:"✓"}),t.jsxs("span",{children:['Kurs "',l||o.courseTitle,'" z pełnym opisem']})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-600",children:"✓"}),t.jsxs("span",{children:[o.summary?.totalTopics||0," tematów rozłożonych na ",o.summary?.totalWeeks||0," tygodni"]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-600",children:"✓"}),t.jsx("span",{children:"Struktura gotowa do wypełnienia materiałami i quizami"})]})]})]}),t.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:t.jsx("p",{className:"text-indigo-800 text-sm",children:b[5].saveInfo})}),t.jsx(Xt,{}),t.jsxs("footer",{className:"flex justify-between gap-4",children:[t.jsxs(T,{type:"button",variant:"outline",onClick:()=>e(ut.step4),disabled:p,className:"flex items-center gap-2",children:[t.jsx(je,{className:"w-4 h-4"}),"Wstecz"]}),t.jsx(T,{type:"submit",disabled:p||f,className:"flex items-center gap-2 min-w-[160px]",children:p?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),b[5].loading]}):t.jsxs(t.Fragment,{children:[t.jsx(nr,{className:"w-4 h-4"}),b[5].button]})})]})]})]})]})})},wz=[t.jsx(L,{path:"/course-structure",element:t.jsx(fz,{})},"course-dashboard"),t.jsx(L,{path:"/course-structure/step1",element:t.jsx(xz,{})},"course-step1"),t.jsx(L,{path:"/course-structure/step2",element:t.jsx(gz,{})},"course-step2"),t.jsx(L,{path:"/course-structure/step3",element:t.jsx(yz,{})},"course-step3"),t.jsx(L,{path:"/course-structure/step4",element:t.jsx(jz,{})},"course-step4"),t.jsx(L,{path:"/course-structure/step5",element:t.jsx(bz,{})},"course-step5")],Od={id:"educational-material-wizard",title:"Kreator materiałów edukacyjnych",schema:{step1:{title:"Podstawowe informacje",type:"object",properties:{subject:{type:"text",title:"Temat materiału",placeholder:"np. Wprowadzenie do programowania w Python"},targetLevel:{type:"select",title:"Poziom zaawansowania",options:[{value:"beginner",label:"Początkujący"},{value:"intermediate",label:"Średniozaawansowany"},{value:"advanced",label:"Zaawansowany"}]},ageGroup:{type:"select",title:"Grupa wiekowa",options:[{value:"7-10",label:"7-10 lat (szkoła podstawowa)"},{value:"11-14",label:"11-14 lat (klasy 4-8)"},{value:"15-18",label:"15-18 lat (szkoła średnia)"},{value:"18+",label:"18+ (dorośli)"}]}},required:["subject","targetLevel","ageGroup"]},step2:{title:"Analiza tematu",type:"object",properties:{keyTopics:{type:"tags",title:"Kluczowe zagadnienia",readOnly:!0},learningObjectives:{type:"textarea",title:"Cele nauczania",readOnly:!0},prerequisites:{type:"tags",title:"Wymagania wstępne",readOnly:!0},estimatedDuration:{type:"number",title:"Szacowany czas (min)",readOnly:!0}}},step3:{title:"Dostosowanie celów",type:"object",properties:{learningObjectives:{type:"textarea",title:"Cele nauczania (edytowalne)",placeholder:"Dostosuj cele nauczania...",rows:6},materialType:{type:"select",title:"Typ materiału",options:[{value:"lesson",label:"Lekcja z teorią"},{value:"exercise",label:"Ćwiczenia praktyczne"},{value:"mixed",label:"Teoria + ćwiczenia"}]}},required:["learningObjectives","materialType"]},step4:{title:"Podgląd materiału",type:"object",properties:{title:{type:"text",title:"Tytuł materiału",readOnly:!0},content:{type:"textarea",title:"Treść materiału",readOnly:!0},exercises:{type:"textarea",title:"Ćwiczenia",readOnly:!0},summary:{type:"textarea",title:"Podsumowanie",readOnly:!0}}},step5:{title:"Finalizacja",type:"object",properties:{courseId:{type:"select",title:"Wybierz kurs",placeholder:"Wybierz kurs..."},topicId:{type:"select",title:"Wybierz temat",placeholder:"Najpierw wybierz kurs..."},activityTitle:{type:"text",title:"Tytuł aktywności",placeholder:"np. Wprowadzenie do zmiennych"},activityType:{type:"select",title:"Typ aktywności",options:[{value:"material",label:"Materiał edukacyjny"},{value:"quiz",label:"Quiz sprawdzający"}]},content:{type:"textarea",title:"Treść materiału",placeholder:"Edytuj wygenerowaną treść...",rows:15},duration:{type:"number",title:"Czas trwania (min)",placeholder:"15"}},required:["courseId","topicId","activityTitle","activityType","content"]}}},vz={id:"analyze-topic",name:"Analiza tematu edukacyjnego",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od edukacji i tworzenia materiałów dydaktycznych.",user:`
Przeanalizuj temat edukacyjny:
Temat: {{subject}}
Poziom: {{targetLevel}}
Grupa wiekowa: {{ageGroup}}

Wygeneruj JSON:
{
  "keyTopics": ["temat1", "temat2", "temat3"],
  "learningObjectives": "<szczegółowe cele nauczania - czego uczeń się nauczy>",
  "prerequisites": ["wymaganie1", "wymaganie2"],
  "estimatedDuration": <liczba minut>
}

Wymagania:
- KeyTopics: 3-7 kluczowych zagadnień do omówienia
- LearningObjectives: konkretne, mierzalne cele (100-200 słów)
- Prerequisites: 2-5 wymagań wstępnych (może być puste dla początkujących)
- EstimatedDuration: realistyczny czas w minutach (15-90)
    `,responseFormat:"json"},inputMapping:e=>({subject:e.subject,targetLevel:e.targetLevel,ageGroup:e.ageGroup}),outputMapping:(e,s)=>({...s,keyTopics:e.keyTopics,learningObjectives:e.learningObjectives,prerequisites:e.prerequisites,estimatedDuration:e.estimatedDuration}),validation:e=>!!(e.keyTopics&&e.learningObjectives&&e.estimatedDuration)},Nz={id:"generate-material",name:"Generowanie materiału edukacyjnego",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś doświadczonym nauczycielem tworzącym angażujące materiały edukacyjne.",user:`
Stwórz materiał edukacyjny:

Temat: {{subject}}
Poziom: {{targetLevel}}
Grupa wiekowa: {{ageGroup}}
Cele nauczania: {{learningObjectives}}
Typ materiału: {{materialType}}
Kluczowe zagadnienia: {{keyTopics}}

Wygeneruj JSON:
{
  "title": "<atrakcyjny tytuł materiału>",
  "content": "<treść materiału w formacie Markdown - teoria, przykłady, wyjaśnienia>",
  "exercises": "<ćwiczenia praktyczne w formacie Markdown>",
  "summary": "<podsumowanie najważniejszych punktów>"
}

Wymagania:
- Title: kreatywny i zachęcający do nauki
- Content: dostosowany do wieku, z przykładami, min. 500 słów
- Exercises: 3-5 ćwiczeń praktycznych z instrukcjami
- Summary: bullet points z najważniejszymi informacjami
- Używaj formatowania Markdown (nagłówki, listy, kod)
- Język dostosowany do grupy wiekowej
    `,responseFormat:"json"},inputMapping:e=>({subject:e.subject,targetLevel:e.targetLevel,ageGroup:e.ageGroup,learningObjectives:e.learningObjectives,materialType:e.materialType,keyTopics:Array.isArray(e.keyTopics)?e.keyTopics.join(", "):e.keyTopics}),outputMapping:(e,s)=>({...s,title:e.title,content:e.content,exercises:e.exercises,summary:e.summary}),validation:e=>!!(e.title&&e.content&&e.exercises&&e.summary)},lt={subject:{minLength:5,errorMessage:"Temat jest wymagany (5-200 znaków)"},activityTitle:{minLength:3,maxLength:100,errorMessage:"Tytuł jest wymagany (3-100 znaków)"},content:{minLength:100,errorMessage:"Treść materiału jest wymagana (min. 100 znaków)"},duration:{min:5,max:180,errorMessage:"Czas trwania musi być między 5 a 180 minut"}},Yn={steps:{1:{title:"O czym chcesz stworzyć materiał?",description:"Podaj temat, poziom zaawansowania i grupę docelową - AI pomoże stworzyć angażujący materiał edukacyjny",button:"Analizuj temat",loading:"Analizuję temat..."},2:{title:"Analiza tematu",description:"AI przeanalizowała temat i zaproponowała strukturę materiału",success:"✓ Analiza zakończona pomyślnie"},3:{title:"Dostosuj cele i typ materiału",description:"Możesz zmodyfikować cele nauczania i wybrać typ materiału do wygenerowania",button:"Generuj materiał",loading:"Generuję materiał...",loadingInfo:"⚡ AI tworzy spersonalizowany materiał edukacyjny..."},4:{title:"Podgląd wygenerowanego materiału",description:"AI przygotowała kompletny materiał edukacyjny",info:"💡 W następnym kroku wybierzesz kurs i temat, do którego dodasz materiał."},5:{title:"Zapisz materiał w kursie",description:"Wybierz kurs i temat, następnie dostosuj materiał przed zapisaniem",saveInfo:"💾 Materiał zostanie zapisany jako nowa aktywność w wybranym temacie",button:"Zapisz materiał",loading:"Zapisuję...",success:"✓ Materiał został zapisany pomyślnie! Przekierowuję do kursu..."}},dashboard:{title:"Kreator materiałów edukacyjnych",description:"Twórz angażujące materiały z pomocą AI",wizardTitle:"Kreator materiałów AI",wizardDescription:"Stwórz materiał edukacyjny w 5 prostych krokach",features:["Automatyczna analiza tematu","Dostosowanie do wieku uczniów","Generowanie celów nauczania","Tworzenie ćwiczeń praktycznych","Formatowanie Markdown","Integracja z kursami"]},errors:{subjectRequired:"Podaj temat materiału",analysisError:"Błąd analizy tematu:",generationError:"Błąd generowania materiału:",saveError:"Wystąpił błąd podczas zapisu",unexpectedError:"Wystąpił nieoczekiwany błąd",noCourses:"Nie znaleziono żadnych kursów",noTopics:"Wybierz najpierw kurs"}},mt={dashboard:"/teacher/educational-material",step1:"/teacher/educational-material/step1",step2:"/teacher/educational-material/step2",step3:"/teacher/educational-material/step3",step4:"/teacher/educational-material/step4",step5:"/teacher/educational-material/step5",courses:"/courses"},kz=()=>{const e=Z(),{getData:s}=Pe(),n=s("educational-material-wizard"),{dashboard:i}=Yn,r=n&&n.title;return t.jsxs(q,{children:[t.jsx(ce,{title:i.title,description:i.description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg border border-purple-200",children:[t.jsxs(I,{variant:"start",className:"mb-4",children:[t.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:t.jsx(ks,{className:"w-8 h-8 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:i.wizardTitle}),t.jsx("p",{className:"text-gray-600",children:i.wizardDescription})]})]}),t.jsxs(be,{variant:"1-2-2",className:"gap-4",children:[t.jsx("div",{className:"space-y-2",children:i.features.slice(0,3).map((a,o)=>t.jsxs(I,{variant:"start",className:"text-sm text-gray-700",children:[t.jsx(Ce,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),t.jsx("span",{children:a})]},o))}),t.jsx("div",{className:"space-y-2",children:i.features.slice(3).map((a,o)=>t.jsxs(I,{variant:"start",className:"text-sm text-gray-700",children:[t.jsx(Ce,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),t.jsx("span",{children:a})]},o))})]}),t.jsx("div",{className:"mt-6",children:t.jsxs(T,{onClick:()=>e(mt.step1),className:"w-full md:w-auto",size:"lg",children:[t.jsx(Un,{className:"w-4 h-4 mr-2"}),"Stwórz nowy materiał"]})})]}),r&&t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsxs(I,{variant:"between-center",className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ostatni materiał"}),t.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Zapisany"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Tytuł materiału"}),t.jsx("p",{className:"font-medium text-gray-900",children:n.title})]}),n.subject&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Temat"}),t.jsx("p",{className:"text-gray-900",children:n.subject})]}),n.targetLevel&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Poziom"}),t.jsx("p",{className:"text-gray-900",children:n.targetLevel==="beginner"?"Początkujący":n.targetLevel==="intermediate"?"Średniozaawansowany":"Zaawansowany"})]})]}),t.jsxs(I,{variant:"start",className:"mt-6 gap-3",children:[t.jsxs(T,{variant:"outline",onClick:()=>e(mt.step4),children:[t.jsx(qe,{className:"w-4 h-4 mr-2"}),"Podgląd"]}),t.jsxs(T,{variant:"outline",onClick:()=>e(mt.step5),children:[t.jsx(Al,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),t.jsxs(T,{variant:"outline",onClick:()=>e(mt.step1),children:[t.jsx(ja,{className:"w-4 h-4 mr-2"}),"Nowy materiał"]})]})]}),t.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Zarządzanie kursami"}),t.jsxs(be,{variant:"1-2-3",className:"gap-4",children:[t.jsxs("button",{onClick:()=>e("/teacher/courses"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(I,{variant:"start",className:"mb-2",children:[t.jsx(Me,{className:"w-5 h-5 text-blue-600"}),t.jsx("span",{className:"font-medium",children:"Kursy"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Zobacz wszystkie kursy"})]}),t.jsxs("button",{onClick:()=>e("/teacher/topics"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(I,{variant:"start",className:"mb-2",children:[t.jsx(ft,{className:"w-5 h-5 text-purple-600"}),t.jsx("span",{className:"font-medium",children:"Tematy"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Zarządzaj tematami kursów"})]}),t.jsxs("button",{onClick:()=>e("/teacher/activities"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(I,{variant:"start",className:"mb-2",children:[t.jsx(As,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{className:"font-medium",children:"Aktywności"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Materiały i quizy"})]})]})]})]})]})},ur=({step:e})=>{const s=Z();return t.jsxs(t.Fragment,{children:[t.jsx(T,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>s("/educational-material"),children:t.jsx(xt,{className:"h-5 w-5"})}),t.jsxs("div",{className:"p-8 space-y-12 text-zinc-800",children:[t.jsx("h1",{className:"text-6xl font-black",children:"SMART UP"}),t.jsxs("h2",{className:"text-4xl",children:["Stwórzmy razem ",t.jsx("br",{}),t.jsx("span",{className:"font-bold",children:"angażujący materiał"})]}),t.jsxs("p",{children:["Krok ",e," z 5"]})]}),t.jsx(Xt,{className:"my-8"})]})},mr=({title:e,description:s})=>t.jsxs("header",{className:"mb-8",children:[t.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:e}),t.jsx("p",{className:"text-gray-600",children:s})]}),zz=()=>{const e=Z(),{register:s,setData:n,getData:i}=Pe(),r=i("educational-material-wizard"),[a,o]=x.useState(""),[l,c]=x.useState(""),[d,m]=x.useState(""),[u,h]=x.useState(""),[p,g]=x.useState(""),[f,y]=x.useState({}),[b,j]=x.useState(null),[w,S]=x.useState(!1),k=Wn("educational-material-wizard","analyze-topic"),{steps:z,errors:N}=Yn,{data:C,isLoading:A}=Ae({resource:"courses",meta:{select:"*, topics(*)"},sorters:[{field:"created_at",order:"desc"}]}),v=C?.data?.find(E=>E.id.toString()===a),P=v?.topics||[];x.useEffect(()=>(s(Od),k.registerOperation(vz),()=>{k.unregisterOperation()}),[]),x.useEffect(()=>{if(!w&&C?.data){let E="",X="",Be="";const Q=sessionStorage.getItem("wizardContext");if(Q)try{const J=JSON.parse(Q);j(J),J.courseId&&(E=J.courseId.toString()),J.topicId&&(X=J.topicId.toString()),J.topicTitle&&(Be=J.topicTitle)}catch(J){console.error("Error parsing wizard context:",J)}!E&&r&&(r.courseId&&(E=r.courseId.toString()),r.topicId&&(X=r.topicId.toString()),r.subject&&(Be=r.subject),r.targetLevel&&h(r.targetLevel),r.ageGroup&&g(r.ageGroup)),E&&o(E),X&&c(X),Be&&m(Be),S(!0)}},[C,w,r]),x.useEffect(()=>{if(l&&P.length>0){const E=P.find(X=>X.id.toString()===l);E&&m(E.title)}},[l,P]);const D=()=>{const E={};return a||(E.courseId="Wybierz kurs"),l||(E.topicId="Wybierz temat z kursu"),(!d.trim()||d.length<lt.subject.minLength)&&(E.subject=lt.subject.errorMessage),u||(E.targetLevel="Wybierz poziom zaawansowania"),p||(E.ageGroup="Wybierz grupę wiekową"),y(E),Object.keys(E).length===0},_=async()=>{if(D())try{const E={courseId:parseInt(a),topicId:parseInt(l),subject:d.trim(),targetLevel:u,ageGroup:p,courseTitle:v?.title,topicTitle:P.find(X=>X.id.toString()===l)?.title};n("educational-material-wizard",E),await k.executeOperation(E),e(mt.step2)}catch(E){console.error(N.analysisError,E)}};return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(ur,{step:1}),t.jsxs("div",{className:"p-6",children:[t.jsx(mr,{title:z[1].title,description:z[1].description}),b&&t.jsxs(Es,{className:"mb-4",children:[t.jsx(Ym,{className:"h-4 w-4"}),t.jsxs(Ds,{children:["Tworzysz materiał dla: ",t.jsx("strong",{children:b.courseTitle}),b.topicTitle&&t.jsxs(t.Fragment,{children:[" → ",t.jsx("strong",{children:b.topicTitle})]})]})]}),k.error&&t.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:t.jsxs("span",{className:"text-red-800 text-sm",children:[N.analysisError," ",k.error]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(R,{className:"border-2 border-purple-200 bg-purple-50/50",children:t.jsxs(F,{className:"pt-6",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(Me,{className:"w-5 h-5 text-purple-600"}),t.jsx("h3",{className:"font-semibold",children:"Wybierz miejsce w kursie"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"courseId",children:["Kurs ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs(ze,{value:a,onValueChange:E=>{o(E),c(""),m("")},disabled:k.loading||A,children:[t.jsx(ve,{className:f.courseId?"border-red-300":"",children:t.jsx(Se,{placeholder:"Wybierz kurs..."})}),t.jsx(Ne,{children:C?.data?.map(E=>t.jsx(V,{value:E.id.toString(),children:t.jsxs("div",{className:"flex items-center gap-2",children:[E.icon_emoji&&t.jsx("span",{children:E.icon_emoji}),t.jsx("span",{children:E.title}),!E.is_published&&t.jsx("span",{className:"text-xs text-muted-foreground",children:"(szkic)"})]})},E.id))})]}),f.courseId&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.courseId})]}),t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"topicId",children:["Temat ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs(ze,{value:l,onValueChange:c,disabled:!a||k.loading,children:[t.jsx(ve,{className:f.topicId?"border-red-300":"",children:t.jsx(Se,{placeholder:a?"Wybierz temat...":"Najpierw wybierz kurs..."})}),t.jsx(Ne,{children:P.sort((E,X)=>E.position-X.position).map(E=>t.jsx(V,{value:E.id.toString(),children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{children:[E.position,". ",E.title]}),E.is_published===!1&&t.jsx("span",{className:"text-xs text-muted-foreground",children:"(szkic)"})]})},E.id))})]}),f.topicId&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.topicId})]})]})]})}),t.jsx(Xt,{}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"subject",children:"Temat materiału"}),t.jsx(B,{id:"subject",type:"text",value:d,onChange:E=>m(E.target.value),placeholder:Od.schema.step1.properties.subject.placeholder,disabled:k.loading,className:f.subject?"border-red-300":""}),f.subject&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.subject}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Możesz dostosować temat materiału lub pozostawić sugerowany"})]}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"targetLevel",children:"Poziom zaawansowania"}),t.jsxs(ze,{value:u,onValueChange:h,disabled:k.loading,children:[t.jsx(ve,{className:f.targetLevel?"border-red-300":"",children:t.jsx(Se,{placeholder:"Wybierz poziom..."})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"beginner",children:"Początkujący"}),t.jsx(V,{value:"intermediate",children:"Średniozaawansowany"}),t.jsx(V,{value:"advanced",children:"Zaawansowany"})]})]}),f.targetLevel&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.targetLevel})]}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"ageGroup",children:"Grupa wiekowa"}),t.jsxs(ze,{value:p,onValueChange:g,disabled:k.loading,children:[t.jsx(ve,{className:f.ageGroup?"border-red-300":"",children:t.jsx(Se,{placeholder:"Wybierz grupę wiekową..."})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"7-10",children:"7-10 lat (szkoła podstawowa)"}),t.jsx(V,{value:"11-14",children:"11-14 lat (klasy 4-8)"}),t.jsx(V,{value:"15-18",children:"15-18 lat (szkoła średnia)"}),t.jsx(V,{value:"18+",children:"18+ (dorośli)"})]})]}),f.ageGroup&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.ageGroup})]}),t.jsx("button",{onClick:_,disabled:k.loading,className:"w-full h-12 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 text-white font-medium rounded-lg flex items-center justify-center gap-2",children:k.loading?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),z[1].loading]}):z[1].button})]})]})]})})},Sz=()=>{const e=Z(),{getData:s}=Pe(),n=s("educational-material-wizard"),{steps:i}=Yn;return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(ur,{step:2}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(mr,{title:i[2].title,description:i[2].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:t.jsx("span",{className:"text-green-800 text-sm",children:i[2].success})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Temat"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800",children:n.subject})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kluczowe zagadnienia"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:n.keyTopics?.map((r,a)=>t.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm",children:r},a))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cele nauczania"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 whitespace-pre-wrap",children:n.learningObjectives})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wymagania wstępne"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:n.prerequisites?.length>0?n.prerequisites.map((r,a)=>t.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:r},a)):t.jsx("span",{className:"text-gray-500 text-sm",children:"Brak wymagań wstępnych"})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Szacowany czas"}),t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[n.estimatedDuration," minut"]})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(mt.step1),children:"Wstecz"}),t.jsx(T,{onClick:()=>e(mt.step3),children:"Kontynuuj"})]})]})]})]})})},Cz=()=>{const e=Z(),{getData:s,setData:n}=Pe(),i=s("educational-material-wizard"),[r,a]=x.useState(i.learningObjectives||""),[o,l]=x.useState("mixed"),c=Wn("educational-material-wizard","generate-material"),{steps:d,errors:m}=Yn;x.useEffect(()=>(c.registerOperation(Nz),()=>{c.unregisterOperation()}),[]);const u=async()=>{if(!(!r.trim()||!o))try{const h={...i,learningObjectives:r.trim(),materialType:o};n("educational-material-wizard",h),await c.executeOperation(h),e(mt.step4)}catch(h){console.error(m.generationError,h)}};return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(ur,{step:3}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(mr,{title:d[3].title,description:d[3].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx(se,{htmlFor:"learningObjectives",children:"Cele nauczania"}),t.jsx(St,{id:"learningObjectives",value:r,onChange:h=>a(h.target.value),placeholder:"Dostosuj cele nauczania...",rows:6,className:"mt-1"}),t.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Możesz edytować automatycznie wygenerowane cele"})]}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"materialType",children:"Typ materiału"}),t.jsxs(ze,{value:o,onValueChange:l,children:[t.jsx(ve,{className:"mt-1",children:t.jsx(Se,{placeholder:"Wybierz typ materiału..."})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"lesson",children:"Lekcja z teorią"}),t.jsx(V,{value:"exercise",children:"Ćwiczenia praktyczne"}),t.jsx(V,{value:"mixed",children:"Teoria + ćwiczenia"})]})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(mt.step2),children:"Wstecz"}),t.jsx(T,{onClick:u,disabled:c.loading||!r.trim(),children:c.loading?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),d[3].loading]}):d[3].button})]})]}),c.loading&&t.jsx("div",{className:"mt-6 p-4 bg-purple-50 border border-purple-200 rounded-lg",children:t.jsx("span",{className:"text-purple-800 text-sm",children:d[3].loadingInfo})})]})]})})},Tz=()=>{const e=Z(),{getData:s}=Pe(),n=s("educational-material-wizard"),{steps:i}=Yn;return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(ur,{step:4}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(mr,{title:t.jsxs(t.Fragment,{children:[t.jsx(qe,{className:"w-8 h-8 text-zinc-500"}),t.jsx("span",{children:i[4].title})]}),description:i[4].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tytuł materiału"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:n.title})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Treść materiału"}),t.jsx("div",{className:"p-4 bg-gray-50 rounded-lg max-h-96 overflow-y-auto",children:t.jsx("div",{className:"prose prose-sm max-w-none",children:t.jsx(Cn,{children:n.content})})})]}),n.exercises&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ćwiczenia"}),t.jsx("div",{className:"p-4 bg-gray-50 rounded-lg max-h-64 overflow-y-auto",children:t.jsx("div",{className:"prose prose-sm max-w-none",children:t.jsx(Cn,{children:n.exercises})})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Podsumowanie"}),t.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:t.jsx("div",{className:"prose prose-sm max-w-none",children:t.jsx(Cn,{children:n.summary})})})]})]}),t.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:t.jsx("p",{className:"text-purple-800 text-sm",children:i[4].info})}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(mt.step3),children:"Wstecz"}),t.jsx(T,{onClick:()=>e(mt.step5),children:"Zapisz w kursie"})]})]})]})})},Az=()=>{const e=Z(),{getData:s,setData:n}=Pe(),{mutate:i}=cs(),r=s("educational-material-wizard"),[a,o]=x.useState(r.title||""),[l,c]=x.useState(r.content+(r.exercises?`

## Ćwiczenia

${r.exercises}`:"")+(r.summary?`

## Podsumowanie

${r.summary}`:"")),[d,m]=x.useState(r.estimatedDuration||30),[u,h]=x.useState({}),[p,g]=x.useState(!1),[f,y]=x.useState(!1),{steps:b,errors:j}=Yn,{data:w}=Ae({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:r.topicId}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!r.topicId}}),S=w?.data?.[0]?.position?w.data[0].position+1:1,k=()=>{const N={};return(!a.trim()||a.length<lt.activityTitle.minLength)&&(N.activityTitle=lt.activityTitle.errorMessage),(!l.trim()||l.length<lt.content.minLength)&&(N.content=lt.content.errorMessage),(!d||d<lt.duration.min||d>lt.duration.max)&&(N.duration=lt.duration.errorMessage),h(N),Object.keys(N).length===0},z=async()=>{if(k()){g(!0);try{i({resource:"activities",values:{topic_id:r.topicId,type:"material",title:a.trim(),content:l.trim(),position:S,duration_min:d,is_published:!1}},{onSuccess:N=>{n("educational-material-wizard",{...r,activityTitle:a.trim(),content:l.trim(),activityId:N.data.id,saved:!0}),g(!1),y(!0);const C=sessionStorage.getItem("returnUrl");setTimeout(()=>{sessionStorage.removeItem("wizardContext"),C?(sessionStorage.removeItem("returnUrl"),e(C)):e(`${mt.courses}/show/${r.courseId}?expanded=${r.topicId}`)},2e3)},onError:N=>{g(!1),console.error(j.saveError,N),alert(j.saveError)}})}catch(N){g(!1),console.error(j.unexpectedError,N),alert(j.unexpectedError)}}};return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative",children:[t.jsx(ur,{step:5}),t.jsxs("div",{className:"p-8",children:[t.jsx(mr,{title:t.jsxs(t.Fragment,{children:[t.jsx(ft,{className:"w-8 h-8 text-purple-500"}),t.jsx("span",{children:b[5].title})]}),description:b[5].description}),f&&t.jsx(Es,{className:"mb-6 bg-green-50 border-green-200",children:t.jsx(Ds,{className:"text-green-800",children:b[5].success})}),t.jsxs("form",{className:"space-y-6",onSubmit:N=>{N.preventDefault(),z()},children:[t.jsx(R,{className:"bg-muted/50",children:t.jsx(F,{className:"pt-6",children:t.jsxs("div",{className:"text-sm space-y-1",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Kurs:"})," ",r.courseTitle]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Temat:"})," ",r.topicTitle]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Pozycja:"})," ",S]})]})})}),t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"activityTitle",children:["Tytuł aktywności ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"activityTitle",type:"text",value:a,onChange:N=>o(N.target.value),placeholder:"np. Wprowadzenie do zmiennych",maxLength:lt.activityTitle.maxLength,className:u.activityTitle?"border-red-300":""}),u.activityTitle&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.activityTitle})]}),t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"duration",children:["Czas trwania (min) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"duration",type:"number",value:d,onChange:N=>m(parseInt(N.target.value)||0),min:lt.duration.min,max:lt.duration.max,className:u.duration?"border-red-300":""}),u.duration&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.duration})]}),t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"content",children:["Treść materiału ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(St,{id:"content",value:l,onChange:N=>c(N.target.value),placeholder:"Treść materiału w formacie Markdown...",rows:15,className:`font-mono text-sm ${u.content?"border-red-300":""}`}),u.content&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.content}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[l.length," znaków (minimum ",lt.content.minLength,")"]})]}),t.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:t.jsx("p",{className:"text-purple-800 text-sm",children:b[5].saveInfo})}),t.jsx(Xt,{}),t.jsxs("footer",{className:"flex justify-between gap-4",children:[t.jsxs(T,{type:"button",variant:"outline",onClick:()=>e(mt.step4),disabled:p,className:"flex items-center gap-2",children:[t.jsx(je,{className:"w-4 h-4"}),"Wstecz"]}),t.jsx(T,{type:"submit",disabled:p||f,className:"flex items-center gap-2 min-w-[160px]",children:p?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),b[5].loading]}):t.jsxs(t.Fragment,{children:[t.jsx(nr,{className:"w-4 h-4"}),b[5].button]})})]})]})]})]})})},Pz=[t.jsx(L,{path:"/educational-material",element:t.jsx(kz,{})},"material-dashboard"),t.jsx(L,{path:"/educational-material/step1",element:t.jsx(zz,{})},"material-step1"),t.jsx(L,{path:"/educational-material/step2",element:t.jsx(Sz,{})},"material-step2"),t.jsx(L,{path:"/educational-material/step3",element:t.jsx(Cz,{})},"material-step3"),t.jsx(L,{path:"/educational-material/step4",element:t.jsx(Tz,{})},"material-step4"),t.jsx(L,{path:"/educational-material/step5",element:t.jsx(Az,{})},"material-step5")],Rd={id:"quiz-wizard",title:"Kreator quizów",schema:{step1:{title:"Podstawowe informacje o quizie",type:"object",properties:{topic:{type:"text",title:"Temat quizu",placeholder:"np. Podstawy programowania w Python"},difficulty:{type:"select",title:"Poziom trudności",options:[{value:"easy",label:"Łatwy"},{value:"medium",label:"Średni"},{value:"hard",label:"Trudny"}]},questionsCount:{type:"number",title:"Liczba pytań",placeholder:"10",min:5,max:30},questionTypes:{type:"multiselect",title:"Typy pytań",options:[{value:"single",label:"Jednokrotny wybór"},{value:"multiple",label:"Wielokrotny wybór"},{value:"truefalse",label:"Prawda/Fałsz"}]}},required:["topic","difficulty","questionsCount"]},step2:{title:"Analiza tematu",type:"object",properties:{keyTopics:{type:"tags",title:"Kluczowe zagadnienia",readOnly:!0},learningObjectives:{type:"textarea",title:"Cele sprawdzające",readOnly:!0},suggestedTime:{type:"number",title:"Sugerowany czas (min)",readOnly:!0},passingScore:{type:"number",title:"Próg zaliczenia (%)",readOnly:!0}}},step3:{title:"Parametry quizu",type:"object",properties:{quizTitle:{type:"text",title:"Tytuł quizu",placeholder:"np. Test wiedzy - Zmienne i typy danych"},passingScore:{type:"number",title:"Próg zaliczenia (%)",placeholder:"70",min:50,max:100},timeLimit:{type:"number",title:"Limit czasu (min)",placeholder:"Pozostaw puste dla braku limitu",min:5,max:180},maxAttempts:{type:"number",title:"Maksymalna liczba podejść",placeholder:"Pozostaw puste dla nieograniczonej liczby",min:1,max:10},shuffleQuestions:{type:"checkbox",title:"Losowa kolejność pytań"},showExplanations:{type:"checkbox",title:"Pokazuj wyjaśnienia po odpowiedzi"}},required:["quizTitle","passingScore"]},step4:{title:"Podgląd wygenerowanych pytań",type:"object",properties:{questions:{type:"array",title:"Lista pytań",readOnly:!0}}},step5:{title:"Finalizacja i zapis",type:"object",properties:{courseId:{type:"select",title:"Wybierz kurs",placeholder:"Wybierz kurs..."},topicId:{type:"select",title:"Wybierz temat",placeholder:"Najpierw wybierz kurs..."},finalTitle:{type:"text",title:"Ostateczny tytuł",placeholder:"Tytuł quizu"},questions:{type:"array",title:"Pytania do edycji"}},required:["courseId","topicId","finalTitle"]}}},Ez={id:"analyze-quiz-topic",name:"Analiza tematu quizu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia testów i quizów edukacyjnych.",user:`
Przeanalizuj temat dla quizu:
Temat: {{topic}}
Poziom trudności: {{difficulty}}
Liczba pytań: {{questionsCount}}

Wygeneruj JSON:
{
  "keyTopics": ["zagadnienie1", "zagadnienie2", "zagadnienie3"],
  "learningObjectives": "<cele sprawdzające - co quiz ma zweryfikować>",
  "suggestedTime": <liczba minut>,
  "passingScore": <próg zaliczenia w %>
}

Wymagania:
- KeyTopics: 5-10 kluczowych zagadnień do sprawdzenia
- LearningObjectives: konkretne umiejętności do weryfikacji (50-150 słów)
- SuggestedTime: 1-3 minuty na pytanie
- PassingScore: 60-80% w zależności od trudności
    `,responseFormat:"json"},inputMapping:e=>({topic:e.topic,difficulty:e.difficulty,questionsCount:e.questionsCount}),outputMapping:(e,s)=>({...s,keyTopics:e.keyTopics,learningObjectives:e.learningObjectives,suggestedTime:e.suggestedTime,passingScore:e.passingScore}),validation:e=>!!(e.keyTopics&&e.learningObjectives&&e.suggestedTime&&e.passingScore)},Dz={id:"generate-quiz-questions",name:"Generowanie pytań quizowych",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia pytań testowych. Tworzysz rzetelne, dobrze sformułowane pytania sprawdzające wiedzę.",user:`
Stwórz pytania quizowe:

Temat: {{topic}}
Poziom trudności: {{difficulty}}
Liczba pytań: {{questionsCount}}
Typy pytań: {{questionTypes}}
Kluczowe zagadnienia: {{keyTopics}}
Cele: {{learningObjectives}}

Wygeneruj JSON z tablicą pytań:
{
  "quizTitle": "<tytuł quizu>",
  "questions": [
    {
      "question": "<treść pytania>",
      "type": "single|multiple|truefalse",
      "options": [
        {"text": "<treść opcji>", "is_correct": true/false},
        {"text": "<treść opcji>", "is_correct": true/false}
      ],
      "explanation": "<wyjaśnienie poprawnej odpowiedzi>",
      "points": <liczba punktów 1-5>
    }
  ]
}

Wymagania:
- Pytania jasne i jednoznaczne
- 4 opcje dla single/multiple, 2 dla true/false
- Dokładnie jedna poprawna dla single, 1-3 dla multiple
- Wyjaśnienia edukacyjne (30-100 słów)
- Punkty: łatwe=1-2, średnie=2-3, trudne=3-5
- Różnorodność typów pytań
- Pokrycie wszystkich kluczowych zagadnień
    `,responseFormat:"json"},inputMapping:e=>({topic:e.topic,difficulty:e.difficulty,questionsCount:e.questionsCount,questionTypes:Array.isArray(e.questionTypes)?e.questionTypes.join(", "):e.questionTypes||"single, multiple, truefalse",keyTopics:Array.isArray(e.keyTopics)?e.keyTopics.join(", "):e.keyTopics,learningObjectives:e.learningObjectives}),outputMapping:(e,s)=>({...s,quizTitle:e.quizTitle,questions:e.questions}),validation:e=>!!(e.quizTitle&&e.questions&&Array.isArray(e.questions)&&e.questions.length>0)},re={topic:{minLength:5,errorMessage:"Temat jest wymagany (5-200 znaków)"},quizTitle:{minLength:5,maxLength:100,errorMessage:"Tytuł jest wymagany (5-100 znaków)"},questionsCount:{min:5,max:30,errorMessage:"Liczba pytań musi być między 5 a 30"},passingScore:{min:50,max:100,errorMessage:"Próg zaliczenia musi być między 50% a 100%"},timeLimit:{min:5,max:180,errorMessage:"Limit czasu musi być między 5 a 180 minut"},maxAttempts:{min:1,max:10,errorMessage:"Liczba podejść musi być między 1 a 10"}},Zn={steps:{1:{title:"Jaki quiz chcesz stworzyć?",description:"Podaj temat, poziom trudności i liczbę pytań - AI wygeneruje profesjonalny quiz",button:"Analizuj temat",loading:"Analizuję temat..."},2:{title:"Analiza tematu quizu",description:"AI przeanalizowała temat i zaproponowała parametry quizu",success:"✓ Analiza zakończona pomyślnie"},3:{title:"Skonfiguruj parametry quizu",description:"Dostosuj ustawienia quizu według swoich potrzeb",button:"Generuj pytania",loading:"Generuję pytania...",loadingInfo:"⚡ AI tworzy zestaw pytań dostosowanych do tematu..."},4:{title:"Podgląd wygenerowanych pytań",description:"AI przygotowała kompletny zestaw pytań",info:"💡 W następnym kroku będziesz mógł edytować pytania i wybrać kurs."},5:{title:"Zapisz quiz w kursie",description:"Wybierz kurs i temat, sprawdź pytania przed zapisaniem",saveInfo:"💾 Quiz zostanie zapisany jako nowa aktywność z wygenerowanymi pytaniami",button:"Zapisz quiz",loading:"Zapisuję...",success:"✓ Quiz został zapisany pomyślnie! Przekierowuję do zarządzania pytaniami..."}},dashboard:{title:"Kreator quizów",description:"Twórz profesjonalne testy sprawdzające z pomocą AI",wizardTitle:"Kreator quizów AI",wizardDescription:"Stwórz quiz w 5 prostych krokach",features:["Automatyczna analiza tematu","Generowanie różnych typów pytań","Dostosowanie poziomu trudności","Inteligentne wyjaśnienia odpowiedzi","Konfiguracja parametrów quizu","Edycja i dostosowanie pytań"]},errors:{topicRequired:"Podaj temat quizu",analysisError:"Błąd analizy tematu:",generationError:"Błąd generowania pytań:",saveError:"Wystąpił błąd podczas zapisu",unexpectedError:"Wystąpił nieoczekiwany błąd",noCourses:"Nie znaleziono żadnych kursów",noTopics:"Wybierz najpierw kurs",noQuestions:"Brak pytań do zapisania"}},et={dashboard:"/quiz-wizard",step1:"/quiz-wizard/step1",step2:"/quiz-wizard/step2",step3:"/quiz-wizard/step3",step4:"/quiz-wizard/step4",step5:"/quiz-wizard/step5",questions:"/questions/manage"},_z=()=>{const e=Z(),{getData:s}=Pe(),n=s("quiz-wizard"),{dashboard:i}=Zn,r=n&&n.quizTitle;return t.jsxs(q,{children:[t.jsx(ce,{title:i.title,description:i.description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 p-6 rounded-lg border border-blue-200",children:[t.jsxs(I,{variant:"start",className:"mb-4",children:[t.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:t.jsx(Mn,{className:"w-8 h-8 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:i.wizardTitle}),t.jsx("p",{className:"text-gray-600",children:i.wizardDescription})]})]}),t.jsxs(be,{variant:"1-2-2",className:"gap-4",children:[t.jsx("div",{className:"space-y-2",children:i.features.slice(0,3).map((a,o)=>t.jsxs(I,{variant:"start",className:"text-sm text-gray-700",children:[t.jsx(Ce,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),t.jsx("span",{children:a})]},o))}),t.jsx("div",{className:"space-y-2",children:i.features.slice(3).map((a,o)=>t.jsxs(I,{variant:"start",className:"text-sm text-gray-700",children:[t.jsx(Ce,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),t.jsx("span",{children:a})]},o))})]}),t.jsx("div",{className:"mt-6",children:t.jsxs(T,{onClick:()=>e(et.step1),className:"w-full md:w-auto",size:"lg",children:[t.jsx(Un,{className:"w-4 h-4 mr-2"}),"Stwórz nowy quiz"]})})]}),r&&t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsxs(I,{variant:"between-center",className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ostatni quiz"}),t.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Zapisany"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Tytuł quizu"}),t.jsx("p",{className:"font-medium text-gray-900",children:n.quizTitle})]}),n.topic&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Temat"}),t.jsx("p",{className:"text-gray-900",children:n.topic})]}),n.questions&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Liczba pytań"}),t.jsxs("p",{className:"text-gray-900",children:[n.questions.length," pytań"]})]})]}),t.jsxs(I,{variant:"start",className:"mt-6 gap-3",children:[t.jsxs(T,{variant:"outline",onClick:()=>e(et.step4),children:[t.jsx(qe,{className:"w-4 h-4 mr-2"}),"Podgląd"]}),t.jsxs(T,{variant:"outline",onClick:()=>e(et.step5),children:[t.jsx(Al,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),t.jsxs(T,{variant:"outline",onClick:()=>e(et.step1),children:[t.jsx(ja,{className:"w-4 h-4 mr-2"}),"Nowy quiz"]})]})]}),t.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Zarządzanie quizami"}),t.jsxs(be,{variant:"1-2-3",className:"gap-4",children:[t.jsxs("button",{onClick:()=>e("/activities"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(I,{variant:"start",className:"mb-2",children:[t.jsx(st,{className:"w-5 h-5 text-blue-600"}),t.jsx("span",{className:"font-medium",children:"Aktywności"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Wszystkie quizy i materiały"})]}),t.jsxs("button",{onClick:()=>e("/questions"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(I,{variant:"start",className:"mb-2",children:[t.jsx(Qs,{className:"w-5 h-5 text-purple-600"}),t.jsx("span",{className:"font-medium",children:"Pytania"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Zarządzaj pytaniami"})]}),t.jsxs("button",{onClick:()=>e("/reports"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(I,{variant:"start",className:"mb-2",children:[t.jsx(dt,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{className:"font-medium",children:"Wyniki"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Statystyki quizów"})]})]})]})]})]})},hr=({step:e})=>{const s=Z();return t.jsxs(t.Fragment,{children:[t.jsx(T,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>s("/quiz-wizard"),children:t.jsx(xt,{className:"h-5 w-5"})}),t.jsxs("div",{className:"p-8 space-y-12 text-zinc-800",children:[t.jsx("h1",{className:"text-6xl font-black",children:"QUIZWISE."}),t.jsxs("h2",{className:"text-4xl",children:["Twórzmy razem ",t.jsx("br",{}),t.jsx("span",{className:"font-bold",children:"sprawdzian wiedzy"})]}),t.jsxs("p",{children:["Krok ",e," z 5"]})]}),t.jsx(Xt,{className:"my-8"})]})},pr=({title:e,description:s})=>t.jsxs("header",{className:"mb-8",children:[t.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:e}),t.jsx("p",{className:"text-gray-600",children:s})]}),Iz=()=>{const e=Z(),{register:s,setData:n}=Pe(),[i,r]=x.useState(""),[a,o]=x.useState(""),[l,c]=x.useState(""),[d,m]=x.useState(""),[u,h]=x.useState(10),[p,g]=x.useState(["single","multiple"]),[f,y]=x.useState({}),[b,j]=x.useState(null),w=Wn("quiz-wizard","analyze-quiz-topic"),{steps:S,errors:k}=Zn,{data:z,isLoading:N}=Ae({resource:"courses",filters:[{field:"is_published",operator:"eq",value:!0}],meta:{select:"*, topics(*)"},sorters:[{field:"created_at",order:"desc"}]}),C=z?.data?.find(_=>_.id.toString()===i),A=C?.topics||[];x.useEffect(()=>{s(Rd),w.registerOperation(Ez);const _=sessionStorage.getItem("wizardContext");if(_){const E=JSON.parse(_);j(E),E.courseId&&r(E.courseId.toString()),E.topicId&&o(E.topicId.toString()),E.topicTitle&&c(E.topicTitle)}return()=>{w.unregisterOperation()}},[]),x.useEffect(()=>{if(a&&A.length>0){const _=A.find(E=>E.id.toString()===a);_&&!l&&c(_.title)}},[a,A]);const v=()=>{const _={};return i||(_.courseId="Wybierz kurs"),a||(_.topicId="Wybierz temat z kursu"),(!l.trim()||l.length<re.topic.minLength)&&(_.topic=re.topic.errorMessage),d||(_.difficulty="Wybierz poziom trudności"),(!u||u<re.questionsCount.min||u>re.questionsCount.max)&&(_.questionsCount=re.questionsCount.errorMessage),p.length===0&&(_.questionTypes="Wybierz przynajmniej jeden typ pytań"),y(_),Object.keys(_).length===0},P=async()=>{if(v())try{const _={courseId:parseInt(i),topicId:parseInt(a),topic:l.trim(),difficulty:d,questionsCount:u,questionTypes:p,courseTitle:C?.title,topicTitle:A.find(E=>E.id.toString()===a)?.title};n("quiz-wizard",_),await w.executeOperation(_),e(et.step2)}catch(_){console.error(k.analysisError,_)}},D=_=>{g(E=>E.includes(_)?E.filter(X=>X!==_):[...E,_])};return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(hr,{step:1}),t.jsxs("div",{className:"p-6",children:[t.jsx(pr,{title:S[1].title,description:S[1].description}),b&&t.jsxs(Es,{className:"mb-4",children:[t.jsx(Ym,{className:"h-4 w-4"}),t.jsxs(Ds,{children:["Tworzysz quiz dla: ",t.jsx("strong",{children:b.courseTitle}),b.topicTitle&&t.jsxs(t.Fragment,{children:[" → ",t.jsx("strong",{children:b.topicTitle})]})]})]}),w.error&&t.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:t.jsxs("span",{className:"text-red-800 text-sm",children:[k.analysisError," ",w.error]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(R,{className:"border-2 border-blue-200 bg-blue-50/50",children:t.jsxs(F,{className:"pt-6",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(Me,{className:"w-5 h-5 text-blue-600"}),t.jsx("h3",{className:"font-semibold",children:"Wybierz miejsce w kursie"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"courseId",children:["Kurs ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs(ze,{value:i,onValueChange:_=>{r(_),o("")},disabled:w.loading||N||!!b?.courseId,children:[t.jsx(ve,{className:f.courseId?"border-red-300":"",children:t.jsx(Se,{placeholder:"Wybierz kurs..."})}),t.jsx(Ne,{children:z?.data?.map(_=>t.jsx(V,{value:_.id.toString(),children:t.jsxs("div",{className:"flex items-center gap-2",children:[_.icon_emoji&&t.jsx("span",{children:_.icon_emoji}),_.title]})},_.id))})]}),f.courseId&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.courseId})]}),t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"topicId",children:["Temat ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs(ze,{value:a,onValueChange:o,disabled:!i||w.loading||!!b?.topicId,children:[t.jsx(ve,{className:f.topicId?"border-red-300":"",children:t.jsx(Se,{placeholder:i?"Wybierz temat...":"Najpierw wybierz kurs..."})}),t.jsx(Ne,{children:A.sort((_,E)=>_.position-E.position).map(_=>t.jsxs(V,{value:_.id.toString(),children:[_.position,". ",_.title]},_.id))})]}),f.topicId&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.topicId})]})]})]})}),t.jsx(Xt,{}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"topic",children:"Temat quizu"}),t.jsx(B,{id:"topic",type:"text",value:l,onChange:_=>c(_.target.value),placeholder:Rd.schema.step1.properties.topic.placeholder,disabled:w.loading,className:f.topic?"border-red-300":""}),f.topic&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.topic}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Możesz dostosować temat quizu lub pozostawić sugerowany"})]}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"difficulty",children:"Poziom trudności"}),t.jsxs(ze,{value:d,onValueChange:m,disabled:w.loading,children:[t.jsx(ve,{className:f.difficulty?"border-red-300":"",children:t.jsx(Se,{placeholder:"Wybierz poziom..."})}),t.jsxs(Ne,{children:[t.jsx(V,{value:"easy",children:"Łatwy"}),t.jsx(V,{value:"medium",children:"Średni"}),t.jsx(V,{value:"hard",children:"Trudny"})]})]}),f.difficulty&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.difficulty})]}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"questionsCount",children:"Liczba pytań"}),t.jsx(B,{id:"questionsCount",type:"number",value:u,onChange:_=>h(parseInt(_.target.value)||0),min:re.questionsCount.min,max:re.questionsCount.max,disabled:w.loading,className:f.questionsCount?"border-red-300":""}),f.questionsCount&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.questionsCount})]}),t.jsxs("div",{children:[t.jsx(se,{children:"Typy pytań"}),t.jsxs("div",{className:"space-y-2 mt-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ht,{id:"single",checked:p.includes("single"),onCheckedChange:()=>D("single"),disabled:w.loading}),t.jsx("label",{htmlFor:"single",className:"text-sm cursor-pointer",children:"Jednokrotny wybór"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ht,{id:"multiple",checked:p.includes("multiple"),onCheckedChange:()=>D("multiple"),disabled:w.loading}),t.jsx("label",{htmlFor:"multiple",className:"text-sm cursor-pointer",children:"Wielokrotny wybór"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ht,{id:"truefalse",checked:p.includes("truefalse"),onCheckedChange:()=>D("truefalse"),disabled:w.loading}),t.jsx("label",{htmlFor:"truefalse",className:"text-sm cursor-pointer",children:"Prawda/Fałsz"})]})]}),f.questionTypes&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.questionTypes})]}),t.jsx("button",{onClick:P,disabled:w.loading,className:"w-full h-12 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium rounded-lg flex items-center justify-center gap-2",children:w.loading?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),S[1].loading]}):S[1].button})]})]})]})})},Mz=()=>{const e=Z(),{getData:s}=Pe(),n=s("quiz-wizard"),{steps:i}=Zn,r=o=>{switch(o){case"easy":return"Łatwy";case"medium":return"Średni";case"hard":return"Trudny";default:return o}},a=o=>{switch(o){case"single":return"Jednokrotny wybór";case"multiple":return"Wielokrotny wybór";case"truefalse":return"Prawda/Fałsz";default:return o}};return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(hr,{step:2}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(pr,{title:i[2].title,description:i[2].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:t.jsx("span",{className:"text-green-800 text-sm",children:i[2].success})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Temat"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800",children:n.topic})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Poziom trudności"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:r(n.difficulty)})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Liczba pytań"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:n.questionsCount})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Typy pytań"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:n.questionTypes?.map(o=>t.jsxs("span",{className:"text-sm text-gray-800",children:[a(o),n.questionTypes.indexOf(o)<n.questionTypes.length-1&&", "]},o))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kluczowe zagadnienia"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:n.keyTopics?.map((o,l)=>t.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:o},l))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cele sprawdzające"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 whitespace-pre-wrap",children:n.learningObjectives})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sugerowany czas"}),t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[n.suggestedTime," minut"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sugerowany próg zaliczenia"}),t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[n.passingScore,"%"]})]})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(et.step1),children:"Wstecz"}),t.jsx(T,{onClick:()=>e(et.step3),children:"Kontynuuj"})]})]})]})]})})},Lz=()=>{const e=Z(),{getData:s,setData:n}=Pe(),i=s("quiz-wizard"),[r,a]=x.useState(i.quizTitle||""),[o,l]=x.useState(i.passingScore||70),[c,d]=x.useState(i.timeLimit||""),[m,u]=x.useState(i.maxAttempts||""),[h,p]=x.useState(!1),[g,f]=x.useState(!0),[y,b]=x.useState({}),j=Wn("quiz-wizard","generate-quiz-questions"),{steps:w,errors:S}=Zn;x.useEffect(()=>(j.registerOperation(Dz),()=>{j.unregisterOperation()}),[]);const k=()=>{const N={};return(!r.trim()||r.length<re.quizTitle.minLength)&&(N.quizTitle=re.quizTitle.errorMessage),(!o||o<re.passingScore.min||o>re.passingScore.max)&&(N.passingScore=re.passingScore.errorMessage),c&&(parseInt(c)<re.timeLimit.min||parseInt(c)>re.timeLimit.max)&&(N.timeLimit=re.timeLimit.errorMessage),m&&(parseInt(m)<re.maxAttempts.min||parseInt(m)>re.maxAttempts.max)&&(N.maxAttempts=re.maxAttempts.errorMessage),b(N),Object.keys(N).length===0},z=async()=>{if(k())try{const N={...i,quizTitle:r.trim(),passingScore:o,timeLimit:c?parseInt(c):null,maxAttempts:m?parseInt(m):null,shuffleQuestions:h,showExplanations:g};n("quiz-wizard",N),await j.executeOperation(N),e(et.step4)}catch(N){console.error(S.generationError,N)}};return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(hr,{step:3}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(pr,{title:w[3].title,description:w[3].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"quizTitle",children:["Tytuł quizu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"quizTitle",value:r,onChange:N=>a(N.target.value),placeholder:"np. Test wiedzy - Zmienne i typy danych",className:`mt-1 ${y.quizTitle?"border-red-300":""}`}),y.quizTitle&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:y.quizTitle})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"passingScore",children:["Próg zaliczenia (%) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"passingScore",type:"number",value:o,onChange:N=>l(parseInt(N.target.value)||0),min:re.passingScore.min,max:re.passingScore.max,className:`mt-1 ${y.passingScore?"border-red-300":""}`}),y.passingScore&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:y.passingScore})]}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"timeLimit",children:"Limit czasu (min)"}),t.jsx(B,{id:"timeLimit",type:"number",value:c,onChange:N=>d(N.target.value),placeholder:"Pozostaw puste dla braku limitu",min:re.timeLimit.min,max:re.timeLimit.max,className:`mt-1 ${y.timeLimit?"border-red-300":""}`}),y.timeLimit&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:y.timeLimit})]})]}),t.jsxs("div",{children:[t.jsx(se,{htmlFor:"maxAttempts",children:"Maksymalna liczba podejść"}),t.jsx(B,{id:"maxAttempts",type:"number",value:m,onChange:N=>u(N.target.value),placeholder:"Pozostaw puste dla nieograniczonej liczby",min:re.maxAttempts.min,max:re.maxAttempts.max,className:`mt-1 ${y.maxAttempts?"border-red-300":""}`}),y.maxAttempts&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:y.maxAttempts})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ht,{id:"shuffleQuestions",checked:h,onCheckedChange:N=>p(N)}),t.jsx("label",{htmlFor:"shuffleQuestions",className:"text-sm cursor-pointer",children:"Losowa kolejność pytań"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ht,{id:"showExplanations",checked:g,onCheckedChange:N=>f(N)}),t.jsx("label",{htmlFor:"showExplanations",className:"text-sm cursor-pointer",children:"Pokazuj wyjaśnienia po odpowiedzi"})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(et.step2),children:"Wstecz"}),t.jsx(T,{onClick:z,disabled:j.loading,children:j.loading?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),w[3].loading]}):w[3].button})]})]}),j.loading&&t.jsx("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:t.jsx("span",{className:"text-blue-800 text-sm",children:w[3].loadingInfo})})]})]})})},Oz=()=>{const e=Z(),{getData:s}=Pe(),n=s("quiz-wizard"),{steps:i}=Zn,r=o=>{switch(o){case"single":return"Jednokrotny wybór";case"multiple":return"Wielokrotny wybór";case"truefalse":return"Prawda/Fałsz";default:return o}},a=o=>{switch(o){case"single":return"default";case"multiple":return"secondary";case"truefalse":return"outline";default:return"default"}};return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(hr,{step:4}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(pr,{title:t.jsxs(t.Fragment,{children:[t.jsx(qe,{className:"w-8 h-8 text-zinc-500"}),t.jsx("span",{children:i[4].title})]}),description:i[4].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold mb-2",children:n.quizTitle}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Liczba pytań:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.questions?.length||0})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Próg zaliczenia:"}),t.jsxs("span",{className:"ml-2 font-medium",children:[n.passingScore,"%"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Limit czasu:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.timeLimit?`${n.timeLimit} min`:"Brak"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Max. podejść:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.maxAttempts||"Bez limitu"})]})]})]}),t.jsx("div",{className:"space-y-4",children:n.questions?.map((o,l)=>t.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("h5",{className:"font-medium",children:["Pytanie ",l+1]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(ne,{variant:a(o.type),children:r(o.type)}),t.jsxs(ne,{variant:"outline",children:[o.points," pkt"]})]})]}),t.jsx("p",{className:"text-gray-700",children:o.question})]}),t.jsx("div",{className:"space-y-2 mb-3",children:o.options?.map((c,d)=>t.jsxs("div",{className:`flex items-center gap-2 p-2 rounded ${c.is_correct?"bg-green-50 border border-green-200":"bg-gray-50"}`,children:[c.is_correct?t.jsx(Ce,{className:"w-4 h-4 text-green-600 flex-shrink-0"}):t.jsx(xt,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),t.jsx("span",{className:c.is_correct?"font-medium":"",children:c.text})]},d))}),o.explanation&&t.jsx("div",{className:"bg-blue-50 p-3 rounded",children:t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"font-medium",children:"Wyjaśnienie:"})," ",o.explanation]})})]},l))})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:t.jsx("p",{className:"text-blue-800 text-sm",children:i[4].info})}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(et.step3),children:"Wstecz"}),t.jsx(T,{onClick:()=>e(et.step5),children:"Zapisz w kursie"})]})]})]})})},Rz=()=>{const e=Z(),{getData:s,setData:n}=Pe(),{mutate:i}=cs(),{mutate:r}=cs(),a=s("quiz-wizard"),[o,l]=x.useState(a.quizTitle||""),[c,d]=x.useState({}),[m,u]=x.useState(!1),[h,p]=x.useState(!1),{steps:g,errors:f}=Zn,{data:y}=Ae({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:a.topicId}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!a.topicId}}),b=y?.data?.[0]?.position?y.data[0].position+1:1;x.useEffect(()=>{(!a.courseId||!a.topicId||!a.questions)&&(O.error("Brak danych z poprzednich kroków. Wracam do początku..."),e(et.step1))},[a,e]);const j=()=>{const S={};return(!o.trim()||o.length<re.quizTitle.minLength)&&(S.finalTitle=re.quizTitle.errorMessage),(!a.questions||a.questions.length===0)&&(S.questions=f.noQuestions),d(S),Object.keys(S).length===0},w=async()=>{if(j()){u(!0),p(!1);try{i({resource:"activities",values:{topic_id:parseInt(a.topicId),type:"quiz",title:o.trim(),position:b,duration_min:a.suggestedTime||a.timeLimit||30,is_published:!1,passing_score:a.passingScore,time_limit:a.timeLimit||null,max_attempts:a.maxAttempts||null}},{onSuccess:async S=>{const k=S.data.id;try{for(let z=0;z<a.questions.length;z++){const N=a.questions[z];await new Promise((C,A)=>{r({resource:"questions",values:{activity_id:k,question:N.question,explanation:N.explanation,points:N.points,position:z+1,options:N.options.map((v,P)=>({id:P+1,text:v.text,is_correct:v.is_correct}))}},{onSuccess:C,onError:A})})}n("quiz-wizard",{...a,finalTitle:o.trim(),activityId:k,saved:!0}),u(!1),p(!0),setTimeout(()=>{e(`${et.questions}/${k}`)},2e3)}catch(z){u(!1),p(!1),console.error("Błąd podczas zapisywania pytań:",z),O.error("Wystąpił błąd podczas zapisywania pytań. Spróbuj ponownie.")}},onError:S=>{u(!1),p(!1),console.error(f.saveError,S),O.error(f.saveError)}})}catch(S){u(!1),p(!1),console.error(f.unexpectedError,S),O.error(f.unexpectedError)}}};return t.jsx(q,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative",children:[t.jsx(hr,{step:5}),t.jsxs("div",{className:"p-8",children:[t.jsx(pr,{title:t.jsxs(t.Fragment,{children:[t.jsx(st,{className:"w-8 h-8 text-blue-500"}),t.jsx("span",{children:g[5].title})]}),description:g[5].description}),h&&t.jsx(Es,{className:"mb-6 bg-green-50 border-green-200",children:t.jsx(Ds,{className:"text-green-800",children:g[5].success})}),t.jsxs("form",{className:"space-y-6",onSubmit:S=>{S.preventDefault(),w()},children:[t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(Me,{className:"w-5 h-5 text-blue-600"}),t.jsx("h4",{className:"font-medium",children:"Lokalizacja quizu"})]}),t.jsxs("div",{className:"space-y-1 text-sm",children:[t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-600",children:"Kurs:"})," ",t.jsx("span",{className:"font-medium",children:a.courseTitle})]}),t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-600",children:"Temat:"})," ",t.jsx("span",{className:"font-medium",children:a.topicTitle})]})]})]}),t.jsxs("div",{children:[t.jsxs(se,{htmlFor:"finalTitle",children:["Tytuł quizu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"finalTitle",type:"text",value:o,onChange:S=>l(S.target.value),placeholder:"Tytuł quizu",maxLength:re.quizTitle.maxLength,className:c.finalTitle?"border-red-300":""}),c.finalTitle&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:c.finalTitle}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Możesz dostosować tytuł quizu przed zapisaniem"})]}),t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-medium mb-3",children:"Podsumowanie quizu"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Liczba pytań:"}),t.jsx("span",{className:"ml-2 font-medium",children:a.questions?.length||0})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Próg zaliczenia:"}),t.jsxs("span",{className:"ml-2 font-medium",children:[a.passingScore,"%"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Limit czasu:"}),t.jsx("span",{className:"ml-2 font-medium",children:a.timeLimit?`${a.timeLimit} min`:"Brak"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Łączna liczba punktów:"}),t.jsx("span",{className:"ml-2 font-medium",children:a.questions?.reduce((S,k)=>S+k.points,0)||0})]})]})]}),t.jsxs("div",{children:[t.jsxs("h4",{className:"font-medium mb-3",children:["Pytania (",a.questions?.length||0,")"]}),t.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2 border rounded-lg p-3",children:a.questions?.map((S,k)=>t.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[t.jsxs("span",{className:"text-sm truncate flex-1",children:[k+1,". ",S.question]}),t.jsxs("span",{className:"text-sm font-medium ml-2",children:[S.points," pkt"]})]},k))})]}),t.jsxs(Es,{className:"bg-yellow-50 border-yellow-200",children:[t.jsx(Cl,{className:"h-4 w-4 text-yellow-800"}),t.jsx(Ds,{className:"text-yellow-800",children:"Po zapisaniu będziesz mógł edytować pytania w panelu zarządzania quizem"})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:t.jsx("p",{className:"text-blue-800 text-sm",children:g[5].saveInfo})}),t.jsx(Xt,{}),t.jsxs("footer",{className:"flex justify-between gap-4",children:[t.jsxs(T,{type:"button",variant:"outline",onClick:()=>e(et.step4),disabled:m,className:"flex items-center gap-2",children:[t.jsx(je,{className:"w-4 h-4"}),"Wstecz"]}),t.jsx(T,{type:"submit",disabled:m||h,className:"flex items-center gap-2 min-w-[160px]",children:m?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),g[5].loading]}):t.jsxs(t.Fragment,{children:[t.jsx(nr,{className:"w-4 h-4"}),g[5].button]})})]})]})]})]})})},Fz=[t.jsx(L,{path:"/quiz-wizard",element:t.jsx(_z,{})},"quiz-dashboard"),t.jsx(L,{path:"/quiz-wizard/step1",element:t.jsx(Iz,{})},"quiz-step1"),t.jsx(L,{path:"/quiz-wizard/step2",element:t.jsx(Mz,{})},"quiz-step2"),t.jsx(L,{path:"/quiz-wizard/step3",element:t.jsx(Lz,{})},"quiz-step3"),t.jsx(L,{path:"/quiz-wizard/step4",element:t.jsx(Oz,{})},"quiz-step4"),t.jsx(L,{path:"/quiz-wizard/step5",element:t.jsx(Rz,{})},"quiz-step5")],$z=()=>{const{activityId:e}=Ze();Z();const[s,n]=x.useState(null),[i,r]=x.useState(!1),{data:a,isLoading:o}=Oe({resource:"activities",id:e,meta:{select:"*, topics(*, courses(*))"}}),{data:l,isLoading:c,refetch:d}=Ae({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(e)}],sorters:[{field:"position",order:"asc"}],pagination:{mode:"off"}}),{mutate:m}=cs(),{mutate:u}=zl(),{mutate:h}=In();if(o||c)return t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const p=a?.data,g=l?.data||[];return t.jsxs(q,{children:[t.jsx(Xs,{}),t.jsxs(I,{children:[t.jsx(ce,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(st,{className:"w-6 h-6 text-blue-500"}),"Pytania quizu"]}),description:t.jsxs("div",{children:[t.jsx("div",{className:"text-lg font-medium",children:p?.title}),t.jsxs("div",{className:"text-sm text-muted-foreground",children:[p?.topics?.courses?.title," → Temat"," ",p?.topics?.position,": ",p?.topics?.title]})]})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(ne,{variant:"outline",className:"text-base px-3 py-1",children:[g.length," ",g.length===1?"pytanie":"pytań"]}),t.jsxs(T,{onClick:()=>r(!0),disabled:i,children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Dodaj pytanie"]})]})]}),t.jsx(R,{className:"bg-muted/50",children:t.jsx(F,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Próg zaliczenia:"}),t.jsxs("span",{className:"ml-2 font-medium",children:[p?.passing_score||70,"%"]})]}),p?.time_limit&&t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Limit czasu:"}),t.jsxs("span",{className:"ml-2 font-medium",children:[p.time_limit," min"]})]}),p?.max_attempts&&t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Max. prób:"}),t.jsx("span",{className:"ml-2 font-medium",children:p.max_attempts})]})]})})}),i&&t.jsx(Fd,{activityId:parseInt(e),position:g.length+1,onSave:f=>{m({resource:"questions",values:f},{onSuccess:()=>{O.success("Pytanie zostało dodane"),r(!1),d()}})},onCancel:()=>r(!1)}),t.jsx("div",{className:"space-y-4",children:g.map(f=>t.jsx("div",{children:s===f.id?t.jsx(Fd,{question:f,activityId:parseInt(e),position:f.position,onSave:y=>{u({resource:"questions",id:f.id,values:y},{onSuccess:()=>{O.success("Pytanie zostało zaktualizowane"),n(null),d()}})},onCancel:()=>n(null)}):t.jsxs(R,{children:[t.jsx(W,{children:t.jsxs(I,{children:[t.jsxs(U,{className:"text-base",children:[t.jsxs("span",{className:"text-muted-foreground mr-2",children:["#",f.position]}),f.question]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(ne,{variant:"outline",children:[f.points," pkt"]}),t.jsx(T,{variant:"outline",size:"sm",onClick:()=>n(f.id),children:t.jsx(Lt,{className:"w-3 h-3"})}),t.jsx(T,{variant:"outline",size:"sm",onClick:()=>{confirm("Czy na pewno chcesz usunąć to pytanie?")&&h({resource:"questions",id:f.id},{onSuccess:()=>{O.success("Pytanie zostało usunięte"),d()}})},children:t.jsx(ds,{className:"w-3 h-3 text-red-600"})})]})]})}),t.jsxs(F,{children:[t.jsx("div",{className:"space-y-2",children:f.options.map((y,b)=>t.jsxs("div",{className:`flex items-center gap-2 p-2 rounded ${y.is_correct?"bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800":""}`,children:[y.is_correct?t.jsx(Ce,{className:"w-4 h-4 text-green-600"}):t.jsx(xt,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:y.is_correct?"font-medium":"",children:y.text})]},y.id||b))}),f.explanation&&t.jsxs("div",{className:"mt-4 p-3 bg-muted rounded",children:[t.jsx("p",{className:"text-sm font-medium mb-1",children:"Wyjaśnienie:"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:f.explanation})]})]})]})},f.id))}),g.length===0&&!i&&t.jsx(R,{children:t.jsxs(F,{className:"text-center py-12",children:[t.jsx(st,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),t.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-4",children:"Quiz nie ma jeszcze żadnych pytań"}),t.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Dodaj pierwsze pytanie, aby uczniowie mogli rozwiązać quiz"}),t.jsxs(T,{onClick:()=>r(!0),children:[t.jsx(Le,{className:"w-4 h-4 mr-2"}),"Dodaj pierwsze pytanie"]})]})}),g.length>0&&t.jsxs("div",{className:"flex justify-between items-center pt-6 border-t",children:[t.jsxs("div",{className:"text-sm text-muted-foreground",children:["Łącznie punktów: ",g.reduce((f,y)=>f+y.points,0)]}),t.jsx(Xs,{variant:"outline",children:"Zakończ edycję"})]})]})},Fd=({question:e,activityId:s,position:n,onSave:i,onCancel:r})=>{const[a,o]=x.useState({question:e?.question||"",explanation:e?.explanation||"",points:e?.points||1,position:n,options:e?.options||[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]}),l=()=>{if(!a.question.trim()){O.error("Pytanie jest wymagane");return}const m=a.options.filter(h=>h.text.trim());if(m.length<2){O.error("Dodaj przynajmniej 2 odpowiedzi");return}if(m.filter(h=>h.is_correct).length===0){O.error("Zaznacz przynajmniej jedną poprawną odpowiedź");return}i({activity_id:s,question:a.question,explanation:a.explanation||null,points:a.points,position:a.position,options:m.map((h,p)=>({...h,position:p+1}))})},c=()=>{a.options.length<6&&o({...a,options:[...a.options,{text:"",is_correct:!1}]})},d=m=>{if(a.options.length>2){const u=a.options.filter((h,p)=>p!==m);o({...a,options:u})}};return t.jsxs(R,{className:"border-primary",children:[t.jsx(W,{children:t.jsx(U,{children:e?"Edytuj pytanie":"Nowe pytanie"})}),t.jsxs(F,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Treść pytania"}),t.jsx(St,{placeholder:"Wprowadź treść pytania...",value:a.question,onChange:m=>o({...a,question:m.target.value}),className:"mt-1",rows:3})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Liczba punktów"}),t.jsx(B,{type:"number",min:"1",value:a.points,onChange:m=>o({...a,points:parseInt(m.target.value)||1}),className:"mt-1"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Pozycja"}),t.jsx(B,{type:"number",min:"1",value:a.position,onChange:m=>o({...a,position:parseInt(m.target.value)||1}),className:"mt-1"})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"Odpowiedzi"}),a.options.length<6&&t.jsxs(T,{type:"button",size:"sm",variant:"outline",onClick:c,children:[t.jsx(Le,{className:"w-3 h-3 mr-1"}),"Dodaj opcję"]})]}),t.jsx("div",{className:"space-y-2",children:a.options.map((m,u)=>t.jsxs("div",{className:"flex gap-2",children:[t.jsx(ht,{checked:m.is_correct,onCheckedChange:h=>{const p=[...a.options];p[u].is_correct=h,o({...a,options:p})}}),t.jsx(B,{placeholder:`Odpowiedź ${u+1}`,value:m.text,onChange:h=>{const p=[...a.options];p[u].text=h.target.value,o({...a,options:p})},className:"flex-1"}),a.options.length>2&&t.jsx(T,{type:"button",variant:"ghost",size:"sm",onClick:()=>d(u),children:t.jsx(xt,{className:"w-4 h-4"})})]},u))}),t.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Zaznacz checkbox przy poprawnych odpowiedziach. Możesz zaznaczyć więcej niż jedną."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Wyjaśnienie (opcjonalne)"}),t.jsx(St,{placeholder:"Wyjaśnienie poprawnej odpowiedzi...",value:a.explanation,onChange:m=>o({...a,explanation:m.target.value}),className:"mt-1",rows:3})]}),t.jsxs(I,{children:[t.jsxs(T,{variant:"outline",onClick:r,children:[t.jsx(xt,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),t.jsxs(T,{onClick:l,children:[t.jsx(nr,{className:"w-4 h-4 mr-2"}),"Zapisz pytanie"]})]})]})]})},qz=()=>{const[e]=pa(),s=Z(),n=e.get("activity_id"),{data:i,isLoading:r}=Ae({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(n)}],sorters:[{field:"position",order:"desc"}],pagination:{mode:"off"}}),[a,o]=x.useState({question:"",explanation:"",points:1,position:1,options:[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]});x.useEffect(()=>{if(i?.data){const f=i.data.reduce((y,b)=>Math.max(y,b.position||0),0);o(y=>({...y,position:f+1}))}},[i]);const{data:l,isLoading:c}=Oe({resource:"activities",id:n,meta:{select:"*, topics(*, courses(*))"}}),{mutate:d,isLoading:m}=cs();if(!n)return t.jsx(q,{children:t.jsx(R,{children:t.jsx(F,{className:"text-center py-12",children:t.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Brak ID aktywności"})})})});if(c||r)return t.jsx(q,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const u=l?.data;if(!u||u.type!=="quiz")return t.jsx(q,{children:t.jsx(R,{children:t.jsx(F,{className:"text-center py-12",children:t.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Nieprawidłowa aktywność lub aktywność nie jest quizem"})})})});const h=()=>{if(!a.question.trim()){O.error("Pytanie jest wymagane");return}const f=a.options.filter(b=>b.text.trim());if(f.length<2){O.error("Dodaj przynajmniej 2 odpowiedzi");return}if(f.filter(b=>b.is_correct).length===0){O.error("Zaznacz przynajmniej jedną poprawną odpowiedź");return}d({resource:"questions",values:{activity_id:parseInt(n),question:a.question,explanation:a.explanation||null,points:a.points,position:a.position,options:f.map((b,j)=>({id:j+1,text:b.text,is_correct:b.is_correct}))}},{onSuccess:()=>{O.success("Pytanie zostało dodane"),s(`/questions/manage/${n}`)},onError:b=>{console.error("Błąd podczas dodawania pytania:",b);const j=b?.code||b?.statusCode,w=b?.message||b?.error?.message;j==="23505"||j===23505?w?.includes("position")?O.error("Pytanie o tej pozycji już istnieje. Zmień pozycję na inną wartość."):O.error("Wystąpił konflikt z istniejącymi danymi. Sprawdź pozycję pytania."):j==="23503"||j===23503?O.error("Nieprawidłowe powiązanie z aktywnością."):j==="22P02"||j===22002?O.error("Nieprawidłowy format danych."):w?O.error(`Błąd: ${w}`):O.error("Wystąpił nieoczekiwany błąd. Spróbuj ponownie.")}})},p=()=>{a.options.length<6&&o({...a,options:[...a.options,{text:"",is_correct:!1}]})},g=f=>{if(a.options.length>2){const y=a.options.filter((b,j)=>j!==f);o({...a,options:y})}};return t.jsxs(q,{children:[t.jsx(Xs,{}),t.jsx(I,{children:t.jsx(ce,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(st,{className:"w-6 h-6 text-blue-500"}),"Dodaj pytanie do quizu"]}),description:t.jsxs("div",{children:[t.jsx("div",{className:"text-lg font-medium",children:u?.title}),t.jsxs("div",{className:"text-sm text-muted-foreground",children:[u?.topics?.courses?.title," → Temat"," ",u?.topics?.position,": ",u?.topics?.title]})]})})}),t.jsxs(R,{children:[t.jsx(W,{children:t.jsx(U,{children:"Nowe pytanie"})}),t.jsxs(F,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Treść pytania"}),t.jsx(St,{placeholder:"Wprowadź treść pytania...",value:a.question,onChange:f=>o({...a,question:f.target.value}),className:"mt-1",rows:3})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Liczba punktów"}),t.jsx(B,{type:"number",min:"1",value:a.points,onChange:f=>o({...a,points:parseInt(f.target.value)||1}),className:"mt-1"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Pozycja"}),t.jsx(B,{type:"number",min:"1",value:a.position,onChange:f=>o({...a,position:parseInt(f.target.value)||1}),className:"mt-1"})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"Odpowiedzi"}),a.options.length<6&&t.jsxs(T,{type:"button",size:"sm",variant:"outline",onClick:p,children:[t.jsx(Le,{className:"w-3 h-3 mr-1"}),"Dodaj opcję"]})]}),t.jsx("div",{className:"space-y-2",children:a.options.map((f,y)=>t.jsxs("div",{className:"flex gap-2",children:[t.jsx(ht,{checked:f.is_correct,onCheckedChange:b=>{const j=[...a.options];j[y].is_correct=b,o({...a,options:j})}}),t.jsx(B,{placeholder:`Odpowiedź ${y+1}`,value:f.text,onChange:b=>{const j=[...a.options];j[y].text=b.target.value,o({...a,options:j})},className:"flex-1"}),a.options.length>2&&t.jsx(T,{type:"button",variant:"ghost",size:"sm",onClick:()=>g(y),children:t.jsx(xt,{className:"w-4 h-4"})})]},y))}),t.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Zaznacz checkbox przy poprawnych odpowiedziach. Możesz zaznaczyć więcej niż jedną."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Wyjaśnienie (opcjonalne)"}),t.jsx(St,{placeholder:"Wyjaśnienie poprawnej odpowiedzi...",value:a.explanation,onChange:f=>o({...a,explanation:f.target.value}),className:"mt-1",rows:3})]}),t.jsxs(I,{children:[t.jsxs(T,{variant:"outline",onClick:()=>s(`/questions/manage/${n}`),children:[t.jsx(xt,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),t.jsxs(T,{onClick:h,disabled:m,children:[t.jsx(nr,{className:"w-4 h-4 mr-2"}),m?"Zapisywanie...":"Zapisz pytanie"]})]})]})]})]})},Vz=[t.jsx(L,{path:"/questions/manage/:activityId",element:t.jsx($z,{})},"questions-manage"),t.jsx(L,{path:"/questions/create",element:t.jsx(qz,{})},"questions-create")],Bz=({className:e="",showRole:s=!0,showEmail:n=!0,compact:i=!1})=>{const{data:r,isLoading:a,error:o}=Tt(),l=h=>{switch(h){case"admin":return t.jsx(Tl,{className:"h-3 w-3"});case"teacher":return t.jsx(Xy,{className:"h-3 w-3"});case"student":return t.jsx(As,{className:"h-3 w-3"});default:return t.jsx(Mi,{className:"h-3 w-3"})}},c=h=>{switch(h){case"admin":return"Administrator";case"teacher":return"Nauczyciel";case"student":return"Uczeń";default:return"Użytkownik"}},d=h=>{switch(h){case"admin":return"text-purple-600 bg-purple-50";case"teacher":return"text-blue-600 bg-blue-50";case"student":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}};if(a)return t.jsxs("div",{className:`flex items-center space-x-3 p-3 ${e}`,children:[t.jsx(Sr,{className:"h-10 w-10 rounded-full"}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(Sr,{className:"h-4 w-28"}),t.jsx(Sr,{className:"h-3 w-20"}),s&&t.jsx(Sr,{className:"h-3 w-16"})]})]});if(o||!r)return t.jsxs("div",{className:`flex items-center space-x-3 p-3 text-muted-foreground ${e}`,children:[t.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-100 flex items-center justify-center",children:t.jsx(Mi,{className:"h-5 w-5 text-gray-400"})}),t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"font-medium text-gray-500",children:"Nie zalogowano"}),t.jsx("div",{className:"text-xs opacity-70",children:"Brak danych użytkownika"})]})]});const u=(h=>{if(!h)return"U";const p=h.trim().split(" ");return p.length>=2?`${p[0][0]}${p[p.length-1][0]}`.toUpperCase():h.slice(0,2).toUpperCase()})(r.full_name||r.email);return i?t.jsxs("div",{className:`flex items-center space-x-2 p-2 ${e}`,children:[t.jsx(Io,{className:"h-8 w-8",children:t.jsx(Mo,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white text-xs",children:u})}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx("div",{className:"font-medium text-sm truncate",children:r.full_name})})]}):t.jsxs("div",{className:`flex items-center space-x-3 px-4 pt-4 rounded-lg bg-white/50 backdrop-blur-sm border border-purple-100/20 ${e}`,children:[t.jsx(Io,{className:"h-12 w-12 ring-2 ring-purple-100 ring-offset-2",children:t.jsx(Mo,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white font-medium",children:u})}),t.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[t.jsx("div",{className:"font-semibold text-gray-900 truncate",title:r.full_name,children:r.full_name}),n&&r.email&&t.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-500",children:[t.jsx(sr,{className:"h-3 w-3"}),t.jsx("span",{className:"truncate",title:r.email,children:r.email})]}),s&&r.role&&t.jsx("div",{className:"inline-flex items-center gap-1.5",children:t.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full text-xs font-medium ${d(r.role)}`,children:[l(r.role),c(r.role)]})})]})]})},Uz=({onClose:e})=>{const{mutate:s}=Wm(),{menuItems:n}=Ly(),{data:i}=Tt(),r=()=>{e&&e()};return t.jsxs("div",{className:"flex h-full w-64 flex-col border-r bg-background",children:[t.jsxs("div",{className:"flex h-16 items-center justify-between border-b px-6",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(Pl,{className:"h-6 w-6 mr-2"}),t.jsx("span",{className:"font-semibold",children:"Smart Up"})]}),e&&t.jsx(T,{variant:"ghost",size:"sm",onClick:e,className:"lg:hidden",children:t.jsx(xt,{className:"h-4 w-4"})})]}),t.jsx(lh,{className:"flex-1 px-3 py-4",children:t.jsx("nav",{className:"space-y-2",children:n.map(a=>t.jsxs(ky,{to:a.route??"/",onClick:r,className:({isActive:o})=>M("flex items-center rounded-md px-3 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground",o?"bg-accent text-accent-foreground":"text-muted-foreground"),children:[a.icon&&t.jsx("span",{className:"mr-3 flex items-center",children:(G.isValidElement(a.icon),a.icon)}),a.label]},a.key))})}),t.jsx(Xt,{}),t.jsx(Bz,{className:"border-b"}),t.jsx("div",{className:"p-4",children:t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>{s(),e&&e()},className:"w-full justify-start",children:[t.jsx(El,{className:"mr-2 h-4 w-4"}),"Logout"]})})]})},Wz=({children:e})=>{const[s,n]=x.useState(!1),i=()=>{n(!s)};return t.jsx("div",{className:"min-h-screen bg-stone-200 relative overflow-x-hidden",children:t.jsxs("div",{className:"flex relative",children:[s&&t.jsx("div",{className:"fixed inset-0 z-40 bg-purple-900/20 backdrop-blur-sm lg:hidden",onClick:()=>n(!1)}),t.jsx("aside",{className:`
            h-screen w-64 transform transition-transform duration-300 ease-in-out
            fixed left-0 top-0 z-50
            ${s?"translate-x-0":"-translate-x-full"}
            lg:translate-x-0
            bg-background/95 backdrop-blur-md border-r border-purple-200/20
          `,children:t.jsx(Uz,{onClose:()=>n(!1)})}),t.jsxs("main",{className:"flex-1 lg:ml-64 min-w-0 relative z-10",children:[t.jsxs("div",{className:"sticky top-0 z-30 flex h-16 items-center border-b border-purple-200/20 bg-background/80 backdrop-blur-md px-4 lg:hidden",children:[t.jsx(T,{variant:"ghost",size:"sm",onClick:i,className:"mr-2 hover:bg-purple-100/20 hover:text-purple-700",children:t.jsx(Pl,{className:"h-6 w-6"})}),t.jsx("span",{className:"font-semibold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Smart Up"})]}),e]})]})})},Kz=[{name:"dashboard",list:"/teacher/dashboard/overview",meta:{label:"Dashboard",icon:t.jsx(Zm,{className:"w-5 h-5"})}},{name:"courses",list:"/teacher/courses",create:"/teacher/courses/create",edit:"/teacher/courses/edit/:id",show:"/teacher/courses/show/:id",meta:{label:"Kursy",icon:t.jsx(Me,{className:"w-5 h-5"})}},{name:"users",list:"/teacher/users",create:"/teacher/users/create",edit:"/teacher/users/edit/:id",meta:{label:"Użytkownicy",icon:t.jsx(Ye,{className:"w-5 h-5"})}},{name:"vendors",list:"/teacher/vendors",create:"/teacher/vendors/create",edit:"/teacher/vendors/edit/:id",meta:{label:"Vendorzy",icon:t.jsx(ej,{className:"w-5 h-5"})}},{name:"reports",list:"/teacher/reports",meta:{label:"Raporty",icon:t.jsx(tj,{className:"w-5 h-5"})}}],$d=[...Zj,...D0,...M0,...Qk,...Vz,...wz,...Pz,...Fz,...sz,...oz,...cz,...uz],Gz=()=>t.jsx(Il,{routes:$d,defaultPath:"dashboard/overview",resources:Kz,layout:t.jsx(Ji,{children:t.jsxs(L,{element:t.jsxs(Wz,{children:[" ",t.jsx(zy,{})]}),children:[t.jsx(L,{index:!0,element:t.jsx(Ts,{to:"dashboard/overview",replace:!0})}),...$d]})})}),Hz=x.lazy(()=>Promise.resolve({default:Gz})),Qz=t.jsx(L,{path:"/teacher/*",element:t.jsx(Vm,{fallback:t.jsx(Bm,{to:"/login"}),children:t.jsx(ih,{allowedRoles:["teacher","admin"],fallbackPath:"/student/dashboard",loadingText:"Ładowanie panelu nauczyciela...",loadingColorClass:"border-indigo-600",children:t.jsx(x.Suspense,{fallback:t.jsx(_l,{text:"Ładowanie panelu nauczyciela...",colorClass:"border-indigo-600"}),children:t.jsx(Hz,{})})})},"teacher-auth-check")}),Pa=()=>{const[e,s]=x.useState({points:0,level:1,streak:0,idle_rate:1,next_level_points:200,quizzes_completed:0,perfect_scores:0,total_time:0,rank:0}),[n,i]=x.useState(!0),r=x.useCallback(async()=>{try{i(!0);const{data:a,error:o}=await te.rpc("get_my_stats");if(o)throw o;a&&s({points:a.points||0,level:a.level||1,streak:a.streak||0,idle_rate:a.idle_rate||1,next_level_points:a.next_level_points||200,quizzes_completed:a.quizzes_completed||0,perfect_scores:a.perfect_scores||0,total_time:a.total_time||0,rank:a.rank||0})}catch(a){console.error("Error fetching stats:",a)}finally{i(!1)}},[]);return x.useEffect(()=>{r()},[r]),{stats:e,setStats:s,isLoading:n,refetch:r}},as=new Map,fr=(e,s,n)=>{const i=n?.cacheKey||`${e}-${JSON.stringify(s)}`,[r,a]=x.useState(()=>as.get(i)||null),[o,l]=x.useState(!as.has(i)),[c,d]=x.useState(null),m=x.useCallback(async(h=!1)=>{if(n?.enabled!==!1){if(!h&&as.has(i)){a(as.get(i)),l(!1);return}try{l(!0),d(null);const{data:p,error:g}=await te.rpc(e,s);if(g)throw g;as.set(i,p),a(p),n?.onSuccess?.(p)}catch(p){d(p),n?.onError?.(p)}finally{l(!1)}}},[e,i,JSON.stringify(s),n?.enabled]);x.useEffect(()=>{m()},[m]);const u=x.useCallback(()=>{as.delete(i)},[i]);return{data:r,isLoading:o,error:c,refetch:()=>m(!0),invalidate:u}},Wo=e=>{e?Array.from(as.keys()).forEach(s=>{s.includes(e)&&as.delete(s)}):as.clear()},Yz=(e,s)=>{const[n,i]=x.useState([]),[r,a]=x.useState(!0),[o,l]=x.useState(null),c=x.useCallback(async()=>{if(s?.enabled!==!1)try{a(!0),l(null);let d=te.from(e).select(s?.select||"*");s?.filters?.forEach(h=>{switch(h.operator){case"eq":d=d.eq(h.field,h.value);break;case"in":d=d.in(h.field,h.value);break;case"contains":d=d.ilike(h.field,`%${h.value}%`);break}}),s?.sorts?.forEach(h=>{d=d.order(h.field,{ascending:h.order==="asc"})}),s?.limit&&(d=d.limit(s.limit));const{data:m,error:u}=await d;if(u)throw u;i(m||[])}catch(d){l(d)}finally{a(!1)}},[e,JSON.stringify(s)]);return x.useEffect(()=>{c()},[c]),{data:n,isLoading:r,error:o,refetch:c}},Zz=()=>t.jsxs("header",{className:"h-16 px-6 border-b relative grid place-items-center justify-start overflow-hidden",children:[t.jsx("i",{"aria-hidden":!0,className:"absolute -right-10 -top-10 w-28 h-28 rounded-3xl bg-gradient-to-br from-primary/10 via-secondary/10 to-accent/10 rotate-45"}),t.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[t.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-secondary text-white grid place-items-center shadow",children:t.jsx(As,{className:"w-5 h-5"})}),t.jsx("strong",{className:"text-lg",children:"Smart Up"})]})]}),sf=({name:e,level:s,streak:n})=>t.jsx("section",{className:"p-6",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-primary/10 to-secondary/10 text-primary grid place-items-center font-bold",children:e?.charAt(0)||"U"}),t.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 rounded-full bg-secondary text-white text-xs grid place-items-center font-bold",children:s})]}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"font-semibold truncate",children:e}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Poziom ",s," • ",n," dni"]})]})]})}),nf=({points:e,idle:s,streak:n})=>t.jsx("section",{className:"px-6 -mt-2 mb-2",children:t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("article",{className:"rounded-xl border p-3 bg-primary/5 border-primary/10",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(It,{className:"w-4 h-4 text-primary"}),t.jsx("span",{className:"text-xs text-muted-foreground",children:"Punkty"})]}),t.jsx("p",{className:"text-lg font-bold",children:e}),t.jsxs("p",{className:"text-xs text-primary",children:["+",s,"/h"]})]}),t.jsxs("article",{className:"rounded-xl border p-3 bg-destructive/5 border-destructive/10",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(Tn,{className:"w-4 h-4 text-destructive"}),t.jsx("span",{className:"text-xs text-muted-foreground",children:"Seria"})]}),t.jsx("p",{className:"text-lg font-bold",children:n}),t.jsx("p",{className:"text-xs text-destructive",children:"dni z rzędu"})]})]})}),rf=({items:e,current:s,onNavigate:n})=>{const i=a=>s===a,r=a=>{const o=i(a.path);return t.jsxs("button",{onClick:()=>n(a.path),className:`relative w-full flex items-center gap-3 px-4 h-11 rounded-xl transition-colors
          ${o?"bg-primary text-primary-foreground":"hover:bg-muted/50 text-muted-foreground hover:text-foreground"}`,children:[t.jsx(a.icon,{className:"w-5 h-5"}),t.jsx("span",{className:"text-sm font-medium",children:a.label})]})};return t.jsx("nav",{className:"px-4",children:t.jsx("ul",{className:"space-y-1",children:e.map(a=>t.jsx("li",{children:t.jsx(r,{...a})},a.path))})})},af=({onLogout:e})=>t.jsxs("button",{onClick:e,className:"w-full flex items-center justify-center gap-2 px-4 h-11 rounded-xl text-destructive border border-destructive/30 bg-destructive/5 hover:bg-destructive/10 transition-colors",title:"Wyloguj",children:[t.jsx(El,{className:"w-5 h-5"}),t.jsx("span",{className:"text-sm font-semibold",children:"Wyloguj"})]}),Jz=({level:e,points:s})=>{const n=Math.max(0,Math.min(100,s%100));return t.jsx("section",{className:"px-6",children:t.jsxs("div",{className:"px-2",children:[t.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-2",children:[t.jsxs("span",{children:["Poziom ",e]}),t.jsxs("span",{children:["Poziom ",e+1]})]}),t.jsx("div",{className:"h-1.5 rounded-full bg-muted overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-primary via-secondary to-accent",style:{width:`${n}%`}})})]})})},Xz=({identity:e,stats:s,menuItems:n,currentPath:i,onNavigate:r,onLogout:a})=>t.jsxs(t.Fragment,{children:[t.jsx(Zz,{}),t.jsx(sf,{name:e?.full_name,level:s.level,streak:s.streak}),t.jsx(nf,{points:s.points,idle:s.idle_rate,streak:s.streak}),t.jsx(rf,{items:n,current:i,onNavigate:r}),t.jsxs("footer",{className:"mt-auto p-4 border-t space-y-3",children:[t.jsx(Jz,{level:s.level,points:s.points}),t.jsx(af,{onLogout:a})]})]}),qd=({variant:e,open:s=!1,onClose:n,identity:i,stats:r,menuItems:a,currentPath:o,onNavigate:l,onLogout:c})=>e==="desktop"?t.jsx("aside",{className:"hidden lg:flex fixed inset-y-0 left-0 w-72 bg-card/95 backdrop-blur border-r flex-col",children:t.jsx(Xz,{identity:i,stats:r,menuItems:a,currentPath:o,onNavigate:l,onLogout:c})}):s?t.jsxs(t.Fragment,{children:[t.jsx("button",{type:"button","aria-label":"Zamknij menu",onClick:n,className:"lg:hidden fixed inset-0 bg-black/30 backdrop-blur-sm z-40"}),t.jsxs("aside",{className:"lg:hidden fixed inset-y-0 left-0 w-80 bg-card/95 backdrop-blur-xl z-50 shadow-2xl border-r flex flex-col","aria-label":"Nawigacja boczna",children:[t.jsxs("header",{className:"h-16 px-6 border-b flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-secondary text-white grid place-items-center",children:t.jsx(As,{className:"w-5 h-5"})}),t.jsx("strong",{className:"text-lg",children:"Smart Up"})]}),t.jsx("button",{onClick:n,className:"p-2 rounded-lg hover:bg-muted focus-ring","aria-label":"Zamknij",children:t.jsx("svg",{viewBox:"0 0 24 24",className:"w-5 h-5 text-muted-foreground",children:t.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]}),t.jsxs("section",{className:"overflow-y-auto",children:[t.jsx(sf,{name:i?.full_name,level:r.level,streak:r.streak}),t.jsx(nf,{points:r.points,idle:r.idle_rate,streak:r.streak}),t.jsx(rf,{items:a,current:o,onNavigate:d=>{l(d),n?.()}})]}),t.jsx("footer",{className:"mt-auto p-4 border-t",children:t.jsx(af,{onLogout:c})})]})]}):null,e1=()=>{const e=()=>{const i=localStorage.getItem("theme");return i==="light"||i==="dark"?i:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},[s,n]=x.useState(e);return G.useEffect(()=>{document.documentElement.classList.toggle("dark",s==="dark"),localStorage.setItem("theme",s)},[s]),{theme:s,toggle:()=>n(i=>i==="dark"?"light":"dark")}},t1=({identity:e,stats:s,menuItems:n,currentPath:i,onNavigate:r,onLogout:a,onOpenSidebar:o})=>{const{theme:l,toggle:c}=e1(),[d,m]=x.useState(!1),u=x.useMemo(()=>n.find(p=>p.path===i)?.label||"Dashboard",[n,i]),h=x.useMemo(()=>[{label:"Profil",icon:Mi,action:()=>r("/student/profile")},{label:"Ustawienia",icon:sj,action:()=>r("/student/settings")},{label:"Pomoc",icon:st,action:()=>r("/student/help")},{label:l==="dark"?"Tryb jasny":"Tryb ciemny",icon:l==="dark"?nj:ij,action:()=>c()},{label:"Wyloguj",icon:El,action:()=>a(),danger:!0}],[r,a,l,c]);return t.jsx("header",{className:"sticky top-0 z-30 h-16 bg-card/80 backdrop-blur supports-[backdrop-filter]:bg-card/60 border-b shadow-sm",children:t.jsxs("div",{className:"mx-auto max-w-6xl h-full px-4 lg:px-8 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("button",{onClick:o,className:"lg:hidden p-2.5 rounded-xl hover:bg-muted focus-ring","aria-label":"Otwórz menu",children:t.jsx(Pl,{className:"w-5 h-5"})}),t.jsxs("div",{className:"hidden lg:block min-w-0",children:[t.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:u}),t.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["Witaj, ",e?.full_name?.split(" ")[0],"!"]})]})]}),t.jsxs("div",{className:"flex items-center gap-2 lg:gap-3",children:[t.jsxs("button",{className:"relative p-2.5 rounded-xl hover:bg-muted focus-ring h-11 w-11 grid place-items-center","aria-label":"Powiadomienia",children:[t.jsx(Jm,{className:"w-5 h-5 text-muted-foreground"}),t.jsx("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-destructive rounded-full"})]}),t.jsxs("div",{className:"flex items-center gap-2 px-3 lg:px-4 h-11 rounded-xl border bg-primary/10 border-primary/20",children:[t.jsx(It,{className:"w-4 h-4 text-primary"}),t.jsx("span",{className:"font-semibold text-sm lg:text-base tabular-nums",children:s.points}),t.jsxs("span",{className:"hidden md:block text-xs text-primary",children:["+",s.idle_rate,"/h"]})]}),t.jsxs("div",{className:"relative",children:[t.jsxs("button",{onClick:()=>m(p=>!p),className:"flex items-center gap-2 px-1.5 h-11 rounded-xl hover:bg-muted focus-ring","aria-haspopup":"menu","aria-expanded":d,children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-9 h-9 lg:w-10 lg:h-10 rounded-xl bg-gradient-to-br from-primary to-secondary text-white grid place-items-center font-bold",children:e?.full_name?.charAt(0)||"U"}),t.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-4 h-4 lg:w-5 lg:h-5 rounded-full bg-accent text-white text-[10px] lg:text-xs grid place-items-center border-2 border-card",children:s.level})]}),t.jsx(ga,{className:"w-4 h-4 text-muted-foreground"})]}),d&&t.jsxs("menu",{className:"absolute right-0 mt-2 w-64 bg-card rounded-xl border shadow-soft-lg z-50 overflow-hidden",children:[t.jsxs("section",{className:"p-4 border-b",children:[t.jsx("p",{className:"font-semibold truncate",children:e?.full_name}),t.jsx("p",{className:"text-sm text-muted-foreground truncate",children:e?.email})]}),t.jsx("ul",{className:"p-2",children:h.map((p,g)=>t.jsx("li",{children:t.jsxs("button",{onClick:()=>{p.action(),m(!1)},className:`w-full flex items-center gap-3 px-3 h-11 rounded-lg ${p.danger?"text-destructive hover:bg-destructive/10":"text-foreground/80 hover:text-foreground hover:bg-muted"}`,role:"menuitem",children:[t.jsx(p.icon,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm font-medium",children:p.label})]})},g))})]})]})]})]})})},s1=({menuItems:e,currentPath:s,onNavigate:n})=>{const i=r=>s===r;return t.jsx("nav",{"aria-label":"Główna nawigacja dolna",className:"fixed bottom-0 z-40 left-0 right-0 lg:left-72 bg-card/80 backdrop-blur supports-[backdrop-filter]:bg-card/60 border-t shadow-sm",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:t.jsx("div",{className:"mx-auto max-w-6xl p-1.5 sm:px-4",children:t.jsx("ul",{className:"grid grid-cols-5 gap-1 p-1",children:e.map(r=>{const a=i(r.path);return t.jsx("li",{children:t.jsxs("button",{onClick:()=>n(r.path),className:`relative flex flex-col items-center justify-center gap-1 rounded-lg p-4 transition-colors ${a?"text-primary":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}`,"aria-current":a?"page":void 0,children:[t.jsx(r.icon,{className:"h-5 w-5"}),t.jsx("span",{className:"text-[11px] font-medium",children:r.label}),a&&t.jsx("i",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-6 -bottom-[3px] h-1 rounded-full bg-primary/70"})]})},r.path)})})})})},n1=()=>t.jsx("div",{"aria-hidden":!0,className:"opacity-50  pointer-events-none fixed inset-0 z-0 overflow-hidden p-0 lg:p-4 lg:pb-28 pt-0",children:t.jsxs("div",{className:"relative w-full h-full",children:[t.jsx("div",{className:"absolute inset-0 bg-white rounded-3xl"}),t.jsxs("div",{className:"absolute inset-0 rounded-3xl",style:{WebkitMaskImage:"linear-gradient(to bottom, transparent 0%, transparent 50%, black 70%)",maskImage:"linear-gradient(to bottom, transparent 0%, transparent 50%, black 70%)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskSize:"cover",maskSize:"cover"},children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-400 via-yellow-300 to-purple-500 opacity-50 rounded-3xl"}),t.jsx("div",{className:"absolute w-[60vw] h-[60vw] top-1/2 -left-1/4 bg-orange-400 rounded-full mix-blend-multiply blur-[220px] opacity-40 animate-pulse"}),t.jsx("div",{className:"absolute w-[50vw] h-[50vw] top-[65%] left-1/2 bg-yellow-300 rounded-full mix-blend-multiply blur-[220px] opacity-40 animate-pulse"}),t.jsx("div",{className:"absolute w-[55vw] h-[55vw] top-[75%] -right-1/4 bg-purple-500 rounded-full mix-blend-multiply blur-[220px] opacity-40 animate-pulse"})]})]})}),i1=({children:e})=>{const[s,n]=x.useState(!1),{data:i}=Tt(),{mutate:r}=Wm(),a=Z(),o=wl(),{stats:l}=Pa(),c=x.useMemo(()=>[{path:"/student/dashboard",label:"Główna",icon:Zm},{path:"/student/gamification",label:"Ulepszenia",icon:Do},{path:"/student/leaderboard",label:"Ranking",icon:dt},{path:"/student/achievements",label:"Osiągnięcia",icon:Di},{path:"/student/profile",label:"Profil",icon:Mi}],[]);return t.jsxs("div",{className:"min-h-screen bg-background relative select-none",children:[t.jsx(n1,{}),t.jsx(qd,{variant:"desktop",identity:i,stats:l,menuItems:c,currentPath:o.pathname,onNavigate:a,onLogout:()=>r()}),t.jsxs("main",{className:"relative lg:ml-72",children:[t.jsx(t1,{identity:i,stats:l,menuItems:c,currentPath:o.pathname,onNavigate:a,onLogout:()=>r(),onOpenSidebar:()=>n(!0)}),t.jsx("section",{className:"min-h-[calc(100vh-4rem)] pb-[104px] sm:pb-[112px] lg:pb-[120px]",children:e})]}),t.jsx(qd,{variant:"mobile",open:s,onClose:()=>n(!1),identity:i,stats:l,menuItems:c,currentPath:o.pathname,onNavigate:a,onLogout:()=>r()}),t.jsx(s1,{menuItems:c,currentPath:o.pathname,onNavigate:a})]})},ec=x.createContext({});function tc(e){const s=x.useRef(null);return s.current===null&&(s.current=e()),s.current}const sc=typeof window<"u",of=sc?x.useLayoutEffect:x.useEffect,Ea=x.createContext(null);function nc(e,s){e.indexOf(s)===-1&&e.push(s)}function ic(e,s){const n=e.indexOf(s);n>-1&&e.splice(n,1)}const us=(e,s,n)=>n>s?s:n<e?e:n;let rc=()=>{};const ms={},lf=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function cf(e){return typeof e=="object"&&e!==null}const df=e=>/^0[^.\s]+$/u.test(e);function ac(e){let s;return()=>(s===void 0&&(s=e()),s)}const kt=e=>e,r1=(e,s)=>n=>s(e(n)),xr=(...e)=>e.reduce(r1),Bi=(e,s,n)=>{const i=s-e;return i===0?1:(n-e)/i};class oc{constructor(){this.subscriptions=[]}add(s){return nc(this.subscriptions,s),()=>ic(this.subscriptions,s)}notify(s,n,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](s,n,i);else for(let a=0;a<r;a++){const o=this.subscriptions[a];o&&o(s,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Wt=e=>e*1e3,Kt=e=>e/1e3;function uf(e,s){return s?e*(1e3/s):0}const mf=(e,s,n)=>(((1-3*n+3*s)*e+(3*n-6*s))*e+3*s)*e,a1=1e-7,o1=12;function l1(e,s,n,i,r){let a,o,l=0;do o=s+(n-s)/2,a=mf(o,i,r)-e,a>0?n=o:s=o;while(Math.abs(a)>a1&&++l<o1);return o}function gr(e,s,n,i){if(e===s&&n===i)return kt;const r=a=>l1(a,0,1,e,n);return a=>a===0||a===1?a:mf(r(a),s,i)}const hf=e=>s=>s<=.5?e(2*s)/2:(2-e(2*(1-s)))/2,pf=e=>s=>1-e(1-s),ff=gr(.33,1.53,.69,.99),lc=pf(ff),xf=hf(lc),gf=e=>(e*=2)<1?.5*lc(e):.5*(2-Math.pow(2,-10*(e-1))),cc=e=>1-Math.sin(Math.acos(e)),yf=pf(cc),jf=hf(cc),c1=gr(.42,0,1,1),d1=gr(0,0,.58,1),bf=gr(.42,0,.58,1),u1=e=>Array.isArray(e)&&typeof e[0]!="number",wf=e=>Array.isArray(e)&&typeof e[0]=="number",m1={linear:kt,easeIn:c1,easeInOut:bf,easeOut:d1,circIn:cc,circInOut:jf,circOut:yf,backIn:lc,backInOut:xf,backOut:ff,anticipate:gf},h1=e=>typeof e=="string",Vd=e=>{if(wf(e)){rc(e.length===4);const[s,n,i,r]=e;return gr(s,n,i,r)}else if(h1(e))return m1[e];return e},Pr=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function p1(e,s){let n=new Set,i=new Set,r=!1,a=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(m){o.has(m)&&(d.schedule(m),e()),m(l)}const d={schedule:(m,u=!1,h=!1)=>{const g=h&&r?n:i;return u&&o.add(m),g.has(m)||g.add(m),m},cancel:m=>{i.delete(m),o.delete(m)},process:m=>{if(l=m,r){a=!0;return}r=!0,[n,i]=[i,n],n.forEach(c),n.clear(),r=!1,a&&(a=!1,d.process(m))}};return d}const f1=40;function vf(e,s){let n=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,o=Pr.reduce((w,S)=>(w[S]=p1(a),w),{}),{setup:l,read:c,resolveKeyframes:d,preUpdate:m,update:u,preRender:h,render:p,postRender:g}=o,f=()=>{const w=ms.useManualTiming?r.timestamp:performance.now();n=!1,ms.useManualTiming||(r.delta=i?1e3/60:Math.max(Math.min(w-r.timestamp,f1),1)),r.timestamp=w,r.isProcessing=!0,l.process(r),c.process(r),d.process(r),m.process(r),u.process(r),h.process(r),p.process(r),g.process(r),r.isProcessing=!1,n&&s&&(i=!1,e(f))},y=()=>{n=!0,i=!0,r.isProcessing||e(f)};return{schedule:Pr.reduce((w,S)=>{const k=o[S];return w[S]=(z,N=!1,C=!1)=>(n||y(),k.schedule(z,N,C)),w},{}),cancel:w=>{for(let S=0;S<Pr.length;S++)o[Pr[S]].cancel(w)},state:r,steps:o}}const{schedule:de,cancel:_s,state:Fe,steps:co}=vf(typeof requestAnimationFrame<"u"?requestAnimationFrame:kt,!0);let qr;function x1(){qr=void 0}const tt={now:()=>(qr===void 0&&tt.set(Fe.isProcessing||ms.useManualTiming?Fe.timestamp:performance.now()),qr),set:e=>{qr=e,queueMicrotask(x1)}},Nf=e=>s=>typeof s=="string"&&s.startsWith(e),dc=Nf("--"),g1=Nf("var(--"),uc=e=>g1(e)?y1.test(e.split("/*")[0].trim()):!1,y1=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Jn={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ui={...Jn,transform:e=>us(0,1,e)},Er={...Jn,default:1},zi=e=>Math.round(e*1e5)/1e5,mc=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function j1(e){return e==null}const b1=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,hc=(e,s)=>n=>!!(typeof n=="string"&&b1.test(n)&&n.startsWith(e)||s&&!j1(n)&&Object.prototype.hasOwnProperty.call(n,s)),kf=(e,s,n)=>i=>{if(typeof i!="string")return i;const[r,a,o,l]=i.match(mc);return{[e]:parseFloat(r),[s]:parseFloat(a),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},w1=e=>us(0,255,e),uo={...Jn,transform:e=>Math.round(w1(e))},Vs={test:hc("rgb","red"),parse:kf("red","green","blue"),transform:({red:e,green:s,blue:n,alpha:i=1})=>"rgba("+uo.transform(e)+", "+uo.transform(s)+", "+uo.transform(n)+", "+zi(Ui.transform(i))+")"};function v1(e){let s="",n="",i="",r="";return e.length>5?(s=e.substring(1,3),n=e.substring(3,5),i=e.substring(5,7),r=e.substring(7,9)):(s=e.substring(1,2),n=e.substring(2,3),i=e.substring(3,4),r=e.substring(4,5),s+=s,n+=n,i+=i,r+=r),{red:parseInt(s,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const Ko={test:hc("#"),parse:v1,transform:Vs.transform},yr=e=>({test:s=>typeof s=="string"&&s.endsWith(e)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${e}`}),bs=yr("deg"),Gt=yr("%"),K=yr("px"),N1=yr("vh"),k1=yr("vw"),Bd={...Gt,parse:e=>Gt.parse(e)/100,transform:e=>Gt.transform(e*100)},yn={test:hc("hsl","hue"),parse:kf("hue","saturation","lightness"),transform:({hue:e,saturation:s,lightness:n,alpha:i=1})=>"hsla("+Math.round(e)+", "+Gt.transform(zi(s))+", "+Gt.transform(zi(n))+", "+zi(Ui.transform(i))+")"},ke={test:e=>Vs.test(e)||Ko.test(e)||yn.test(e),parse:e=>Vs.test(e)?Vs.parse(e):yn.test(e)?yn.parse(e):Ko.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Vs.transform(e):yn.transform(e),getAnimatableNone:e=>{const s=ke.parse(e);return s.alpha=0,ke.transform(s)}},z1=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function S1(e){return isNaN(e)&&typeof e=="string"&&(e.match(mc)?.length||0)+(e.match(z1)?.length||0)>0}const zf="number",Sf="color",C1="var",T1="var(",Ud="${}",A1=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Wi(e){const s=e.toString(),n=[],i={color:[],number:[],var:[]},r=[];let a=0;const l=s.replace(A1,c=>(ke.test(c)?(i.color.push(a),r.push(Sf),n.push(ke.parse(c))):c.startsWith(T1)?(i.var.push(a),r.push(C1),n.push(c)):(i.number.push(a),r.push(zf),n.push(parseFloat(c))),++a,Ud)).split(Ud);return{values:n,split:l,indexes:i,types:r}}function Cf(e){return Wi(e).values}function Tf(e){const{split:s,types:n}=Wi(e),i=s.length;return r=>{let a="";for(let o=0;o<i;o++)if(a+=s[o],r[o]!==void 0){const l=n[o];l===zf?a+=zi(r[o]):l===Sf?a+=ke.transform(r[o]):a+=r[o]}return a}}const P1=e=>typeof e=="number"?0:ke.test(e)?ke.getAnimatableNone(e):e;function E1(e){const s=Cf(e);return Tf(e)(s.map(P1))}const Is={test:S1,parse:Cf,createTransformer:Tf,getAnimatableNone:E1};function mo(e,s,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(s-e)*6*n:n<1/2?s:n<2/3?e+(s-e)*(2/3-n)*6:e}function D1({hue:e,saturation:s,lightness:n,alpha:i}){e/=360,s/=100,n/=100;let r=0,a=0,o=0;if(!s)r=a=o=n;else{const l=n<.5?n*(1+s):n+s-n*s,c=2*n-l;r=mo(c,l,e+1/3),a=mo(c,l,e),o=mo(c,l,e-1/3)}return{red:Math.round(r*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:i}}function ia(e,s){return n=>n>0?s:e}const he=(e,s,n)=>e+(s-e)*n,ho=(e,s,n)=>{const i=e*e,r=n*(s*s-i)+i;return r<0?0:Math.sqrt(r)},_1=[Ko,Vs,yn],I1=e=>_1.find(s=>s.test(e));function Wd(e){const s=I1(e);if(!s)return!1;let n=s.parse(e);return s===yn&&(n=D1(n)),n}const Kd=(e,s)=>{const n=Wd(e),i=Wd(s);if(!n||!i)return ia(e,s);const r={...n};return a=>(r.red=ho(n.red,i.red,a),r.green=ho(n.green,i.green,a),r.blue=ho(n.blue,i.blue,a),r.alpha=he(n.alpha,i.alpha,a),Vs.transform(r))},Go=new Set(["none","hidden"]);function M1(e,s){return Go.has(e)?n=>n<=0?e:s:n=>n>=1?s:e}function L1(e,s){return n=>he(e,s,n)}function pc(e){return typeof e=="number"?L1:typeof e=="string"?uc(e)?ia:ke.test(e)?Kd:F1:Array.isArray(e)?Af:typeof e=="object"?ke.test(e)?Kd:O1:ia}function Af(e,s){const n=[...e],i=n.length,r=e.map((a,o)=>pc(a)(a,s[o]));return a=>{for(let o=0;o<i;o++)n[o]=r[o](a);return n}}function O1(e,s){const n={...e,...s},i={};for(const r in n)e[r]!==void 0&&s[r]!==void 0&&(i[r]=pc(e[r])(e[r],s[r]));return r=>{for(const a in i)n[a]=i[a](r);return n}}function R1(e,s){const n=[],i={color:0,var:0,number:0};for(let r=0;r<s.values.length;r++){const a=s.types[r],o=e.indexes[a][i[a]],l=e.values[o]??0;n[r]=l,i[a]++}return n}const F1=(e,s)=>{const n=Is.createTransformer(s),i=Wi(e),r=Wi(s);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?Go.has(e)&&!r.values.length||Go.has(s)&&!i.values.length?M1(e,s):xr(Af(R1(i,r),r.values),n):ia(e,s)};function Pf(e,s,n){return typeof e=="number"&&typeof s=="number"&&typeof n=="number"?he(e,s,n):pc(e)(e,s)}const $1=e=>{const s=({timestamp:n})=>e(n);return{start:(n=!0)=>de.update(s,n),stop:()=>_s(s),now:()=>Fe.isProcessing?Fe.timestamp:tt.now()}},Ef=(e,s,n=10)=>{let i="";const r=Math.max(Math.round(s/n),2);for(let a=0;a<r;a++)i+=Math.round(e(a/(r-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},ra=2e4;function fc(e){let s=0;const n=50;let i=e.next(s);for(;!i.done&&s<ra;)s+=n,i=e.next(s);return s>=ra?1/0:s}function q1(e,s=100,n){const i=n({...e,keyframes:[0,s]}),r=Math.min(fc(i),ra);return{type:"keyframes",ease:a=>i.next(r*a).value/s,duration:Kt(r)}}const V1=5;function Df(e,s,n){const i=Math.max(s-V1,0);return uf(n-e(i),s-i)}const ge={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},po=.001;function B1({duration:e=ge.duration,bounce:s=ge.bounce,velocity:n=ge.velocity,mass:i=ge.mass}){let r,a,o=1-s;o=us(ge.minDamping,ge.maxDamping,o),e=us(ge.minDuration,ge.maxDuration,Kt(e)),o<1?(r=d=>{const m=d*o,u=m*e,h=m-n,p=Ho(d,o),g=Math.exp(-u);return po-h/p*g},a=d=>{const u=d*o*e,h=u*n+n,p=Math.pow(o,2)*Math.pow(d,2)*e,g=Math.exp(-u),f=Ho(Math.pow(d,2),o);return(-r(d)+po>0?-1:1)*((h-p)*g)/f}):(r=d=>{const m=Math.exp(-d*e),u=(d-n)*e+1;return-po+m*u},a=d=>{const m=Math.exp(-d*e),u=(n-d)*(e*e);return m*u});const l=5/e,c=W1(r,a,l);if(e=Wt(e),isNaN(c))return{stiffness:ge.stiffness,damping:ge.damping,duration:e};{const d=Math.pow(c,2)*i;return{stiffness:d,damping:o*2*Math.sqrt(i*d),duration:e}}}const U1=12;function W1(e,s,n){let i=n;for(let r=1;r<U1;r++)i=i-e(i)/s(i);return i}function Ho(e,s){return e*Math.sqrt(1-s*s)}const K1=["duration","bounce"],G1=["stiffness","damping","mass"];function Gd(e,s){return s.some(n=>e[n]!==void 0)}function H1(e){let s={velocity:ge.velocity,stiffness:ge.stiffness,damping:ge.damping,mass:ge.mass,isResolvedFromDuration:!1,...e};if(!Gd(e,G1)&&Gd(e,K1))if(e.visualDuration){const n=e.visualDuration,i=2*Math.PI/(n*1.2),r=i*i,a=2*us(.05,1,1-(e.bounce||0))*Math.sqrt(r);s={...s,mass:ge.mass,stiffness:r,damping:a}}else{const n=B1(e);s={...s,...n,mass:ge.mass},s.isResolvedFromDuration=!0}return s}function aa(e=ge.visualDuration,s=ge.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:s}:e;let{restSpeed:i,restDelta:r}=n;const a=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],l={done:!1,value:a},{stiffness:c,damping:d,mass:m,duration:u,velocity:h,isResolvedFromDuration:p}=H1({...n,velocity:-Kt(n.velocity||0)}),g=h||0,f=d/(2*Math.sqrt(c*m)),y=o-a,b=Kt(Math.sqrt(c/m)),j=Math.abs(y)<5;i||(i=j?ge.restSpeed.granular:ge.restSpeed.default),r||(r=j?ge.restDelta.granular:ge.restDelta.default);let w;if(f<1){const k=Ho(b,f);w=z=>{const N=Math.exp(-f*b*z);return o-N*((g+f*b*y)/k*Math.sin(k*z)+y*Math.cos(k*z))}}else if(f===1)w=k=>o-Math.exp(-b*k)*(y+(g+b*y)*k);else{const k=b*Math.sqrt(f*f-1);w=z=>{const N=Math.exp(-f*b*z),C=Math.min(k*z,300);return o-N*((g+f*b*y)*Math.sinh(C)+k*y*Math.cosh(C))/k}}const S={calculatedDuration:p&&u||null,next:k=>{const z=w(k);if(p)l.done=k>=u;else{let N=k===0?g:0;f<1&&(N=k===0?Wt(g):Df(w,k,z));const C=Math.abs(N)<=i,A=Math.abs(o-z)<=r;l.done=C&&A}return l.value=l.done?o:z,l},toString:()=>{const k=Math.min(fc(S),ra),z=Ef(N=>S.next(k*N).value,k,30);return k+"ms "+z},toTransition:()=>{}};return S}aa.applyToOptions=e=>{const s=q1(e,100,aa);return e.ease=s.ease,e.duration=Wt(s.duration),e.type="keyframes",e};function Qo({keyframes:e,velocity:s=0,power:n=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:a=500,modifyTarget:o,min:l,max:c,restDelta:d=.5,restSpeed:m}){const u=e[0],h={done:!1,value:u},p=C=>l!==void 0&&C<l||c!==void 0&&C>c,g=C=>l===void 0?c:c===void 0||Math.abs(l-C)<Math.abs(c-C)?l:c;let f=n*s;const y=u+f,b=o===void 0?y:o(y);b!==y&&(f=b-u);const j=C=>-f*Math.exp(-C/i),w=C=>b+j(C),S=C=>{const A=j(C),v=w(C);h.done=Math.abs(A)<=d,h.value=h.done?b:v};let k,z;const N=C=>{p(h.value)&&(k=C,z=aa({keyframes:[h.value,g(h.value)],velocity:Df(w,C,h.value),damping:r,stiffness:a,restDelta:d,restSpeed:m}))};return N(0),{calculatedDuration:null,next:C=>{let A=!1;return!z&&k===void 0&&(A=!0,S(C),N(C)),k!==void 0&&C>=k?z.next(C-k):(!A&&S(C),h)}}}function Q1(e,s,n){const i=[],r=n||ms.mix||Pf,a=e.length-1;for(let o=0;o<a;o++){let l=r(e[o],e[o+1]);if(s){const c=Array.isArray(s)?s[o]||kt:s;l=xr(c,l)}i.push(l)}return i}function Y1(e,s,{clamp:n=!0,ease:i,mixer:r}={}){const a=e.length;if(rc(a===s.length),a===1)return()=>s[0];if(a===2&&s[0]===s[1])return()=>s[1];const o=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),s=[...s].reverse());const l=Q1(s,i,r),c=l.length,d=m=>{if(o&&m<e[0])return s[0];let u=0;if(c>1)for(;u<e.length-2&&!(m<e[u+1]);u++);const h=Bi(e[u],e[u+1],m);return l[u](h)};return n?m=>d(us(e[0],e[a-1],m)):d}function Z1(e,s){const n=e[e.length-1];for(let i=1;i<=s;i++){const r=Bi(0,s,i);e.push(he(n,1,r))}}function J1(e){const s=[0];return Z1(s,e.length-1),s}function X1(e,s){return e.map(n=>n*s)}function eS(e,s){return e.map(()=>s||bf).splice(0,e.length-1)}function Si({duration:e=300,keyframes:s,times:n,ease:i="easeInOut"}){const r=u1(i)?i.map(Vd):Vd(i),a={done:!1,value:s[0]},o=X1(n&&n.length===s.length?n:J1(s),e),l=Y1(o,s,{ease:Array.isArray(r)?r:eS(s,r)});return{calculatedDuration:e,next:c=>(a.value=l(c),a.done=c>=e,a)}}const tS=e=>e!==null;function xc(e,{repeat:s,repeatType:n="loop"},i,r=1){const a=e.filter(tS),l=r<0||s&&n!=="loop"&&s%2===1?0:a.length-1;return!l||i===void 0?a[l]:i}const sS={decay:Qo,inertia:Qo,tween:Si,keyframes:Si,spring:aa};function _f(e){typeof e.type=="string"&&(e.type=sS[e.type])}class gc{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(s=>{this.resolve=s})}notifyFinished(){this.resolve()}then(s,n){return this.finished.then(s,n)}}const nS=e=>e/100;class yc extends gc{constructor(s){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==tt.now()&&this.tick(tt.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=s,this.initAnimation(),this.play(),s.autoplay===!1&&this.pause()}initAnimation(){const{options:s}=this;_f(s);const{type:n=Si,repeat:i=0,repeatDelay:r=0,repeatType:a,velocity:o=0}=s;let{keyframes:l}=s;const c=n||Si;c!==Si&&typeof l[0]!="number"&&(this.mixKeyframes=xr(nS,Pf(l[0],l[1])),l=[0,100]);const d=c({...s,keyframes:l});a==="mirror"&&(this.mirroredGenerator=c({...s,keyframes:[...l].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=fc(d));const{calculatedDuration:m}=d;this.calculatedDuration=m,this.resolvedDuration=m+r,this.totalDuration=this.resolvedDuration*(i+1)-r,this.generator=d}updateTime(s){const n=Math.round(s-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(s,n=!1){const{generator:i,totalDuration:r,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return i.next(0);const{delay:d=0,keyframes:m,repeat:u,repeatType:h,repeatDelay:p,type:g,onUpdate:f,finalKeyframe:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-r/this.speed,this.startTime)),n?this.currentTime=s:this.updateTime(s);const b=this.currentTime-d*(this.playbackSpeed>=0?1:-1),j=this.playbackSpeed>=0?b<0:b>r;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let w=this.currentTime,S=i;if(u){const C=Math.min(this.currentTime,r)/l;let A=Math.floor(C),v=C%1;!v&&C>=1&&(v=1),v===1&&A--,A=Math.min(A,u+1),!!(A%2)&&(h==="reverse"?(v=1-v,p&&(v-=p/l)):h==="mirror"&&(S=o)),w=us(0,1,v)*l}const k=j?{done:!1,value:m[0]}:S.next(w);a&&(k.value=a(k.value));let{done:z}=k;!j&&c!==null&&(z=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const N=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&z);return N&&g!==Qo&&(k.value=xc(m,this.options,y,this.speed)),f&&f(k.value),N&&this.finish(),k}then(s,n){return this.finished.then(s,n)}get duration(){return Kt(this.calculatedDuration)}get time(){return Kt(this.currentTime)}set time(s){s=Wt(s),this.currentTime=s,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(s){this.updateTime(tt.now());const n=this.playbackSpeed!==s;this.playbackSpeed=s,n&&(this.time=Kt(this.currentTime))}play(){if(this.isStopped)return;const{driver:s=$1,startTime:n}=this.options;this.driver||(this.driver=s(r=>this.tick(r))),this.options.onPlay?.();const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=n??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(tt.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}attachTimeline(s){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),s.observe(this)}}function iS(e){for(let s=1;s<e.length;s++)e[s]??(e[s]=e[s-1])}const Bs=e=>e*180/Math.PI,Yo=e=>{const s=Bs(Math.atan2(e[1],e[0]));return Zo(s)},rS={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Yo,rotateZ:Yo,skewX:e=>Bs(Math.atan(e[1])),skewY:e=>Bs(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Zo=e=>(e=e%360,e<0&&(e+=360),e),Hd=Yo,Qd=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Yd=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),aS={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Qd,scaleY:Yd,scale:e=>(Qd(e)+Yd(e))/2,rotateX:e=>Zo(Bs(Math.atan2(e[6],e[5]))),rotateY:e=>Zo(Bs(Math.atan2(-e[2],e[0]))),rotateZ:Hd,rotate:Hd,skewX:e=>Bs(Math.atan(e[4])),skewY:e=>Bs(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Jo(e){return e.includes("scale")?1:0}function Xo(e,s){if(!e||e==="none")return Jo(s);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,r;if(n)i=aS,r=n;else{const l=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=rS,r=l}if(!r)return Jo(s);const a=i[s],o=r[1].split(",").map(lS);return typeof a=="function"?a(o):o[a]}const oS=(e,s)=>{const{transform:n="none"}=getComputedStyle(e);return Xo(n,s)};function lS(e){return parseFloat(e.trim())}const Xn=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ei=new Set(Xn),Zd=e=>e===Jn||e===K,cS=new Set(["x","y","z"]),dS=Xn.filter(e=>!cS.has(e));function uS(e){const s=[];return dS.forEach(n=>{const i=e.getValue(n);i!==void 0&&(s.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),s}const Ys={width:({x:e},{paddingLeft:s="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(s)-parseFloat(n),height:({y:e},{paddingTop:s="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(s)-parseFloat(n),top:(e,{top:s})=>parseFloat(s),left:(e,{left:s})=>parseFloat(s),bottom:({y:e},{top:s})=>parseFloat(s)+(e.max-e.min),right:({x:e},{left:s})=>parseFloat(s)+(e.max-e.min),x:(e,{transform:s})=>Xo(s,"x"),y:(e,{transform:s})=>Xo(s,"y")};Ys.translateX=Ys.x;Ys.translateY=Ys.y;const Zs=new Set;let el=!1,tl=!1,sl=!1;function If(){if(tl){const e=Array.from(Zs).filter(i=>i.needsMeasurement),s=new Set(e.map(i=>i.element)),n=new Map;s.forEach(i=>{const r=uS(i);r.length&&(n.set(i,r),i.render())}),e.forEach(i=>i.measureInitialState()),s.forEach(i=>{i.render();const r=n.get(i);r&&r.forEach(([a,o])=>{i.getValue(a)?.set(o)})}),e.forEach(i=>i.measureEndState()),e.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}tl=!1,el=!1,Zs.forEach(e=>e.complete(sl)),Zs.clear()}function Mf(){Zs.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(tl=!0)})}function mS(){sl=!0,Mf(),If(),sl=!1}class jc{constructor(s,n,i,r,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...s],this.onComplete=n,this.name=i,this.motionValue=r,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Zs.add(this),el||(el=!0,de.read(Mf),de.resolveKeyframes(If))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:n,element:i,motionValue:r}=this;if(s[0]===null){const a=r?.get(),o=s[s.length-1];if(a!==void 0)s[0]=a;else if(i&&n){const l=i.readValue(n,o);l!=null&&(s[0]=l)}s[0]===void 0&&(s[0]=o),r&&a===void 0&&r.set(s[0])}iS(s)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(s=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,s),Zs.delete(this)}cancel(){this.state==="scheduled"&&(Zs.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const hS=e=>e.startsWith("--");function pS(e,s,n){hS(s)?e.style.setProperty(s,n):e.style[s]=n}const fS=ac(()=>window.ScrollTimeline!==void 0),xS={};function gS(e,s){const n=ac(e);return()=>xS[s]??n()}const Lf=gS(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),bi=([e,s,n,i])=>`cubic-bezier(${e}, ${s}, ${n}, ${i})`,Jd={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:bi([0,.65,.55,1]),circOut:bi([.55,0,1,.45]),backIn:bi([.31,.01,.66,-.59]),backOut:bi([.33,1.53,.69,.99])};function Of(e,s){if(e)return typeof e=="function"?Lf()?Ef(e,s):"ease-out":wf(e)?bi(e):Array.isArray(e)?e.map(n=>Of(n,s)||Jd.easeOut):Jd[e]}function yS(e,s,n,{delay:i=0,duration:r=300,repeat:a=0,repeatType:o="loop",ease:l="easeOut",times:c}={},d=void 0){const m={[s]:n};c&&(m.offset=c);const u=Of(l,r);Array.isArray(u)&&(m.easing=u);const h={delay:i,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(h.pseudoElement=d),e.animate(m,h)}function Rf(e){return typeof e=="function"&&"applyToOptions"in e}function jS({type:e,...s}){return Rf(e)&&Lf()?e.applyToOptions(s):(s.duration??(s.duration=300),s.ease??(s.ease="easeOut"),s)}class bS extends gc{constructor(s){if(super(),this.finishedTime=null,this.isStopped=!1,!s)return;const{element:n,name:i,keyframes:r,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:l,onComplete:c}=s;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=s,rc(typeof s.type!="string");const d=jS(s);this.animation=yS(n,i,r,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const m=xc(r,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(m):pS(n,i,m),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:s}=this;s==="idle"||s==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const s=this.animation.effect?.getComputedTiming?.().duration||0;return Kt(Number(s))}get time(){return Kt(Number(this.animation.currentTime)||0)}set time(s){this.finishedTime=null,this.animation.currentTime=Wt(s)}get speed(){return this.animation.playbackRate}set speed(s){s<0&&(this.finishedTime=null),this.animation.playbackRate=s}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(s){this.animation.startTime=s}attachTimeline({timeline:s,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,s&&fS()?(this.animation.timeline=s,kt):n(this)}}const Ff={anticipate:gf,backInOut:xf,circInOut:jf};function wS(e){return e in Ff}function vS(e){typeof e.ease=="string"&&wS(e.ease)&&(e.ease=Ff[e.ease])}const Xd=10;class NS extends bS{constructor(s){vS(s),_f(s),super(s),s.startTime&&(this.startTime=s.startTime),this.options=s}updateMotionValue(s){const{motionValue:n,onUpdate:i,onComplete:r,element:a,...o}=this.options;if(!n)return;if(s!==void 0){n.set(s);return}const l=new yc({...o,autoplay:!1}),c=Wt(this.finishedTime??this.time);n.setWithVelocity(l.sample(c-Xd).value,l.sample(c).value,Xd),l.stop()}}const eu=(e,s)=>s==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Is.test(e)||e==="0")&&!e.startsWith("url("));function kS(e){const s=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==s)return!0}function zS(e,s,n,i){const r=e[0];if(r===null)return!1;if(s==="display"||s==="visibility")return!0;const a=e[e.length-1],o=eu(r,s),l=eu(a,s);return!o||!l?!1:kS(e)||(n==="spring"||Rf(n))&&i}function nl(e){e.duration=0,e.type}const SS=new Set(["opacity","clipPath","filter","transform"]),CS=ac(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function TS(e){const{motionValue:s,name:n,repeatDelay:i,repeatType:r,damping:a,type:o}=e;if(!(s?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=s.owner.getProps();return CS()&&n&&SS.has(n)&&(n!=="transform"||!d)&&!c&&!i&&r!=="mirror"&&a!==0&&o!=="inertia"}const AS=40;class PS extends gc{constructor({autoplay:s=!0,delay:n=0,type:i="keyframes",repeat:r=0,repeatDelay:a=0,repeatType:o="loop",keyframes:l,name:c,motionValue:d,element:m,...u}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=tt.now();const h={autoplay:s,delay:n,type:i,repeat:r,repeatDelay:a,repeatType:o,name:c,motionValue:d,element:m,...u},p=m?.KeyframeResolver||jc;this.keyframeResolver=new p(l,(g,f,y)=>this.onKeyframesResolved(g,f,h,!y),c,d,m),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(s,n,i,r){this.keyframeResolver=void 0;const{name:a,type:o,velocity:l,delay:c,isHandoff:d,onUpdate:m}=i;this.resolvedAt=tt.now(),zS(s,a,o,l)||((ms.instantAnimations||!c)&&m?.(xc(s,i,n)),s[0]=s[s.length-1],nl(i),i.repeat=0);const h={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>AS?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...i,keyframes:s},p=!d&&TS(h)?new NS({...h,element:h.motionValue.owner.current}):new yc(h);p.finished.then(()=>this.notifyFinished()).catch(kt),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(s,n){return this.finished.finally(s).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),mS()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(s){this.animation.time=s}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(s){this.animation.speed=s}get startTime(){return this.animation.startTime}attachTimeline(s){return this._animation?this.stopTimeline=this.animation.attachTimeline(s):this.pendingTimeline=s,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const ES=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function DS(e){const s=ES.exec(e);if(!s)return[,];const[,n,i,r]=s;return[`--${n??i}`,r]}function $f(e,s,n=1){const[i,r]=DS(e);if(!i)return;const a=window.getComputedStyle(s).getPropertyValue(i);if(a){const o=a.trim();return lf(o)?parseFloat(o):o}return uc(r)?$f(r,s,n+1):r}function bc(e,s){return e?.[s]??e?.default??e}const qf=new Set(["width","height","top","left","right","bottom",...Xn]),_S={test:e=>e==="auto",parse:e=>e},Vf=e=>s=>s.test(e),Bf=[Jn,K,Gt,bs,k1,N1,_S],tu=e=>Bf.find(Vf(e));function IS(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||df(e):!0}const MS=new Set(["brightness","contrast","saturate","opacity"]);function LS(e){const[s,n]=e.slice(0,-1).split("(");if(s==="drop-shadow")return e;const[i]=n.match(mc)||[];if(!i)return e;const r=n.replace(i,"");let a=MS.has(s)?1:0;return i!==n&&(a*=100),s+"("+a+r+")"}const OS=/\b([a-z-]*)\(.*?\)/gu,il={...Is,getAnimatableNone:e=>{const s=e.match(OS);return s?s.map(LS).join(" "):e}},su={...Jn,transform:Math.round},RS={rotate:bs,rotateX:bs,rotateY:bs,rotateZ:bs,scale:Er,scaleX:Er,scaleY:Er,scaleZ:Er,skew:bs,skewX:bs,skewY:bs,distance:K,translateX:K,translateY:K,translateZ:K,x:K,y:K,z:K,perspective:K,transformPerspective:K,opacity:Ui,originX:Bd,originY:Bd,originZ:K},wc={borderWidth:K,borderTopWidth:K,borderRightWidth:K,borderBottomWidth:K,borderLeftWidth:K,borderRadius:K,radius:K,borderTopLeftRadius:K,borderTopRightRadius:K,borderBottomRightRadius:K,borderBottomLeftRadius:K,width:K,maxWidth:K,height:K,maxHeight:K,top:K,right:K,bottom:K,left:K,padding:K,paddingTop:K,paddingRight:K,paddingBottom:K,paddingLeft:K,margin:K,marginTop:K,marginRight:K,marginBottom:K,marginLeft:K,backgroundPositionX:K,backgroundPositionY:K,...RS,zIndex:su,fillOpacity:Ui,strokeOpacity:Ui,numOctaves:su},FS={...wc,color:ke,backgroundColor:ke,outlineColor:ke,fill:ke,stroke:ke,borderColor:ke,borderTopColor:ke,borderRightColor:ke,borderBottomColor:ke,borderLeftColor:ke,filter:il,WebkitFilter:il},Uf=e=>FS[e];function Wf(e,s){let n=Uf(e);return n!==il&&(n=Is),n.getAnimatableNone?n.getAnimatableNone(s):void 0}const $S=new Set(["auto","none","0"]);function qS(e,s,n){let i=0,r;for(;i<e.length&&!r;){const a=e[i];typeof a=="string"&&!$S.has(a)&&Wi(a).values.length&&(r=e[i]),i++}if(r&&n)for(const a of s)e[a]=Wf(n,r)}class VS extends jc{constructor(s,n,i,r,a){super(s,n,i,r,a,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:n,name:i}=this;if(!n||!n.current)return;super.readKeyframes();for(let c=0;c<s.length;c++){let d=s[c];if(typeof d=="string"&&(d=d.trim(),uc(d))){const m=$f(d,n.current);m!==void 0&&(s[c]=m),c===s.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!qf.has(i)||s.length!==2)return;const[r,a]=s,o=tu(r),l=tu(a);if(o!==l)if(Zd(o)&&Zd(l))for(let c=0;c<s.length;c++){const d=s[c];typeof d=="string"&&(s[c]=parseFloat(d))}else Ys[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:n}=this,i=[];for(let r=0;r<s.length;r++)(s[r]===null||IS(s[r]))&&i.push(r);i.length&&qS(s,i,n)}measureInitialState(){const{element:s,unresolvedKeyframes:n,name:i}=this;if(!s||!s.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ys[i](s.measureViewportBox(),window.getComputedStyle(s.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&s.getValue(i,r).jump(r,!1)}measureEndState(){const{element:s,name:n,unresolvedKeyframes:i}=this;if(!s||!s.current)return;const r=s.getValue(n);r&&r.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=Ys[n](s.measureViewportBox(),window.getComputedStyle(s.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,c])=>{s.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function BS(e,s,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let i=document;const r=n?.[e]??i.querySelectorAll(e);return r?Array.from(r):[]}return Array.from(e)}const Kf=(e,s)=>s&&typeof e=="number"?s.transform(e):e;function Gf(e){return cf(e)&&"offsetHeight"in e}const nu=30,US=e=>!isNaN(parseFloat(e));class WS{constructor(s,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{const r=tt.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(s),this.owner=n.owner}setCurrent(s){this.current=s,this.updatedAt=tt.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=US(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,n){this.events[s]||(this.events[s]=new oc);const i=this.events[s].add(n);return s==="change"?()=>{i(),de.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,n){this.passiveEffect=s,this.stopPassiveEffect=n}set(s){this.passiveEffect?this.passiveEffect(s,this.updateAndNotify):this.updateAndNotify(s)}setWithVelocity(s,n,i){this.set(n),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-i}jump(s,n=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(s){this.dependents||(this.dependents=new Set),this.dependents.add(s)}removeDependent(s){this.dependents&&this.dependents.delete(s)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const s=tt.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>nu)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,nu);return uf(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(s){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=s(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Fn(e,s){return new WS(e,s)}const{schedule:vc}=vf(queueMicrotask,!1),Dt={x:!1,y:!1};function Hf(){return Dt.x||Dt.y}function KS(e){return e==="x"||e==="y"?Dt[e]?null:(Dt[e]=!0,()=>{Dt[e]=!1}):Dt.x||Dt.y?null:(Dt.x=Dt.y=!0,()=>{Dt.x=Dt.y=!1})}function Qf(e,s){const n=BS(e),i=new AbortController,r={passive:!0,...s,signal:i.signal};return[n,r,()=>i.abort()]}function iu(e){return!(e.pointerType==="touch"||Hf())}function GS(e,s,n={}){const[i,r,a]=Qf(e,n),o=l=>{if(!iu(l))return;const{target:c}=l,d=s(c,l);if(typeof d!="function"||!c)return;const m=u=>{iu(u)&&(d(u),c.removeEventListener("pointerleave",m))};c.addEventListener("pointerleave",m,r)};return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),a}const Yf=(e,s)=>s?e===s?!0:Yf(e,s.parentElement):!1,Nc=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,HS=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function QS(e){return HS.has(e.tagName)||e.tabIndex!==-1}const Vr=new WeakSet;function ru(e){return s=>{s.key==="Enter"&&e(s)}}function fo(e,s){e.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const YS=(e,s)=>{const n=e.currentTarget;if(!n)return;const i=ru(()=>{if(Vr.has(n))return;fo(n,"down");const r=ru(()=>{fo(n,"up")}),a=()=>fo(n,"cancel");n.addEventListener("keyup",r,s),n.addEventListener("blur",a,s)});n.addEventListener("keydown",i,s),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),s)};function au(e){return Nc(e)&&!Hf()}function ZS(e,s,n={}){const[i,r,a]=Qf(e,n),o=l=>{const c=l.currentTarget;if(!au(l))return;Vr.add(c);const d=s(c,l),m=(p,g)=>{window.removeEventListener("pointerup",u),window.removeEventListener("pointercancel",h),Vr.has(c)&&Vr.delete(c),au(p)&&typeof d=="function"&&d(p,{success:g})},u=p=>{m(p,c===window||c===document||n.useGlobalTarget||Yf(c,p.target))},h=p=>{m(p,!1)};window.addEventListener("pointerup",u,r),window.addEventListener("pointercancel",h,r)};return i.forEach(l=>{(n.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),Gf(l)&&(l.addEventListener("focus",d=>YS(d,r)),!QS(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),a}function Zf(e){return cf(e)&&"ownerSVGElement"in e}function JS(e){return Zf(e)&&e.tagName==="svg"}const We=e=>!!(e&&e.getVelocity),XS=[...Bf,ke,Is],eC=e=>XS.find(Vf(e)),kc=x.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class tC extends x.Component{getSnapshotBeforeUpdate(s){const n=this.props.childRef.current;if(n&&s.isPresent&&!this.props.isPresent){const i=n.offsetParent,r=Gf(i)&&i.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=r-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function sC({children:e,isPresent:s,anchorX:n,root:i}){const r=x.useId(),a=x.useRef(null),o=x.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=x.useContext(kc);return x.useInsertionEffect(()=>{const{width:c,height:d,top:m,left:u,right:h}=o.current;if(s||!a.current||!c||!d)return;const p=n==="left"?`left: ${u}`:`right: ${h}`;a.current.dataset.motionPopId=r;const g=document.createElement("style");l&&(g.nonce=l);const f=i??document.head;return f.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${d}px !important;
            ${p}px !important;
            top: ${m}px !important;
          }
        `),()=>{f.contains(g)&&f.removeChild(g)}},[s]),t.jsx(tC,{isPresent:s,childRef:a,sizeRef:o,children:x.cloneElement(e,{ref:a})})}const nC=({children:e,initial:s,isPresent:n,onExitComplete:i,custom:r,presenceAffectsLayout:a,mode:o,anchorX:l,root:c})=>{const d=tc(iC),m=x.useId();let u=!0,h=x.useMemo(()=>(u=!1,{id:m,initial:s,isPresent:n,custom:r,onExitComplete:p=>{d.set(p,!0);for(const g of d.values())if(!g)return;i&&i()},register:p=>(d.set(p,!1),()=>d.delete(p))}),[n,d,i]);return a&&u&&(h={...h}),x.useMemo(()=>{d.forEach((p,g)=>d.set(g,!1))},[n]),x.useEffect(()=>{!n&&!d.size&&i&&i()},[n]),o==="popLayout"&&(e=t.jsx(sC,{isPresent:n,anchorX:l,root:c,children:e})),t.jsx(Ea.Provider,{value:h,children:e})};function iC(){return new Map}function Jf(e=!0){const s=x.useContext(Ea);if(s===null)return[!0,null];const{isPresent:n,onExitComplete:i,register:r}=s,a=x.useId();x.useEffect(()=>{if(e)return r(a)},[e]);const o=x.useCallback(()=>e&&i&&i(a),[a,i,e]);return!n&&i?[!1,o]:[!0]}const Dr=e=>e.key||"";function ou(e){const s=[];return x.Children.forEach(e,n=>{x.isValidElement(n)&&s.push(n)}),s}const rC=({children:e,custom:s,initial:n=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:a="sync",propagate:o=!1,anchorX:l="left",root:c})=>{const[d,m]=Jf(o),u=x.useMemo(()=>ou(e),[e]),h=o&&!d?[]:u.map(Dr),p=x.useRef(!0),g=x.useRef(u),f=tc(()=>new Map),[y,b]=x.useState(u),[j,w]=x.useState(u);of(()=>{p.current=!1,g.current=u;for(let z=0;z<j.length;z++){const N=Dr(j[z]);h.includes(N)?f.delete(N):f.get(N)!==!0&&f.set(N,!1)}},[j,h.length,h.join("-")]);const S=[];if(u!==y){let z=[...u];for(let N=0;N<j.length;N++){const C=j[N],A=Dr(C);h.includes(A)||(z.splice(N,0,C),S.push(C))}return a==="wait"&&S.length&&(z=S),w(ou(z)),b(u),null}const{forceRender:k}=x.useContext(ec);return t.jsx(t.Fragment,{children:j.map(z=>{const N=Dr(z),C=o&&!d?!1:u===j||h.includes(N),A=()=>{if(f.has(N))f.set(N,!0);else return;let v=!0;f.forEach(P=>{P||(v=!1)}),v&&(k?.(),w(g.current),o&&m?.(),i&&i())};return t.jsx(nC,{isPresent:C,initial:!p.current||n?void 0:!1,custom:s,presenceAffectsLayout:r,mode:a,root:c,onExitComplete:C?void 0:A,anchorX:l,children:z},N)})})},Xf=x.createContext({strict:!1}),lu={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},$n={};for(const e in lu)$n[e]={isEnabled:s=>lu[e].some(n=>!!s[n])};function aC(e){for(const s in e)$n[s]={...$n[s],...e[s]}}const oC=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function oa(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||oC.has(e)}let ex=e=>!oa(e);function lC(e){typeof e=="function"&&(ex=s=>s.startsWith("on")?!oa(s):e(s))}try{lC(require("@emotion/is-prop-valid").default)}catch{}function cC(e,s,n){const i={};for(const r in e)r==="values"&&typeof e.values=="object"||(ex(r)||n===!0&&oa(r)||!s&&!oa(r)||e.draggable&&r.startsWith("onDrag"))&&(i[r]=e[r]);return i}const Da=x.createContext({});function _a(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Ki(e){return typeof e=="string"||Array.isArray(e)}const zc=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Sc=["initial",...zc];function Ia(e){return _a(e.animate)||Sc.some(s=>Ki(e[s]))}function tx(e){return!!(Ia(e)||e.variants)}function dC(e,s){if(Ia(e)){const{initial:n,animate:i}=e;return{initial:n===!1||Ki(n)?n:void 0,animate:Ki(i)?i:void 0}}return e.inherit!==!1?s:{}}function uC(e){const{initial:s,animate:n}=dC(e,x.useContext(Da));return x.useMemo(()=>({initial:s,animate:n}),[cu(s),cu(n)])}function cu(e){return Array.isArray(e)?e.join(" "):e}const Gi={};function mC(e){for(const s in e)Gi[s]=e[s],dc(s)&&(Gi[s].isCSSVariable=!0)}function sx(e,{layout:s,layoutId:n}){return ei.has(e)||e.startsWith("origin")||(s||n!==void 0)&&(!!Gi[e]||e==="opacity")}const hC={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},pC=Xn.length;function fC(e,s,n){let i="",r=!0;for(let a=0;a<pC;a++){const o=Xn[a],l=e[o];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(o.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||n){const d=Kf(l,wc[o]);if(!c){r=!1;const m=hC[o]||o;i+=`${m}(${d}) `}n&&(s[o]=d)}}return i=i.trim(),n?i=n(s,r?"":i):r&&(i="none"),i}function Cc(e,s,n){const{style:i,vars:r,transformOrigin:a}=e;let o=!1,l=!1;for(const c in s){const d=s[c];if(ei.has(c)){o=!0;continue}else if(dc(c)){r[c]=d;continue}else{const m=Kf(d,wc[c]);c.startsWith("origin")?(l=!0,a[c]=m):i[c]=m}}if(s.transform||(o||n?i.transform=fC(s,e.transform,n):i.transform&&(i.transform="none")),l){const{originX:c="50%",originY:d="50%",originZ:m=0}=a;i.transformOrigin=`${c} ${d} ${m}`}}const Tc=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function nx(e,s,n){for(const i in s)!We(s[i])&&!sx(i,n)&&(e[i]=s[i])}function xC({transformTemplate:e},s){return x.useMemo(()=>{const n=Tc();return Cc(n,s,e),Object.assign({},n.vars,n.style)},[s])}function gC(e,s){const n=e.style||{},i={};return nx(i,n,e),Object.assign(i,xC(e,s)),i}function yC(e,s){const n={},i=gC(e,s);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n}const jC={offset:"stroke-dashoffset",array:"stroke-dasharray"},bC={offset:"strokeDashoffset",array:"strokeDasharray"};function wC(e,s,n=1,i=0,r=!0){e.pathLength=1;const a=r?jC:bC;e[a.offset]=K.transform(-i);const o=K.transform(s),l=K.transform(n);e[a.array]=`${o} ${l}`}function ix(e,{attrX:s,attrY:n,attrScale:i,pathLength:r,pathSpacing:a=1,pathOffset:o=0,...l},c,d,m){if(Cc(e,l,d),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:u,style:h}=e;u.transform&&(h.transform=u.transform,delete u.transform),(h.transform||u.transformOrigin)&&(h.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),h.transform&&(h.transformBox=m?.transformBox??"fill-box",delete u.transformBox),s!==void 0&&(u.x=s),n!==void 0&&(u.y=n),i!==void 0&&(u.scale=i),r!==void 0&&wC(u,r,a,o,!1)}const rx=()=>({...Tc(),attrs:{}}),ax=e=>typeof e=="string"&&e.toLowerCase()==="svg";function vC(e,s,n,i){const r=x.useMemo(()=>{const a=rx();return ix(a,s,ax(i),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[s]);if(e.style){const a={};nx(a,e.style,e),r.style={...a,...r.style}}return r}const NC=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Ac(e){return typeof e!="string"||e.includes("-")?!1:!!(NC.indexOf(e)>-1||/[A-Z]/u.test(e))}function kC(e,s,n,{latestValues:i},r,a=!1){const l=(Ac(e)?vC:yC)(s,i,r,e),c=cC(s,typeof e=="string",a),d=e!==x.Fragment?{...c,...l,ref:n}:{},{children:m}=s,u=x.useMemo(()=>We(m)?m.get():m,[m]);return x.createElement(e,{...d,children:u})}function du(e){const s=[{},{}];return e?.values.forEach((n,i)=>{s[0][i]=n.get(),s[1][i]=n.getVelocity()}),s}function Pc(e,s,n,i){if(typeof s=="function"){const[r,a]=du(i);s=s(n!==void 0?n:e.custom,r,a)}if(typeof s=="string"&&(s=e.variants&&e.variants[s]),typeof s=="function"){const[r,a]=du(i);s=s(n!==void 0?n:e.custom,r,a)}return s}function Br(e){return We(e)?e.get():e}function zC({scrapeMotionValuesFromProps:e,createRenderState:s},n,i,r){return{latestValues:SC(n,i,r,e),renderState:s()}}function SC(e,s,n,i){const r={},a=i(e,{});for(const h in a)r[h]=Br(a[h]);let{initial:o,animate:l}=e;const c=Ia(e),d=tx(e);s&&d&&!c&&e.inherit!==!1&&(o===void 0&&(o=s.initial),l===void 0&&(l=s.animate));let m=n?n.initial===!1:!1;m=m||o===!1;const u=m?l:o;if(u&&typeof u!="boolean"&&!_a(u)){const h=Array.isArray(u)?u:[u];for(let p=0;p<h.length;p++){const g=Pc(e,h[p]);if(g){const{transitionEnd:f,transition:y,...b}=g;for(const j in b){let w=b[j];if(Array.isArray(w)){const S=m?w.length-1:0;w=w[S]}w!==null&&(r[j]=w)}for(const j in f)r[j]=f[j]}}}return r}const ox=e=>(s,n)=>{const i=x.useContext(Da),r=x.useContext(Ea),a=()=>zC(e,s,i,r);return n?a():tc(a)};function Ec(e,s,n){const{style:i}=e,r={};for(const a in i)(We(i[a])||s.style&&We(s.style[a])||sx(a,e)||n?.getValue(a)?.liveStyle!==void 0)&&(r[a]=i[a]);return r}const CC=ox({scrapeMotionValuesFromProps:Ec,createRenderState:Tc});function lx(e,s,n){const i=Ec(e,s,n);for(const r in e)if(We(e[r])||We(s[r])){const a=Xn.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[a]=e[r]}return i}const TC=ox({scrapeMotionValuesFromProps:lx,createRenderState:rx}),AC=Symbol.for("motionComponentSymbol");function jn(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function PC(e,s,n){return x.useCallback(i=>{i&&e.onMount&&e.onMount(i),s&&(i?s.mount(i):s.unmount()),n&&(typeof n=="function"?n(i):jn(n)&&(n.current=i))},[s])}const Dc=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),EC="framerAppearId",cx="data-"+Dc(EC),dx=x.createContext({});function DC(e,s,n,i,r){const{visualElement:a}=x.useContext(Da),o=x.useContext(Xf),l=x.useContext(Ea),c=x.useContext(kc).reducedMotion,d=x.useRef(null);i=i||o.renderer,!d.current&&i&&(d.current=i(e,{visualState:s,parent:a,props:n,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:c}));const m=d.current,u=x.useContext(dx);m&&!m.projection&&r&&(m.type==="html"||m.type==="svg")&&_C(d.current,n,r,u);const h=x.useRef(!1);x.useInsertionEffect(()=>{m&&h.current&&m.update(n,l)});const p=n[cx],g=x.useRef(!!p&&!window.MotionHandoffIsComplete?.(p)&&window.MotionHasOptimisedAnimation?.(p));return of(()=>{m&&(h.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),g.current&&m.animationState&&m.animationState.animateChanges())}),x.useEffect(()=>{m&&(!g.current&&m.animationState&&m.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(p)}),g.current=!1),m.enteringChildren=void 0)}),m}function _C(e,s,n,i){const{layoutId:r,layout:a,drag:o,dragConstraints:l,layoutScroll:c,layoutRoot:d,layoutCrossfade:m}=s;e.projection=new n(e.latestValues,s["data-framer-portal-id"]?void 0:ux(e.parent)),e.projection.setOptions({layoutId:r,layout:a,alwaysMeasureLayout:!!o||l&&jn(l),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:i,crossfade:m,layoutScroll:c,layoutRoot:d})}function ux(e){if(e)return e.options.allowProjection!==!1?e.projection:ux(e.parent)}function xo(e,{forwardMotionProps:s=!1}={},n,i){n&&aC(n);const r=Ac(e)?TC:CC;function a(l,c){let d;const m={...x.useContext(kc),...l,layoutId:IC(l)},{isStatic:u}=m,h=uC(l),p=r(l,u);if(!u&&sc){MC();const g=LC(m);d=g.MeasureLayout,h.visualElement=DC(e,p,m,i,g.ProjectionNode)}return t.jsxs(Da.Provider,{value:h,children:[d&&h.visualElement?t.jsx(d,{visualElement:h.visualElement,...m}):null,kC(e,l,PC(p,h.visualElement,c),p,u,s)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const o=x.forwardRef(a);return o[AC]=e,o}function IC({layoutId:e}){const s=x.useContext(ec).id;return s&&e!==void 0?s+"-"+e:e}function MC(e,s){x.useContext(Xf).strict}function LC(e){const{drag:s,layout:n}=$n;if(!s&&!n)return{};const i={...s,...n};return{MeasureLayout:s?.isEnabled(e)||n?.isEnabled(e)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}function OC(e,s){if(typeof Proxy>"u")return xo;const n=new Map,i=(a,o)=>xo(a,o,e,s),r=(a,o)=>i(a,o);return new Proxy(r,{get:(a,o)=>o==="create"?i:(n.has(o)||n.set(o,xo(o,void 0,e,s)),n.get(o))})}function mx({top:e,left:s,right:n,bottom:i}){return{x:{min:s,max:n},y:{min:e,max:i}}}function RC({x:e,y:s}){return{top:s.min,right:e.max,bottom:s.max,left:e.min}}function FC(e,s){if(!s)return e;const n=s({x:e.left,y:e.top}),i=s({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function go(e){return e===void 0||e===1}function rl({scale:e,scaleX:s,scaleY:n}){return!go(e)||!go(s)||!go(n)}function qs(e){return rl(e)||hx(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function hx(e){return uu(e.x)||uu(e.y)}function uu(e){return e&&e!=="0%"}function la(e,s,n){const i=e-n,r=s*i;return n+r}function mu(e,s,n,i,r){return r!==void 0&&(e=la(e,r,i)),la(e,n,i)+s}function al(e,s=0,n=1,i,r){e.min=mu(e.min,s,n,i,r),e.max=mu(e.max,s,n,i,r)}function px(e,{x:s,y:n}){al(e.x,s.translate,s.scale,s.originPoint),al(e.y,n.translate,n.scale,n.originPoint)}const hu=.999999999999,pu=1.0000000000001;function $C(e,s,n,i=!1){const r=n.length;if(!r)return;s.x=s.y=1;let a,o;for(let l=0;l<r;l++){a=n[l],o=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&a.options.layoutScroll&&a.scroll&&a!==a.root&&wn(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(s.x*=o.x.scale,s.y*=o.y.scale,px(e,o)),i&&qs(a.latestValues)&&wn(e,a.latestValues))}s.x<pu&&s.x>hu&&(s.x=1),s.y<pu&&s.y>hu&&(s.y=1)}function bn(e,s){e.min=e.min+s,e.max=e.max+s}function fu(e,s,n,i,r=.5){const a=he(e.min,e.max,r);al(e,s,n,a,i)}function wn(e,s){fu(e.x,s.x,s.scaleX,s.scale,s.originX),fu(e.y,s.y,s.scaleY,s.scale,s.originY)}function fx(e,s){return mx(FC(e.getBoundingClientRect(),s))}function qC(e,s,n){const i=fx(e,n),{scroll:r}=s;return r&&(bn(i.x,r.offset.x),bn(i.y,r.offset.y)),i}const xu=()=>({translate:0,scale:1,origin:0,originPoint:0}),vn=()=>({x:xu(),y:xu()}),gu=()=>({min:0,max:0}),we=()=>({x:gu(),y:gu()}),ol={current:null},xx={current:!1};function VC(){if(xx.current=!0,!!sc)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),s=()=>ol.current=e.matches;e.addEventListener("change",s),s()}else ol.current=!1}const BC=new WeakMap;function UC(e,s,n){for(const i in s){const r=s[i],a=n[i];if(We(r))e.addValue(i,r);else if(We(a))e.addValue(i,Fn(r,{owner:e}));else if(a!==r)if(e.hasValue(i)){const o=e.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=e.getStaticValue(i);e.addValue(i,Fn(o!==void 0?o:r,{owner:e}))}}for(const i in n)s[i]===void 0&&e.removeValue(i);return s}const yu=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class WC{scrapeMotionValuesFromProps(s,n,i){return{}}constructor({parent:s,props:n,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:a,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=jc,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=tt.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,de.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=o;this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=d,this.parent=s,this.props=n,this.presenceContext=i,this.depth=s?s.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!a,this.isControllingVariants=Ia(n),this.isVariantNode=tx(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:m,...u}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in u){const p=u[h];c[h]!==void 0&&We(p)&&p.set(c[h])}}mount(s){this.current=s,BC.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),xx.current||VC(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:ol.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),_s(this.notifyUpdate),_s(this.render),this.valueSubscriptions.forEach(s=>s()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const s in this.events)this.events[s].clear();for(const s in this.features){const n=this.features[s];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(s){this.children.add(s),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(s)}removeChild(s){this.children.delete(s),this.enteringChildren&&this.enteringChildren.delete(s)}bindToMotionValue(s,n){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const i=ei.has(s);i&&this.onBindTransform&&this.onBindTransform();const r=n.on("change",o=>{this.latestValues[s]=o,this.props.onUpdate&&de.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,s,n)),this.valueSubscriptions.set(s,()=>{r(),a&&a(),n.owner&&n.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in $n){const n=$n[s];if(!n)continue;const{isEnabled:i,Feature:r}=n;if(!this.features[s]&&r&&i(this.props)&&(this.features[s]=new r(this)),this.features[s]){const a=this.features[s];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):we()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,n){this.latestValues[s]=n}update(s,n){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<yu.length;i++){const r=yu[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const a="on"+r,o=s[a];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=UC(this,this.scrapeMotionValuesFromProps(s,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(s),()=>n.variantChildren.delete(s)}addValue(s,n){const i=this.values.get(s);n!==i&&(i&&this.removeValue(s),this.bindToMotionValue(s,n),this.values.set(s,n),this.latestValues[s]=n.get())}removeValue(s){this.values.delete(s);const n=this.valueSubscriptions.get(s);n&&(n(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,n){if(this.props.values&&this.props.values[s])return this.props.values[s];let i=this.values.get(s);return i===void 0&&n!==void 0&&(i=Fn(n===null?void 0:n,{owner:this}),this.addValue(s,i)),i}readValue(s,n){let i=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:this.getBaseTargetFromProps(this.props,s)??this.readValueFromInstance(this.current,s,this.options);return i!=null&&(typeof i=="string"&&(lf(i)||df(i))?i=parseFloat(i):!eC(i)&&Is.test(n)&&(i=Wf(s,n)),this.setBaseTarget(s,We(i)?i.get():i)),We(i)?i.get():i}setBaseTarget(s,n){this.baseTarget[s]=n}getBaseTarget(s){const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const a=Pc(this.props,n,this.presenceContext?.custom);a&&(i=a[s])}if(n&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,s);return r!==void 0&&!We(r)?r:this.initialValues[s]!==void 0&&i===void 0?void 0:this.baseTarget[s]}on(s,n){return this.events[s]||(this.events[s]=new oc),this.events[s].add(n)}notify(s,...n){this.events[s]&&this.events[s].notify(...n)}scheduleRenderMicrotask(){vc.render(this.render)}}class gx extends WC{constructor(){super(...arguments),this.KeyframeResolver=VS}sortInstanceNodePosition(s,n){return s.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(s,n){return s.style?s.style[n]:void 0}removeValueFromRenderState(s,{vars:n,style:i}){delete n[s],delete i[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;We(s)&&(this.childSubscription=s.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function yx(e,{style:s,vars:n},i,r){const a=e.style;let o;for(o in s)a[o]=s[o];r?.applyProjectionStyles(a,i);for(o in n)a.setProperty(o,n[o])}function KC(e){return window.getComputedStyle(e)}class GC extends gx{constructor(){super(...arguments),this.type="html",this.renderInstance=yx}readValueFromInstance(s,n){if(ei.has(n))return this.projection?.isProjecting?Jo(n):oS(s,n);{const i=KC(s),r=(dc(n)?i.getPropertyValue(n):i[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(s,{transformPagePoint:n}){return fx(s,n)}build(s,n,i){Cc(s,n,i.transformTemplate)}scrapeMotionValuesFromProps(s,n,i){return Ec(s,n,i)}}const jx=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function HC(e,s,n,i){yx(e,s,void 0,i);for(const r in s.attrs)e.setAttribute(jx.has(r)?r:Dc(r),s.attrs[r])}class QC extends gx{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=we}getBaseTargetFromProps(s,n){return s[n]}readValueFromInstance(s,n){if(ei.has(n)){const i=Uf(n);return i&&i.default||0}return n=jx.has(n)?n:Dc(n),s.getAttribute(n)}scrapeMotionValuesFromProps(s,n,i){return lx(s,n,i)}build(s,n,i){ix(s,n,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(s,n,i,r){HC(s,n,i,r)}mount(s){this.isSVGTag=ax(s.tagName),super.mount(s)}}const YC=(e,s)=>Ac(e)?new QC(s):new GC(s,{allowProjection:e!==x.Fragment});function Pn(e,s,n){const i=e.getProps();return Pc(i,s,n!==void 0?n:i.custom,e)}const ll=e=>Array.isArray(e);function ZC(e,s,n){e.hasValue(s)?e.getValue(s).set(n):e.addValue(s,Fn(n))}function JC(e){return ll(e)?e[e.length-1]||0:e}function XC(e,s){const n=Pn(e,s);let{transitionEnd:i={},transition:r={},...a}=n||{};a={...a,...i};for(const o in a){const l=JC(a[o]);ZC(e,o,l)}}function e2(e){return!!(We(e)&&e.add)}function cl(e,s){const n=e.getValue("willChange");if(e2(n))return n.add(s);if(!n&&ms.WillChange){const i=new ms.WillChange("auto");e.addValue("willChange",i),i.add(s)}}function bx(e){return e.props[cx]}const t2=e=>e!==null;function s2(e,{repeat:s,repeatType:n="loop"},i){const r=e.filter(t2),a=s&&n!=="loop"&&s%2===1?0:r.length-1;return r[a]}const n2={type:"spring",stiffness:500,damping:25,restSpeed:10},i2=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),r2={type:"keyframes",duration:.8},a2={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},o2=(e,{keyframes:s})=>s.length>2?r2:ei.has(e)?e.startsWith("scale")?i2(s[1]):n2:a2;function l2({when:e,delay:s,delayChildren:n,staggerChildren:i,staggerDirection:r,repeat:a,repeatType:o,repeatDelay:l,from:c,elapsed:d,...m}){return!!Object.keys(m).length}const _c=(e,s,n,i={},r,a)=>o=>{const l=bc(i,e)||{},c=l.delay||i.delay||0;let{elapsed:d=0}=i;d=d-Wt(c);const m={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:s.getVelocity(),...l,delay:-d,onUpdate:h=>{s.set(h),l.onUpdate&&l.onUpdate(h)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:e,motionValue:s,element:a?void 0:r};l2(l)||Object.assign(m,o2(e,m)),m.duration&&(m.duration=Wt(m.duration)),m.repeatDelay&&(m.repeatDelay=Wt(m.repeatDelay)),m.from!==void 0&&(m.keyframes[0]=m.from);let u=!1;if((m.type===!1||m.duration===0&&!m.repeatDelay)&&(nl(m),m.delay===0&&(u=!0)),(ms.instantAnimations||ms.skipAnimations)&&(u=!0,nl(m),m.delay=0),m.allowFlatten=!l.type&&!l.ease,u&&!a&&s.get()!==void 0){const h=s2(m.keyframes,l);if(h!==void 0){de.update(()=>{m.onUpdate(h),m.onComplete()});return}}return l.isSync?new yc(m):new PS(m)};function c2({protectedKeys:e,needsAnimating:s},n){const i=e.hasOwnProperty(n)&&s[n]!==!0;return s[n]=!1,i}function wx(e,s,{delay:n=0,transitionOverride:i,type:r}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:o,...l}=s;i&&(a=i);const c=[],d=r&&e.animationState&&e.animationState.getState()[r];for(const m in l){const u=e.getValue(m,e.latestValues[m]??null),h=l[m];if(h===void 0||d&&c2(d,m))continue;const p={delay:n,...bc(a||{},m)},g=u.get();if(g!==void 0&&!u.isAnimating&&!Array.isArray(h)&&h===g&&!p.velocity)continue;let f=!1;if(window.MotionHandoffAnimation){const b=bx(e);if(b){const j=window.MotionHandoffAnimation(b,m,de);j!==null&&(p.startTime=j,f=!0)}}cl(e,m),u.start(_c(m,u,h,e.shouldReduceMotion&&qf.has(m)?{type:!1}:p,e,f));const y=u.animation;y&&c.push(y)}return o&&Promise.all(c).then(()=>{de.update(()=>{o&&XC(e,o)})}),c}function vx(e,s,n,i=0,r=1){const a=Array.from(e).sort((d,m)=>d.sortNodePosition(m)).indexOf(s),o=e.size,l=(o-1)*i;return typeof n=="function"?n(a,o):r===1?a*i:l-a*i}function dl(e,s,n={}){const i=Pn(e,s,n.type==="exit"?e.presenceContext?.custom:void 0);let{transition:r=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const a=i?()=>Promise.all(wx(e,i,n)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:m,staggerDirection:u}=r;return d2(e,s,c,d,m,u,n)}:()=>Promise.resolve(),{when:l}=r;if(l){const[c,d]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>d())}else return Promise.all([a(),o(n.delay)])}function d2(e,s,n=0,i=0,r=0,a=1,o){const l=[];for(const c of e.variantChildren)c.notify("AnimationStart",s),l.push(dl(c,s,{...o,delay:n+(typeof i=="function"?0:i)+vx(e.variantChildren,c,i,r,a)}).then(()=>c.notify("AnimationComplete",s)));return Promise.all(l)}function u2(e,s,n={}){e.notify("AnimationStart",s);let i;if(Array.isArray(s)){const r=s.map(a=>dl(e,a,n));i=Promise.all(r)}else if(typeof s=="string")i=dl(e,s,n);else{const r=typeof s=="function"?Pn(e,s,n.custom):s;i=Promise.all(wx(e,r,n))}return i.then(()=>{e.notify("AnimationComplete",s)})}function Nx(e,s){if(!Array.isArray(s))return!1;const n=s.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(s[i]!==e[i])return!1;return!0}const m2=Sc.length;function kx(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?kx(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const s={};for(let n=0;n<m2;n++){const i=Sc[n],r=e.props[i];(Ki(r)||r===!1)&&(s[i]=r)}return s}const h2=[...zc].reverse(),p2=zc.length;function f2(e){return s=>Promise.all(s.map(({animation:n,options:i})=>u2(e,n,i)))}function x2(e){let s=f2(e),n=ju(),i=!0;const r=c=>(d,m)=>{const u=Pn(e,m,c==="exit"?e.presenceContext?.custom:void 0);if(u){const{transition:h,transitionEnd:p,...g}=u;d={...d,...g,...p}}return d};function a(c){s=c(e)}function o(c){const{props:d}=e,m=kx(e.parent)||{},u=[],h=new Set;let p={},g=1/0;for(let y=0;y<p2;y++){const b=h2[y],j=n[b],w=d[b]!==void 0?d[b]:m[b],S=Ki(w),k=b===c?j.isActive:null;k===!1&&(g=y);let z=w===m[b]&&w!==d[b]&&S;if(z&&i&&e.manuallyAnimateOnMount&&(z=!1),j.protectedKeys={...p},!j.isActive&&k===null||!w&&!j.prevProp||_a(w)||typeof w=="boolean")continue;const N=g2(j.prevProp,w);let C=N||b===c&&j.isActive&&!z&&S||y>g&&S,A=!1;const v=Array.isArray(w)?w:[w];let P=v.reduce(r(b),{});k===!1&&(P={});const{prevResolvedValues:D={}}=j,_={...D,...P},E=Q=>{C=!0,h.has(Q)&&(A=!0,h.delete(Q)),j.needsAnimating[Q]=!0;const J=e.getValue(Q);J&&(J.liveStyle=!1)};for(const Q in _){const J=P[Q],$=D[Q];if(p.hasOwnProperty(Q))continue;let me=!1;ll(J)&&ll($)?me=!Nx(J,$):me=J!==$,me?J!=null?E(Q):h.add(Q):J!==void 0&&h.has(Q)?E(Q):j.protectedKeys[Q]=!0}j.prevProp=w,j.prevResolvedValues=P,j.isActive&&(p={...p,...P}),i&&e.blockInitialAnimation&&(C=!1);const X=z&&N;C&&(!X||A)&&u.push(...v.map(Q=>{const J={type:b};if(typeof Q=="string"&&i&&!X&&e.manuallyAnimateOnMount&&e.parent){const{parent:$}=e,me=Pn($,Q);if($.enteringChildren&&me){const{delayChildren:Ee}=me.transition||{};J.delay=vx($.enteringChildren,e,Ee)}}return{animation:Q,options:J}}))}if(h.size){const y={};if(typeof d.initial!="boolean"){const b=Pn(e,Array.isArray(d.initial)?d.initial[0]:d.initial);b&&b.transition&&(y.transition=b.transition)}h.forEach(b=>{const j=e.getBaseTarget(b),w=e.getValue(b);w&&(w.liveStyle=!0),y[b]=j??null}),u.push({animation:y})}let f=!!u.length;return i&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(f=!1),i=!1,f?s(u):Promise.resolve()}function l(c,d){if(n[c].isActive===d)return Promise.resolve();e.variantChildren?.forEach(u=>u.animationState?.setActive(c,d)),n[c].isActive=d;const m=o(c);for(const u in n)n[u].protectedKeys={};return m}return{animateChanges:o,setActive:l,setAnimateFunction:a,getState:()=>n,reset:()=>{n=ju(),i=!0}}}function g2(e,s){return typeof s=="string"?s!==e:Array.isArray(s)?!Nx(s,e):!1}function $s(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function ju(){return{animate:$s(!0),whileInView:$s(),whileHover:$s(),whileTap:$s(),whileDrag:$s(),whileFocus:$s(),exit:$s()}}class Os{constructor(s){this.isMounted=!1,this.node=s}update(){}}class y2 extends Os{constructor(s){super(s),s.animationState||(s.animationState=x2(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();_a(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:n}=this.node.prevProps||{};s!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let j2=0;class b2 extends Os{constructor(){super(...arguments),this.id=j2++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===i)return;const r=this.node.animationState.setActive("exit",!s);n&&!s&&r.then(()=>{n(this.id)})}mount(){const{register:s,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),s&&(this.unmount=s(this.id))}unmount(){}}const w2={animation:{Feature:y2},exit:{Feature:b2}};function Hi(e,s,n,i={passive:!0}){return e.addEventListener(s,n,i),()=>e.removeEventListener(s,n)}function jr(e){return{point:{x:e.pageX,y:e.pageY}}}const v2=e=>s=>Nc(s)&&e(s,jr(s));function Ci(e,s,n,i){return Hi(e,s,v2(n),i)}const zx=1e-4,N2=1-zx,k2=1+zx,Sx=.01,z2=0-Sx,S2=0+Sx;function Qe(e){return e.max-e.min}function C2(e,s,n){return Math.abs(e-s)<=n}function bu(e,s,n,i=.5){e.origin=i,e.originPoint=he(s.min,s.max,e.origin),e.scale=Qe(n)/Qe(s),e.translate=he(n.min,n.max,e.origin)-e.originPoint,(e.scale>=N2&&e.scale<=k2||isNaN(e.scale))&&(e.scale=1),(e.translate>=z2&&e.translate<=S2||isNaN(e.translate))&&(e.translate=0)}function Ti(e,s,n,i){bu(e.x,s.x,n.x,i?i.originX:void 0),bu(e.y,s.y,n.y,i?i.originY:void 0)}function wu(e,s,n){e.min=n.min+s.min,e.max=e.min+Qe(s)}function T2(e,s,n){wu(e.x,s.x,n.x),wu(e.y,s.y,n.y)}function vu(e,s,n){e.min=s.min-n.min,e.max=e.min+Qe(s)}function Ai(e,s,n){vu(e.x,s.x,n.x),vu(e.y,s.y,n.y)}function bt(e){return[e("x"),e("y")]}const Cx=({current:e})=>e?e.ownerDocument.defaultView:null,Nu=(e,s)=>Math.abs(e-s);function A2(e,s){const n=Nu(e.x,s.x),i=Nu(e.y,s.y);return Math.sqrt(n**2+i**2)}class Tx{constructor(s,n,{transformPagePoint:i,contextWindow:r=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=jo(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,g=A2(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!g)return;const{point:f}=h,{timestamp:y}=Fe;this.history.push({...f,timestamp:y});const{onStart:b,onMove:j}=this.handlers;p||(b&&b(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),j&&j(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=yo(p,this.transformPagePoint),de.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:g,onSessionEnd:f,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=jo(h.type==="pointercancel"?this.lastMoveEventInfo:yo(p,this.transformPagePoint),this.history);this.startEvent&&g&&g(h,b),f&&f(h,b)},!Nc(s))return;this.dragSnapToOrigin=a,this.handlers=n,this.transformPagePoint=i,this.distanceThreshold=o,this.contextWindow=r||window;const l=jr(s),c=yo(l,this.transformPagePoint),{point:d}=c,{timestamp:m}=Fe;this.history=[{...d,timestamp:m}];const{onSessionStart:u}=n;u&&u(s,jo(c,this.history)),this.removeListeners=xr(Ci(this.contextWindow,"pointermove",this.handlePointerMove),Ci(this.contextWindow,"pointerup",this.handlePointerUp),Ci(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),_s(this.updatePoint)}}function yo(e,s){return s?{point:s(e.point)}:e}function ku(e,s){return{x:e.x-s.x,y:e.y-s.y}}function jo({point:e},s){return{point:e,delta:ku(e,Ax(s)),offset:ku(e,P2(s)),velocity:E2(s,.1)}}function P2(e){return e[0]}function Ax(e){return e[e.length-1]}function E2(e,s){if(e.length<2)return{x:0,y:0};let n=e.length-1,i=null;const r=Ax(e);for(;n>=0&&(i=e[n],!(r.timestamp-i.timestamp>Wt(s)));)n--;if(!i)return{x:0,y:0};const a=Kt(r.timestamp-i.timestamp);if(a===0)return{x:0,y:0};const o={x:(r.x-i.x)/a,y:(r.y-i.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function D2(e,{min:s,max:n},i){return s!==void 0&&e<s?e=i?he(s,e,i.min):Math.max(e,s):n!==void 0&&e>n&&(e=i?he(n,e,i.max):Math.min(e,n)),e}function zu(e,s,n){return{min:s!==void 0?e.min+s:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function _2(e,{top:s,left:n,bottom:i,right:r}){return{x:zu(e.x,n,r),y:zu(e.y,s,i)}}function Su(e,s){let n=s.min-e.min,i=s.max-e.max;return s.max-s.min<e.max-e.min&&([n,i]=[i,n]),{min:n,max:i}}function I2(e,s){return{x:Su(e.x,s.x),y:Su(e.y,s.y)}}function M2(e,s){let n=.5;const i=Qe(e),r=Qe(s);return r>i?n=Bi(s.min,s.max-i,e.min):i>r&&(n=Bi(e.min,e.max-r,s.min)),us(0,1,n)}function L2(e,s){const n={};return s.min!==void 0&&(n.min=s.min-e.min),s.max!==void 0&&(n.max=s.max-e.min),n}const ul=.35;function O2(e=ul){return e===!1?e=0:e===!0&&(e=ul),{x:Cu(e,"left","right"),y:Cu(e,"top","bottom")}}function Cu(e,s,n){return{min:Tu(e,s),max:Tu(e,n)}}function Tu(e,s){return typeof e=="number"?e:e[s]||0}const R2=new WeakMap;class F2{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=we(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=s}start(s,{snapToCursor:n=!1,distanceThreshold:i}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const a=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(jr(u).point)},o=(u,h)=>{const{drag:p,dragPropagation:g,onDragStart:f}=this.getProps();if(p&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=KS(p),!this.openDragLock))return;this.latestPointerEvent=u,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),bt(b=>{let j=this.getAxisMotionValue(b).get()||0;if(Gt.test(j)){const{projection:w}=this.visualElement;if(w&&w.layout){const S=w.layout.layoutBox[b];S&&(j=Qe(S)*(parseFloat(j)/100))}}this.originPoint[b]=j}),f&&de.postRender(()=>f(u,h)),cl(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},l=(u,h)=>{this.latestPointerEvent=u,this.latestPanInfo=h;const{dragPropagation:p,dragDirectionLock:g,onDirectionLock:f,onDrag:y}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:b}=h;if(g&&this.currentDirection===null){this.currentDirection=$2(b),this.currentDirection!==null&&f&&f(this.currentDirection);return}this.updateAxis("x",h.point,b),this.updateAxis("y",h.point,b),this.visualElement.render(),y&&y(u,h)},c=(u,h)=>{this.latestPointerEvent=u,this.latestPanInfo=h,this.stop(u,h),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>bt(u=>this.getAnimationState(u)==="paused"&&this.getAxisMotionValue(u).animation?.play()),{dragSnapToOrigin:m}=this.getProps();this.panSession=new Tx(s,{onSessionStart:a,onStart:o,onMove:l,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:m,distanceThreshold:i,contextWindow:Cx(this.visualElement)})}stop(s,n){const i=s||this.latestPointerEvent,r=n||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!r||!i)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:l}=this.getProps();l&&de.postRender(()=>l(i,r))}cancel(){this.isDragging=!1;const{projection:s,animationState:n}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(s,n,i){const{drag:r}=this.getProps();if(!i||!_r(s,r,this.currentDirection))return;const a=this.getAxisMotionValue(s);let o=this.originPoint[s]+i[s];this.constraints&&this.constraints[s]&&(o=D2(o,this.constraints[s],this.elastic[s])),a.set(o)}resolveConstraints(){const{dragConstraints:s,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,r=this.constraints;s&&jn(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&i?this.constraints=_2(i.layoutBox,s):this.constraints=!1,this.elastic=O2(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&bt(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=L2(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:n}=this.getProps();if(!s||!jn(s))return!1;const i=s.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const a=qC(i,r.root,this.visualElement.getTransformPagePoint());let o=I2(r.layout.layoutBox,a);if(n){const l=n(RC(o));this.hasMutatedConstraints=!!l,l&&(o=mx(l))}return o}startAnimation(s){const{drag:n,dragMomentum:i,dragElastic:r,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=bt(m=>{if(!_r(m,n,this.currentDirection))return;let u=c&&c[m]||{};o&&(u={min:0,max:0});const h=r?200:1e6,p=r?40:1e7,g={type:"inertia",velocity:i?s[m]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...a,...u};return this.startAxisValueAnimation(m,g)});return Promise.all(d).then(l)}startAxisValueAnimation(s,n){const i=this.getAxisMotionValue(s);return cl(this.visualElement,s),i.start(_c(s,i,0,n,this.visualElement,!1))}stopAnimation(){bt(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){bt(s=>this.getAxisMotionValue(s).animation?.pause())}getAnimationState(s){return this.getAxisMotionValue(s).animation?.state}getAxisMotionValue(s){const n=`_drag${s.toUpperCase()}`,i=this.visualElement.getProps(),r=i[n];return r||this.visualElement.getValue(s,(i.initial?i.initial[s]:void 0)||0)}snapToCursor(s){bt(n=>{const{drag:i}=this.getProps();if(!_r(n,i,this.currentDirection))return;const{projection:r}=this.visualElement,a=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[n];a.set(s[n]-he(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!jn(n)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};bt(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const c=l.get();r[o]=M2({min:c,max:c},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),bt(o=>{if(!_r(o,s,null))return;const l=this.getAxisMotionValue(o),{min:c,max:d}=this.constraints[o];l.set(he(c,d,r[o]))})}addListeners(){if(!this.visualElement.current)return;R2.set(this.visualElement,this);const s=this.visualElement.current,n=Ci(s,"pointerdown",c=>{const{drag:d,dragListener:m=!0}=this.getProps();d&&m&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();jn(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,a=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),de.read(i);const o=Hi(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(bt(m=>{const u=this.getAxisMotionValue(m);u&&(this.originPoint[m]+=c[m].translate,u.set(u.get()+c[m].translate))}),this.visualElement.render())});return()=>{o(),n(),a(),l&&l()}}getProps(){const s=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:a=!1,dragElastic:o=ul,dragMomentum:l=!0}=s;return{...s,drag:n,dragDirectionLock:i,dragPropagation:r,dragConstraints:a,dragElastic:o,dragMomentum:l}}}function _r(e,s,n){return(s===!0||s===e)&&(n===null||n===e)}function $2(e,s=10){let n=null;return Math.abs(e.y)>s?n="y":Math.abs(e.x)>s&&(n="x"),n}class q2 extends Os{constructor(s){super(s),this.removeGroupControls=kt,this.removeListeners=kt,this.controls=new F2(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||kt}unmount(){this.removeGroupControls(),this.removeListeners()}}const Au=e=>(s,n)=>{e&&de.postRender(()=>e(s,n))};class V2 extends Os{constructor(){super(...arguments),this.removePointerDownListener=kt}onPointerDown(s){this.session=new Tx(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Cx(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:n,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:Au(s),onStart:Au(n),onMove:i,onEnd:(a,o)=>{delete this.session,r&&de.postRender(()=>r(a,o))}}}mount(){this.removePointerDownListener=Ci(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ur={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Pu(e,s){return s.max===s.min?0:e/(s.max-s.min)*100}const pi={correct:(e,s)=>{if(!s.target)return e;if(typeof e=="string")if(K.test(e))e=parseFloat(e);else return e;const n=Pu(e,s.target.x),i=Pu(e,s.target.y);return`${n}% ${i}%`}},B2={correct:(e,{treeScale:s,projectionDelta:n})=>{const i=e,r=Is.parse(e);if(r.length>5)return i;const a=Is.createTransformer(e),o=typeof r[0]!="number"?1:0,l=n.x.scale*s.x,c=n.y.scale*s.y;r[0+o]/=l,r[1+o]/=c;const d=he(l,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=d),typeof r[3+o]=="number"&&(r[3+o]/=d),a(r)}};let bo=!1;class U2 extends x.Component{componentDidMount(){const{visualElement:s,layoutGroup:n,switchLayoutGroup:i,layoutId:r}=this.props,{projection:a}=s;mC(W2),a&&(n.group&&n.group.add(a),i&&i.register&&r&&i.register(a),bo&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Ur.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:n,visualElement:i,drag:r,isPresent:a}=this.props,{projection:o}=i;return o&&(o.isPresent=a,bo=!0,r||s.layoutDependency!==n||n===void 0||s.isPresent!==a?o.willUpdate():this.safeToRemove(),s.isPresent!==a&&(a?o.promote():o.relegate()||de.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),vc.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:r}=s;bo=!0,r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function Px(e){const[s,n]=Jf(),i=x.useContext(ec);return t.jsx(U2,{...e,layoutGroup:i,switchLayoutGroup:x.useContext(dx),isPresent:s,safeToRemove:n})}const W2={borderRadius:{...pi,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:pi,borderTopRightRadius:pi,borderBottomLeftRadius:pi,borderBottomRightRadius:pi,boxShadow:B2};function K2(e,s,n){const i=We(e)?e:Fn(e);return i.start(_c("",i,s,n)),i.animation}const G2=(e,s)=>e.depth-s.depth;class H2{constructor(){this.children=[],this.isDirty=!1}add(s){nc(this.children,s),this.isDirty=!0}remove(s){ic(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(G2),this.isDirty=!1,this.children.forEach(s)}}function Q2(e,s){const n=tt.now(),i=({timestamp:r})=>{const a=r-n;a>=s&&(_s(i),e(a-s))};return de.setup(i,!0),()=>_s(i)}const Ex=["TopLeft","TopRight","BottomLeft","BottomRight"],Y2=Ex.length,Eu=e=>typeof e=="string"?parseFloat(e):e,Du=e=>typeof e=="number"||K.test(e);function Z2(e,s,n,i,r,a){r?(e.opacity=he(0,n.opacity??1,J2(i)),e.opacityExit=he(s.opacity??1,0,X2(i))):a&&(e.opacity=he(s.opacity??1,n.opacity??1,i));for(let o=0;o<Y2;o++){const l=`border${Ex[o]}Radius`;let c=_u(s,l),d=_u(n,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||Du(c)===Du(d)?(e[l]=Math.max(he(Eu(c),Eu(d),i),0),(Gt.test(d)||Gt.test(c))&&(e[l]+="%")):e[l]=d}(s.rotate||n.rotate)&&(e.rotate=he(s.rotate||0,n.rotate||0,i))}function _u(e,s){return e[s]!==void 0?e[s]:e.borderRadius}const J2=Dx(0,.5,yf),X2=Dx(.5,.95,kt);function Dx(e,s,n){return i=>i<e?0:i>s?1:n(Bi(e,s,i))}function Iu(e,s){e.min=s.min,e.max=s.max}function yt(e,s){Iu(e.x,s.x),Iu(e.y,s.y)}function Mu(e,s){e.translate=s.translate,e.scale=s.scale,e.originPoint=s.originPoint,e.origin=s.origin}function Lu(e,s,n,i,r){return e-=s,e=la(e,1/n,i),r!==void 0&&(e=la(e,1/r,i)),e}function eT(e,s=0,n=1,i=.5,r,a=e,o=e){if(Gt.test(s)&&(s=parseFloat(s),s=he(o.min,o.max,s/100)-o.min),typeof s!="number")return;let l=he(a.min,a.max,i);e===a&&(l-=s),e.min=Lu(e.min,s,n,l,r),e.max=Lu(e.max,s,n,l,r)}function Ou(e,s,[n,i,r],a,o){eT(e,s[n],s[i],s[r],s.scale,a,o)}const tT=["x","scaleX","originX"],sT=["y","scaleY","originY"];function Ru(e,s,n,i){Ou(e.x,s,tT,n?n.x:void 0,i?i.x:void 0),Ou(e.y,s,sT,n?n.y:void 0,i?i.y:void 0)}function Fu(e){return e.translate===0&&e.scale===1}function _x(e){return Fu(e.x)&&Fu(e.y)}function $u(e,s){return e.min===s.min&&e.max===s.max}function nT(e,s){return $u(e.x,s.x)&&$u(e.y,s.y)}function qu(e,s){return Math.round(e.min)===Math.round(s.min)&&Math.round(e.max)===Math.round(s.max)}function Ix(e,s){return qu(e.x,s.x)&&qu(e.y,s.y)}function Vu(e){return Qe(e.x)/Qe(e.y)}function Bu(e,s){return e.translate===s.translate&&e.scale===s.scale&&e.originPoint===s.originPoint}class iT{constructor(){this.members=[]}add(s){nc(this.members,s),s.scheduleRender()}remove(s){if(ic(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(s){const n=this.members.findIndex(r=>s===r);if(n===0)return!1;let i;for(let r=n;r>=0;r--){const a=this.members[r];if(a.isPresent!==!1){i=a;break}}return i?(this.promote(i),!0):!1}promote(s,n){const i=this.lead;if(s!==i&&(this.prevLead=i,this.lead=s,s.show(),i)){i.instance&&i.scheduleRender(),s.scheduleRender(),s.resumeFrom=i,n&&(s.resumeFrom.preserveOpacity=!0),i.snapshot&&(s.snapshot=i.snapshot,s.snapshot.latestValues=i.animationValues||i.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0);const{crossfade:r}=s.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:n,resumingFrom:i}=s;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function rT(e,s,n){let i="";const r=e.x.translate/s.x,a=e.y.translate/s.y,o=n?.z||0;if((r||a||o)&&(i=`translate3d(${r}px, ${a}px, ${o}px) `),(s.x!==1||s.y!==1)&&(i+=`scale(${1/s.x}, ${1/s.y}) `),n){const{transformPerspective:d,rotate:m,rotateX:u,rotateY:h,skewX:p,skewY:g}=n;d&&(i=`perspective(${d}px) ${i}`),m&&(i+=`rotate(${m}deg) `),u&&(i+=`rotateX(${u}deg) `),h&&(i+=`rotateY(${h}deg) `),p&&(i+=`skewX(${p}deg) `),g&&(i+=`skewY(${g}deg) `)}const l=e.x.scale*s.x,c=e.y.scale*s.y;return(l!==1||c!==1)&&(i+=`scale(${l}, ${c})`),i||"none"}const wo=["","X","Y","Z"],aT=1e3;let oT=0;function vo(e,s,n,i){const{latestValues:r}=s;r[e]&&(n[e]=r[e],s.setStaticValue(e,0),i&&(i[e]=0))}function Mx(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:s}=e.options;if(!s)return;const n=bx(s);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",de,!(r||a))}const{parent:i}=e;i&&!i.hasCheckedOptimisedAppear&&Mx(i)}function Lx({attachResizeListener:e,defaultParent:s,measureScroll:n,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=s?.()){this.id=oT++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(dT),this.nodes.forEach(pT),this.nodes.forEach(fT),this.nodes.forEach(uT)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new H2)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new oc),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=Zf(o)&&!JS(o),this.instance=o;const{layoutId:l,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),e){let m,u=0;const h=()=>this.root.updateBlockedByResize=!1;de.read(()=>{u=window.innerWidth}),e(o,()=>{const p=window.innerWidth;p!==u&&(u=p,this.root.updateBlockedByResize=!0,m&&m(),m=Q2(h,250),Ur.hasAnimatedSinceResize&&(Ur.hasAnimatedSinceResize=!1,this.nodes.forEach(Ku)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&d&&(l||c)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:u,hasRelativeLayoutChanged:h,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||d.getDefaultTransition()||bT,{onLayoutAnimationStart:f,onLayoutAnimationComplete:y}=d.getProps(),b=!this.targetLayout||!Ix(this.targetLayout,p),j=!u&&h;if(this.options.layoutRoot||this.resumeFrom||j||u&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const w={...bc(g,"layout"),onPlay:f,onComplete:y};(d.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w),this.setAnimationOrigin(m,j)}else u||Ku(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),_s(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(xT),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Mx(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let m=0;m<this.path.length;m++){const u=this.path[m];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Uu);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Wu);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(hT),this.nodes.forEach(lT),this.nodes.forEach(cT)):this.nodes.forEach(Wu),this.clearAllSnapshots();const l=tt.now();Fe.delta=us(0,1e3/60,l-Fe.timestamp),Fe.timestamp=l,Fe.isProcessing=!0,co.update.process(Fe),co.preRender.process(Fe),co.render.process(Fe),Fe.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,vc.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(mT),this.sharedNodes.forEach(gT)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,de.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){de.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Qe(this.snapshot.measuredBox.x)&&!Qe(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=we(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!_x(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,m=d!==this.prevTransformTemplateValue;o&&this.instance&&(l||qs(this.latestValues)||m)&&(r(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),wT(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return we();const l=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(vT))){const{scroll:d}=this.root;d&&(bn(l.x,d.offset.x),bn(l.y,d.offset.y))}return l}removeElementScroll(o){const l=we();if(yt(l,o),this.scroll?.wasRoot)return l;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:m,options:u}=d;d!==this.root&&m&&u.layoutScroll&&(m.wasRoot&&yt(l,o),bn(l.x,m.offset.x),bn(l.y,m.offset.y))}return l}applyTransform(o,l=!1){const c=we();yt(c,o);for(let d=0;d<this.path.length;d++){const m=this.path[d];!l&&m.options.layoutScroll&&m.scroll&&m!==m.root&&wn(c,{x:-m.scroll.offset.x,y:-m.scroll.offset.y}),qs(m.latestValues)&&wn(c,m.latestValues)}return qs(this.latestValues)&&wn(c,this.latestValues),c}removeTransform(o){const l=we();yt(l,o);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!qs(d.latestValues))continue;rl(d.latestValues)&&d.updateSnapshot();const m=we(),u=d.measurePageBox();yt(m,u),Ru(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,m)}return qs(this.latestValues)&&Ru(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Fe.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:u}=this.options;if(!(!this.layout||!(m||u))){if(this.resolvedRelativeTargetAt=Fe.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=we(),this.relativeTargetOrigin=we(),Ai(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),yt(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=we(),this.targetWithTransforms=we()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),T2(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):yt(this.target,this.layout.layoutBox),px(this.target,this.targetDelta)):yt(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=we(),this.relativeTargetOrigin=we(),Ai(this.relativeTargetOrigin,this.target,h.target),yt(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||rl(this.parent.latestValues)||hx(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Fe.timestamp&&(c=!1),c)return;const{layout:d,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||m))return;yt(this.layoutCorrected,this.layout.layoutBox);const u=this.treeScale.x,h=this.treeScale.y;$C(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=we());const{target:p}=o;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Mu(this.prevProjectionDelta.x,this.projectionDelta.x),Mu(this.prevProjectionDelta.y,this.projectionDelta.y)),Ti(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==u||this.treeScale.y!==h||!Bu(this.projectionDelta.x,this.prevProjectionDelta.x)||!Bu(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=vn(),this.projectionDelta=vn(),this.projectionDeltaWithTransform=vn()}setAnimationOrigin(o,l=!1){const c=this.snapshot,d=c?c.latestValues:{},m={...this.latestValues},u=vn();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=we(),p=c?c.source:void 0,g=this.layout?this.layout.source:void 0,f=p!==g,y=this.getStack(),b=!y||y.members.length<=1,j=!!(f&&!b&&this.options.crossfade===!0&&!this.path.some(jT));this.animationProgress=0;let w;this.mixTargetDelta=S=>{const k=S/1e3;Gu(u.x,o.x,k),Gu(u.y,o.y,k),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ai(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),yT(this.relativeTarget,this.relativeTargetOrigin,h,k),w&&nT(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=we()),yt(w,this.relativeTarget)),f&&(this.animationValues=m,Z2(m,d,this.latestValues,k,j,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(_s(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=de.update(()=>{Ur.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Fn(0)),this.currentAnimation=K2(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(aT),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:m}=o;if(!(!l||!c||!d)){if(this!==o&&this.layout&&d&&Ox(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||we();const u=Qe(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+u;const h=Qe(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+h}yt(l,c),wn(l,m),Ti(this.projectionDeltaWithTransform,this.layoutCorrected,l,m)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new iT),this.sharedNodes.get(o).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const d={};c.z&&vo("z",o,d,this.animationValues);for(let m=0;m<wo.length;m++)vo(`rotate${wo[m]}`,o,d,this.animationValues),vo(`skew${wo[m]}`,o,d,this.animationValues);o.render();for(const m in d)o.setStaticValue(m,d[m]),this.animationValues&&(this.animationValues[m]=d[m]);o.scheduleRender()}applyProjectionStyles(o,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Br(l?.pointerEvents)||"",o.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Br(l?.pointerEvents)||""),this.hasProjected&&!qs(this.latestValues)&&(o.transform=c?c({},""):"none",this.hasProjected=!1);return}o.visibility="";const m=d.animationValues||d.latestValues;this.applyTransformsToTarget();let u=rT(this.projectionDeltaWithTransform,this.treeScale,m);c&&(u=c(m,u)),o.transform=u;const{x:h,y:p}=this.projectionDelta;o.transformOrigin=`${h.origin*100}% ${p.origin*100}% 0`,d.animationValues?o.opacity=d===this?m.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:o.opacity=d===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const g in Gi){if(m[g]===void 0)continue;const{correct:f,applyTo:y,isCSSVariable:b}=Gi[g],j=u==="none"?m[g]:f(m[g],d);if(y){const w=y.length;for(let S=0;S<w;S++)o[y[S]]=j}else b?this.options.visualElement.renderState.vars[g]=j:o[g]=j}this.options.layoutId&&(o.pointerEvents=d===this?Br(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(Uu),this.root.sharedNodes.clear()}}}function lT(e){e.updateLayout()}function cT(e){const s=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=e.layout,{animationType:r}=e.options,a=s.source!==e.layout.source;r==="size"?bt(m=>{const u=a?s.measuredBox[m]:s.layoutBox[m],h=Qe(u);u.min=n[m].min,u.max=u.min+h}):Ox(r,s.layoutBox,n)&&bt(m=>{const u=a?s.measuredBox[m]:s.layoutBox[m],h=Qe(n[m]);u.max=u.min+h,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[m].max=e.relativeTarget[m].min+h)});const o=vn();Ti(o,n,s.layoutBox);const l=vn();a?Ti(l,e.applyTransform(i,!0),s.measuredBox):Ti(l,n,s.layoutBox);const c=!_x(o);let d=!1;if(!e.resumeFrom){const m=e.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:u,layout:h}=m;if(u&&h){const p=we();Ai(p,s.layoutBox,u.layoutBox);const g=we();Ai(g,n,h.layoutBox),Ix(p,g)||(d=!0),m.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=p,e.relativeParent=m)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:s,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:d})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function dT(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function uT(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function mT(e){e.clearSnapshot()}function Uu(e){e.clearMeasurements()}function Wu(e){e.isLayoutDirty=!1}function hT(e){const{visualElement:s}=e.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),e.resetTransform()}function Ku(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function pT(e){e.resolveTargetDelta()}function fT(e){e.calcProjection()}function xT(e){e.resetSkewAndRotation()}function gT(e){e.removeLeadSnapshot()}function Gu(e,s,n){e.translate=he(s.translate,0,n),e.scale=he(s.scale,1,n),e.origin=s.origin,e.originPoint=s.originPoint}function Hu(e,s,n,i){e.min=he(s.min,n.min,i),e.max=he(s.max,n.max,i)}function yT(e,s,n,i){Hu(e.x,s.x,n.x,i),Hu(e.y,s.y,n.y,i)}function jT(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const bT={duration:.45,ease:[.4,0,.1,1]},Qu=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Yu=Qu("applewebkit/")&&!Qu("chrome/")?Math.round:kt;function Zu(e){e.min=Yu(e.min),e.max=Yu(e.max)}function wT(e){Zu(e.x),Zu(e.y)}function Ox(e,s,n){return e==="position"||e==="preserve-aspect"&&!C2(Vu(s),Vu(n),.2)}function vT(e){return e!==e.root&&e.scroll?.wasRoot}const NT=Lx({attachResizeListener:(e,s)=>Hi(e,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),No={current:void 0},Rx=Lx({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!No.current){const e=new NT({});e.mount(window),e.setOptions({layoutScroll:!0}),No.current=e}return No.current},resetTransform:(e,s)=>{e.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),kT={pan:{Feature:V2},drag:{Feature:q2,ProjectionNode:Rx,MeasureLayout:Px}};function Ju(e,s,n){const{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,a=i[r];a&&de.postRender(()=>a(s,jr(s)))}class zT extends Os{mount(){const{current:s}=this.node;s&&(this.unmount=GS(s,(n,i)=>(Ju(this.node,i,"Start"),r=>Ju(this.node,r,"End"))))}unmount(){}}class ST extends Os{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=xr(Hi(this.node.current,"focus",()=>this.onFocus()),Hi(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Xu(e,s,n){const{props:i}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&i.whileTap&&e.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),a=i[r];a&&de.postRender(()=>a(s,jr(s)))}class CT extends Os{mount(){const{current:s}=this.node;s&&(this.unmount=ZS(s,(n,i)=>(Xu(this.node,i,"Start"),(r,{success:a})=>Xu(this.node,r,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const ml=new WeakMap,ko=new WeakMap,TT=e=>{const s=ml.get(e.target);s&&s(e)},AT=e=>{e.forEach(TT)};function PT({root:e,...s}){const n=e||document;ko.has(n)||ko.set(n,{});const i=ko.get(n),r=JSON.stringify(s);return i[r]||(i[r]=new IntersectionObserver(AT,{root:e,...s})),i[r]}function ET(e,s,n){const i=PT(s);return ml.set(e,n),i.observe(e),()=>{ml.delete(e),i.unobserve(e)}}const DT={some:0,all:1};class _T extends Os{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:n,margin:i,amount:r="some",once:a}=s,o={root:n?n.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:DT[r]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:m,onViewportLeave:u}=this.node.getProps(),h=d?m:u;h&&h(c)};return ET(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:n}=this.node;["amount","margin","root"].some(IT(s,n))&&this.startObserver()}unmount(){}}function IT({viewport:e={}},{viewport:s={}}={}){return n=>e[n]!==s[n]}const MT={inView:{Feature:_T},tap:{Feature:CT},focus:{Feature:ST},hover:{Feature:zT}},LT={layout:{ProjectionNode:Rx,MeasureLayout:Px}},OT={...w2,...MT,...kT,...LT},ye=OC(OT,YC),Ma={normal:.3,slow:.5},RT={stagger:.05},FT={default:[.4,0,.2,1]},$T={hidden:{opacity:0,y:20},visible:(e=0)=>({opacity:1,y:0,transition:{delay:e*RT.stagger,duration:Ma.normal,ease:FT.default}})},qT=(e,s=Ma.slow)=>{const[n,i]=G.useState(0),r=G.useRef(0);return G.useEffect(()=>{const a=r.current,o=e,l=Date.now(),c=()=>{const d=(Date.now()-l)/1e3,m=Math.min(d/s,1),u=1-Math.pow(1-m,3),h=Math.floor(a+(o-a)*u);i(h),m<1?requestAnimationFrame(c):r.current=o};requestAnimationFrame(c)},[e,s]),n},ti=({children:e,index:s=0,className:n="",...i})=>t.jsx(ye.div,{variants:$T,initial:"hidden",animate:"visible",custom:s,className:n,...i,children:e}),en=({value:e,className:s="bg-gray-100 rounded-full overflow-hidden",barClassName:n="h-full bg-gray-900",height:i="h-2"})=>t.jsx("div",{className:`${i} ${s}`,children:t.jsx(ye.div,{initial:{width:0},animate:{width:`${e}%`},transition:{duration:Ma.slow,ease:"easeOut"},className:n})}),$e=({value:e,className:s="",duration:n=Ma.slow,prefix:i="",suffix:r=""})=>{const a=qT(e,n);return t.jsxs("span",{className:s,children:[i,a.toLocaleString("pl-PL"),r]})},VT=()=>t.jsxs("div",{className:"rounded-2xl border bg-card p-5 shadow-soft animate-pulse",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("div",{className:"h-8 w-8 rounded-md bg-muted/70"}),t.jsx("div",{className:"h-4 w-40 rounded bg-muted/70"})]}),t.jsx("div",{className:"h-5 w-16 rounded-full bg-muted/70"})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("div",{className:"h-2 w-full rounded-full bg-muted/60"}),t.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[t.jsx("div",{className:"h-3 w-16 rounded bg-muted/60"}),t.jsx("div",{className:"h-3 w-20 rounded bg-muted/60"})]})]}),t.jsx("div",{className:"mt-4 h-9 w-2/3 rounded-lg bg-muted/60"}),t.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[t.jsx("div",{className:"h-6 w-16 rounded bg-muted/60"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("div",{className:"h-9 w-24 rounded-lg bg-muted/60"}),t.jsx("div",{className:"h-9 w-10 rounded-lg bg-muted/60"})]})]})]}),BT=()=>{const e=Z(),{data:s}=Tt(),{stats:n,refetch:i}=Pa(),{data:r,isLoading:a}=fr("get_my_courses"),[o,l]=G.useState(0),c=r||[],d=!a&&c.length===0;G.useEffect(()=>{const u=async()=>{try{const{data:p}=await te.rpc("check_claimable_rewards");l(p?.claimable_points||0)}catch{}};u();const h=setInterval(u,3e4);return()=>clearInterval(h)},[]);const m=async()=>{try{const{data:u,error:h}=await te.rpc("claim_daily_rewards");if(h)throw h;u&&(O.success(`Odebrano ${u.total_earned} punktów`),i(),l(0))}catch{O.error("Nie można odebrać nagród")}};return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs(ye.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),t.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),t.jsxs("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:[t.jsxs("div",{className:"space-y-6 md:hidden",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsx("h2",{className:"text-xl font-bold tracking-tight",children:"Twoje tempo nauki"}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.streak>0&&t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1.5 shadow-soft",children:[t.jsx(Tn,{className:"h-4 w-4 text-destructive"}),t.jsxs("span",{className:"text-sm font-medium",children:["Seria: ",t.jsx("span",{className:"tabular-nums",children:n.streak})," ","dni"]})]}),o>0&&t.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 rounded-lg bg-primary px-3 py-1.5 text-sm text-primary-foreground hover:bg-primary/90 focus-ring",children:[t.jsx(od,{className:"h-4 w-4"}),"Odbierz ",o," pkt"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[t.jsxs("div",{className:"rounded-xl border bg-card p-4 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Punkty"}),t.jsx(It,{className:"h-4 w-4 text-primary"})]}),t.jsxs("div",{className:"flex items-end gap-2",children:[t.jsx("span",{className:"text-3xl font-semibold tabular-nums text-primary leading-none",children:t.jsx($e,{value:n.points})}),t.jsx("span",{className:"mb-1 text-sm text-muted-foreground",children:"pkt"})]}),t.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["+",t.jsx($e,{value:n.idle_rate}),"/h"]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"rounded-xl border bg-card p-4 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Poziom"}),t.jsx(Ii,{className:"h-4 w-4 text-secondary"})]}),t.jsx("span",{className:"text-2xl font-semibold text-secondary",children:n.level}),t.jsx("div",{className:"mt-2 h-1.5 w-full rounded-full bg-muted",children:t.jsx("div",{className:"h-full rounded-full bg-secondary transition-all",style:{width:`${n.points%100}%`}})})]}),t.jsxs("div",{className:"rounded-xl border bg-card p-4 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Tempo"}),t.jsx(Gs,{className:"h-4 w-4 text-accent"})]}),t.jsxs("span",{className:"text-2xl font-semibold text-accent",children:["+",t.jsx($e,{value:n.idle_rate})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"pkt/h"})]})]})]})]}),t.jsxs("div",{className:"hidden md:grid gap-8 md:grid-cols-12 md:items-center",children:[t.jsxs("div",{className:"md:col-span-4 space-y-4",children:[t.jsx("h2",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Twoje tempo nauki"}),n.streak>0&&t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1.5 shadow-soft",children:[t.jsx(Tn,{className:"h-4 w-4 text-destructive"}),t.jsxs("span",{className:"text-sm font-medium",children:["Seria: ",t.jsx("span",{className:"tabular-nums",children:n.streak})," ","dni"]})]}),o>0&&t.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90 focus-ring",children:[t.jsx(od,{className:"h-4 w-4"}),"Odbierz ",o," pkt"]})]}),t.jsx("div",{className:"md:col-span-8",children:t.jsxs("div",{className:"grid grid-cols-3 gap-4 md:gap-6",children:[t.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Punkty"}),t.jsx(It,{className:"h-4 w-4 text-primary"})]}),t.jsxs("div",{className:"mt-2 flex items-end gap-2",children:[t.jsx("span",{className:"text-4xl md:text-5xl font-semibold tabular-nums text-primary leading-none",children:t.jsx($e,{value:n.points})}),t.jsx("span",{className:"mb-[2px] text-sm text-muted-foreground",children:"pkt"})]}),t.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["+",t.jsx($e,{value:n.idle_rate}),"/h"]})]}),t.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Poziom"}),t.jsx(Ii,{className:"h-4 w-4 text-secondary"})]}),t.jsx("div",{className:"mt-2 flex items-center gap-2",children:t.jsx("span",{className:"text-4xl md:text-5xl font-semibold text-secondary leading-none",children:n.level})}),t.jsx("div",{className:"mt-3 h-2 w-full rounded-full bg-muted",children:t.jsx("div",{className:"h-full rounded-full bg-secondary transition-all",style:{width:`${n.points%100}%`}})}),t.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["Do kolejnego: ",100-n.points%100," pkt"]})]}),t.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Tempo"}),t.jsx(Gs,{className:"h-4 w-4 text-accent"})]}),t.jsxs("div",{className:"mt-2 flex items-end gap-2",children:[t.jsxs("span",{className:"text-4xl md:text-5xl font-semibold text-accent leading-none",children:["+",t.jsx($e,{value:n.idle_rate})]}),t.jsx("span",{className:"mb-[2px] text-sm text-muted-foreground",children:"pkt/h"})]}),t.jsx("button",{onClick:()=>e("/student/gamification"),className:"mt-3 w-full rounded-lg border px-3 py-2 hover:bg-primary/5 focus-ring",children:"Gamifikacja"})]})]})})]})]})]}),t.jsxs(ye.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between gap-4",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-semibold tracking-tight",children:"Twoje kursy"}),t.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"To jest Twoja główna ścieżka — kontynuuj naukę tam, gdzie skończyłeś."})]}),t.jsxs("button",{onClick:()=>e("/student/courses"),className:"inline-flex items-center gap-1 sm:gap-2 rounded-lg border px-2 sm:px-3 py-1.5 sm:py-2 text-sm hover:bg-primary/5 focus-ring whitespace-nowrap",children:[t.jsx("span",{className:"hidden sm:inline",children:"Zobacz wszystkie"}),t.jsx("span",{className:"sm:hidden",children:"Wszystkie"}),t.jsx(Ge,{className:"h-4 w-4"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-5",children:[a&&Array.from({length:6}).map((u,h)=>t.jsx(VT,{},h)),!a&&c.slice(0,9).map(u=>{const h=u.progress_percent===100;return t.jsxs("div",{className:"group relative rounded-2xl border bg-card p-4 sm:p-5 shadow-soft hover:bg-muted/40 transition-colors",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("span",{className:"text-2xl sm:text-3xl shrink-0 leading-none",children:u.icon_emoji||"📚"}),t.jsx("h4",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:u.title})]}),h?t.jsx("span",{className:"inline-flex items-center gap-1 rounded-full border border-green-600/30 bg-green-500/10 text-green-700 dark:text-green-400 px-2 sm:px-2.5 py-0.5 sm:py-1 text-[10px] sm:text-[11px] font-semibold",children:"Ukończono"}):t.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-primary/30 text-primary px-2 sm:px-2.5 py-0.5 sm:py-1 text-[10px] sm:text-[11px] font-semibold",children:[u.progress_percent,"%"]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("div",{className:"h-2 w-full rounded-full bg-muted",children:t.jsx("div",{className:`h-full rounded-full transition-all ${h?"bg-green-600":"bg-primary"}`,style:{width:`${u.progress_percent||0}%`}})}),t.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-muted-foreground",children:[t.jsx("span",{children:"Ukończono"}),t.jsxs("span",{className:"font-medium text-foreground",children:[u.completed_lessons||0,"/",u.total_lessons||10," lekcji"]})]})]}),u.next_activity&&t.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-2 rounded-lg border bg-background/60 px-2.5 sm:px-3 py-1.5 sm:py-2",children:[t.jsx(rj,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-primary"}),t.jsx("p",{className:"text-xs sm:text-sm font-medium truncate",children:u.next_activity})]}),t.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center justify-between",children:[u.points_available?t.jsxs("span",{className:"inline-flex rounded-md bg-orange-500/10 text-[10px] sm:text-[11px] font-semibold px-2 py-0.5 sm:py-1 text-orange-600",children:["+",u.points_available," pkt"]}):t.jsx("span",{}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>e(`/student/courses/${u.course_id}`),className:"rounded-lg bg-primary px-3 sm:px-4 py-1.5 sm:py-2 text-sm text-primary-foreground hover:bg-primary/90 focus-ring",children:"Kontynuuj"}),t.jsx("button",{onClick:()=>e(`/student/courses/${u.course_id}`),className:"rounded-lg border px-2.5 sm:px-3 py-1.5 sm:py-2 hover:bg-primary/5 focus-ring",title:"Szczegóły",children:t.jsx(Ge,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4"})})]})]})]},u.course_id)}),d&&t.jsxs("div",{className:"col-span-full rounded-2xl border bg-card p-8 sm:p-10 text-center shadow-soft",children:[t.jsx("div",{className:"text-4xl sm:text-5xl",children:"🚀"}),t.jsx("h4",{className:"mt-3 sm:mt-4 text-base sm:text-lg font-semibold",children:"Zacznij swoją przygodę"}),t.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:"Dołącz do kursu i odkryj nowy sposób nauki."}),t.jsx("button",{onClick:()=>e("/student/courses"),className:"mt-4 sm:mt-6 rounded-lg bg-secondary px-4 sm:px-5 py-2 sm:py-2.5 text-sm text-white hover:opacity-95 focus-ring",children:"Odkryj kursy"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[t.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Punkty"}),t.jsx(It,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-primary"})]}),t.jsx("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold tabular-nums text-foreground",children:t.jsx($e,{value:n.points})}),t.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:["+",t.jsx($e,{value:n.idle_rate}),"/h"]})]}),t.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Poziom"}),t.jsx(dt,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-secondary"})]}),t.jsx("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold text-foreground",children:n.level}),t.jsx("div",{className:"mt-2 sm:mt-3",children:t.jsx(en,{value:n.points%100})})]}),t.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Seria dni"}),t.jsx(Tn,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-destructive"})]}),t.jsx("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold text-foreground",children:t.jsx($e,{value:n.streak})}),t.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"dni z rzędu"})]}),t.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Tempo"}),t.jsx(Gs,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-accent"})]}),t.jsxs("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold text-foreground",children:["+",t.jsx($e,{value:n.idle_rate})]}),t.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"punktów/h"})]})]})]})},UT=[t.jsx(L,{path:"/dashboard",element:t.jsx(BT,{})},"dashboard")],WT=()=>{const e=Z(),{data:s}=fr("get_my_courses"),n=s||[];return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs(ye.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsx("div",{className:"pointer-events-none absolute inset-0",children:t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"})}),t.jsxs("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Twoje kursy"}),t.jsx("p",{className:"mt-2 text-sm md:text-base text-muted-foreground",children:"Wybierz kurs i kontynuuj naukę w swoim tempie."})]})]}),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-5",children:n.map((i,r)=>t.jsxs(ti,{index:r,className:"group relative rounded-2xl border bg-card p-4 sm:p-5 shadow-soft hover:bg-muted/40 transition-colors cursor-pointer",onClick:()=>e(`/student/courses/${i.course_id}`),children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("span",{className:"text-2xl sm:text-3xl shrink-0 leading-none",children:i.icon_emoji||"📚"}),t.jsx("h4",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:i.title})]}),t.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-primary/30 text-primary px-2 sm:px-2.5 py-0.5 sm:py-1 text-[10px] sm:text-[11px] font-semibold",children:[i.progress_percent,"%"]})]}),t.jsx("div",{className:"mt-4",children:t.jsx(en,{value:i.progress_percent})}),t.jsxs("button",{className:"mt-4 inline-flex items-center gap-1 text-sm font-medium text-primary",children:["Kontynuuj",t.jsx(Ge,{className:"h-4 w-4"})]})]},i.course_id))})]})},KT=[t.jsx(L,{path:"/courses",element:t.jsx(WT,{})},"courses-list")],GT=()=>t.jsxs("div",{className:"rounded-2xl border bg-card p-5 md:p-6 shadow-soft animate-pulse",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-12 w-12 rounded-xl bg-muted/60"}),t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsx("div",{className:"h-5 w-1/2 rounded bg-muted/60"}),t.jsx("div",{className:"h-4 w-3/4 rounded bg-muted/60"})]}),t.jsx("div",{className:"h-9 w-36 rounded-lg bg-muted/60"})]}),t.jsxs("div",{className:"mt-5",children:[t.jsx("div",{className:"h-2 w-full rounded-full bg-muted/60"}),t.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[t.jsx("div",{className:"h-3 w-16 rounded bg-muted/60"}),t.jsx("div",{className:"h-3 w-10 rounded bg-muted/60"})]})]})]}),HT=()=>t.jsxs("div",{className:"rounded-2xl border bg-card p-4 md:p-5 shadow-soft animate-pulse",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("div",{className:"h-10 w-10 rounded-full bg-muted/60"}),t.jsx("div",{className:"h-4 w-2/5 rounded bg-muted/60"})]}),t.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((e,s)=>t.jsx("div",{className:"h-14 rounded-xl border bg-muted/40"},s))})]}),QT=()=>{const{courseId:e}=Ze(),s=Z(),{data:n,isLoading:i}=fr("get_course_structure",{p_course_id:parseInt(e)},{enabled:!!e}),{data:r}=Yz("courses",{filters:[{field:"id",operator:"eq",value:parseInt(e)}],enabled:!!e}),a=G.useMemo(()=>{if(!n)return[];const d=n.reduce((u,h)=>{const p=`${h.topic_id}-${h.topic_title}`;return u[p]||(u[p]={id:h.topic_id,title:h.topic_title,position:h.topic_position,activities:[]}),h.activity_id&&u[p].activities.push({id:h.activity_id,title:h.activity_title,type:h.activity_type,position:h.activity_position,completed:h.is_completed,score:h.score}),u},{}),m=Object.values(d).sort((u,h)=>u.position-h.position);return m.map((u,h)=>{const p=u.activities.length>0&&u.activities.every(f=>f.completed),g=h===0||m[h-1].activities.length>0&&m[h-1].activities.every(f=>f.completed);return u.activities.sort((f,y)=>f.position-y.position),{...u,isCompleted:p,isUnlocked:g}})},[n]),o=G.useMemo(()=>{const d=a.flatMap(h=>h.activities),m=d.filter(h=>h.completed).length,u=d.length;return{totalActivities:u,completedActivities:m,progress:u>0?Math.round(m/u*100):0}},[a]),l=r?.[0],c=G.useMemo(()=>{for(const d of a){if(!d.isUnlocked)break;const m=d.activities.find(u=>!u.completed);if(m)return{topicId:d.id,activity:m,path:m.type==="quiz"?`/student/courses/${e}/quiz/${m.id}`:`/student/courses/${e}/lesson/${m.id}`}}return null},[a,e]);return i?t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8",children:[t.jsxs("button",{className:"inline-flex items-center gap-2 text-muted-foreground cursor-default",disabled:!0,children:[t.jsx(je,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Powrót"})]}),t.jsx(GT,{}),t.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((d,m)=>t.jsx(HT,{},m))})]}):l?t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs("button",{onClick:()=>s("/student/dashboard#courses"),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[t.jsx(je,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Powrót"})]}),t.jsxs(ye.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),t.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),t.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:t.jsxs("div",{className:"grid md:grid-cols-12 gap-6 md:items-center",children:[t.jsxs("div",{className:"md:col-span-7 flex items-start gap-4 min-w-0",children:[t.jsx("div",{className:"text-5xl md:text-6xl leading-none shrink-0",children:l.icon_emoji||"📚"}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h1",{className:"text-xl md:text-3xl font-bold tracking-tight",children:l.title}),l.description&&t.jsx("p",{className:"mt-2 text-sm md:text-base text-muted-foreground line-clamp-3",children:l.description}),t.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[t.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1.5 shadow-soft",children:[t.jsx(Qt,{className:"h-4 w-4"}),t.jsxs("span",{className:"text-sm font-medium",children:["Ukończone:"," ",t.jsx("span",{className:"tabular-nums",children:t.jsx($e,{value:o.completedActivities})}),"/",o.totalActivities]})]}),o.progress===100&&t.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-green-600/30 bg-green-500/10 text-green-700 dark:text-green-400 px-3 py-1.5 shadow-soft text-sm font-semibold",children:[t.jsx(Ce,{className:"h-4 w-4"}),"Kurs ukończony"]})]})]})]}),t.jsx("div",{className:"md:col-span-5",children:t.jsxs("div",{className:"rounded-xl border bg-card p-4 md:p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Postęp kursu"}),t.jsxs("span",{className:"text-sm font-semibold",children:[o.progress,"%"]})]}),t.jsx("div",{className:"mt-2",children:t.jsx(en,{value:o.progress})}),t.jsxs("div",{className:"mt-3 flex gap-2",children:[c?t.jsxs("button",{onClick:()=>s(c.path),className:"flex-1 inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90 focus-ring",children:["Kontynuuj",t.jsx(Ge,{className:"h-4 w-4"})]}):t.jsx("button",{disabled:!0,className:"flex-1 rounded-lg border px-4 py-2 text-muted-foreground cursor-default",title:"Brak kolejnej aktywności",children:"Wszystko ukończone"}),t.jsx("button",{onClick:()=>s("/student/courses"),className:"rounded-lg border px-3 py-2 hover:bg-primary/5 focus-ring",title:"Wróć do listy",children:t.jsx(je,{className:"h-4 w-4"})})]})]})})]})})]}),t.jsx("div",{className:"space-y-6",children:a.map((d,m)=>t.jsxs(ti,{index:m,className:M("relative rounded-2xl border bg-card p-4 md:p-5 shadow-soft",!d.isUnlocked&&"opacity-60"),children:[t.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3 md:mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:M("w-10 h-10 rounded-full flex items-center justify-center",d.isCompleted?"bg-green-600 text-white":d.isUnlocked?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),"aria-label":d.isCompleted?"Temat ukończony":d.isUnlocked?"Temat odblokowany":"Temat zablokowany",children:d.isCompleted?t.jsx(Ce,{className:"w-5 h-5"}):d.isUnlocked?t.jsx("span",{className:"font-semibold",children:d.position}):t.jsx(Yr,{className:"w-4 h-4"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:d.title}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[d.activities.filter(u=>u.completed).length," ","z ",d.activities.length," ukończonych"]})]})]}),t.jsx("div",{className:"hidden md:block w-40",children:t.jsx(en,{value:d.activities.length?Math.round(d.activities.filter(u=>u.completed).length/d.activities.length*100):0})})]}),t.jsx("div",{className:"mt-3 md:mt-4 space-y-3",children:d.activities.map(u=>{const h=u.type==="quiz",p=u.type==="quiz"?`/student/courses/${e}/quiz/${u.id}`:`/student/courses/${e}/lesson/${u.id}`;return t.jsxs(ye.button,{whileHover:d.isUnlocked?{x:2}:{},whileTap:d.isUnlocked?{scale:.98}:{},onClick:()=>{d.isUnlocked&&s(p)},disabled:!d.isUnlocked,className:M("w-full flex items-center justify-between p-4 rounded-xl border transition-colors focus-ring",d.isUnlocked?"bg-background/60 hover:bg-primary/5":"bg-muted/40 cursor-not-allowed"),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:M("w-8 h-8 rounded-lg flex items-center justify-center shrink-0",h?"bg-purple-100":"bg-blue-100"),children:h?t.jsx(It,{className:"w-4 h-4 text-purple-600"}):t.jsx(Qt,{className:"w-4 h-4 text-blue-600"})}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium text-foreground",children:u.title}),t.jsxs("div",{className:"text-sm text-muted-foreground",children:[h?"Quiz":"Materiał",u.score!==null&&` • ${u.score}%`]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[!u.completed&&d.isUnlocked&&t.jsx("span",{className:"hidden sm:inline text-xs text-muted-foreground",children:"Przejdź"}),u.completed?t.jsx(Ce,{className:"w-5 h-5 text-green-600"}):t.jsx(Ge,{className:"w-5 h-5 text-muted-foreground"})]})]},u.id)})})]},d.id))})]}):t.jsxs("div",{className:"container mx-auto px-4 py-12 text-center",children:[t.jsx("div",{className:"text-5xl",children:"🤷‍♂️"}),t.jsx("h2",{className:"mt-3 text-xl font-semibold",children:"Nie znaleziono kursu"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Spróbuj wrócić do listy kursów i wybrać ponownie."}),t.jsx("button",{onClick:()=>s("/student/courses"),className:"mt-6 rounded-lg bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90 focus-ring",children:"Przejdź do kursów"})]})},YT=[t.jsx(L,{path:"/courses/:courseId",element:t.jsx(QT,{})},"course-detail")],Ic=Symbol.for("yaml.alias"),hl=Symbol.for("yaml.document"),Cs=Symbol.for("yaml.map"),Fx=Symbol.for("yaml.pair"),Zt=Symbol.for("yaml.scalar"),si=Symbol.for("yaml.seq"),Ct=Symbol.for("yaml.node.type"),Rs=e=>!!e&&typeof e=="object"&&e[Ct]===Ic,an=e=>!!e&&typeof e=="object"&&e[Ct]===hl,ni=e=>!!e&&typeof e=="object"&&e[Ct]===Cs,ue=e=>!!e&&typeof e=="object"&&e[Ct]===Fx,oe=e=>!!e&&typeof e=="object"&&e[Ct]===Zt,ii=e=>!!e&&typeof e=="object"&&e[Ct]===si;function pe(e){if(e&&typeof e=="object")switch(e[Ct]){case Cs:case si:return!0}return!1}function fe(e){if(e&&typeof e=="object")switch(e[Ct]){case Ic:case Cs:case Zt:case si:return!0}return!1}const $x=e=>(oe(e)||pe(e))&&!!e.anchor,Xe=Symbol("break visit"),qx=Symbol("skip children"),Ht=Symbol("remove node");function on(e,s){const n=Vx(s);an(e)?Nn(null,e.contents,n,Object.freeze([e]))===Ht&&(e.contents=null):Nn(null,e,n,Object.freeze([]))}on.BREAK=Xe;on.SKIP=qx;on.REMOVE=Ht;function Nn(e,s,n,i){const r=Bx(e,s,n,i);if(fe(r)||ue(r))return Ux(e,i,r),Nn(e,r,n,i);if(typeof r!="symbol"){if(pe(s)){i=Object.freeze(i.concat(s));for(let a=0;a<s.items.length;++a){const o=Nn(a,s.items[a],n,i);if(typeof o=="number")a=o-1;else{if(o===Xe)return Xe;o===Ht&&(s.items.splice(a,1),a-=1)}}}else if(ue(s)){i=Object.freeze(i.concat(s));const a=Nn("key",s.key,n,i);if(a===Xe)return Xe;a===Ht&&(s.key=null);const o=Nn("value",s.value,n,i);if(o===Xe)return Xe;o===Ht&&(s.value=null)}}return r}async function La(e,s){const n=Vx(s);an(e)?await kn(null,e.contents,n,Object.freeze([e]))===Ht&&(e.contents=null):await kn(null,e,n,Object.freeze([]))}La.BREAK=Xe;La.SKIP=qx;La.REMOVE=Ht;async function kn(e,s,n,i){const r=await Bx(e,s,n,i);if(fe(r)||ue(r))return Ux(e,i,r),kn(e,r,n,i);if(typeof r!="symbol"){if(pe(s)){i=Object.freeze(i.concat(s));for(let a=0;a<s.items.length;++a){const o=await kn(a,s.items[a],n,i);if(typeof o=="number")a=o-1;else{if(o===Xe)return Xe;o===Ht&&(s.items.splice(a,1),a-=1)}}}else if(ue(s)){i=Object.freeze(i.concat(s));const a=await kn("key",s.key,n,i);if(a===Xe)return Xe;a===Ht&&(s.key=null);const o=await kn("value",s.value,n,i);if(o===Xe)return Xe;o===Ht&&(s.value=null)}}return r}function Vx(e){return typeof e=="object"&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function Bx(e,s,n,i){if(typeof n=="function")return n(e,s,i);if(ni(s))return n.Map?.(e,s,i);if(ii(s))return n.Seq?.(e,s,i);if(ue(s))return n.Pair?.(e,s,i);if(oe(s))return n.Scalar?.(e,s,i);if(Rs(s))return n.Alias?.(e,s,i)}function Ux(e,s,n){const i=s[s.length-1];if(pe(i))i.items[e]=n;else if(ue(i))e==="key"?i.key=n:i.value=n;else if(an(i))i.contents=n;else{const r=Rs(i)?"alias":"scalar";throw new Error(`Cannot replace node with ${r} parent`)}}const ZT={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},JT=e=>e.replace(/[!,[\]{}]/g,s=>ZT[s]);class He{constructor(s,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},He.defaultYaml,s),this.tags=Object.assign({},He.defaultTags,n)}clone(){const s=new He(this.yaml,this.tags);return s.docStart=this.docStart,s}atDocument(){const s=new He(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:He.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},He.defaultTags);break}return s}add(s,n){this.atNextDocument&&(this.yaml={explicit:He.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},He.defaultTags),this.atNextDocument=!1);const i=s.trim().split(/[ \t]+/),r=i.shift();switch(r){case"%TAG":{if(i.length!==2&&(n(0,"%TAG directive should contain exactly two parts"),i.length<2))return!1;const[a,o]=i;return this.tags[a]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,i.length!==1)return n(0,"%YAML directive should contain exactly one part"),!1;const[a]=i;if(a==="1.1"||a==="1.2")return this.yaml.version=a,!0;{const o=/^\d+\.\d+$/.test(a);return n(6,`Unsupported YAML version ${a}`,o),!1}}default:return n(0,`Unknown directive ${r}`,!0),!1}}tagName(s,n){if(s==="!")return"!";if(s[0]!=="!")return n(`Not a valid tag: ${s}`),null;if(s[1]==="<"){const o=s.slice(2,-1);return o==="!"||o==="!!"?(n(`Verbatim tags aren't resolved, so ${s} is invalid.`),null):(s[s.length-1]!==">"&&n("Verbatim tags must end with a >"),o)}const[,i,r]=s.match(/^(.*!)([^!]*)$/s);r||n(`The ${s} tag has no suffix`);const a=this.tags[i];if(a)try{return a+decodeURIComponent(r)}catch(o){return n(String(o)),null}return i==="!"?s:(n(`Could not resolve tag: ${s}`),null)}tagString(s){for(const[n,i]of Object.entries(this.tags))if(s.startsWith(i))return n+JT(s.substring(i.length));return s[0]==="!"?s:`!<${s}>`}toString(s){const n=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],i=Object.entries(this.tags);let r;if(s&&i.length>0&&fe(s.contents)){const a={};on(s.contents,(o,l)=>{fe(l)&&l.tag&&(a[l.tag]=!0)}),r=Object.keys(a)}else r=[];for(const[a,o]of i)a==="!!"&&o==="tag:yaml.org,2002:"||(!s||r.some(l=>l.startsWith(o)))&&n.push(`%TAG ${a} ${o}`);return n.join(`
`)}}He.defaultYaml={explicit:!1,version:"1.2"};He.defaultTags={"!!":"tag:yaml.org,2002:"};function Wx(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){const n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(e)}`;throw new Error(n)}return!0}function Kx(e){const s=new Set;return on(e,{Value(n,i){i.anchor&&s.add(i.anchor)}}),s}function Gx(e,s){for(let n=1;;++n){const i=`${e}${n}`;if(!s.has(i))return i}}function XT(e,s){const n=[],i=new Map;let r=null;return{onAnchor:a=>{n.push(a),r??(r=Kx(e));const o=Gx(s,r);return r.add(o),o},setAnchors:()=>{for(const a of n){const o=i.get(a);if(typeof o=="object"&&o.anchor&&(oe(o.node)||pe(o.node)))o.node.anchor=o.anchor;else{const l=new Error("Failed to resolve repeated object (this should not happen)");throw l.source=a,l}}},sourceObjects:i}}function zn(e,s,n,i){if(i&&typeof i=="object")if(Array.isArray(i))for(let r=0,a=i.length;r<a;++r){const o=i[r],l=zn(e,i,String(r),o);l===void 0?delete i[r]:l!==o&&(i[r]=l)}else if(i instanceof Map)for(const r of Array.from(i.keys())){const a=i.get(r),o=zn(e,i,r,a);o===void 0?i.delete(r):o!==a&&i.set(r,o)}else if(i instanceof Set)for(const r of Array.from(i)){const a=zn(e,i,r,r);a===void 0?i.delete(r):a!==r&&(i.delete(r),i.add(a))}else for(const[r,a]of Object.entries(i)){const o=zn(e,i,r,a);o===void 0?delete i[r]:o!==a&&(i[r]=o)}return e.call(s,n,i)}function zt(e,s,n){if(Array.isArray(e))return e.map((i,r)=>zt(i,String(r),n));if(e&&typeof e.toJSON=="function"){if(!n||!$x(e))return e.toJSON(s,n);const i={aliasCount:0,count:1,res:void 0};n.anchors.set(e,i),n.onCreate=a=>{i.res=a,delete n.onCreate};const r=e.toJSON(s,n);return n.onCreate&&n.onCreate(r),r}return typeof e=="bigint"&&!n?.keep?Number(e):e}class Mc{constructor(s){Object.defineProperty(this,Ct,{value:s})}clone(){const s=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(s.range=this.range.slice()),s}toJS(s,{mapAsMap:n,maxAliasCount:i,onAnchor:r,reviver:a}={}){if(!an(s))throw new TypeError("A document argument is required");const o={anchors:new Map,doc:s,keep:!0,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},l=zt(this,"",o);if(typeof r=="function")for(const{count:c,res:d}of o.anchors.values())r(d,c);return typeof a=="function"?zn(a,{"":l},"",l):l}}class Oa extends Mc{constructor(s){super(Ic),this.source=s,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(s,n){let i;n?.aliasResolveCache?i=n.aliasResolveCache:(i=[],on(s,{Node:(a,o)=>{(Rs(o)||$x(o))&&i.push(o)}}),n&&(n.aliasResolveCache=i));let r;for(const a of i){if(a===this)break;a.anchor===this.source&&(r=a)}return r}toJSON(s,n){if(!n)return{source:this.source};const{anchors:i,doc:r,maxAliasCount:a}=n,o=this.resolve(r,n);if(!o){const c=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(c)}let l=i.get(o);if(l||(zt(o,null,n),l=i.get(o)),!l||l.res===void 0){const c="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(c)}if(a>=0&&(l.count+=1,l.aliasCount===0&&(l.aliasCount=Wr(r,o,i)),l.count*l.aliasCount>a)){const c="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(c)}return l.res}toString(s,n,i){const r=`*${this.source}`;if(s){if(Wx(this.source),s.options.verifyAliasOrder&&!s.anchors.has(this.source)){const a=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(a)}if(s.implicitKey)return`${r} `}return r}}function Wr(e,s,n){if(Rs(s)){const i=s.resolve(e),r=n&&i&&n.get(i);return r?r.count*r.aliasCount:0}else if(pe(s)){let i=0;for(const r of s.items){const a=Wr(e,r,n);a>i&&(i=a)}return i}else if(ue(s)){const i=Wr(e,s.key,n),r=Wr(e,s.value,n);return Math.max(i,r)}return 1}const Hx=e=>!e||typeof e!="function"&&typeof e!="object";class Y extends Mc{constructor(s){super(Zt),this.value=s}toJSON(s,n){return n?.keep?this.value:zt(this.value,s,n)}toString(){return String(this.value)}}Y.BLOCK_FOLDED="BLOCK_FOLDED";Y.BLOCK_LITERAL="BLOCK_LITERAL";Y.PLAIN="PLAIN";Y.QUOTE_DOUBLE="QUOTE_DOUBLE";Y.QUOTE_SINGLE="QUOTE_SINGLE";const eA="tag:yaml.org,2002:";function tA(e,s,n){if(s){const i=n.filter(a=>a.tag===s),r=i.find(a=>!a.format)??i[0];if(!r)throw new Error(`Tag ${s} not found`);return r}return n.find(i=>i.identify?.(e)&&!i.format)}function Qi(e,s,n){if(an(e)&&(e=e.contents),fe(e))return e;if(ue(e)){const u=n.schema[Cs].createNode?.(n.schema,null,n);return u.items.push(e),u}(e instanceof String||e instanceof Number||e instanceof Boolean||typeof BigInt<"u"&&e instanceof BigInt)&&(e=e.valueOf());const{aliasDuplicateObjects:i,onAnchor:r,onTagObj:a,schema:o,sourceObjects:l}=n;let c;if(i&&e&&typeof e=="object"){if(c=l.get(e),c)return c.anchor??(c.anchor=r(e)),new Oa(c.anchor);c={anchor:null,node:null},l.set(e,c)}s?.startsWith("!!")&&(s=eA+s.slice(2));let d=tA(e,s,o.tags);if(!d){if(e&&typeof e.toJSON=="function"&&(e=e.toJSON()),!e||typeof e!="object"){const u=new Y(e);return c&&(c.node=u),u}d=e instanceof Map?o[Cs]:Symbol.iterator in Object(e)?o[si]:o[Cs]}a&&(a(d),delete n.onTagObj);const m=d?.createNode?d.createNode(n.schema,e,n):typeof d?.nodeClass?.from=="function"?d.nodeClass.from(n.schema,e,n):new Y(e);return s?m.tag=s:d.default||(m.tag=d.tag),c&&(c.node=m),m}function ca(e,s,n){let i=n;for(let r=s.length-1;r>=0;--r){const a=s[r];if(typeof a=="number"&&Number.isInteger(a)&&a>=0){const o=[];o[a]=i,i=o}else i=new Map([[a,i]])}return Qi(i,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}const wi=e=>e==null||typeof e=="object"&&!!e[Symbol.iterator]().next().done;class Qx extends Mc{constructor(s,n){super(s),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(s){const n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return s&&(n.schema=s),n.items=n.items.map(i=>fe(i)||ue(i)?i.clone(s):i),this.range&&(n.range=this.range.slice()),n}addIn(s,n){if(wi(s))this.add(n);else{const[i,...r]=s,a=this.get(i,!0);if(pe(a))a.addIn(r,n);else if(a===void 0&&this.schema)this.set(i,ca(this.schema,r,n));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${r}`)}}deleteIn(s){const[n,...i]=s;if(i.length===0)return this.delete(n);const r=this.get(n,!0);if(pe(r))return r.deleteIn(i);throw new Error(`Expected YAML collection at ${n}. Remaining path: ${i}`)}getIn(s,n){const[i,...r]=s,a=this.get(i,!0);return r.length===0?!n&&oe(a)?a.value:a:pe(a)?a.getIn(r,n):void 0}hasAllNullValues(s){return this.items.every(n=>{if(!ue(n))return!1;const i=n.value;return i==null||s&&oe(i)&&i.value==null&&!i.commentBefore&&!i.comment&&!i.tag})}hasIn(s){const[n,...i]=s;if(i.length===0)return this.has(n);const r=this.get(n,!0);return pe(r)?r.hasIn(i):!1}setIn(s,n){const[i,...r]=s;if(r.length===0)this.set(i,n);else{const a=this.get(i,!0);if(pe(a))a.setIn(r,n);else if(a===void 0&&this.schema)this.set(i,ca(this.schema,r,n));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${r}`)}}}const sA=e=>e.replace(/^(?!$)(?: $)?/gm,"#");function os(e,s){return/^\n+$/.test(e)?e.substring(1):s?e.replace(/^(?! *$)/gm,s):e}const Us=(e,s,n)=>e.endsWith(`
`)?os(n,s):n.includes(`
`)?`
`+os(n,s):(e.endsWith(" ")?"":" ")+n,Yx="flow",pl="block",Kr="quoted";function Ra(e,s,n="flow",{indentAtStart:i,lineWidth:r=80,minContentWidth:a=20,onFold:o,onOverflow:l}={}){if(!r||r<0)return e;r<a&&(a=0);const c=Math.max(1+a,1+r-s.length);if(e.length<=c)return e;const d=[],m={};let u=r-s.length;typeof i=="number"&&(i>r-Math.max(2,a)?d.push(0):u=r-i);let h,p,g=!1,f=-1,y=-1,b=-1;n===pl&&(f=em(e,f,s.length),f!==-1&&(u=f+c));for(let w;w=e[f+=1];){if(n===Kr&&w==="\\"){switch(y=f,e[f+1]){case"x":f+=3;break;case"u":f+=5;break;case"U":f+=9;break;default:f+=1}b=f}if(w===`
`)n===pl&&(f=em(e,f,s.length)),u=f+s.length+c,h=void 0;else{if(w===" "&&p&&p!==" "&&p!==`
`&&p!=="	"){const S=e[f+1];S&&S!==" "&&S!==`
`&&S!=="	"&&(h=f)}if(f>=u)if(h)d.push(h),u=h+c,h=void 0;else if(n===Kr){for(;p===" "||p==="	";)p=w,w=e[f+=1],g=!0;const S=f>b+1?f-2:y-1;if(m[S])return e;d.push(S),m[S]=!0,u=S+c,h=void 0}else g=!0}p=w}if(g&&l&&l(),d.length===0)return e;o&&o();let j=e.slice(0,d[0]);for(let w=0;w<d.length;++w){const S=d[w],k=d[w+1]||e.length;S===0?j=`
${s}${e.slice(0,k)}`:(n===Kr&&m[S]&&(j+=`${e[S]}\\`),j+=`
${s}${e.slice(S+1,k)}`)}return j}function em(e,s,n){let i=s,r=s+1,a=e[r];for(;a===" "||a==="	";)if(s<r+n)a=e[++s];else{do a=e[++s];while(a&&a!==`
`);i=s,r=s+1,a=e[r]}return i}const Fa=(e,s)=>({indentAtStart:s?e.indent.length:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),$a=e=>/^(%|---|\.\.\.)/m.test(e);function nA(e,s,n){if(!s||s<0)return!1;const i=s-n,r=e.length;if(r<=i)return!1;for(let a=0,o=0;a<r;++a)if(e[a]===`
`){if(a-o>i)return!0;if(o=a+1,r-o<=i)return!1}return!0}function Pi(e,s){const n=JSON.stringify(e);if(s.options.doubleQuotedAsJSON)return n;const{implicitKey:i}=s,r=s.options.doubleQuotedMinMultiLineLength,a=s.indent||($a(e)?"  ":"");let o="",l=0;for(let c=0,d=n[c];d;d=n[++c])if(d===" "&&n[c+1]==="\\"&&n[c+2]==="n"&&(o+=n.slice(l,c)+"\\ ",c+=1,l=c,d="\\"),d==="\\")switch(n[c+1]){case"u":{o+=n.slice(l,c);const m=n.substr(c+2,4);switch(m){case"0000":o+="\\0";break;case"0007":o+="\\a";break;case"000b":o+="\\v";break;case"001b":o+="\\e";break;case"0085":o+="\\N";break;case"00a0":o+="\\_";break;case"2028":o+="\\L";break;case"2029":o+="\\P";break;default:m.substr(0,2)==="00"?o+="\\x"+m.substr(2):o+=n.substr(c,6)}c+=5,l=c+1}break;case"n":if(i||n[c+2]==='"'||n.length<r)c+=1;else{for(o+=n.slice(l,c)+`

`;n[c+2]==="\\"&&n[c+3]==="n"&&n[c+4]!=='"';)o+=`
`,c+=2;o+=a,n[c+2]===" "&&(o+="\\"),c+=1,l=c+1}break;default:c+=1}return o=l?o+n.slice(l):n,i?o:Ra(o,a,Kr,Fa(s,!1))}function fl(e,s){if(s.options.singleQuote===!1||s.implicitKey&&e.includes(`
`)||/[ \t]\n|\n[ \t]/.test(e))return Pi(e,s);const n=s.indent||($a(e)?"  ":""),i="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&
${n}`)+"'";return s.implicitKey?i:Ra(i,n,Yx,Fa(s,!1))}function Sn(e,s){const{singleQuote:n}=s.options;let i;if(n===!1)i=Pi;else{const r=e.includes('"'),a=e.includes("'");r&&!a?i=fl:a&&!r?i=Pi:i=n?fl:Pi}return i(e,s)}let xl;try{xl=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{xl=/\n+(?!\n|$)/g}function Gr({comment:e,type:s,value:n},i,r,a){const{blockQuote:o,commentString:l,lineWidth:c}=i.options;if(!o||/\n[\t ]+$/.test(n)||/^\s*$/.test(n))return Sn(n,i);const d=i.indent||(i.forceBlockIndent||$a(n)?"  ":""),m=o==="literal"?!0:o==="folded"||s===Y.BLOCK_FOLDED?!1:s===Y.BLOCK_LITERAL?!0:!nA(n,c,d.length);if(!n)return m?`|
`:`>
`;let u,h;for(h=n.length;h>0;--h){const k=n[h-1];if(k!==`
`&&k!=="	"&&k!==" ")break}let p=n.substring(h);const g=p.indexOf(`
`);g===-1?u="-":n===p||g!==p.length-1?(u="+",a&&a()):u="",p&&(n=n.slice(0,-p.length),p[p.length-1]===`
`&&(p=p.slice(0,-1)),p=p.replace(xl,`$&${d}`));let f=!1,y,b=-1;for(y=0;y<n.length;++y){const k=n[y];if(k===" ")f=!0;else if(k===`
`)b=y;else break}let j=n.substring(0,b<y?b+1:y);j&&(n=n.substring(j.length),j=j.replace(/\n+/g,`$&${d}`));let S=(f?d?"2":"1":"")+u;if(e&&(S+=" "+l(e.replace(/ ?[\r\n]+/g," ")),r&&r()),!m){const k=n.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${d}`);let z=!1;const N=Fa(i,!0);o!=="folded"&&s!==Y.BLOCK_FOLDED&&(N.onOverflow=()=>{z=!0});const C=Ra(`${j}${k}${p}`,d,pl,N);if(!z)return`>${S}
${d}${C}`}return n=n.replace(/\n+/g,`$&${d}`),`|${S}
${d}${j}${n}${p}`}function iA(e,s,n,i){const{type:r,value:a}=e,{actualString:o,implicitKey:l,indent:c,indentStep:d,inFlow:m}=s;if(l&&a.includes(`
`)||m&&/[[\]{},]/.test(a))return Sn(a,s);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(a))return l||m||!a.includes(`
`)?Sn(a,s):Gr(e,s,n,i);if(!l&&!m&&r!==Y.PLAIN&&a.includes(`
`))return Gr(e,s,n,i);if($a(a)){if(c==="")return s.forceBlockIndent=!0,Gr(e,s,n,i);if(l&&c===d)return Sn(a,s)}const u=a.replace(/\n+/g,`$&
${c}`);if(o){const h=f=>f.default&&f.tag!=="tag:yaml.org,2002:str"&&f.test?.test(u),{compat:p,tags:g}=s.doc.schema;if(g.some(h)||p?.some(h))return Sn(a,s)}return l?u:Ra(u,c,Yx,Fa(s,!1))}function br(e,s,n,i){const{implicitKey:r,inFlow:a}=s,o=typeof e.value=="string"?e:Object.assign({},e,{value:String(e.value)});let{type:l}=e;l!==Y.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(o.value)&&(l=Y.QUOTE_DOUBLE);const c=m=>{switch(m){case Y.BLOCK_FOLDED:case Y.BLOCK_LITERAL:return r||a?Sn(o.value,s):Gr(o,s,n,i);case Y.QUOTE_DOUBLE:return Pi(o.value,s);case Y.QUOTE_SINGLE:return fl(o.value,s);case Y.PLAIN:return iA(o,s,n,i);default:return null}};let d=c(l);if(d===null){const{defaultKeyType:m,defaultStringType:u}=s.options,h=r&&m||u;if(d=c(h),d===null)throw new Error(`Unsupported default string type ${h}`)}return d}function Zx(e,s){const n=Object.assign({blockQuote:!0,commentString:sA,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,s);let i;switch(n.collectionStyle){case"block":i=!1;break;case"flow":i=!0;break;default:i=null}return{anchors:new Set,doc:e,flowCollectionPadding:n.flowCollectionPadding?" ":"",indent:"",indentStep:typeof n.indent=="number"?" ".repeat(n.indent):"  ",inFlow:i,options:n}}function rA(e,s){if(s.tag){const r=e.filter(a=>a.tag===s.tag);if(r.length>0)return r.find(a=>a.format===s.format)??r[0]}let n,i;if(oe(s)){i=s.value;let r=e.filter(a=>a.identify?.(i));if(r.length>1){const a=r.filter(o=>o.test);a.length>0&&(r=a)}n=r.find(a=>a.format===s.format)??r.find(a=>!a.format)}else i=s,n=e.find(r=>r.nodeClass&&i instanceof r.nodeClass);if(!n){const r=i?.constructor?.name??(i===null?"null":typeof i);throw new Error(`Tag not resolved for ${r} value`)}return n}function aA(e,s,{anchors:n,doc:i}){if(!i.directives)return"";const r=[],a=(oe(e)||pe(e))&&e.anchor;a&&Wx(a)&&(n.add(a),r.push(`&${a}`));const o=e.tag??(s.default?null:s.tag);return o&&r.push(i.directives.tagString(o)),r.join(" ")}function qn(e,s,n,i){if(ue(e))return e.toString(s,n,i);if(Rs(e)){if(s.doc.directives)return e.toString(s);if(s.resolvedAliases?.has(e))throw new TypeError("Cannot stringify circular structure without alias nodes");s.resolvedAliases?s.resolvedAliases.add(e):s.resolvedAliases=new Set([e]),e=e.resolve(s.doc)}let r;const a=fe(e)?e:s.doc.createNode(e,{onTagObj:c=>r=c});r??(r=rA(s.doc.schema.tags,a));const o=aA(a,r,s);o.length>0&&(s.indentAtStart=(s.indentAtStart??0)+o.length+1);const l=typeof r.stringify=="function"?r.stringify(a,s,n,i):oe(a)?br(a,s,n,i):a.toString(s,n,i);return o?oe(a)||l[0]==="{"||l[0]==="["?`${o} ${l}`:`${o}
${s.indent}${l}`:l}function oA({key:e,value:s},n,i,r){const{allNullValues:a,doc:o,indent:l,indentStep:c,options:{commentString:d,indentSeq:m,simpleKeys:u}}=n;let h=fe(e)&&e.comment||null;if(u){if(h)throw new Error("With simple keys, key nodes cannot have comments");if(pe(e)||!fe(e)&&typeof e=="object"){const N="With simple keys, collection cannot be used as a key value";throw new Error(N)}}let p=!u&&(!e||h&&s==null&&!n.inFlow||pe(e)||(oe(e)?e.type===Y.BLOCK_FOLDED||e.type===Y.BLOCK_LITERAL:typeof e=="object"));n=Object.assign({},n,{allNullValues:!1,implicitKey:!p&&(u||!a),indent:l+c});let g=!1,f=!1,y=qn(e,n,()=>g=!0,()=>f=!0);if(!p&&!n.inFlow&&y.length>1024){if(u)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");p=!0}if(n.inFlow){if(a||s==null)return g&&i&&i(),y===""?"?":p?`? ${y}`:y}else if(a&&!u||s==null&&p)return y=`? ${y}`,h&&!g?y+=Us(y,n.indent,d(h)):f&&r&&r(),y;g&&(h=null),p?(h&&(y+=Us(y,n.indent,d(h))),y=`? ${y}
${l}:`):(y=`${y}:`,h&&(y+=Us(y,n.indent,d(h))));let b,j,w;fe(s)?(b=!!s.spaceBefore,j=s.commentBefore,w=s.comment):(b=!1,j=null,w=null,s&&typeof s=="object"&&(s=o.createNode(s))),n.implicitKey=!1,!p&&!h&&oe(s)&&(n.indentAtStart=y.length+1),f=!1,!m&&c.length>=2&&!n.inFlow&&!p&&ii(s)&&!s.flow&&!s.tag&&!s.anchor&&(n.indent=n.indent.substring(2));let S=!1;const k=qn(s,n,()=>S=!0,()=>f=!0);let z=" ";if(h||b||j){if(z=b?`
`:"",j){const N=d(j);z+=`
${os(N,n.indent)}`}k===""&&!n.inFlow?z===`
`&&(z=`

`):z+=`
${n.indent}`}else if(!p&&pe(s)){const N=k[0],C=k.indexOf(`
`),A=C!==-1,v=n.inFlow??s.flow??s.items.length===0;if(A||!v){let P=!1;if(A&&(N==="&"||N==="!")){let D=k.indexOf(" ");N==="&"&&D!==-1&&D<C&&k[D+1]==="!"&&(D=k.indexOf(" ",D+1)),(D===-1||C<D)&&(P=!0)}P||(z=`
${n.indent}`)}}else(k===""||k[0]===`
`)&&(z="");return y+=z+k,n.inFlow?S&&i&&i():w&&!S?y+=Us(y,n.indent,d(w)):f&&r&&r(),y}function Jx(e,s){(e==="debug"||e==="warn")&&console.warn(s)}const Ir="<<",ls={identify:e=>e===Ir||typeof e=="symbol"&&e.description===Ir,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new Y(Symbol(Ir)),{addToJSMap:Xx}),stringify:()=>Ir},lA=(e,s)=>(ls.identify(s)||oe(s)&&(!s.type||s.type===Y.PLAIN)&&ls.identify(s.value))&&e?.doc.schema.tags.some(n=>n.tag===ls.tag&&n.default);function Xx(e,s,n){if(n=e&&Rs(n)?n.resolve(e.doc):n,ii(n))for(const i of n.items)zo(e,s,i);else if(Array.isArray(n))for(const i of n)zo(e,s,i);else zo(e,s,n)}function zo(e,s,n){const i=e&&Rs(n)?n.resolve(e.doc):n;if(!ni(i))throw new Error("Merge sources must be maps or map aliases");const r=i.toJSON(null,e,Map);for(const[a,o]of r)s instanceof Map?s.has(a)||s.set(a,o):s instanceof Set?s.add(a):Object.prototype.hasOwnProperty.call(s,a)||Object.defineProperty(s,a,{value:o,writable:!0,enumerable:!0,configurable:!0});return s}function eg(e,s,{key:n,value:i}){if(fe(n)&&n.addToJSMap)n.addToJSMap(e,s,i);else if(lA(e,n))Xx(e,s,i);else{const r=zt(n,"",e);if(s instanceof Map)s.set(r,zt(i,r,e));else if(s instanceof Set)s.add(r);else{const a=cA(n,r,e),o=zt(i,a,e);a in s?Object.defineProperty(s,a,{value:o,writable:!0,enumerable:!0,configurable:!0}):s[a]=o}}return s}function cA(e,s,n){if(s===null)return"";if(typeof s!="object")return String(s);if(fe(e)&&n?.doc){const i=Zx(n.doc,{});i.anchors=new Set;for(const a of n.anchors.keys())i.anchors.add(a.anchor);i.inFlow=!0,i.inStringifyKey=!0;const r=e.toString(i);if(!n.mapKeyWarned){let a=JSON.stringify(r);a.length>40&&(a=a.substring(0,36)+'..."'),Jx(n.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${a}. Set mapAsMap: true to use object keys.`),n.mapKeyWarned=!0}return r}return JSON.stringify(s)}function Lc(e,s,n){const i=Qi(e,void 0,n),r=Qi(s,void 0,n);return new Ke(i,r)}class Ke{constructor(s,n=null){Object.defineProperty(this,Ct,{value:Fx}),this.key=s,this.value=n}clone(s){let{key:n,value:i}=this;return fe(n)&&(n=n.clone(s)),fe(i)&&(i=i.clone(s)),new Ke(n,i)}toJSON(s,n){const i=n?.mapAsMap?new Map:{};return eg(n,i,this)}toString(s,n,i){return s?.doc?oA(this,s,n,i):JSON.stringify(this)}}function tg(e,s,n){return(s.inFlow??e.flow?uA:dA)(e,s,n)}function dA({comment:e,items:s},n,{blockItemPrefix:i,flowChars:r,itemIndent:a,onChompKeep:o,onComment:l}){const{indent:c,options:{commentString:d}}=n,m=Object.assign({},n,{indent:a,type:null});let u=!1;const h=[];for(let g=0;g<s.length;++g){const f=s[g];let y=null;if(fe(f))!u&&f.spaceBefore&&h.push(""),da(n,h,f.commentBefore,u),f.comment&&(y=f.comment);else if(ue(f)){const j=fe(f.key)?f.key:null;j&&(!u&&j.spaceBefore&&h.push(""),da(n,h,j.commentBefore,u))}u=!1;let b=qn(f,m,()=>y=null,()=>u=!0);y&&(b+=Us(b,a,d(y))),u&&y&&(u=!1),h.push(i+b)}let p;if(h.length===0)p=r.start+r.end;else{p=h[0];for(let g=1;g<h.length;++g){const f=h[g];p+=f?`
${c}${f}`:`
`}}return e?(p+=`
`+os(d(e),c),l&&l()):u&&o&&o(),p}function uA({items:e},s,{flowChars:n,itemIndent:i}){const{indent:r,indentStep:a,flowCollectionPadding:o,options:{commentString:l}}=s;i+=a;const c=Object.assign({},s,{indent:i,inFlow:!0,type:null});let d=!1,m=0;const u=[];for(let g=0;g<e.length;++g){const f=e[g];let y=null;if(fe(f))f.spaceBefore&&u.push(""),da(s,u,f.commentBefore,!1),f.comment&&(y=f.comment);else if(ue(f)){const j=fe(f.key)?f.key:null;j&&(j.spaceBefore&&u.push(""),da(s,u,j.commentBefore,!1),j.comment&&(d=!0));const w=fe(f.value)?f.value:null;w?(w.comment&&(y=w.comment),w.commentBefore&&(d=!0)):f.value==null&&j?.comment&&(y=j.comment)}y&&(d=!0);let b=qn(f,c,()=>y=null);g<e.length-1&&(b+=","),y&&(b+=Us(b,i,l(y))),!d&&(u.length>m||b.includes(`
`))&&(d=!0),u.push(b),m=u.length}const{start:h,end:p}=n;if(u.length===0)return h+p;if(!d){const g=u.reduce((f,y)=>f+y.length+2,2);d=s.options.lineWidth>0&&g>s.options.lineWidth}if(d){let g=h;for(const f of u)g+=f?`
${a}${r}${f}`:`
`;return`${g}
${r}${p}`}else return`${h}${o}${u.join(" ")}${o}${p}`}function da({indent:e,options:{commentString:s}},n,i,r){if(i&&r&&(i=i.replace(/^\n+/,"")),i){const a=os(s(i),e);n.push(a.trimStart())}}function Ws(e,s){const n=oe(s)?s.value:s;for(const i of e)if(ue(i)&&(i.key===s||i.key===n||oe(i.key)&&i.key.value===n))return i}class ct extends Qx{static get tagName(){return"tag:yaml.org,2002:map"}constructor(s){super(Cs,s),this.items=[]}static from(s,n,i){const{keepUndefined:r,replacer:a}=i,o=new this(s),l=(c,d)=>{if(typeof a=="function")d=a.call(n,c,d);else if(Array.isArray(a)&&!a.includes(c))return;(d!==void 0||r)&&o.items.push(Lc(c,d,i))};if(n instanceof Map)for(const[c,d]of n)l(c,d);else if(n&&typeof n=="object")for(const c of Object.keys(n))l(c,n[c]);return typeof s.sortMapEntries=="function"&&o.items.sort(s.sortMapEntries),o}add(s,n){let i;ue(s)?i=s:!s||typeof s!="object"||!("key"in s)?i=new Ke(s,s?.value):i=new Ke(s.key,s.value);const r=Ws(this.items,i.key),a=this.schema?.sortMapEntries;if(r){if(!n)throw new Error(`Key ${i.key} already set`);oe(r.value)&&Hx(i.value)?r.value.value=i.value:r.value=i.value}else if(a){const o=this.items.findIndex(l=>a(i,l)<0);o===-1?this.items.push(i):this.items.splice(o,0,i)}else this.items.push(i)}delete(s){const n=Ws(this.items,s);return n?this.items.splice(this.items.indexOf(n),1).length>0:!1}get(s,n){const r=Ws(this.items,s)?.value;return(!n&&oe(r)?r.value:r)??void 0}has(s){return!!Ws(this.items,s)}set(s,n){this.add(new Ke(s,n),!0)}toJSON(s,n,i){const r=i?new i:n?.mapAsMap?new Map:{};n?.onCreate&&n.onCreate(r);for(const a of this.items)eg(n,r,a);return r}toString(s,n,i){if(!s)return JSON.stringify(this);for(const r of this.items)if(!ue(r))throw new Error(`Map items must all be pairs; found ${JSON.stringify(r)} instead`);return!s.allNullValues&&this.hasAllNullValues(!1)&&(s=Object.assign({},s,{allNullValues:!0})),tg(this,s,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:s.indent||"",onChompKeep:i,onComment:n})}}const ri={collection:"map",default:!0,nodeClass:ct,tag:"tag:yaml.org,2002:map",resolve(e,s){return ni(e)||s("Expected a mapping for this tag"),e},createNode:(e,s,n)=>ct.from(e,s,n)};class Ms extends Qx{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(s){super(si,s),this.items=[]}add(s){this.items.push(s)}delete(s){const n=Mr(s);return typeof n!="number"?!1:this.items.splice(n,1).length>0}get(s,n){const i=Mr(s);if(typeof i!="number")return;const r=this.items[i];return!n&&oe(r)?r.value:r}has(s){const n=Mr(s);return typeof n=="number"&&n<this.items.length}set(s,n){const i=Mr(s);if(typeof i!="number")throw new Error(`Expected a valid index, not ${s}.`);const r=this.items[i];oe(r)&&Hx(n)?r.value=n:this.items[i]=n}toJSON(s,n){const i=[];n?.onCreate&&n.onCreate(i);let r=0;for(const a of this.items)i.push(zt(a,String(r++),n));return i}toString(s,n,i){return s?tg(this,s,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(s.indent||"")+"  ",onChompKeep:i,onComment:n}):JSON.stringify(this)}static from(s,n,i){const{replacer:r}=i,a=new this(s);if(n&&Symbol.iterator in Object(n)){let o=0;for(let l of n){if(typeof r=="function"){const c=n instanceof Set?l:String(o++);l=r.call(n,c,l)}a.items.push(Qi(l,void 0,i))}}return a}}function Mr(e){let s=oe(e)?e.value:e;return s&&typeof s=="string"&&(s=Number(s)),typeof s=="number"&&Number.isInteger(s)&&s>=0?s:null}const ai={collection:"seq",default:!0,nodeClass:Ms,tag:"tag:yaml.org,2002:seq",resolve(e,s){return ii(e)||s("Expected a sequence for this tag"),e},createNode:(e,s,n)=>Ms.from(e,s,n)},qa={identify:e=>typeof e=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify(e,s,n,i){return s=Object.assign({actualString:!0},s),br(e,s,n,i)}},Va={identify:e=>e==null,createNode:()=>new Y(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new Y(null),stringify:({source:e},s)=>typeof e=="string"&&Va.test.test(e)?e:s.options.nullStr},Oc={identify:e=>typeof e=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new Y(e[0]==="t"||e[0]==="T"),stringify({source:e,value:s},n){if(e&&Oc.test.test(e)){const i=e[0]==="t"||e[0]==="T";if(s===i)return e}return s?n.options.trueStr:n.options.falseStr}};function Rt({format:e,minFractionDigits:s,tag:n,value:i}){if(typeof i=="bigint")return String(i);const r=typeof i=="number"?i:Number(i);if(!isFinite(r))return isNaN(r)?".nan":r<0?"-.inf":".inf";let a=JSON.stringify(i);if(!e&&s&&(!n||n==="tag:yaml.org,2002:float")&&/^\d/.test(a)){let o=a.indexOf(".");o<0&&(o=a.length,a+=".");let l=s-(a.length-o-1);for(;l-- >0;)a+="0"}return a}const sg={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>e.slice(-3).toLowerCase()==="nan"?NaN:e[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Rt},ng={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){const s=Number(e.value);return isFinite(s)?s.toExponential():Rt(e)}},ig={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){const s=new Y(parseFloat(e)),n=e.indexOf(".");return n!==-1&&e[e.length-1]==="0"&&(s.minFractionDigits=e.length-n-1),s},stringify:Rt},Ba=e=>typeof e=="bigint"||Number.isInteger(e),Rc=(e,s,n,{intAsBigInt:i})=>i?BigInt(e):parseInt(e.substring(s),n);function rg(e,s,n){const{value:i}=e;return Ba(i)&&i>=0?n+i.toString(s):Rt(e)}const ag={identify:e=>Ba(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,s,n)=>Rc(e,2,8,n),stringify:e=>rg(e,8,"0o")},og={identify:Ba,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,s,n)=>Rc(e,0,10,n),stringify:Rt},lg={identify:e=>Ba(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,s,n)=>Rc(e,2,16,n),stringify:e=>rg(e,16,"0x")},mA=[ri,ai,qa,Va,Oc,ag,og,lg,sg,ng,ig];function tm(e){return typeof e=="bigint"||Number.isInteger(e)}const Lr=({value:e})=>JSON.stringify(e),hA=[{identify:e=>typeof e=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:Lr},{identify:e=>e==null,createNode:()=>new Y(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:Lr},{identify:e=>typeof e=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:e=>e==="true",stringify:Lr},{identify:tm,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,s,{intAsBigInt:n})=>n?BigInt(e):parseInt(e,10),stringify:({value:e})=>tm(e)?e.toString():JSON.stringify(e)},{identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:Lr}],pA={default:!0,tag:"",test:/^/,resolve(e,s){return s(`Unresolved plain scalar ${JSON.stringify(e)}`),e}},fA=[ri,ai].concat(hA,pA),Fc={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,s){if(typeof atob=="function"){const n=atob(e.replace(/[\n\r]/g,"")),i=new Uint8Array(n.length);for(let r=0;r<n.length;++r)i[r]=n.charCodeAt(r);return i}else return s("This environment does not support reading binary tags; either Buffer or atob is required"),e},stringify({comment:e,type:s,value:n},i,r,a){if(!n)return"";const o=n;let l;if(typeof btoa=="function"){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);l=btoa(c)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(s??(s=Y.BLOCK_LITERAL),s!==Y.QUOTE_DOUBLE){const c=Math.max(i.options.lineWidth-i.indent.length,i.options.minContentWidth),d=Math.ceil(l.length/c),m=new Array(d);for(let u=0,h=0;u<d;++u,h+=c)m[u]=l.substr(h,c);l=m.join(s===Y.BLOCK_LITERAL?`
`:" ")}return br({comment:e,type:s,value:l},i,r,a)}};function cg(e,s){if(ii(e))for(let n=0;n<e.items.length;++n){let i=e.items[n];if(!ue(i)){if(ni(i)){i.items.length>1&&s("Each pair must have its own sequence indicator");const r=i.items[0]||new Ke(new Y(null));if(i.commentBefore&&(r.key.commentBefore=r.key.commentBefore?`${i.commentBefore}
${r.key.commentBefore}`:i.commentBefore),i.comment){const a=r.value??r.key;a.comment=a.comment?`${i.comment}
${a.comment}`:i.comment}i=r}e.items[n]=ue(i)?i:new Ke(i)}}else s("Expected a sequence for this tag");return e}function dg(e,s,n){const{replacer:i}=n,r=new Ms(e);r.tag="tag:yaml.org,2002:pairs";let a=0;if(s&&Symbol.iterator in Object(s))for(let o of s){typeof i=="function"&&(o=i.call(s,String(a++),o));let l,c;if(Array.isArray(o))if(o.length===2)l=o[0],c=o[1];else throw new TypeError(`Expected [key, value] tuple: ${o}`);else if(o&&o instanceof Object){const d=Object.keys(o);if(d.length===1)l=d[0],c=o[l];else throw new TypeError(`Expected tuple with one key, not ${d.length} keys`)}else l=o;r.items.push(Lc(l,c,n))}return r}const $c={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:cg,createNode:dg};class En extends Ms{constructor(){super(),this.add=ct.prototype.add.bind(this),this.delete=ct.prototype.delete.bind(this),this.get=ct.prototype.get.bind(this),this.has=ct.prototype.has.bind(this),this.set=ct.prototype.set.bind(this),this.tag=En.tag}toJSON(s,n){if(!n)return super.toJSON(s);const i=new Map;n?.onCreate&&n.onCreate(i);for(const r of this.items){let a,o;if(ue(r)?(a=zt(r.key,"",n),o=zt(r.value,a,n)):a=zt(r,"",n),i.has(a))throw new Error("Ordered maps must not include duplicate keys");i.set(a,o)}return i}static from(s,n,i){const r=dg(s,n,i),a=new this;return a.items=r.items,a}}En.tag="tag:yaml.org,2002:omap";const qc={collection:"seq",identify:e=>e instanceof Map,nodeClass:En,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,s){const n=cg(e,s),i=[];for(const{key:r}of n.items)oe(r)&&(i.includes(r.value)?s(`Ordered maps must not include duplicate keys: ${r.value}`):i.push(r.value));return Object.assign(new En,n)},createNode:(e,s,n)=>En.from(e,s,n)};function ug({value:e,source:s},n){return s&&(e?mg:hg).test.test(s)?s:e?n.options.trueStr:n.options.falseStr}const mg={identify:e=>e===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new Y(!0),stringify:ug},hg={identify:e=>e===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new Y(!1),stringify:ug},xA={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>e.slice(-3).toLowerCase()==="nan"?NaN:e[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Rt},gA={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){const s=Number(e.value);return isFinite(s)?s.toExponential():Rt(e)}},yA={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){const s=new Y(parseFloat(e.replace(/_/g,""))),n=e.indexOf(".");if(n!==-1){const i=e.substring(n+1).replace(/_/g,"");i[i.length-1]==="0"&&(s.minFractionDigits=i.length)}return s},stringify:Rt},wr=e=>typeof e=="bigint"||Number.isInteger(e);function Ua(e,s,n,{intAsBigInt:i}){const r=e[0];if((r==="-"||r==="+")&&(s+=1),e=e.substring(s).replace(/_/g,""),i){switch(n){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`;break}const o=BigInt(e);return r==="-"?BigInt(-1)*o:o}const a=parseInt(e,n);return r==="-"?-1*a:a}function Vc(e,s,n){const{value:i}=e;if(wr(i)){const r=i.toString(s);return i<0?"-"+n+r.substr(1):n+r}return Rt(e)}const jA={identify:wr,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,s,n)=>Ua(e,2,2,n),stringify:e=>Vc(e,2,"0b")},bA={identify:wr,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,s,n)=>Ua(e,1,8,n),stringify:e=>Vc(e,8,"0")},wA={identify:wr,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,s,n)=>Ua(e,0,10,n),stringify:Rt},vA={identify:wr,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,s,n)=>Ua(e,2,16,n),stringify:e=>Vc(e,16,"0x")};class Dn extends ct{constructor(s){super(s),this.tag=Dn.tag}add(s){let n;ue(s)?n=s:s&&typeof s=="object"&&"key"in s&&"value"in s&&s.value===null?n=new Ke(s.key,null):n=new Ke(s,null),Ws(this.items,n.key)||this.items.push(n)}get(s,n){const i=Ws(this.items,s);return!n&&ue(i)?oe(i.key)?i.key.value:i.key:i}set(s,n){if(typeof n!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);const i=Ws(this.items,s);i&&!n?this.items.splice(this.items.indexOf(i),1):!i&&n&&this.items.push(new Ke(s))}toJSON(s,n){return super.toJSON(s,n,Set)}toString(s,n,i){if(!s)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},s,{allNullValues:!0}),n,i);throw new Error("Set items must all have null values")}static from(s,n,i){const{replacer:r}=i,a=new this(s);if(n&&Symbol.iterator in Object(n))for(let o of n)typeof r=="function"&&(o=r.call(n,o,o)),a.items.push(Lc(o,null,i));return a}}Dn.tag="tag:yaml.org,2002:set";const Bc={collection:"map",identify:e=>e instanceof Set,nodeClass:Dn,default:!1,tag:"tag:yaml.org,2002:set",createNode:(e,s,n)=>Dn.from(e,s,n),resolve(e,s){if(ni(e)){if(e.hasAllNullValues(!0))return Object.assign(new Dn,e);s("Set items must all have null values")}else s("Expected a mapping for this tag");return e}};function Uc(e,s){const n=e[0],i=n==="-"||n==="+"?e.substring(1):e,r=o=>s?BigInt(o):Number(o),a=i.replace(/_/g,"").split(":").reduce((o,l)=>o*r(60)+r(l),r(0));return n==="-"?r(-1)*a:a}function pg(e){let{value:s}=e,n=o=>o;if(typeof s=="bigint")n=o=>BigInt(o);else if(isNaN(s)||!isFinite(s))return Rt(e);let i="";s<0&&(i="-",s*=n(-1));const r=n(60),a=[s%r];return s<60?a.unshift(0):(s=(s-a[0])/r,a.unshift(s%r),s>=60&&(s=(s-a[0])/r,a.unshift(s))),i+a.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const fg={identify:e=>typeof e=="bigint"||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,s,{intAsBigInt:n})=>Uc(e,n),stringify:pg},xg={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>Uc(e,!1),stringify:pg},Wa={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){const s=e.match(Wa.test);if(!s)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,n,i,r,a,o,l]=s.map(Number),c=s[7]?Number((s[7]+"00").substr(1,3)):0;let d=Date.UTC(n,i-1,r,a||0,o||0,l||0,c);const m=s[8];if(m&&m!=="Z"){let u=Uc(m,!1);Math.abs(u)<30&&(u*=60),d-=6e4*u}return new Date(d)},stringify:({value:e})=>e?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""},sm=[ri,ai,qa,Va,mg,hg,jA,bA,wA,vA,xA,gA,yA,Fc,ls,qc,$c,Bc,fg,xg,Wa],nm=new Map([["core",mA],["failsafe",[ri,ai,qa]],["json",fA],["yaml11",sm],["yaml-1.1",sm]]),im={binary:Fc,bool:Oc,float:ig,floatExp:ng,floatNaN:sg,floatTime:xg,int:og,intHex:lg,intOct:ag,intTime:fg,map:ri,merge:ls,null:Va,omap:qc,pairs:$c,seq:ai,set:Bc,timestamp:Wa},NA={"tag:yaml.org,2002:binary":Fc,"tag:yaml.org,2002:merge":ls,"tag:yaml.org,2002:omap":qc,"tag:yaml.org,2002:pairs":$c,"tag:yaml.org,2002:set":Bc,"tag:yaml.org,2002:timestamp":Wa};function So(e,s,n){const i=nm.get(s);if(i&&!e)return n&&!i.includes(ls)?i.concat(ls):i.slice();let r=i;if(!r)if(Array.isArray(e))r=[];else{const a=Array.from(nm.keys()).filter(o=>o!=="yaml11").map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown schema "${s}"; use one of ${a} or define customTags array`)}if(Array.isArray(e))for(const a of e)r=r.concat(a);else typeof e=="function"&&(r=e(r.slice()));return n&&(r=r.concat(ls)),r.reduce((a,o)=>{const l=typeof o=="string"?im[o]:o;if(!l){const c=JSON.stringify(o),d=Object.keys(im).map(m=>JSON.stringify(m)).join(", ");throw new Error(`Unknown custom tag ${c}; use one of ${d}`)}return a.includes(l)||a.push(l),a},[])}const kA=(e,s)=>e.key<s.key?-1:e.key>s.key?1:0;class Ka{constructor({compat:s,customTags:n,merge:i,resolveKnownTags:r,schema:a,sortMapEntries:o,toStringDefaults:l}){this.compat=Array.isArray(s)?So(s,"compat"):s?So(null,s):null,this.name=typeof a=="string"&&a||"core",this.knownTags=r?NA:{},this.tags=So(n,this.name,i),this.toStringOptions=l??null,Object.defineProperty(this,Cs,{value:ri}),Object.defineProperty(this,Zt,{value:qa}),Object.defineProperty(this,si,{value:ai}),this.sortMapEntries=typeof o=="function"?o:o===!0?kA:null}clone(){const s=Object.create(Ka.prototype,Object.getOwnPropertyDescriptors(this));return s.tags=this.tags.slice(),s}}function zA(e,s){const n=[];let i=s.directives===!0;if(s.directives!==!1&&e.directives){const c=e.directives.toString(e);c?(n.push(c),i=!0):e.directives.docStart&&(i=!0)}i&&n.push("---");const r=Zx(e,s),{commentString:a}=r.options;if(e.commentBefore){n.length!==1&&n.unshift("");const c=a(e.commentBefore);n.unshift(os(c,""))}let o=!1,l=null;if(e.contents){if(fe(e.contents)){if(e.contents.spaceBefore&&i&&n.push(""),e.contents.commentBefore){const m=a(e.contents.commentBefore);n.push(os(m,""))}r.forceBlockIndent=!!e.comment,l=e.contents.comment}const c=l?void 0:()=>o=!0;let d=qn(e.contents,r,()=>l=null,c);l&&(d+=Us(d,"",a(l))),(d[0]==="|"||d[0]===">")&&n[n.length-1]==="---"?n[n.length-1]=`--- ${d}`:n.push(d)}else n.push(qn(e.contents,r));if(e.directives?.docEnd)if(e.comment){const c=a(e.comment);c.includes(`
`)?(n.push("..."),n.push(os(c,""))):n.push(`... ${c}`)}else n.push("...");else{let c=e.comment;c&&o&&(c=c.replace(/^\n+/,"")),c&&((!o||l)&&n[n.length-1]!==""&&n.push(""),n.push(os(a(c),"")))}return n.join(`
`)+`
`}class oi{constructor(s,n,i){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,Ct,{value:hl});let r=null;typeof n=="function"||Array.isArray(n)?r=n:i===void 0&&n&&(i=n,n=void 0);const a=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},i);this.options=a;let{version:o}=a;i?._directives?(this.directives=i._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new He({version:o}),this.setSchema(o,i),this.contents=s===void 0?null:this.createNode(s,r,i)}clone(){const s=Object.create(oi.prototype,{[Ct]:{value:hl}});return s.commentBefore=this.commentBefore,s.comment=this.comment,s.errors=this.errors.slice(),s.warnings=this.warnings.slice(),s.options=Object.assign({},this.options),this.directives&&(s.directives=this.directives.clone()),s.schema=this.schema.clone(),s.contents=fe(this.contents)?this.contents.clone(s.schema):this.contents,this.range&&(s.range=this.range.slice()),s}add(s){pn(this.contents)&&this.contents.add(s)}addIn(s,n){pn(this.contents)&&this.contents.addIn(s,n)}createAlias(s,n){if(!s.anchor){const i=Kx(this);s.anchor=!n||i.has(n)?Gx(n||"a",i):n}return new Oa(s.anchor)}createNode(s,n,i){let r;if(typeof n=="function")s=n.call({"":s},"",s),r=n;else if(Array.isArray(n)){const y=j=>typeof j=="number"||j instanceof String||j instanceof Number,b=n.filter(y).map(String);b.length>0&&(n=n.concat(b)),r=n}else i===void 0&&n&&(i=n,n=void 0);const{aliasDuplicateObjects:a,anchorPrefix:o,flow:l,keepUndefined:c,onTagObj:d,tag:m}=i??{},{onAnchor:u,setAnchors:h,sourceObjects:p}=XT(this,o||"a"),g={aliasDuplicateObjects:a??!0,keepUndefined:c??!1,onAnchor:u,onTagObj:d,replacer:r,schema:this.schema,sourceObjects:p},f=Qi(s,m,g);return l&&pe(f)&&(f.flow=!0),h(),f}createPair(s,n,i={}){const r=this.createNode(s,null,i),a=this.createNode(n,null,i);return new Ke(r,a)}delete(s){return pn(this.contents)?this.contents.delete(s):!1}deleteIn(s){return wi(s)?this.contents==null?!1:(this.contents=null,!0):pn(this.contents)?this.contents.deleteIn(s):!1}get(s,n){return pe(this.contents)?this.contents.get(s,n):void 0}getIn(s,n){return wi(s)?!n&&oe(this.contents)?this.contents.value:this.contents:pe(this.contents)?this.contents.getIn(s,n):void 0}has(s){return pe(this.contents)?this.contents.has(s):!1}hasIn(s){return wi(s)?this.contents!==void 0:pe(this.contents)?this.contents.hasIn(s):!1}set(s,n){this.contents==null?this.contents=ca(this.schema,[s],n):pn(this.contents)&&this.contents.set(s,n)}setIn(s,n){wi(s)?this.contents=n:this.contents==null?this.contents=ca(this.schema,Array.from(s),n):pn(this.contents)&&this.contents.setIn(s,n)}setSchema(s,n={}){typeof s=="number"&&(s=String(s));let i;switch(s){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new He({version:"1.1"}),i={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=s:this.directives=new He({version:s}),i={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,i=null;break;default:{const r=JSON.stringify(s);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${r}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(i)this.schema=new Ka(Object.assign(i,n));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:s,jsonArg:n,mapAsMap:i,maxAliasCount:r,onAnchor:a,reviver:o}={}){const l={anchors:new Map,doc:this,keep:!s,mapAsMap:i===!0,mapKeyWarned:!1,maxAliasCount:typeof r=="number"?r:100},c=zt(this.contents,n??"",l);if(typeof a=="function")for(const{count:d,res:m}of l.anchors.values())a(m,d);return typeof o=="function"?zn(o,{"":c},"",c):c}toJSON(s,n){return this.toJS({json:!0,jsonArg:s,mapAsMap:!1,onAnchor:n})}toString(s={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in s&&(!Number.isInteger(s.indent)||Number(s.indent)<=0)){const n=JSON.stringify(s.indent);throw new Error(`"indent" option must be a positive integer, not ${n}`)}return zA(this,s)}}function pn(e){if(pe(e))return!0;throw new Error("Expected a YAML collection as document contents")}class Wc extends Error{constructor(s,n,i,r){super(),this.name=s,this.code=i,this.message=r,this.pos=n}}class Ks extends Wc{constructor(s,n,i){super("YAMLParseError",s,n,i)}}class gg extends Wc{constructor(s,n,i){super("YAMLWarning",s,n,i)}}const ua=(e,s)=>n=>{if(n.pos[0]===-1)return;n.linePos=n.pos.map(l=>s.linePos(l));const{line:i,col:r}=n.linePos[0];n.message+=` at line ${i}, column ${r}`;let a=r-1,o=e.substring(s.lineStarts[i-1],s.lineStarts[i]).replace(/[\n\r]+$/,"");if(a>=60&&o.length>80){const l=Math.min(a-39,o.length-79);o="…"+o.substring(l),a-=l-1}if(o.length>80&&(o=o.substring(0,79)+"…"),i>1&&/^ *$/.test(o.substring(0,a))){let l=e.substring(s.lineStarts[i-2],s.lineStarts[i-1]);l.length>80&&(l=l.substring(0,79)+`…
`),o=l+o}if(/[^ ]/.test(o)){let l=1;const c=n.linePos[1];c&&c.line===i&&c.col>r&&(l=Math.max(1,Math.min(c.col-r,80-a)));const d=" ".repeat(a)+"^".repeat(l);n.message+=`:

${o}
${d}
`}};function Vn(e,{flow:s,indicator:n,next:i,offset:r,onError:a,parentIndent:o,startOnNewline:l}){let c=!1,d=l,m=l,u="",h="",p=!1,g=!1,f=null,y=null,b=null,j=null,w=null,S=null,k=null;for(const C of e)switch(g&&(C.type!=="space"&&C.type!=="newline"&&C.type!=="comma"&&a(C.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),g=!1),f&&(d&&C.type!=="comment"&&C.type!=="newline"&&a(f,"TAB_AS_INDENT","Tabs are not allowed as indentation"),f=null),C.type){case"space":!s&&(n!=="doc-start"||i?.type!=="flow-collection")&&C.source.includes("	")&&(f=C),m=!0;break;case"comment":{m||a(C,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const A=C.source.substring(1)||" ";u?u+=h+A:u=A,h="",d=!1;break}case"newline":d?u?u+=C.source:(!S||n!=="seq-item-ind")&&(c=!0):h+=C.source,d=!0,p=!0,(y||b)&&(j=C),m=!0;break;case"anchor":y&&a(C,"MULTIPLE_ANCHORS","A node can have at most one anchor"),C.source.endsWith(":")&&a(C.offset+C.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),y=C,k??(k=C.offset),d=!1,m=!1,g=!0;break;case"tag":{b&&a(C,"MULTIPLE_TAGS","A node can have at most one tag"),b=C,k??(k=C.offset),d=!1,m=!1,g=!0;break}case n:(y||b)&&a(C,"BAD_PROP_ORDER",`Anchors and tags must be after the ${C.source} indicator`),S&&a(C,"UNEXPECTED_TOKEN",`Unexpected ${C.source} in ${s??"collection"}`),S=C,d=n==="seq-item-ind"||n==="explicit-key-ind",m=!1;break;case"comma":if(s){w&&a(C,"UNEXPECTED_TOKEN",`Unexpected , in ${s}`),w=C,d=!1,m=!1;break}default:a(C,"UNEXPECTED_TOKEN",`Unexpected ${C.type} token`),d=!1,m=!1}const z=e[e.length-1],N=z?z.offset+z.source.length:r;return g&&i&&i.type!=="space"&&i.type!=="newline"&&i.type!=="comma"&&(i.type!=="scalar"||i.source!=="")&&a(i.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),f&&(d&&f.indent<=o||i?.type==="block-map"||i?.type==="block-seq")&&a(f,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:w,found:S,spaceBefore:c,comment:u,hasNewline:p,anchor:y,tag:b,newlineAfterProp:j,end:N,start:k??N}}function Yi(e){if(!e)return null;switch(e.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(e.source.includes(`
`))return!0;if(e.end){for(const s of e.end)if(s.type==="newline")return!0}return!1;case"flow-collection":for(const s of e.items){for(const n of s.start)if(n.type==="newline")return!0;if(s.sep){for(const n of s.sep)if(n.type==="newline")return!0}if(Yi(s.key)||Yi(s.value))return!0}return!1;default:return!0}}function gl(e,s,n){if(s?.type==="flow-collection"){const i=s.end[0];i.indent===e&&(i.source==="]"||i.source==="}")&&Yi(s)&&n(i,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function yg(e,s,n){const{uniqueKeys:i}=e.options;if(i===!1)return!1;const r=typeof i=="function"?i:(a,o)=>a===o||oe(a)&&oe(o)&&a.value===o.value;return s.some(a=>r(a.key,n))}const rm="All mapping items must start at the same column";function SA({composeNode:e,composeEmptyNode:s},n,i,r,a){const o=a?.nodeClass??ct,l=new o(n.schema);n.atRoot&&(n.atRoot=!1);let c=i.offset,d=null;for(const m of i.items){const{start:u,key:h,sep:p,value:g}=m,f=Vn(u,{indicator:"explicit-key-ind",next:h??p?.[0],offset:c,onError:r,parentIndent:i.indent,startOnNewline:!0}),y=!f.found;if(y){if(h&&(h.type==="block-seq"?r(c,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in h&&h.indent!==i.indent&&r(c,"BAD_INDENT",rm)),!f.anchor&&!f.tag&&!p){d=f.end,f.comment&&(l.comment?l.comment+=`
`+f.comment:l.comment=f.comment);continue}(f.newlineAfterProp||Yi(h))&&r(h??u[u.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else f.found?.indent!==i.indent&&r(c,"BAD_INDENT",rm);n.atKey=!0;const b=f.end,j=h?e(n,h,f,r):s(n,b,u,null,f,r);n.schema.compat&&gl(i.indent,h,r),n.atKey=!1,yg(n,l.items,j)&&r(b,"DUPLICATE_KEY","Map keys must be unique");const w=Vn(p??[],{indicator:"map-value-ind",next:g,offset:j.range[2],onError:r,parentIndent:i.indent,startOnNewline:!h||h.type==="block-scalar"});if(c=w.end,w.found){y&&(g?.type==="block-map"&&!w.hasNewline&&r(c,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),n.options.strict&&f.start<w.found.offset-1024&&r(j.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const S=g?e(n,g,w,r):s(n,c,p,null,w,r);n.schema.compat&&gl(i.indent,g,r),c=S.range[2];const k=new Ke(j,S);n.options.keepSourceTokens&&(k.srcToken=m),l.items.push(k)}else{y&&r(j.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),w.comment&&(j.comment?j.comment+=`
`+w.comment:j.comment=w.comment);const S=new Ke(j);n.options.keepSourceTokens&&(S.srcToken=m),l.items.push(S)}}return d&&d<c&&r(d,"IMPOSSIBLE","Map comment with trailing content"),l.range=[i.offset,c,d??c],l}function CA({composeNode:e,composeEmptyNode:s},n,i,r,a){const o=a?.nodeClass??Ms,l=new o(n.schema);n.atRoot&&(n.atRoot=!1),n.atKey&&(n.atKey=!1);let c=i.offset,d=null;for(const{start:m,value:u}of i.items){const h=Vn(m,{indicator:"seq-item-ind",next:u,offset:c,onError:r,parentIndent:i.indent,startOnNewline:!0});if(!h.found)if(h.anchor||h.tag||u)u&&u.type==="block-seq"?r(h.end,"BAD_INDENT","All sequence items must start at the same column"):r(c,"MISSING_CHAR","Sequence item without - indicator");else{d=h.end,h.comment&&(l.comment=h.comment);continue}const p=u?e(n,u,h,r):s(n,h.end,m,null,h,r);n.schema.compat&&gl(i.indent,u,r),c=p.range[2],l.items.push(p)}return l.range=[i.offset,c,d??c],l}function vr(e,s,n,i){let r="";if(e){let a=!1,o="";for(const l of e){const{source:c,type:d}=l;switch(d){case"space":a=!0;break;case"comment":{n&&!a&&i(l,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const m=c.substring(1)||" ";r?r+=o+m:r=m,o="";break}case"newline":r&&(o+=c),a=!0;break;default:i(l,"UNEXPECTED_TOKEN",`Unexpected ${d} at node end`)}s+=c.length}}return{comment:r,offset:s}}const Co="Block collections are not allowed within flow collections",To=e=>e&&(e.type==="block-map"||e.type==="block-seq");function TA({composeNode:e,composeEmptyNode:s},n,i,r,a){const o=i.start.source==="{",l=o?"flow map":"flow sequence",c=a?.nodeClass??(o?ct:Ms),d=new c(n.schema);d.flow=!0;const m=n.atRoot;m&&(n.atRoot=!1),n.atKey&&(n.atKey=!1);let u=i.offset+i.start.source.length;for(let y=0;y<i.items.length;++y){const b=i.items[y],{start:j,key:w,sep:S,value:k}=b,z=Vn(j,{flow:l,indicator:"explicit-key-ind",next:w??S?.[0],offset:u,onError:r,parentIndent:i.indent,startOnNewline:!1});if(!z.found){if(!z.anchor&&!z.tag&&!S&&!k){y===0&&z.comma?r(z.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${l}`):y<i.items.length-1&&r(z.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${l}`),z.comment&&(d.comment?d.comment+=`
`+z.comment:d.comment=z.comment),u=z.end;continue}!o&&n.options.strict&&Yi(w)&&r(w,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(y===0)z.comma&&r(z.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${l}`);else if(z.comma||r(z.start,"MISSING_CHAR",`Missing , between ${l} items`),z.comment){let N="";e:for(const C of j)switch(C.type){case"comma":case"space":break;case"comment":N=C.source.substring(1);break e;default:break e}if(N){let C=d.items[d.items.length-1];ue(C)&&(C=C.value??C.key),C.comment?C.comment+=`
`+N:C.comment=N,z.comment=z.comment.substring(N.length+1)}}if(!o&&!S&&!z.found){const N=k?e(n,k,z,r):s(n,z.end,S,null,z,r);d.items.push(N),u=N.range[2],To(k)&&r(N.range,"BLOCK_IN_FLOW",Co)}else{n.atKey=!0;const N=z.end,C=w?e(n,w,z,r):s(n,N,j,null,z,r);To(w)&&r(C.range,"BLOCK_IN_FLOW",Co),n.atKey=!1;const A=Vn(S??[],{flow:l,indicator:"map-value-ind",next:k,offset:C.range[2],onError:r,parentIndent:i.indent,startOnNewline:!1});if(A.found){if(!o&&!z.found&&n.options.strict){if(S)for(const D of S){if(D===A.found)break;if(D.type==="newline"){r(D,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}z.start<A.found.offset-1024&&r(A.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else k&&("source"in k&&k.source&&k.source[0]===":"?r(k,"MISSING_CHAR",`Missing space after : in ${l}`):r(A.start,"MISSING_CHAR",`Missing , or : between ${l} items`));const v=k?e(n,k,A,r):A.found?s(n,A.end,S,null,A,r):null;v?To(k)&&r(v.range,"BLOCK_IN_FLOW",Co):A.comment&&(C.comment?C.comment+=`
`+A.comment:C.comment=A.comment);const P=new Ke(C,v);if(n.options.keepSourceTokens&&(P.srcToken=b),o){const D=d;yg(n,D.items,C)&&r(N,"DUPLICATE_KEY","Map keys must be unique"),D.items.push(P)}else{const D=new ct(n.schema);D.flow=!0,D.items.push(P);const _=(v??C).range;D.range=[C.range[0],_[1],_[2]],d.items.push(D)}u=v?v.range[2]:A.end}}const h=o?"}":"]",[p,...g]=i.end;let f=u;if(p&&p.source===h)f=p.offset+p.source.length;else{const y=l[0].toUpperCase()+l.substring(1),b=m?`${y} must end with a ${h}`:`${y} in block collection must be sufficiently indented and end with a ${h}`;r(u,m?"MISSING_CHAR":"BAD_INDENT",b),p&&p.source.length!==1&&g.unshift(p)}if(g.length>0){const y=vr(g,f,n.options.strict,r);y.comment&&(d.comment?d.comment+=`
`+y.comment:d.comment=y.comment),d.range=[i.offset,f,y.offset]}else d.range=[i.offset,f,f];return d}function Ao(e,s,n,i,r,a){const o=n.type==="block-map"?SA(e,s,n,i,a):n.type==="block-seq"?CA(e,s,n,i,a):TA(e,s,n,i,a),l=o.constructor;return r==="!"||r===l.tagName?(o.tag=l.tagName,o):(r&&(o.tag=r),o)}function AA(e,s,n,i,r){const a=i.tag,o=a?s.directives.tagName(a.source,h=>r(a,"TAG_RESOLVE_FAILED",h)):null;if(n.type==="block-seq"){const{anchor:h,newlineAfterProp:p}=i,g=h&&a?h.offset>a.offset?h:a:h??a;g&&(!p||p.offset<g.offset)&&r(g,"MISSING_CHAR","Missing newline after block sequence props")}const l=n.type==="block-map"?"map":n.type==="block-seq"?"seq":n.start.source==="{"?"map":"seq";if(!a||!o||o==="!"||o===ct.tagName&&l==="map"||o===Ms.tagName&&l==="seq")return Ao(e,s,n,r,o);let c=s.schema.tags.find(h=>h.tag===o&&h.collection===l);if(!c){const h=s.schema.knownTags[o];if(h&&h.collection===l)s.schema.tags.push(Object.assign({},h,{default:!1})),c=h;else return h?r(a,"BAD_COLLECTION_TYPE",`${h.tag} used for ${l} collection, but expects ${h.collection??"scalar"}`,!0):r(a,"TAG_RESOLVE_FAILED",`Unresolved tag: ${o}`,!0),Ao(e,s,n,r,o)}const d=Ao(e,s,n,r,o,c),m=c.resolve?.(d,h=>r(a,"TAG_RESOLVE_FAILED",h),s.options)??d,u=fe(m)?m:new Y(m);return u.range=d.range,u.tag=o,c?.format&&(u.format=c.format),u}function jg(e,s,n){const i=s.offset,r=PA(s,e.options.strict,n);if(!r)return{value:"",type:null,comment:"",range:[i,i,i]};const a=r.mode===">"?Y.BLOCK_FOLDED:Y.BLOCK_LITERAL,o=s.source?EA(s.source):[];let l=o.length;for(let f=o.length-1;f>=0;--f){const y=o[f][1];if(y===""||y==="\r")l=f;else break}if(l===0){const f=r.chomp==="+"&&o.length>0?`
`.repeat(Math.max(1,o.length-1)):"";let y=i+r.length;return s.source&&(y+=s.source.length),{value:f,type:a,comment:r.comment,range:[i,y,y]}}let c=s.indent+r.indent,d=s.offset+r.length,m=0;for(let f=0;f<l;++f){const[y,b]=o[f];if(b===""||b==="\r")r.indent===0&&y.length>c&&(c=y.length);else{y.length<c&&n(d+y.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),r.indent===0&&(c=y.length),m=f,c===0&&!e.atRoot&&n(d,"BAD_INDENT","Block scalar values in collections must be indented");break}d+=y.length+b.length+1}for(let f=o.length-1;f>=l;--f)o[f][0].length>c&&(l=f+1);let u="",h="",p=!1;for(let f=0;f<m;++f)u+=o[f][0].slice(c)+`
`;for(let f=m;f<l;++f){let[y,b]=o[f];d+=y.length+b.length+1;const j=b[b.length-1]==="\r";if(j&&(b=b.slice(0,-1)),b&&y.length<c){const S=`Block scalar lines must not be less indented than their ${r.indent?"explicit indentation indicator":"first line"}`;n(d-b.length-(j?2:1),"BAD_INDENT",S),y=""}a===Y.BLOCK_LITERAL?(u+=h+y.slice(c)+b,h=`
`):y.length>c||b[0]==="	"?(h===" "?h=`
`:!p&&h===`
`&&(h=`

`),u+=h+y.slice(c)+b,h=`
`,p=!0):b===""?h===`
`?u+=`
`:h=`
`:(u+=h+b,h=" ",p=!1)}switch(r.chomp){case"-":break;case"+":for(let f=l;f<o.length;++f)u+=`
`+o[f][0].slice(c);u[u.length-1]!==`
`&&(u+=`
`);break;default:u+=`
`}const g=i+r.length+s.source.length;return{value:u,type:a,comment:r.comment,range:[i,g,g]}}function PA({offset:e,props:s},n,i){if(s[0].type!=="block-scalar-header")return i(s[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:r}=s[0],a=r[0];let o=0,l="",c=-1;for(let h=1;h<r.length;++h){const p=r[h];if(!l&&(p==="-"||p==="+"))l=p;else{const g=Number(p);!o&&g?o=g:c===-1&&(c=e+h)}}c!==-1&&i(c,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${r}`);let d=!1,m="",u=r.length;for(let h=1;h<s.length;++h){const p=s[h];switch(p.type){case"space":d=!0;case"newline":u+=p.source.length;break;case"comment":n&&!d&&i(p,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),u+=p.source.length,m=p.source.substring(1);break;case"error":i(p,"UNEXPECTED_TOKEN",p.message),u+=p.source.length;break;default:{const g=`Unexpected token in block scalar header: ${p.type}`;i(p,"UNEXPECTED_TOKEN",g);const f=p.source;f&&typeof f=="string"&&(u+=f.length)}}}return{mode:a,indent:o,chomp:l,comment:m,length:u}}function EA(e){const s=e.split(/\n( *)/),n=s[0],i=n.match(/^( *)/),a=[i?.[1]?[i[1],n.slice(i[1].length)]:["",n]];for(let o=1;o<s.length;o+=2)a.push([s[o],s[o+1]]);return a}function bg(e,s,n){const{offset:i,type:r,source:a,end:o}=e;let l,c;const d=(h,p,g)=>n(i+h,p,g);switch(r){case"scalar":l=Y.PLAIN,c=DA(a,d);break;case"single-quoted-scalar":l=Y.QUOTE_SINGLE,c=_A(a,d);break;case"double-quoted-scalar":l=Y.QUOTE_DOUBLE,c=IA(a,d);break;default:return n(e,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${r}`),{value:"",type:null,comment:"",range:[i,i+a.length,i+a.length]}}const m=i+a.length,u=vr(o,m,s,n);return{value:c,type:l,comment:u.comment,range:[i,m,u.offset]}}function DA(e,s){let n="";switch(e[0]){case"	":n="a tab character";break;case",":n="flow indicator character ,";break;case"%":n="directive indicator character %";break;case"|":case">":{n=`block scalar indicator ${e[0]}`;break}case"@":case"`":{n=`reserved character ${e[0]}`;break}}return n&&s(0,"BAD_SCALAR_START",`Plain value cannot start with ${n}`),wg(e)}function _A(e,s){return(e[e.length-1]!=="'"||e.length===1)&&s(e.length,"MISSING_CHAR","Missing closing 'quote"),wg(e.slice(1,-1)).replace(/''/g,"'")}function wg(e){let s,n;try{s=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),n=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{s=/(.*?)[ \t]*\r?\n/sy,n=/[ \t]*(.*?)[ \t]*\r?\n/sy}let i=s.exec(e);if(!i)return e;let r=i[1],a=" ",o=s.lastIndex;for(n.lastIndex=o;i=n.exec(e);)i[1]===""?a===`
`?r+=a:a=`
`:(r+=a+i[1],a=" "),o=n.lastIndex;const l=/[ \t]*(.*)/sy;return l.lastIndex=o,i=l.exec(e),r+a+(i?.[1]??"")}function IA(e,s){let n="";for(let i=1;i<e.length-1;++i){const r=e[i];if(!(r==="\r"&&e[i+1]===`
`))if(r===`
`){const{fold:a,offset:o}=MA(e,i);n+=a,i=o}else if(r==="\\"){let a=e[++i];const o=LA[a];if(o)n+=o;else if(a===`
`)for(a=e[i+1];a===" "||a==="	";)a=e[++i+1];else if(a==="\r"&&e[i+1]===`
`)for(a=e[++i+1];a===" "||a==="	";)a=e[++i+1];else if(a==="x"||a==="u"||a==="U"){const l={x:2,u:4,U:8}[a];n+=OA(e,i+1,l,s),i+=l}else{const l=e.substr(i-1,2);s(i-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${l}`),n+=l}}else if(r===" "||r==="	"){const a=i;let o=e[i+1];for(;o===" "||o==="	";)o=e[++i+1];o!==`
`&&!(o==="\r"&&e[i+2]===`
`)&&(n+=i>a?e.slice(a,i+1):r)}else n+=r}return(e[e.length-1]!=='"'||e.length===1)&&s(e.length,"MISSING_CHAR",'Missing closing "quote'),n}function MA(e,s){let n="",i=e[s+1];for(;(i===" "||i==="	"||i===`
`||i==="\r")&&!(i==="\r"&&e[s+2]!==`
`);)i===`
`&&(n+=`
`),s+=1,i=e[s+1];return n||(n=" "),{fold:n,offset:s}}const LA={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function OA(e,s,n,i){const r=e.substr(s,n),o=r.length===n&&/^[0-9a-fA-F]+$/.test(r)?parseInt(r,16):NaN;if(isNaN(o)){const l=e.substr(s-2,n+2);return i(s-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${l}`),l}return String.fromCodePoint(o)}function vg(e,s,n,i){const{value:r,type:a,comment:o,range:l}=s.type==="block-scalar"?jg(e,s,i):bg(s,e.options.strict,i),c=n?e.directives.tagName(n.source,u=>i(n,"TAG_RESOLVE_FAILED",u)):null;let d;e.options.stringKeys&&e.atKey?d=e.schema[Zt]:c?d=RA(e.schema,r,c,n,i):s.type==="scalar"?d=FA(e,r,s,i):d=e.schema[Zt];let m;try{const u=d.resolve(r,h=>i(n??s,"TAG_RESOLVE_FAILED",h),e.options);m=oe(u)?u:new Y(u)}catch(u){const h=u instanceof Error?u.message:String(u);i(n??s,"TAG_RESOLVE_FAILED",h),m=new Y(r)}return m.range=l,m.source=r,a&&(m.type=a),c&&(m.tag=c),d.format&&(m.format=d.format),o&&(m.comment=o),m}function RA(e,s,n,i,r){if(n==="!")return e[Zt];const a=[];for(const l of e.tags)if(!l.collection&&l.tag===n)if(l.default&&l.test)a.push(l);else return l;for(const l of a)if(l.test?.test(s))return l;const o=e.knownTags[n];return o&&!o.collection?(e.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(r(i,"TAG_RESOLVE_FAILED",`Unresolved tag: ${n}`,n!=="tag:yaml.org,2002:str"),e[Zt])}function FA({atKey:e,directives:s,schema:n},i,r,a){const o=n.tags.find(l=>(l.default===!0||e&&l.default==="key")&&l.test?.test(i))||n[Zt];if(n.compat){const l=n.compat.find(c=>c.default&&c.test?.test(i))??n[Zt];if(o.tag!==l.tag){const c=s.tagString(o.tag),d=s.tagString(l.tag),m=`Value may be parsed as either ${c} or ${d}`;a(r,"TAG_RESOLVE_FAILED",m,!0)}}return o}function $A(e,s,n){if(s){n??(n=s.length);for(let i=n-1;i>=0;--i){let r=s[i];switch(r.type){case"space":case"comment":case"newline":e-=r.source.length;continue}for(r=s[++i];r?.type==="space";)e+=r.source.length,r=s[++i];break}}return e}const qA={composeNode:Ng,composeEmptyNode:Kc};function Ng(e,s,n,i){const r=e.atKey,{spaceBefore:a,comment:o,anchor:l,tag:c}=n;let d,m=!0;switch(s.type){case"alias":d=VA(e,s,i),(l||c)&&i(s,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":d=vg(e,s,c,i),l&&(d.anchor=l.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":d=AA(qA,e,s,n,i),l&&(d.anchor=l.source.substring(1));break;default:{const u=s.type==="error"?s.message:`Unsupported token (type: ${s.type})`;i(s,"UNEXPECTED_TOKEN",u),d=Kc(e,s.offset,void 0,null,n,i),m=!1}}return l&&d.anchor===""&&i(l,"BAD_ALIAS","Anchor cannot be an empty string"),r&&e.options.stringKeys&&(!oe(d)||typeof d.value!="string"||d.tag&&d.tag!=="tag:yaml.org,2002:str")&&i(c??s,"NON_STRING_KEY","With stringKeys, all keys must be strings"),a&&(d.spaceBefore=!0),o&&(s.type==="scalar"&&s.source===""?d.comment=o:d.commentBefore=o),e.options.keepSourceTokens&&m&&(d.srcToken=s),d}function Kc(e,s,n,i,{spaceBefore:r,comment:a,anchor:o,tag:l,end:c},d){const m={type:"scalar",offset:$A(s,n,i),indent:-1,source:""},u=vg(e,m,l,d);return o&&(u.anchor=o.source.substring(1),u.anchor===""&&d(o,"BAD_ALIAS","Anchor cannot be an empty string")),r&&(u.spaceBefore=!0),a&&(u.comment=a,u.range[2]=c),u}function VA({options:e},{offset:s,source:n,end:i},r){const a=new Oa(n.substring(1));a.source===""&&r(s,"BAD_ALIAS","Alias cannot be an empty string"),a.source.endsWith(":")&&r(s+n.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const o=s+n.length,l=vr(i,o,e.strict,r);return a.range=[s,o,l.offset],l.comment&&(a.comment=l.comment),a}function BA(e,s,{offset:n,start:i,value:r,end:a},o){const l=Object.assign({_directives:s},e),c=new oi(void 0,l),d={atKey:!1,atRoot:!0,directives:c.directives,options:c.options,schema:c.schema},m=Vn(i,{indicator:"doc-start",next:r??a?.[0],offset:n,onError:o,parentIndent:0,startOnNewline:!0});m.found&&(c.directives.docStart=!0,r&&(r.type==="block-map"||r.type==="block-seq")&&!m.hasNewline&&o(m.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),c.contents=r?Ng(d,r,m,o):Kc(d,m.end,i,null,m,o);const u=c.contents.range[2],h=vr(a,u,!1,o);return h.comment&&(c.comment=h.comment),c.range=[n,u,h.offset],c}function fi(e){if(typeof e=="number")return[e,e+1];if(Array.isArray(e))return e.length===2?e:[e[0],e[1]];const{offset:s,source:n}=e;return[s,s+(typeof n=="string"?n.length:1)]}function am(e){let s="",n=!1,i=!1;for(let r=0;r<e.length;++r){const a=e[r];switch(a[0]){case"#":s+=(s===""?"":i?`

`:`
`)+(a.substring(1)||" "),n=!0,i=!1;break;case"%":e[r+1]?.[0]!=="#"&&(r+=1),n=!1;break;default:n||(i=!0),n=!1}}return{comment:s,afterEmptyLine:i}}class Gc{constructor(s={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(n,i,r,a)=>{const o=fi(n);a?this.warnings.push(new gg(o,i,r)):this.errors.push(new Ks(o,i,r))},this.directives=new He({version:s.version||"1.2"}),this.options=s}decorate(s,n){const{comment:i,afterEmptyLine:r}=am(this.prelude);if(i){const a=s.contents;if(n)s.comment=s.comment?`${s.comment}
${i}`:i;else if(r||s.directives.docStart||!a)s.commentBefore=i;else if(pe(a)&&!a.flow&&a.items.length>0){let o=a.items[0];ue(o)&&(o=o.key);const l=o.commentBefore;o.commentBefore=l?`${i}
${l}`:i}else{const o=a.commentBefore;a.commentBefore=o?`${i}
${o}`:i}}n?(Array.prototype.push.apply(s.errors,this.errors),Array.prototype.push.apply(s.warnings,this.warnings)):(s.errors=this.errors,s.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:am(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(s,n=!1,i=-1){for(const r of s)yield*this.next(r);yield*this.end(n,i)}*next(s){switch(s.type){case"directive":this.directives.add(s.source,(n,i,r)=>{const a=fi(s);a[0]+=n,this.onError(a,"BAD_DIRECTIVE",i,r)}),this.prelude.push(s.source),this.atDirectives=!0;break;case"document":{const n=BA(this.options,this.directives,s,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(s,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(s.source);break;case"error":{const n=s.source?`${s.message}: ${JSON.stringify(s.source)}`:s.message,i=new Ks(fi(s),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(i):this.doc.errors.push(i);break}case"doc-end":{if(!this.doc){const i="Unexpected doc-end without preceding document";this.errors.push(new Ks(fi(s),"UNEXPECTED_TOKEN",i));break}this.doc.directives.docEnd=!0;const n=vr(s.end,s.offset+s.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){const i=this.doc.comment;this.doc.comment=i?`${i}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new Ks(fi(s),"UNEXPECTED_TOKEN",`Unsupported token ${s.type}`))}}*end(s=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(s){const i=Object.assign({_directives:this.directives},this.options),r=new oi(void 0,i);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),r.range=[0,n,n],this.decorate(r,!1),yield r}}}function UA(e,s=!0,n){if(e){const i=(r,a,o)=>{const l=typeof r=="number"?r:Array.isArray(r)?r[0]:r.offset;if(n)n(l,a,o);else throw new Ks([l,l+1],a,o)};switch(e.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return bg(e,s,i);case"block-scalar":return jg({options:{strict:s}},e,i)}}return null}function WA(e,s){const{implicitKey:n=!1,indent:i,inFlow:r=!1,offset:a=-1,type:o="PLAIN"}=s,l=br({type:o,value:e},{implicitKey:n,indent:i>0?" ".repeat(i):"",inFlow:r,options:{blockQuote:!0,lineWidth:-1}}),c=s.end??[{type:"newline",offset:-1,indent:i,source:`
`}];switch(l[0]){case"|":case">":{const d=l.indexOf(`
`),m=l.substring(0,d),u=l.substring(d+1)+`
`,h=[{type:"block-scalar-header",offset:a,indent:i,source:m}];return kg(h,c)||h.push({type:"newline",offset:-1,indent:i,source:`
`}),{type:"block-scalar",offset:a,indent:i,props:h,source:u}}case'"':return{type:"double-quoted-scalar",offset:a,indent:i,source:l,end:c};case"'":return{type:"single-quoted-scalar",offset:a,indent:i,source:l,end:c};default:return{type:"scalar",offset:a,indent:i,source:l,end:c}}}function KA(e,s,n={}){let{afterKey:i=!1,implicitKey:r=!1,inFlow:a=!1,type:o}=n,l="indent"in e?e.indent:null;if(i&&typeof l=="number"&&(l+=2),!o)switch(e.type){case"single-quoted-scalar":o="QUOTE_SINGLE";break;case"double-quoted-scalar":o="QUOTE_DOUBLE";break;case"block-scalar":{const d=e.props[0];if(d.type!=="block-scalar-header")throw new Error("Invalid block scalar header");o=d.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:o="PLAIN"}const c=br({type:o,value:s},{implicitKey:r||l===null,indent:l!==null&&l>0?" ".repeat(l):"",inFlow:a,options:{blockQuote:!0,lineWidth:-1}});switch(c[0]){case"|":case">":GA(e,c);break;case'"':Po(e,c,"double-quoted-scalar");break;case"'":Po(e,c,"single-quoted-scalar");break;default:Po(e,c,"scalar")}}function GA(e,s){const n=s.indexOf(`
`),i=s.substring(0,n),r=s.substring(n+1)+`
`;if(e.type==="block-scalar"){const a=e.props[0];if(a.type!=="block-scalar-header")throw new Error("Invalid block scalar header");a.source=i,e.source=r}else{const{offset:a}=e,o="indent"in e?e.indent:-1,l=[{type:"block-scalar-header",offset:a,indent:o,source:i}];kg(l,"end"in e?e.end:void 0)||l.push({type:"newline",offset:-1,indent:o,source:`
`});for(const c of Object.keys(e))c!=="type"&&c!=="offset"&&delete e[c];Object.assign(e,{type:"block-scalar",indent:o,props:l,source:r})}}function kg(e,s){if(s)for(const n of s)switch(n.type){case"space":case"comment":e.push(n);break;case"newline":return e.push(n),!0}return!1}function Po(e,s,n){switch(e.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":e.type=n,e.source=s;break;case"block-scalar":{const i=e.props.slice(1);let r=s.length;e.props[0].type==="block-scalar-header"&&(r-=e.props[0].source.length);for(const a of i)a.offset+=r;delete e.props,Object.assign(e,{type:n,source:s,end:i});break}case"block-map":case"block-seq":{const r={type:"newline",offset:e.offset+s.length,indent:e.indent,source:`
`};delete e.items,Object.assign(e,{type:n,source:s,end:[r]});break}default:{const i="indent"in e?e.indent:-1,r="end"in e&&Array.isArray(e.end)?e.end.filter(a=>a.type==="space"||a.type==="comment"||a.type==="newline"):[];for(const a of Object.keys(e))a!=="type"&&a!=="offset"&&delete e[a];Object.assign(e,{type:n,indent:i,source:s,end:r})}}}const HA=e=>"type"in e?ma(e):Hr(e);function ma(e){switch(e.type){case"block-scalar":{let s="";for(const n of e.props)s+=ma(n);return s+e.source}case"block-map":case"block-seq":{let s="";for(const n of e.items)s+=Hr(n);return s}case"flow-collection":{let s=e.start.source;for(const n of e.items)s+=Hr(n);for(const n of e.end)s+=n.source;return s}case"document":{let s=Hr(e);if(e.end)for(const n of e.end)s+=n.source;return s}default:{let s=e.source;if("end"in e&&e.end)for(const n of e.end)s+=n.source;return s}}}function Hr({start:e,key:s,sep:n,value:i}){let r="";for(const a of e)r+=a.source;if(s&&(r+=ma(s)),n)for(const a of n)r+=a.source;return i&&(r+=ma(i)),r}const yl=Symbol("break visit"),QA=Symbol("skip children"),zg=Symbol("remove item");function tn(e,s){"type"in e&&e.type==="document"&&(e={start:e.start,value:e.value}),Sg(Object.freeze([]),e,s)}tn.BREAK=yl;tn.SKIP=QA;tn.REMOVE=zg;tn.itemAtPath=(e,s)=>{let n=e;for(const[i,r]of s){const a=n?.[i];if(a&&"items"in a)n=a.items[r];else return}return n};tn.parentCollection=(e,s)=>{const n=tn.itemAtPath(e,s.slice(0,-1)),i=s[s.length-1][0],r=n?.[i];if(r&&"items"in r)return r;throw new Error("Parent collection not found")};function Sg(e,s,n){let i=n(s,e);if(typeof i=="symbol")return i;for(const r of["key","value"]){const a=s[r];if(a&&"items"in a){for(let o=0;o<a.items.length;++o){const l=Sg(Object.freeze(e.concat([[r,o]])),a.items[o],n);if(typeof l=="number")o=l-1;else{if(l===yl)return yl;l===zg&&(a.items.splice(o,1),o-=1)}}typeof i=="function"&&r==="key"&&(i=i(s,e))}}return typeof i=="function"?i(s,e):i}const Ga="\uFEFF",Ha="",Qa="",Zi="",YA=e=>!!e&&"items"in e,ZA=e=>!!e&&(e.type==="scalar"||e.type==="single-quoted-scalar"||e.type==="double-quoted-scalar"||e.type==="block-scalar");function JA(e){switch(e){case Ga:return"<BOM>";case Ha:return"<DOC>";case Qa:return"<FLOW_END>";case Zi:return"<SCALAR>";default:return JSON.stringify(e)}}function Cg(e){switch(e){case Ga:return"byte-order-mark";case Ha:return"doc-mode";case Qa:return"flow-error-end";case Zi:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(e[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const XA=Object.freeze(Object.defineProperty({__proto__:null,BOM:Ga,DOCUMENT:Ha,FLOW_END:Qa,SCALAR:Zi,createScalarToken:WA,isCollection:YA,isScalar:ZA,prettyToken:JA,resolveAsScalar:UA,setScalarValue:KA,stringify:HA,tokenType:Cg,visit:tn},Symbol.toStringTag,{value:"Module"}));function Et(e){switch(e){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const om=new Set("0123456789ABCDEFabcdef"),eP=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),Or=new Set(",[]{}"),tP=new Set(` ,[]{}
\r	`),Eo=e=>!e||tP.has(e);class Tg{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(s,n=!1){if(s){if(typeof s!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+s:s,this.lineEndPos=null}this.atEnd=!n;let i=this.next??"stream";for(;i&&(n||this.hasChars(1));)i=yield*this.parseNext(i)}atLineEnd(){let s=this.pos,n=this.buffer[s];for(;n===" "||n==="	";)n=this.buffer[++s];return!n||n==="#"||n===`
`?!0:n==="\r"?this.buffer[s+1]===`
`:!1}charAt(s){return this.buffer[this.pos+s]}continueScalar(s){let n=this.buffer[s];if(this.indentNext>0){let i=0;for(;n===" ";)n=this.buffer[++i+s];if(n==="\r"){const r=this.buffer[i+s+1];if(r===`
`||!r&&!this.atEnd)return s+i+1}return n===`
`||i>=this.indentNext||!n&&!this.atEnd?s+i:-1}if(n==="-"||n==="."){const i=this.buffer.substr(s,3);if((i==="---"||i==="...")&&Et(this.buffer[s+3]))return-1}return s}getLine(){let s=this.lineEndPos;return(typeof s!="number"||s!==-1&&s<this.pos)&&(s=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=s),s===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[s-1]==="\r"&&(s-=1),this.buffer.substring(this.pos,s))}hasChars(s){return this.pos+s<=this.buffer.length}setNext(s){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=s,null}peek(s){return this.buffer.substr(this.pos,s)}*parseNext(s){switch(s){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let s=this.getLine();if(s===null)return this.setNext("stream");if(s[0]===Ga&&(yield*this.pushCount(1),s=s.substring(1)),s[0]==="%"){let n=s.length,i=s.indexOf("#");for(;i!==-1;){const a=s[i-1];if(a===" "||a==="	"){n=i-1;break}else i=s.indexOf("#",i+1)}for(;;){const a=s[n-1];if(a===" "||a==="	")n-=1;else break}const r=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(s.length-r),this.pushNewline(),"stream"}if(this.atLineEnd()){const n=yield*this.pushSpaces(!0);return yield*this.pushCount(s.length-n),yield*this.pushNewline(),"stream"}return yield Ha,yield*this.parseLineStart()}*parseLineStart(){const s=this.charAt(0);if(!s&&!this.atEnd)return this.setNext("line-start");if(s==="-"||s==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const n=this.peek(3);if((n==="---"||n==="...")&&Et(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,n==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!Et(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[s,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if((s==="-"||s==="?"||s===":")&&Et(n)){const i=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=i,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const s=this.getLine();if(s===null)return this.setNext("doc");let n=yield*this.pushIndicators();switch(s[n]){case"#":yield*this.pushCount(s.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Eo),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=yield*this.parseBlockScalarHeader(),n+=yield*this.pushSpaces(!0),yield*this.pushCount(s.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let s,n,i=-1;do s=yield*this.pushNewline(),s>0?(n=yield*this.pushSpaces(!1),this.indentValue=i=n):n=0,n+=yield*this.pushSpaces(!0);while(s+n>0);const r=this.getLine();if(r===null)return this.setNext("flow");if((i!==-1&&i<this.indentNext&&r[0]!=="#"||i===0&&(r.startsWith("---")||r.startsWith("..."))&&Et(r[3]))&&!(i===this.indentNext-1&&this.flowLevel===1&&(r[0]==="]"||r[0]==="}")))return this.flowLevel=0,yield Qa,yield*this.parseLineStart();let a=0;for(;r[a]===",";)a+=yield*this.pushCount(1),a+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(a+=yield*this.pushIndicators(),r[a]){case void 0:return"flow";case"#":return yield*this.pushCount(r.length-a),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Eo),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const o=this.charAt(1);if(this.flowKey||Et(o)||o===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const s=this.charAt(0);let n=this.buffer.indexOf(s,this.pos+1);if(s==="'")for(;n!==-1&&this.buffer[n+1]==="'";)n=this.buffer.indexOf("'",n+2);else for(;n!==-1;){let a=0;for(;this.buffer[n-1-a]==="\\";)a+=1;if(a%2===0)break;n=this.buffer.indexOf('"',n+1)}const i=this.buffer.substring(0,n);let r=i.indexOf(`
`,this.pos);if(r!==-1){for(;r!==-1;){const a=this.continueScalar(r+1);if(a===-1)break;r=i.indexOf(`
`,a)}r!==-1&&(n=r-(i[r-1]==="\r"?2:1))}if(n===-1){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let s=this.pos;for(;;){const n=this.buffer[++s];if(n==="+")this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if(n!=="-")break}return yield*this.pushUntil(n=>Et(n)||n==="#")}*parseBlockScalar(){let s=this.pos-1,n=0,i;e:for(let a=this.pos;i=this.buffer[a];++a)switch(i){case" ":n+=1;break;case`
`:s=a,n=0;break;case"\r":{const o=this.buffer[a+1];if(!o&&!this.atEnd)return this.setNext("block-scalar");if(o===`
`)break}default:break e}if(!i&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=n:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{const a=this.continueScalar(s+1);if(a===-1)break;s=this.buffer.indexOf(`
`,a)}while(s!==-1);if(s===-1){if(!this.atEnd)return this.setNext("block-scalar");s=this.buffer.length}}let r=s+1;for(i=this.buffer[r];i===" ";)i=this.buffer[++r];if(i==="	"){for(;i==="	"||i===" "||i==="\r"||i===`
`;)i=this.buffer[++r];s=r-1}else if(!this.blockScalarKeep)do{let a=s-1,o=this.buffer[a];o==="\r"&&(o=this.buffer[--a]);const l=a;for(;o===" ";)o=this.buffer[--a];if(o===`
`&&a>=this.pos&&a+1+n>l)s=a;else break}while(!0);return yield Zi,yield*this.pushToIndex(s+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const s=this.flowLevel>0;let n=this.pos-1,i=this.pos-1,r;for(;r=this.buffer[++i];)if(r===":"){const a=this.buffer[i+1];if(Et(a)||s&&Or.has(a))break;n=i}else if(Et(r)){let a=this.buffer[i+1];if(r==="\r"&&(a===`
`?(i+=1,r=`
`,a=this.buffer[i+1]):n=i),a==="#"||s&&Or.has(a))break;if(r===`
`){const o=this.continueScalar(i+1);if(o===-1)break;i=Math.max(i,o-2)}}else{if(s&&Or.has(r))break;n=i}return!r&&!this.atEnd?this.setNext("plain-scalar"):(yield Zi,yield*this.pushToIndex(n+1,!0),s?"flow":"doc")}*pushCount(s){return s>0?(yield this.buffer.substr(this.pos,s),this.pos+=s,s):0}*pushToIndex(s,n){const i=this.buffer.slice(this.pos,s);return i?(yield i,this.pos+=i.length,i.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Eo))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const s=this.flowLevel>0,n=this.charAt(1);if(Et(n)||s&&Or.has(n))return s?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let s=this.pos+2,n=this.buffer[s];for(;!Et(n)&&n!==">";)n=this.buffer[++s];return yield*this.pushToIndex(n===">"?s+1:s,!1)}else{let s=this.pos+1,n=this.buffer[s];for(;n;)if(eP.has(n))n=this.buffer[++s];else if(n==="%"&&om.has(this.buffer[s+1])&&om.has(this.buffer[s+2]))n=this.buffer[s+=3];else break;return yield*this.pushToIndex(s,!1)}}*pushNewline(){const s=this.buffer[this.pos];return s===`
`?yield*this.pushCount(1):s==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(s){let n=this.pos-1,i;do i=this.buffer[++n];while(i===" "||s&&i==="	");const r=n-this.pos;return r>0&&(yield this.buffer.substr(this.pos,r),this.pos=n),r}*pushUntil(s){let n=this.pos,i=this.buffer[n];for(;!s(i);)i=this.buffer[++n];return yield*this.pushToIndex(n,!1)}}class Ag{constructor(){this.lineStarts=[],this.addNewLine=s=>this.lineStarts.push(s),this.linePos=s=>{let n=0,i=this.lineStarts.length;for(;n<i;){const a=n+i>>1;this.lineStarts[a]<s?n=a+1:i=a}if(this.lineStarts[n]===s)return{line:n+1,col:1};if(n===0)return{line:0,col:s};const r=this.lineStarts[n-1];return{line:n,col:s-r+1}}}}function vs(e,s){for(let n=0;n<e.length;++n)if(e[n].type===s)return!0;return!1}function lm(e){for(let s=0;s<e.length;++s)switch(e[s].type){case"space":case"comment":case"newline":break;default:return s}return-1}function Pg(e){switch(e?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function Rr(e){switch(e.type){case"document":return e.start;case"block-map":{const s=e.items[e.items.length-1];return s.sep??s.start}case"block-seq":return e.items[e.items.length-1].start;default:return[]}}function fn(e){if(e.length===0)return[];let s=e.length;e:for(;--s>=0;)switch(e[s].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;e[++s]?.type==="space";);return e.splice(s,e.length)}function cm(e){if(e.start.type==="flow-seq-start")for(const s of e.items)s.sep&&!s.value&&!vs(s.start,"explicit-key-ind")&&!vs(s.sep,"map-value-ind")&&(s.key&&(s.value=s.key),delete s.key,Pg(s.value)?s.value.end?Array.prototype.push.apply(s.value.end,s.sep):s.value.end=s.sep:Array.prototype.push.apply(s.start,s.sep),delete s.sep)}class Hc{constructor(s){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Tg,this.onNewLine=s}*parse(s,n=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const i of this.lexer.lex(s,n))yield*this.next(i);n||(yield*this.end())}*next(s){if(this.source=s,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=s.length;return}const n=Cg(s);if(n)if(n==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+s.length);break;case"space":this.atNewLine&&s[0]===" "&&(this.indent+=s.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=s.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=s.length}else{const i=`Not a YAML token: ${s}`;yield*this.pop({type:"error",offset:this.offset,message:i,source:s}),this.offset+=s.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const s=this.peek(1);if(this.type==="doc-end"&&(!s||s.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!s)return yield*this.stream();switch(s.type){case"document":return yield*this.document(s);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(s);case"block-scalar":return yield*this.blockScalar(s);case"block-map":return yield*this.blockMap(s);case"block-seq":return yield*this.blockSequence(s);case"flow-collection":return yield*this.flowCollection(s);case"doc-end":return yield*this.documentEnd(s)}yield*this.pop()}peek(s){return this.stack[this.stack.length-s]}*pop(s){const n=s??this.stack.pop();if(!n)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield n;else{const i=this.peek(1);switch(n.type==="block-scalar"?n.indent="indent"in i?i.indent:0:n.type==="flow-collection"&&i.type==="document"&&(n.indent=0),n.type==="flow-collection"&&cm(n),i.type){case"document":i.value=n;break;case"block-scalar":i.props.push(n);break;case"block-map":{const r=i.items[i.items.length-1];if(r.value){i.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}else if(r.sep)r.value=n;else{Object.assign(r,{key:n,sep:[]}),this.onKeyLine=!r.explicitKey;return}break}case"block-seq":{const r=i.items[i.items.length-1];r.value?i.items.push({start:[],value:n}):r.value=n;break}case"flow-collection":{const r=i.items[i.items.length-1];!r||r.value?i.items.push({start:[],key:n,sep:[]}):r.sep?r.value=n:Object.assign(r,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if((i.type==="document"||i.type==="block-map"||i.type==="block-seq")&&(n.type==="block-map"||n.type==="block-seq")){const r=n.items[n.items.length-1];r&&!r.sep&&!r.value&&r.start.length>0&&lm(r.start)===-1&&(n.indent===0||r.start.every(a=>a.type!=="comment"||a.indent<n.indent))&&(i.type==="document"?i.end=r.start:i.items.push({start:r.start}),n.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const s={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&s.start.push(this.sourceToken),this.stack.push(s);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(s){if(s.value)return yield*this.lineEnd(s);switch(this.type){case"doc-start":{lm(s.start)!==-1?(yield*this.pop(),yield*this.step()):s.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":s.start.push(this.sourceToken);return}const n=this.startBlockValue(s);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(s){if(this.type==="map-value-ind"){const n=Rr(this.peek(2)),i=fn(n);let r;s.end?(r=s.end,r.push(this.sourceToken),delete s.end):r=[this.sourceToken];const a={type:"block-map",offset:s.offset,indent:s.indent,items:[{start:i,key:s,sep:r}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(s)}*blockScalar(s){switch(this.type){case"space":case"comment":case"newline":s.props.push(this.sourceToken);return;case"scalar":if(s.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(s){const n=s.items[s.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,n.value){const i="end"in n.value?n.value.end:void 0;(Array.isArray(i)?i[i.length-1]:void 0)?.type==="comment"?i?.push(this.sourceToken):s.items.push({start:[this.sourceToken]})}else n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)s.items.push({start:[this.sourceToken]});else if(n.sep)n.sep.push(this.sourceToken);else{if(this.atIndentedComment(n.start,s.indent)){const r=s.items[s.items.length-2]?.value?.end;if(Array.isArray(r)){Array.prototype.push.apply(r,n.start),r.push(this.sourceToken),s.items.pop();return}}n.start.push(this.sourceToken)}return}if(this.indent>=s.indent){const i=!this.onKeyLine&&this.indent===s.indent,r=i&&(n.sep||n.explicitKey)&&this.type!=="seq-item-ind";let a=[];if(r&&n.sep&&!n.value){const o=[];for(let l=0;l<n.sep.length;++l){const c=n.sep[l];switch(c.type){case"newline":o.push(l);break;case"space":break;case"comment":c.indent>s.indent&&(o.length=0);break;default:o.length=0}}o.length>=2&&(a=n.sep.splice(o[1]))}switch(this.type){case"anchor":case"tag":r||n.value?(a.push(this.sourceToken),s.items.push({start:a}),this.onKeyLine=!0):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"explicit-key-ind":!n.sep&&!n.explicitKey?(n.start.push(this.sourceToken),n.explicitKey=!0):r||n.value?(a.push(this.sourceToken),s.items.push({start:a,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(n.explicitKey)if(n.sep)if(n.value)s.items.push({start:[],key:null,sep:[this.sourceToken]});else if(vs(n.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]});else if(Pg(n.key)&&!vs(n.sep,"newline")){const o=fn(n.start),l=n.key,c=n.sep;c.push(this.sourceToken),delete n.key,delete n.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:l,sep:c}]})}else a.length>0?n.sep=n.sep.concat(a,this.sourceToken):n.sep.push(this.sourceToken);else if(vs(n.start,"newline"))Object.assign(n,{key:null,sep:[this.sourceToken]});else{const o=fn(n.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:null,sep:[this.sourceToken]}]})}else n.sep?n.value||r?s.items.push({start:a,key:null,sep:[this.sourceToken]}):vs(n.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const o=this.flowScalar(this.type);r||n.value?(s.items.push({start:a,key:o,sep:[]}),this.onKeyLine=!0):n.sep?this.stack.push(o):(Object.assign(n,{key:o,sep:[]}),this.onKeyLine=!0);return}default:{const o=this.startBlockValue(s);if(o){if(o.type==="block-seq"){if(!n.explicitKey&&n.sep&&!vs(n.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else i&&s.items.push({start:a});this.stack.push(o);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(s){const n=s.items[s.items.length-1];switch(this.type){case"newline":if(n.value){const i="end"in n.value?n.value.end:void 0;(Array.isArray(i)?i[i.length-1]:void 0)?.type==="comment"?i?.push(this.sourceToken):s.items.push({start:[this.sourceToken]})}else n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)s.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(n.start,s.indent)){const r=s.items[s.items.length-2]?.value?.end;if(Array.isArray(r)){Array.prototype.push.apply(r,n.start),r.push(this.sourceToken),s.items.pop();return}}n.start.push(this.sourceToken)}return;case"anchor":case"tag":if(n.value||this.indent<=s.indent)break;n.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==s.indent)break;n.value||vs(n.start,"seq-item-ind")?s.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return}if(this.indent>s.indent){const i=this.startBlockValue(s);if(i){this.stack.push(i);return}}yield*this.pop(),yield*this.step()}*flowCollection(s){const n=s.items[s.items.length-1];if(this.type==="flow-error-end"){let i;do yield*this.pop(),i=this.peek(1);while(i&&i.type==="flow-collection")}else if(s.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?s.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?s.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?s.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const r=this.flowScalar(this.type);!n||n.value?s.items.push({start:[],key:r,sep:[]}):n.sep?this.stack.push(r):Object.assign(n,{key:r,sep:[]});return}case"flow-map-end":case"flow-seq-end":s.end.push(this.sourceToken);return}const i=this.startBlockValue(s);i?this.stack.push(i):(yield*this.pop(),yield*this.step())}else{const i=this.peek(2);if(i.type==="block-map"&&(this.type==="map-value-ind"&&i.indent===s.indent||this.type==="newline"&&!i.items[i.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&i.type!=="flow-collection"){const r=Rr(i),a=fn(r);cm(s);const o=s.end.splice(1,s.end.length);o.push(this.sourceToken);const l={type:"block-map",offset:s.offset,indent:s.indent,items:[{start:a,key:s,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=l}else yield*this.lineEnd(s)}}flowScalar(s){if(this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}return{type:s,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(s){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const n=Rr(s),i=fn(n);return i.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const n=Rr(s),i=fn(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(s,n){return this.type!=="comment"||this.indent<=n?!1:s.every(i=>i.type==="newline"||i.type==="space")}*documentEnd(s){this.type!=="doc-mode"&&(s.end?s.end.push(this.sourceToken):s.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(s){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:s.end?s.end.push(this.sourceToken):s.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function Eg(e){const s=e.prettyErrors!==!1;return{lineCounter:e.lineCounter||s&&new Ag||null,prettyErrors:s}}function sP(e,s={}){const{lineCounter:n,prettyErrors:i}=Eg(s),r=new Hc(n?.addNewLine),a=new Gc(s),o=Array.from(a.compose(r.parse(e)));if(i&&n)for(const l of o)l.errors.forEach(ua(e,n)),l.warnings.forEach(ua(e,n));return o.length>0?o:Object.assign([],{empty:!0},a.streamInfo())}function Dg(e,s={}){const{lineCounter:n,prettyErrors:i}=Eg(s),r=new Hc(n?.addNewLine),a=new Gc(s);let o=null;for(const l of a.compose(r.parse(e),!0,e.length))if(!o)o=l;else if(o.options.logLevel!=="silent"){o.errors.push(new Ks(l.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return i&&n&&(o.errors.forEach(ua(e,n)),o.warnings.forEach(ua(e,n))),o}function nP(e,s,n){let i;typeof s=="function"?i=s:n===void 0&&s&&typeof s=="object"&&(n=s);const r=Dg(e,n);if(!r)return null;if(r.warnings.forEach(a=>Jx(r.options.logLevel,a)),r.errors.length>0){if(r.options.logLevel!=="silent")throw r.errors[0];r.errors=[]}return r.toJS(Object.assign({reviver:i},n))}function iP(e,s,n){let i=null;if(typeof s=="function"||Array.isArray(s)?i=s:n===void 0&&s&&(n=s),typeof n=="string"&&(n=n.length),typeof n=="number"){const r=Math.round(n);n=r<1?void 0:r>8?{indent:8}:{indent:r}}if(e===void 0){const{keepUndefined:r}=n??s??{};if(!r)return}return an(e)&&!i?e.toString(n):new oi(e,i,n).toString(n)}const rP=Object.freeze(Object.defineProperty({__proto__:null,Alias:Oa,CST:XA,Composer:Gc,Document:oi,Lexer:Tg,LineCounter:Ag,Pair:Ke,Parser:Hc,Scalar:Y,Schema:Ka,YAMLError:Wc,YAMLMap:ct,YAMLParseError:Ks,YAMLSeq:Ms,YAMLWarning:gg,isAlias:Rs,isCollection:pe,isDocument:an,isMap:ni,isNode:fe,isPair:ue,isScalar:oe,isSeq:ii,parse:nP,parseAllDocuments:sP,parseDocument:Dg,stringify:iP,visit:on,visitAsync:La},Symbol.toStringTag,{value:"Module"})),dm=e=>e.toLowerCase().replace(/[^\p{Letter}\p{Number}]+/gu,"-").replace(/(^-|-$)/g,"")||"sekcja",aP=(e,s)=>{const n=e.split(/\n(?=##\s+)/g);return n.length<=1&&!/^##\s+/.test(e)?[{id:dm(s||"Sekcja 1"),title:s||"Sekcja 1",content:e}]:n.map((i,r)=>{const o=(i.match(/^##\s+(.+?)\s*$/m)?.[1]||`Sekcja ${r+1}`).trim(),l=i.replace(/^##\s+.+?\n/,"").trim();return{id:dm(o),title:o,content:l}})},oP=/```quiz\s*?\n([\s\S]*?)```/g,lP=(e,s,n)=>{try{const i=rP.parse(e),r=(i?.options||[]).map(String);return!i?.question||!Array.isArray(i?.options)||typeof i?.answerIndex!="number"||i.answerIndex<0||i.answerIndex>=r.length?null:{question:i.question,options:r,answerIndex:i.answerIndex,key:`${s}:${n}`}}catch{return null}},cP=e=>new Map(e.map(s=>[s.id,[...s.content.matchAll(oP)].map((n,i)=>lP(n[1],s.id,i)).filter(Boolean)])),um=(e,s)=>{const[n,i]=G.useState(()=>{try{const r=localStorage.getItem(e);return r?JSON.parse(r):s}catch{return s}});return G.useEffect(()=>{try{localStorage.setItem(e,JSON.stringify(n))}catch(r){console.error("Błąd zapisu do localStorage:",r)}},[e,n]),[n,i]},dP=()=>{const e=G.useRef(null);return{ref:e,say:n=>{e.current&&(e.current.textContent="",setTimeout(()=>e.current&&(e.current.textContent=n),30))}}},uP=()=>t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6",children:[t.jsx("div",{className:"h-5 w-24 rounded bg-muted/60"}),t.jsxs("div",{className:"rounded-2xl border bg-card p-6 shadow-soft animate-pulse",children:[t.jsx("div",{className:"h-6 w-2/3 rounded bg-muted/60 mb-2"}),t.jsx("div",{className:"h-4 w-40 rounded bg-muted/60"})]}),t.jsx("div",{className:"space-y-3",children:Array.from({length:10}).map((e,s)=>t.jsx("div",{className:"h-4 w-full rounded bg-muted/50"},s))}),t.jsx("div",{className:"h-10 w-48 rounded-lg bg-muted/60 ml-auto"})]}),mm={code:({inline:e,className:s="",children:n,...i})=>{const r=(s||"").toLowerCase();return!e&&r.includes("language-quiz")?null:t.jsx("code",{className:s,...i,children:n})},pre:e=>((Array.isArray(e.children)?e.children[0]:e.children)?.props?.className?.toLowerCase?.()||"").includes("language-quiz")?null:t.jsx("pre",{...e})},mP=({quiz:e,onClose:s,onPass:n})=>{const[i,r]=G.useState(null),[a,o]=G.useState(!1),l=()=>{const c=i!==null&&i===e.answerIndex;o(c),c?(O.success("Poprawna odpowiedź!"),setTimeout(n,200)):O.error("Niepoprawna odpowiedź — spróbuj ponownie.")};return t.jsxs("div",{className:"fixed inset-0 z-[90] flex items-end sm:items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:s}),t.jsxs("div",{className:"relative z-[91] w-full sm:max-w-lg bg-background rounded-t-2xl sm:rounded-2xl border shadow-2xl p-4 sm:p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:"Pytanie kontrolne"}),t.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-muted","aria-label":"Zamknij",children:t.jsx(xt,{className:"h-5 w-5"})})]}),t.jsx("p",{className:"mb-3 text-sm sm:text-base",children:e.question}),t.jsx("div",{className:"space-y-2 mb-4",children:e.options.map((c,d)=>t.jsxs("label",{className:"flex items-center gap-2 rounded-md border px-3 py-2 cursor-pointer hover:bg-muted",children:[t.jsx("input",{type:"radio",name:"quiz-choice",className:"h-4 w-4",checked:i===d,onChange:()=>r(d),disabled:a}),t.jsx("span",{className:"text-sm",children:c})]},d))}),t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:s,className:"rounded-lg border px-3 py-1.5 text-sm hover:bg-muted",children:"Anuluj"}),t.jsx("button",{onClick:l,className:"rounded-lg border px-3 py-1.5 text-sm font-medium hover:bg-muted",disabled:a,children:"Zatwierdź"})]})]})]})},hP=()=>{const{courseId:e,lessonId:s}=Ze(),n=Z(),{data:i,isLoading:r}=Oe({resource:"activities",id:s,meta:{select:"*, topics(title, course_id, courses(title, icon_emoji))"}}),a=i?.data??{},o=a?.content_md??a?.markdown??a?.content,l=G.useMemo(()=>o?aP(o,a?.title??"Sekcja"):[],[o,a?.title]),c=G.useMemo(()=>cP(l),[l]),d=`lesson-progress:${s}`,m=`lesson-quiz:${s}`,[u,h]=um(d,Object.fromEntries(l.map(A=>[A.id,!1]))),[p,g]=um(m,{}),[f,y]=G.useState(null);G.useEffect(()=>{l.length&&h(A=>{const v={};return l.forEach(P=>v[P.id]=A[P.id]??!1),v})},[l.map(A=>A.id).join("|")]);const{ref:b,say:j}=dP(),w=l.findIndex(A=>!u[A.id]),S=w===-1,k=A=>{const[v]=c.get(A)??[];v&&y(v)},z=A=>{const v=l[A];if(!v||!(w===-1||A<=w)&&!u[v.id])return;if(u[v.id]){h(_=>({..._,[v.id]:!1})),j(`Sekcja ${A+1} cofnięta.`);return}(c.get(v.id)??[]).length>0?k(v.id):(h(_=>({..._,[v.id]:!0})),j(`Sekcja ${A+1} odhaczona.`))},N=()=>{const A=f;if(y(null),!A)return;g(D=>({...D,[A.key]:!0}));const v=A.key.split(":")[0];h(D=>({...D,[v]:!0}));const P=l.findIndex(D=>D.id===v);j(`Sekcja ${P+1} odhaczona po pytaniu kontrolnym.`)},C=async()=>{if(!S)return O.info("Najpierw odhacz wszystkie sekcje po kolei.");try{await te.rpc("start_activity",{p_activity_id:parseInt(s)});const{data:A,error:v}=await te.rpc("complete_material",{p_activity_id:parseInt(s)});if(v)throw v;if(A){O.success("Lekcja ukończona!"),Wo("get_course_structure"),Wo("get_my_courses");try{localStorage.removeItem(d),localStorage.removeItem(m)}catch(P){console.error("Błąd zapisu do localStorage:",P)}n(`/student/courses/${e}`)}}catch{O.error("Nie udało się ukończyć lekcji")}};return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-10 pb-28 lg:pb-16",children:[t.jsx("div",{ref:b,"aria-live":"polite",className:"sr-only"}),t.jsxs("button",{onClick:()=>n(`/student/courses/${e}`),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[t.jsx(je,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Powrót do kursu"})]}),t.jsx("section",{className:"relative overflow-hidden rounded-2xl border bg-white dark:bg-card",children:t.jsx("div",{className:"relative z-10 p-5 sm:p-7 md:p-10",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"text-4xl md:text-5xl leading-none",children:a?.topics?.courses?.icon_emoji||"📚"}),t.jsxs("div",{className:"min-w-0",children:[t.jsxs("div",{className:"text-xs sm:text-sm text-muted-foreground flex items-center gap-2",children:[t.jsx("span",{className:"truncate",children:a?.topics?.courses?.title||"…"}),t.jsx("span",{children:"•"}),t.jsx("span",{className:"truncate",children:a?.topics?.title||"…"})]}),t.jsx("h1",{className:"mt-1 text-xl md:text-3xl font-bold tracking-tight",children:a?.title||"Ładowanie…"}),a?.duration_min&&t.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 rounded-full border bg-white/70 dark:bg-background/60 px-3 py-1.5 shadow-soft",children:[t.jsx(Qt,{className:"h-4 w-4"}),t.jsxs("span",{className:"text-sm font-medium",children:[a?.duration_min," min czytania"]})]})]})]})})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_280px] gap-10",children:[t.jsx("main",{children:r?t.jsx(uP,{}):t.jsxs("section",{children:[t.jsx("div",{className:"prose prose-neutral dark:prose-invert max-w-[72ch] mx-auto prose-headings:font-semibold prose-p:text-muted-foreground prose-p:leading-relaxed prose-li:leading-relaxed prose-headings:tracking-tight prose-img:rounded-xl prose-blockquote:rounded-xl md:prose-lg",children:l.length?l.map((A,v)=>{const P=!!u[A.id],D=!P&&v===w,E=!(w===-1||v<=w)&&!P,X=(c.get(A.id)??[])[0],Be="rounded-[20px] border p-6 sm:p-7 md:p-8 shadow-sm transition-colors duration-200",Q=P?"bg-emerald-50 dark:bg-emerald-950/25 border-emerald-300":D?"bg-white dark:bg-background border-neutral-200 shadow-md":E?"bg-white dark:bg-card border-dashed border-muted-foreground/40":"bg-white dark:bg-card border-neutral-200",J=!P&&E?"filter blur-[2px] select-none pointer-events-none":"";return t.jsxs("div",{id:A.id,className:"mb-12 scroll-mt-28",children:[t.jsxs("div",{className:`${Be} ${Q}`,children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[E&&t.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-[11px] text-muted-foreground bg-white",children:[t.jsx(Yr,{className:"h-3.5 w-3.5"}),"Zablokowana"]}),P&&t.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-emerald-300/60 bg-emerald-50/60 px-2.5 py-0.5 text-[11px] text-emerald-700 dark:text-emerald-300",children:[t.jsx(Ce,{className:"h-3.5 w-3.5"}),"Ukończona"]}),D&&!P&&t.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border bg-white px-2.5 py-0.5 text-[11px]",children:[t.jsx(Fr,{className:"h-3.5 w-3.5"}),"W trakcie"]}),X&&t.jsxs("button",{type:"button",onClick:()=>!P&&!E&&k(A.id),disabled:P||E,className:["inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-[11px]",P?"text-emerald-700 border-emerald-300/60 bg-emerald-50/60 dark:bg-emerald-950/25":E?"text-muted-foreground cursor-not-allowed bg-white dark:bg-background/40":"bg-white hover:bg-muted"].join(" "),title:P?"Pytanie rozwiązane":E?"Najpierw odblokuj sekcję":"Kliknij, aby odpowiedzieć","aria-label":"Pytanie kontrolne",children:[t.jsx(st,{className:"h-3.5 w-3.5"}),X.question.length>72?X.question.slice(0,69)+"…":X.question]})]}),t.jsxs("div",{className:J,children:[t.jsx("h2",{className:"text-[22px] md:text-[26px] font-semibold tracking-tight m-0 mb-4",children:A.title||`Sekcja ${v+1}`}),t.jsx(Cn,{remarkPlugins:[Uo],components:mm,children:A.content})]}),t.jsx("div",{className:"mt-6 flex justify-end",children:t.jsxs("label",{className:["inline-flex items-center gap-3",E?"cursor-not-allowed opacity-60":"cursor-pointer"].join(" "),title:E?"Najpierw ukończ poprzednie sekcje":P?"Sekcja odhaczona — klik, aby cofnąć":X?"Kliknij, aby odpowiedzieć na pytanie":"Odhacz sekcję",children:[t.jsx("input",{type:"checkbox",className:"sr-only",checked:P,onChange:()=>!E&&z(v),disabled:E&&!P,"aria-label":`Odhacz sekcję: ${A.title||`Sekcja ${v+1}`}`}),t.jsx("span",{className:["inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm font-medium shadow-soft transition-all",P?"bg-emerald-50/70 dark:bg-emerald-950/30 border-emerald-300/60 text-emerald-700 dark:text-emerald-300":"bg-white hover:bg-muted border-neutral-200"].join(" "),children:X&&!P?t.jsx("span",{className:"truncate max-w-[56ch]",children:X.question}):t.jsxs(t.Fragment,{children:[P?t.jsx(Ce,{className:"h-4 w-4"}):t.jsx(Fr,{className:"h-4 w-4"}),t.jsxs("span",{className:"whitespace-nowrap",children:[String(v+1).padStart(2,"0")," • ",P?"Odhaczono":X?"Odhacz (pytanie)":"Odhacz sekcję"]})]})})]})})]}),t.jsx("div",{className:"h-8"})]},A.id)}):o?t.jsx(Cn,{remarkPlugins:[Uo],components:mm,children:o}):t.jsx("div",{dangerouslySetInnerHTML:{__html:a?.content||""}})}),!!l.length&&t.jsx("div",{className:"mt-10 flex justify-end",children:t.jsx("button",{onClick:C,className:"inline-flex items-center gap-2 rounded-lg border bg-white px-4 py-2 text-sm font-medium shadow-soft hover:bg-muted transition-colors disabled:opacity-60",disabled:!S,title:S?void 0:"Najpierw odhacz wszystkie sekcje",children:"Zakończ lekcję"})})]})}),t.jsx("aside",{children:t.jsxs("nav",{className:"border rounded-[14px] p-4 bg-white dark:bg-background/60 lg:sticky lg:top-28",children:[t.jsx("h2",{className:"text-sm font-semibold mb-3",children:"Spis treści"}),r?t.jsx("div",{className:"h-4 w-40 rounded bg-muted/60 animate-pulse"}):l.length?t.jsx("ol",{className:"space-y-1.5 text-sm",children:l.map((A,v)=>{const P=!!u[A.id],D=!P&&v===w,E=!(w===-1||v<=w)&&!P;return t.jsxs("li",{className:"flex items-center gap-1.5",children:[E?t.jsx(Yr,{className:"h-3.5 w-3.5 text-muted-foreground"}):P?t.jsx(Ce,{className:"h-3.5 w-3.5 text-emerald-600"}):t.jsx(Fr,{className:"h-3.5 w-3.5"}),t.jsxs("a",{href:`#${A.id}`,className:["flex-1 block px-2 py-1 rounded transition-colors",E?"text-muted-foreground pointer-events-none":"hover:bg-muted",P?"text-emerald-700":"",D?"font-semibold underline":""].join(" "),"aria-disabled":E,children:[String(v+1).padStart(2,"0"),". ",A.title||`Sekcja ${v+1}`]})]},A.id)})}):t.jsx("p",{className:"text-sm text-muted-foreground",children:"Brak sekcji."})]})})]}),f&&t.jsx(mP,{quiz:f,onClose:()=>y(null),onPass:N})]})},pP=[t.jsx(L,{path:"/courses/:courseId/lesson/:lessonId",element:t.jsx(hP,{})},"lesson-view")],fP=()=>{const{courseId:e,quizId:s}=Ze(),n=Z(),[i,r]=G.useState(0),[a,o]=G.useState({}),[l,c]=G.useState(null),[d,m]=G.useState(!1),[u,h]=G.useState([]),[p,g]=G.useState(!0),{data:f,isLoading:y}=Oe({resource:"activities",id:s,meta:{select:"*, topics(title, course_id, courses(title, icon_emoji))"}});G.useEffect(()=>{(async()=>{if(s)try{await te.rpc("start_activity",{p_activity_id:parseInt(s)}),g(!0);const{data:N,error:C}=await te.rpc("get_quiz_questions",{p_activity_id:parseInt(s)});if(C)throw C;const A=typeof N=="string"?JSON.parse(N):N;h(Array.isArray(A)?A:[])}catch(N){console.error("Quiz init error:",N),O.error("Błąd podczas ładowania quizu")}finally{g(!1)}})()},[s]),G.useEffect(()=>{f?.data?.time_limit&&l===null&&c(f.data.time_limit*60)},[f]),G.useEffect(()=>{if(l!==null&&l>0){const z=setTimeout(()=>c(l-1),1e3);return()=>clearTimeout(z)}else l===0&&k()},[l]);const b=f?.data,j=u[i],w=u.length>0?(i+1)/u.length*100:0,S=(z,N)=>{o(C=>({...C,[z]:N}))},k=async()=>{m(!0);try{const z=Object.entries(a).map(([A,v])=>({question_id:parseInt(A),option_id:v})),{data:N,error:C}=await te.rpc("finish_quiz",{p_activity_id:parseInt(s),p_answers:z});if(C)throw C;if(N){const{score:A,passed:v,points_earned:P}=N;v?O.success(`Quiz zaliczony! Wynik: ${A}%`):O.error(`Quiz niezaliczony. Wynik: ${A}%`),Wo("get_course_structure"),n(`/student/courses/${e}`)}}catch{O.error("Nie udało się przesłać odpowiedzi")}finally{m(!1)}};return y||p?t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-300"})}):t.jsxs("div",{className:"max-w-3xl mx-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-8",children:[t.jsxs("button",{onClick:()=>n(`/student/courses/${e}`),className:"flex items-center gap-2 text-gray-500 hover:text-gray-900 transition-colors",children:[t.jsx(je,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Zakończ quiz"})]}),l!==null&&t.jsxs("div",{className:M("flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium",l<60?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:[t.jsx(Qt,{className:"w-4 h-4"}),Math.floor(l/60),":",String(l%60).padStart(2,"0")]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:b?.title}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[t.jsxs("span",{children:["Pytanie ",i+1," z ",u.length]}),t.jsx("span",{children:"•"}),t.jsxs("span",{children:[j?.points," pkt"]})]})]}),t.jsx("div",{className:"h-1 bg-gray-100 rounded-full overflow-hidden mb-8",children:t.jsx(ye.div,{initial:{width:0},animate:{width:`${w}%`},className:"h-full bg-gray-900"})}),t.jsx(rC,{mode:"wait",children:j&&t.jsx(ye.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:t.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-8 mb-8",children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-6",children:j.question}),t.jsx("div",{className:"space-y-3",children:j.options.map(z=>t.jsx("label",{className:M("block p-4 rounded-xl border-2 cursor-pointer transition-all",a[j.id]===z.id?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-300"),children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"radio",name:`question-${j.id}`,value:z.id,checked:a[j.id]===z.id,onChange:()=>S(j.id,z.id),className:"sr-only"}),t.jsx("div",{className:M("w-5 h-5 rounded-full border-2 flex items-center justify-center",a[j.id]===z.id?"border-gray-900":"border-gray-300"),children:a[j.id]===z.id&&t.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-gray-900"})}),t.jsx("span",{className:"flex-1",children:z.text})]})},z.id))})]})},j.id)}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("button",{onClick:()=>r(Math.max(0,i-1)),disabled:i===0,className:M("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all",i===0?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"),children:[t.jsx(je,{className:"w-4 h-4"}),"Poprzednie"]}),t.jsx("div",{className:"flex gap-2",children:u.map((z,N)=>t.jsx("button",{onClick:()=>r(N),className:M("w-2 h-2 rounded-full transition-all",N===i?"bg-gray-900 w-8":a[u[N]?.id]?"bg-gray-600":"bg-gray-300")},N))}),i<u.length-1?t.jsxs("button",{onClick:()=>r(i+1),disabled:!a[j?.id],className:M("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all",a[j?.id]?"bg-gray-900 text-white hover:bg-gray-800":"bg-gray-100 text-gray-400 cursor-not-allowed"),children:["Następne",t.jsx(Ge,{className:"w-4 h-4"})]}):t.jsxs("button",{onClick:k,disabled:d||Object.keys(a).length<u.length,className:M("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all",d||Object.keys(a).length<u.length?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-green-500 text-white hover:bg-green-600"),children:[d?"Przesyłanie...":"Zakończ quiz",t.jsx(Ce,{className:"w-4 h-4"})]})]})]})},xP=[t.jsx(L,{path:"/courses/:courseId/quiz/:quizId",element:t.jsx(fP,{})},"quiz-take")],gP={"⚡":It,"🚀":Un,"🧠":Mn,"☕":oj,"📚":aj},yP=()=>t.jsxs("div",{className:"rounded-2xl border bg-card p-6 shadow-soft animate-pulse",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-muted/70"}),t.jsxs("div",{children:[t.jsx("div",{className:"h-4 w-40 rounded bg-muted/70"}),t.jsx("div",{className:"mt-2 h-3 w-24 rounded bg-muted/60"})]})]}),t.jsx("div",{className:"h-5 w-16 rounded-full bg-muted/60"})]}),t.jsxs("div",{className:"space-y-3 mb-4",children:[t.jsx("div",{className:"h-3 w-full rounded bg-muted/60"}),t.jsx("div",{className:"h-3 w-2/3 rounded bg-muted/60"})]}),t.jsx("div",{className:"h-10 w-full rounded-lg bg-muted/60"})]}),jP=()=>{const{stats:e,refetch:s}=Pa(),{data:n,isLoading:i,refetch:r}=fr("get_idle_upgrades"),a=async l=>{try{const{data:c,error:d}=await te.rpc("buy_idle_upgrade",{p_upgrade_id:l});if(d)throw d;c&&(O.success(`Ulepszenie zakupione! Poziom ${c.new_level}`),s(),r())}catch{O.error("Niewystarczająca ilość punktów")}},o=n||[];return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs(ye.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),t.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),t.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:t.jsxs("div",{className:"grid gap-4 md:grid-cols-12 md:items-center",children:[t.jsxs("div",{className:"md:col-span-4 space-y-2",children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Ulepszenia"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Inwestuj punkty, aby zwiększyć tempo zdobywania kolejnych."})]}),t.jsxs("div",{className:"md:col-span-8 grid grid-cols-3 gap-4 md:gap-6",children:[t.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Punkty / h"}),t.jsx(Gs,{className:"h-4 w-4 text-accent"})]}),t.jsx("div",{className:"mt-2 flex items-end gap-2",children:t.jsx("span",{className:"text-4xl md:text-5xl font-semibold text-accent leading-none tabular-nums",children:t.jsx($e,{value:e.idle_rate})})}),t.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Pasywne tempo zdobywania punktów."})]}),t.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Twoje punkty"}),t.jsx(It,{className:"h-4 w-4 text-primary"})]}),t.jsxs("div",{className:"mt-2 flex items-end gap-2",children:[t.jsx("span",{className:"text-4xl md:text-5xl font-semibold text-primary leading-none tabular-nums",children:t.jsx($e,{value:e.points})}),t.jsx("span",{className:"mb-[2px] text-sm text-muted-foreground",children:"pkt"})]}),t.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Wydaj je na ulepszenia poniżej."})]}),t.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Do kolejnego poziomu"}),t.jsx(Un,{className:"h-4 w-4 text-secondary"})]}),t.jsx("div",{className:"mt-3",children:t.jsx(en,{value:e.points%100})}),t.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["Pozostało ",100-e.points%100," pkt"]})]})]})]})})]}),t.jsxs(ye.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"space-y-4",children:[t.jsx("div",{className:"flex items-center justify-between gap-4",children:t.jsxs("div",{className:"min-w-0",children:[t.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-semibold tracking-tight",children:"Dostępne ulepszenia"}),t.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Wybierz i zwiększ swoje tempo zdobywania punktów."})]})}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-5",children:[i&&Array.from({length:6}).map((l,c)=>t.jsx(yP,{},c)),!i&&o.map((l,c)=>{const d=e.points>=l.next_cost,m=gP[l.icon]||It;return t.jsxs(ti,{index:c,className:M("group relative rounded-2xl border bg-card p-5 shadow-soft hover:bg-muted/40 transition-colors"),children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-muted flex items-center justify-center shrink-0",children:t.jsx(m,{className:"w-6 h-6 text-muted-foreground"})}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h4",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:l.name}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Poziom ",l.current_level]})]})]}),t.jsx("span",{className:M("inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-semibold border",d?"border-primary/30 text-primary":"border-muted-foreground/25 text-muted-foreground"),children:d?"Dostępne":"Za drogie"})]}),t.jsxs("div",{className:"mt-4 space-y-3",children:[t.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Aktualny bonus"}),t.jsxs("span",{className:"font-medium text-green-600 dark:text-green-400",children:["+",t.jsx($e,{value:l.total_bonus})," pkt/h"]})]}),t.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Następny poziom"}),t.jsxs("span",{className:"font-medium",children:["+",l.bonus_per_level," pkt/h"]})]})]}),t.jsxs(ye.button,{whileHover:d?{scale:1.02}:{},whileTap:d?{scale:.98}:{},onClick:()=>a(l.id),disabled:!d,className:M("mt-4 w-full py-2.5 sm:py-3 rounded-lg font-medium focus-ring transition-colors",d?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-muted text-muted-foreground cursor-not-allowed"),title:d?"Kup ulepszenie":"Brakuje punktów",children:["Ulepsz za ",t.jsx($e,{value:l.next_cost})," pkt"]})]},l.id)})]})]})]})},bP=[t.jsx(L,{path:"/gamification",element:t.jsx(jP,{})},"gamification")],wP=()=>t.jsx("div",{className:"rounded-2xl border bg-card p-4 shadow-soft animate-pulse",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-8 h-5 rounded bg-muted/60"}),t.jsx("div",{className:"w-10 h-10 rounded-full bg-muted/70"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 w-40 rounded bg-muted/60"}),t.jsx("div",{className:"mt-2 h-3 w-28 rounded bg-muted/50"})]}),t.jsx("div",{className:"h-5 w-16 rounded bg-muted/60"})]})}),vP=()=>{const{data:e}=Tt(),[s,n]=G.useState("all"),{data:i,isLoading:r,refetch:a,error:o}=fr("get_leaderboard",{p_limit:20,p_filter:s});G.useEffect(()=>{let d=!1,m=!1;return(async()=>{if(!(d||m)){m=!0;try{await a()}finally{m=!1}}})(),()=>{d=!0}},[s]);const l=i||[],c=d=>{switch(d){case 1:return t.jsx(dt,{className:"w-5 h-5 text-yellow-500"});case 2:return t.jsx(cj,{className:"w-5 h-5 text-gray-400"});case 3:return t.jsx(Di,{className:"w-5 h-5 text-orange-500"});default:return t.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:d})}};return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs(ye.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),t.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),t.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:t.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Ranking"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Top 20 użytkowników według punktów."})]}),t.jsx("div",{className:"bg-muted rounded-lg p-1 inline-flex gap-1",children:[{value:"all",label:"Wszyscy"},{value:"students",label:"Uczniowie"},{value:"teachers",label:"Nauczyciele"}].map(d=>t.jsx("button",{onClick:()=>n(d.value),className:M("px-3 sm:px-4 py-1.5 rounded-md text-sm font-medium transition-colors",s===d.value?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:d.label},d.value))})]})})]}),t.jsxs(ye.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"space-y-2",children:[r&&Array.from({length:4}).map((d,m)=>t.jsx(wP,{},m)),!r&&(o||l.length===0)&&t.jsxs("div",{className:"rounded-2xl border bg-card p-8 text-center shadow-soft",children:[t.jsx("div",{className:"text-4xl",children:"🥲"}),t.jsx("h4",{className:"mt-3 text-base sm:text-lg font-semibold",children:"Brak wyników"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:o?"Nie udało się pobrać rankingu.":"Brak danych dla wybranego filtra."}),t.jsxs("button",{onClick:()=>a(),className:"mt-4 inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm hover:bg-primary/5 focus-ring",children:[t.jsx(lj,{className:"w-4 h-4"}),"Spróbuj ponownie"]})]}),!r&&l.length>0&&l.map((d,m)=>{const u=d.user_id===e?.id,h=d.rank<=3;return t.jsxs(ti,{index:m,className:M("flex items-center gap-4 p-4 rounded-2xl border shadow-soft transition-colors",u?"bg-primary text-primary-foreground border-primary/40":h?"bg-muted/50 border-border":"bg-card hover:bg-muted/40 border-border"),children:[t.jsx("div",{className:"w-8 flex justify-center",children:c(d.rank)}),t.jsx("div",{className:M("w-10 h-10 rounded-full flex items-center justify-center font-semibold shrink-0",u?"bg-primary-foreground text-primary":h?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),"aria-label":`Avatar użytkownika ${d.full_name||"Użytkownik"}`,title:d.full_name||"Użytkownik",children:d.full_name?.charAt(0)??"U"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"font-medium truncate",children:[d.full_name||"Użytkownik",u&&t.jsx("span",{className:"ml-2 text-sm opacity-80",children:"(Ty)"})]}),t.jsxs("div",{className:M("text-sm",u?"text-primary-foreground/80":"text-muted-foreground"),children:["Poziom ",d.level," • Seria ",d.streak," dni"]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-semibold tabular-nums",children:t.jsx($e,{value:d.points})}),t.jsx("div",{className:M("text-xs",u?"text-primary-foreground/80":"text-muted-foreground"),children:"punktów"})]})]},d.user_id||`${d.rank}-${m}`)})]})]})},NP=[t.jsx(L,{path:"/leaderboard",element:t.jsx(vP,{})},"leaderboard")],xi=[{id:1,icon:Tn,title:"Pierwszy Krok",description:"Ukończ pierwszą lekcję",unlocked:!0,rarity:"common",unlockedAt:"2024-01-15",progress:100},{id:2,icon:Ii,title:"Perfekcjonista",description:"Zdobądź 100% w 10 quizach",unlocked:!0,rarity:"rare",unlockedAt:"2024-02-20",progress:100},{id:3,icon:It,title:"Błyskawica",description:"Ukończ 5 lekcji w jeden dzień",unlocked:!1,rarity:"epic",progress:60},{id:4,icon:dt,title:"Mistrz",description:"Osiągnij poziom 50",unlocked:!1,rarity:"legendary",progress:24},{id:5,icon:Ss,title:"Snajper",description:"Odpowiedz poprawnie na 100 pytań z rzędu",unlocked:!1,rarity:"epic",progress:45},{id:6,icon:Un,title:"Rakieta",description:"Ukończ kurs w mniej niż tydzień",unlocked:!1,rarity:"rare",progress:0}],hm={common:{bg:"bg-muted",ring:"ring-1 ring-border",label:"Pospolite",badge:"border border-muted-foreground/20 text-muted-foreground bg-background/60"},rare:{bg:"bg-blue-500/10",ring:"ring-1 ring-blue-500/30",label:"Rzadkie",badge:"border border-blue-500/30 text-blue-600 dark:text-blue-400"},epic:{bg:"bg-purple-500/10",ring:"ring-1 ring-purple-500/30",label:"Epiczne",badge:"border border-purple-500/30 text-purple-600 dark:text-purple-400"},legendary:{bg:"bg-orange-500/10",ring:"ring-1 ring-orange-500/30",label:"Legendarne",badge:"border border-orange-500/30 text-orange-600 dark:text-orange-400"}},kP=()=>{const e=xi.filter(i=>i.unlocked).length,s=xi.length,n=Math.round(e/s*100);return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs(ye.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),t.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),t.jsxs("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:[t.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Osiągnięcia"}),t.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Odblokowano"," ",t.jsx("span",{className:"font-semibold tabular-nums",children:e})," ","z"," ",t.jsx("span",{className:"font-semibold tabular-nums",children:s})," ","(",n,"%)"]})]}),t.jsxs("div",{className:"w-full md:w-96",children:[t.jsxs("div",{className:"flex items-center justify-between text-xs mb-1.5",children:[t.jsx("span",{className:"text-muted-foreground",children:"Postęp osiągnięć"}),t.jsxs("span",{className:"font-medium tabular-nums",children:[n,"%"]})]}),t.jsx(en,{value:n})]})]}),t.jsx("div",{className:"mt-4 grid grid-cols-2 sm:grid-cols-4 gap-2",children:Object.entries(hm).map(([i,r])=>{const a=xi.filter(l=>l.rarity===i&&l.unlocked).length,o=xi.filter(l=>l.rarity===i).length;return t.jsxs("div",{className:M("rounded-xl border bg-card/70 backdrop-blur-sm p-3 shadow-soft"),children:[t.jsxs("p",{className:"text-lg font-semibold tabular-nums",children:[a,"/",o]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:r.label})]},i)})})]})]}),t.jsx(ye.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-5",children:xi.map((i,r)=>{const a=hm[i.rarity],o=i.icon,l=i.unlocked?t.jsx("span",{className:M("inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-semibold",a.badge),children:"Odblokowane"}):t.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-primary/30 text-primary px-2.5 py-1 text-[11px] font-semibold",children:[i.progress,"%"]});return t.jsxs(ti,{index:r,className:M("group relative rounded-2xl border bg-card p-5 shadow-soft hover:bg-muted/40 transition-colors",!i.unlocked&&"opacity-95"),children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("div",{className:M("w-12 h-12 rounded-xl flex items-center justify-center shrink-0",a.bg,a.ring),children:t.jsx(o,{className:"w-6 h-6"})}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h3",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:i.title}),t.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:i.description})]})]}),l]}),t.jsx("div",{className:"mt-4",children:i.unlocked?t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Odblokowano:"," ",t.jsx("span",{className:"font-medium",children:new Date(i.unlockedAt).toLocaleDateString("pl-PL")})]}):t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[t.jsx("span",{className:"text-muted-foreground",children:"Postęp"}),t.jsxs("span",{className:"font-medium tabular-nums",children:[i.progress,"%"]})]}),t.jsx(en,{value:i.progress})]})})]},i.id)})})]})},zP=[t.jsx(L,{path:"/achievements",element:t.jsx(kP,{})},"achievements")],SP=()=>{const{data:e}=Tt(),{stats:s}=Pa(),n=e?.full_name||e?.name||e?.email||"Użytkownik",i=(e?.full_name||e?.name||"U").split(" ").map(o=>o[0]).slice(0,2).join("").toUpperCase()||"U",r=(()=>{const o=e?.created_at;return(o?new Date(o):new Date).toLocaleDateString("pl-PL")})(),a=[{icon:dt,label:"Punkty",value:s.points,iconColor:"text-primary",highlight:"primary",counter:!0},{icon:Ss,label:"Ukończone quizy",value:s.quizzes_completed??0,iconColor:"text-green-600 dark:text-green-400",counter:!1},{icon:Ii,label:"Perfekcyjne wyniki",value:s.perfect_scores??0,iconColor:"text-yellow-600 dark:text-yellow-400",counter:!1},{icon:Tn,label:"Najdłuższa seria",value:`${s.streak??0} dni`,iconColor:"text-destructive",counter:!1},{icon:Qt,label:"Czas nauki",value:`${Math.max(0,Math.floor((s.total_time??0)/60))}h`,iconColor:"text-blue-600 dark:text-blue-400",counter:!1},{icon:dt,label:"Poziom",value:`Poziom ${s.level??1}`,iconColor:"text-secondary",counter:!1}];return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs(ye.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),t.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),t.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[t.jsxs("div",{className:"flex items-start gap-4 sm:gap-6",children:[t.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-2xl bg-primary text-primary-foreground flex items-center justify-center text-xl sm:text-2xl font-semibold shadow-soft",children:i}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:n}),t.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-muted-foreground",children:[e?.email&&t.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[t.jsx(sr,{className:"w-4 h-4 shrink-0"}),t.jsx("span",{className:"truncate",children:e.email})]}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(Ps,{className:"w-4 h-4"}),t.jsxs("span",{children:["Dołączył ",r]})]})]})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsxs("button",{className:"inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm hover:bg-primary/5 focus-ring",children:[t.jsx(dj,{className:"w-4 h-4"}),"Edytuj profil"]}),t.jsx("button",{className:"inline-flex items-center gap-2 rounded-lg bg-primary px-3 py-2 text-sm text-primary-foreground hover:bg-primary/90 focus-ring",children:"Ustawienia"})]})]})})]}),t.jsxs(ye.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},children:[t.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-semibold tracking-tight mb-4",children:"Statystyki"}),t.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-5",children:a.map((o,l)=>{const c=o.icon;return t.jsx(ti,{index:l,className:"group relative rounded-2xl border bg-card p-5 shadow-soft hover:bg-muted/40 transition-colors",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-muted flex items-center justify-center shrink-0",children:t.jsx(c,{className:`w-6 h-6 ${o.iconColor}`})}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:`text-2xl font-semibold leading-none tabular-nums ${o.highlight==="primary"?"text-primary":o.highlight==="secondary"?"text-secondary":o.highlight==="accent"?"text-accent":"text-foreground"}`,children:o.counter?t.jsx($e,{value:Number(o.value)}):o.value}),t.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:o.label})]})]})},o.label)})})]}),t.jsxs(ye.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.08},className:"space-y-4",children:[t.jsx("h2",{className:"text-lg sm:text-xl font-semibold tracking-tight",children:"Ustawienia"}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap gap-3",children:[t.jsx(ye.button,{whileHover:{x:2},whileTap:{scale:.98},className:"w-full sm:w-auto sm:min-w-[220px] inline-flex items-center justify-center rounded-xl bg-primary text-primary-foreground px-4 py-3 shadow-soft hover:bg-primary/90 focus-ring",children:t.jsxs("span",{className:"inline-flex items-center gap-2 font-medium",children:[t.jsx(Yr,{className:"w-4 h-4"}),"Zmień hasło"]})}),t.jsx(ye.button,{whileHover:{x:2},whileTap:{scale:.98},className:"w-full sm:w-auto sm:min-w-[220px] inline-flex items-center justify-center rounded-xl bg-secondary text-white px-4 py-3 shadow-soft hover:opacity-95 focus-ring",children:t.jsxs("span",{className:"inline-flex items-center gap-2 font-medium",children:[t.jsx(Jm,{className:"w-4 h-4"}),"Ustawienia powiadomień"]})}),t.jsx(ye.button,{whileHover:{x:2},whileTap:{scale:.98},className:"w-full sm:w-auto sm:min-w-[220px] inline-flex items-center justify-center rounded-xl bg-destructive text-white px-4 py-3 shadow-soft hover:bg-destructive/90 focus-ring",children:t.jsxs("span",{className:"inline-flex items-center gap-2 font-medium",children:[t.jsx(ds,{className:"w-4 h-4"}),"Usuń konto"]})})]})]})]})},CP=[t.jsx(L,{path:"/profile",element:t.jsx(SP,{})},"profile")],TP=x.lazy(()=>er(()=>Promise.resolve().then(()=>Wj),void 0).then(e=>{const s=[...UT,...KT,...YT,...pP,...xP,...bP,...NP,...zP,...CP];return{default:()=>t.jsx(Il,{routes:s,layout:t.jsx(i1,{children:t.jsxs(Ji,{children:[t.jsx(L,{index:!0,element:t.jsx(Ts,{to:"dashboard",replace:!0})}),...s,t.jsx(L,{path:"*",element:t.jsx(Ts,{to:"dashboard",replace:!0})})]})})})}})),AP=()=>t.jsx(Uj,{authKey:"student-auth-check",children:t.jsx(ih,{allowedRoles:["student"],fallbackPath:"/dashboard/overview",loadingText:"Ładowanie panelu ucznia...",loadingColorClass:"border-blue-600",children:t.jsx(x.Suspense,{fallback:t.jsx(_l,{text:"Ładowanie panelu ucznia...",colorClass:"border-blue-600"}),children:t.jsx(TP,{})})})}),PP=t.jsx(L,{path:"/student/*",element:t.jsx(AP,{})}),EP=new Oy({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:!1,staleTime:300*1e3}}});function DP(){return t.jsx(Ry,{client:EP,children:t.jsx(kl,{dataProvider:Sl(te),authProvider:Dl,resources:[],options:{syncWithLocation:!1,warnWhenUnsavedChanges:!1,useNewQueryKeys:!0,disableTelemetry:!0},children:t.jsx(Sy,{children:t.jsxs(Ji,{children:[t.jsx(L,{path:"/",element:t.jsx(Dj,{})}),nh,Oj,$j,Bj,Qz,PP,t.jsx(L,{path:"/admin/*",element:t.jsx(Ts,{to:"/teacher",replace:!0})}),t.jsx(L,{path:"*",element:t.jsx(Ts,{to:"/",replace:!0})})]})})})})}const _P=document.getElementById("root"),IP=gj.createRoot(_P);IP.render(t.jsxs(G.StrictMode,{children:[t.jsx(DP,{}),t.jsx(My,{position:"top-right",richColors:!0,closeButton:!0,duration:4e3,toastOptions:{style:{width:"500px",fontSize:"20px"},className:"sonner-toast"}})]}));export{Es as A,T as B,R as C,es as F,B as I,ce as L,Ds as a,W as b,U as c,rh as d,F as e,H as f,ts as g,se as h,th as i,Xm as l,eh as r,te as s,sh as u};
