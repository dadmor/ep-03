var Rg=Object.defineProperty;var Fg=(e,s,n)=>s in e?Rg(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n;var Er=(e,s,n)=>Fg(e,typeof s!="symbol"?s+"":s,n);import{j as t,R as vm,I as Nm,F as km,S as Ol,a as zm,P as $g,C as Sm,b as Cm,V as qg,c as Bg,d as Tm,e as Vg,T as Am,f as Ug,g as Pm,h as Dm,i as Wg,k as _m,l as Kg,L as Em,m as Im,n as Gg,o as Hg,p as Mm,q as Qg,r as Zg,s as Lm,t as Om,u as Rm,v as Fm,w as $m,x as Yg,y as dn,z as qm,A as Rl,B as $s,D as ue,E as Jg,G as Xg,H as ey,J as Bm,K as ty,M as sy,N as ny,O as iy,Q as Vm,U as Um,W as Wm,X as Na,Y as ry,Z as ay,_ as oy,$ as ly,a0 as cy,a1 as dy,a2 as uy,a3 as my,a4 as hy,a5 as py,a6 as fy,a7 as xy,a8 as Km,a9 as gy,aa as yy,ab as jy,ac as pd}from"./radix-ui-D8ryuvwx.js";import{l as by,a as g,n as wy,R as L,d as ka,e as H,o as F,u as tt,i as ki,p as ar,O as Ho,N as In,L as zi,B as vy,q as Ny}from"./react-vendor-DEevTyTQ.js";import{c as ky,t as $,a as Gm,v as zy,o as Yn,u as $n,b as Fl,n as or,d as ra,e as Sy,f as Hm,E as Cy,g as $l,h as Fi,m as bt,i as Ty,j as Ay,k as As,s as po,r as Py,l as Si,p as Nn,q as Dy,M as Mn,T as _y}from"./utils-DzP_hRLA.js";import{n as st,M as ql,d as Ey,e as Bl,f as Fe,$ as _e,k as Qm,i as Ue,j as qn,I as za,X as ps,H as Iy,w as My,l as Ly,m as Oy,o as Ry,p as Fy,D as $y,E as fo,t as fd,u as qy,_ as By,x as Vy}from"./refine-core-CyN9gnqv.js";import{c as Uy,k as rs,b as Wy,I as Ky}from"./refine-ui-BTr0XArU.js";import{t as Gy,c as Hy,U as ss,M as fs,G as Es,a as Qy,S as Sa,b as Ca,C as Ta,d as Zy,e as ze,f as Aa,X as lt,L as Pa,T as Je,H as Zm,B as Ee,g as aa,A as Bn,h as Ym,i as Qo,F as Js,j as Vl,k as He,l as Jm,m as Ds,n as Xs,o as Yy,p as Jy,q as $i,r as Qr,P as en,s as Ps,u as Re,E as lr,v as Ve,w as Vt,x as Da,y as Vn,z as xs,D as et,I as qt,J as me,K as Xm,N as tn,O as Xy,Q as ct,W as _a,R as ej,V as Is,Y as tj,Z as cr,_ as Ms,$ as Ul,a0 as dr,a1 as rn,a2 as Ze,a3 as xd,a4 as eh,a5 as sj,a6 as th,a7 as nj,a8 as ij,a9 as Jn,aa as Wl,ab as Ea,ac as $t,ad as rj,ae as aj,af as gd,ag as qi,ah as oj,ai as Bi,aj as lj,ak as cj,al as dj,am as uj,an as mj,ao as an,ap as Vi,aq as hj,ar as pj,as as fj,at as yd}from"./ui-utils--mvP9e4I.js";import{R as xj,A as gj,a as yj,X as jj,Y as bj}from"./tables-Czb0d3sH.js";import"./forms-B2VSq9sJ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();var Ir={},jd;function wj(){if(jd)return Ir;jd=1;var e=by();return Ir.createRoot=e.createRoot,Ir.hydrateRoot=e.hydrateRoot,Ir}var vj=wj();const Nj="https://hqsyimochfcfqahcuprn.supabase.co",kj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhxc3lpbW9jaGZjZnFhaGN1cHJuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NjU4NTYsImV4cCI6MjA2OTQ0MTg1Nn0.KutvVrkDKuVyvrYQosU3SI6QrrMnWqDCSZ2E3fhCteI",se=Uy(Nj,kj,{db:{schema:"public"},auth:{persistSession:!0}}),O=(...e)=>Gy(Hy(e));class xo extends Error{constructor(n,i,r,a){super(n);Er(this,"code");Er(this,"statusCode");Er(this,"details");this.name="AuthError",this.code=i,this.statusCode=r||400,this.details=a}}const Mr={user_already_exists:"Konto z tym adresem email już istnieje.",password_too_short:"Hasło musi mieć co najmniej 6 znaków.",password_too_long:"Hasło nie może być dłuższe niż 72 znaki.",invalid_email:"Nieprawidłowy format adresu email.",over_email_send_rate_limit:"Za szybko! Poczekaj 2 sekundy przed ponowną próbą.",registration_failed:"Rejestracja nie powiodła się.",invalid_credentials:"Nieprawidłowy email lub hasło.",email_not_confirmed:"Potwierdź swój adres email przed zalogowaniem.",user_not_found:"Nie znaleziono użytkownika.",reset_password_rate_limit:"Zbyt wiele prób. Spróbuj ponownie za chwilę.",invalid_recovery_token:"Link do resetowania hasła wygasł lub jest nieprawidłowy.",update_failed:"Aktualizacja nie powiodła się.",session_expired:"Sesja wygasła. Zaloguj się ponownie.",oauth_error:"Błąd podczas logowania przez zewnętrznego dostawcę.",oauth_cancelled:"Logowanie zostało anulowane.",unknown_error:"Wystąpił nieoczekiwany błąd. Spróbuj ponownie.",network_error:"Błąd połączenia. Sprawdź swoje połączenie internetowe."},it=e=>{if(!e)return new xo(Mr.unknown_error,"unknown_error");if(e instanceof xo)return e;const s=e.message||e.error_description||"",n=e.code||e.error||"";let i="unknown_error",r=Mr.unknown_error,a=400;if(n)switch(n){case"user_already_exists":case"user_already_registered":i="user_already_exists",a=409;break;case"weak_password":i="password_too_short",a=422;break;case"invalid_email":i="invalid_email",a=422;break;case"over_email_send_rate_limit":i="over_email_send_rate_limit",a=429;break;case"invalid_credentials":i="invalid_credentials",a=401;break;case"email_not_confirmed":i="email_not_confirmed",a=403;break;case"session_not_found":i="session_expired",a=401;break}return i==="unknown_error"&&(s.includes("User already registered")||s.includes("already exists")?(i="user_already_exists",a=409):s.includes("Password should be at least")?(i="password_too_short",a=422):s.includes("Password cannot be longer than 72")?(i="password_too_long",a=422):s.includes("Invalid email")?(i="invalid_email",a=422):s.includes("over_email_send_rate_limit")?(i="over_email_send_rate_limit",a=429):s.includes("Invalid login credentials")?(i="invalid_credentials",a=401):s.includes("Email not confirmed")?(i="email_not_confirmed",a=403):s.includes("Network request failed")&&(i="network_error",a=503)),r=Mr[i]||s||Mr.unknown_error,new xo(r,i,a,{originalError:s,originalCode:n})};let Vs=null,bi=0;const bd=6e4,Zo={login:async({email:e,password:s})=>{try{const{data:n,error:i}=await se.auth.signInWithPassword({email:e,password:s});return i?{success:!1,error:it(i)}:(Vs=null,bi=0,{success:!0,redirectTo:"/dashboard/overview"})}catch(n){return{success:!1,error:it(n)}}},logout:async()=>{try{const{error:e}=await se.auth.signOut();return Vs=null,bi=0,e?{success:!1,error:it(e)}:{success:!0,redirectTo:"/login"}}catch(e){return{success:!1,error:it(e)}}},check:async()=>{try{const{data:e}=await se.auth.getSession();return e?.session?{authenticated:!0}:{authenticated:!1,redirectTo:"/login"}}catch{return{authenticated:!1,redirectTo:"/login"}}},getIdentity:async()=>{try{const e=Date.now();if(Vs&&e-bi<bd)return Vs;const{data:{session:s}}=await se.auth.getSession();if(!s)return null;const{data:n,error:i}=await se.from("users").select("*").eq("id",s.user.id).single();if(i||!n)return console.error("Error fetching user data:",i),{id:s.user.id,email:s.user.email||"",full_name:s.user.user_metadata?.full_name||"User",vendor_id:1,role:"student"};const r={id:n.id,email:n.email,full_name:n.full_name,vendor_id:n.vendor_id,role:n.role,is_active:n.is_active,created_at:n.created_at};return Vs=r,bi=e,r}catch(e){return console.error("Error in getIdentity:",e),null}},register:async({email:e,password:s,name:n})=>{try{if(console.log("🚀 Starting registration:",{email:e,name:n}),!e||!s)return{success:!1,error:it({message:"Email i hasło są wymagane",code:"validation_error"})};if(s.length<6)return{success:!1,error:it({message:"Password should be at least 6 characters",code:"weak_password"})};if(s.length>72)return{success:!1,error:it({message:"Password cannot be longer than 72 characters",code:"password_too_long"})};const{data:i,error:r}=await se.auth.signUp({email:e.trim(),password:s,options:{data:{full_name:n||e.split("@")[0],role:"student"},emailRedirectTo:`${window.location.origin}/login?verified=true`}});return r?(console.error("❌ Registration error:",r),{success:!1,error:it(r)}):i.user?(console.log("✅ Registration successful:",i.user.id),{success:!0,successNotification:{message:"Rejestracja udana! Sprawdź swoją skrzynkę email.",description:"Wysłaliśmy link aktywacyjny na podany adres email."}}):{success:!1,error:it({message:"Rejestracja nie powiodła się - brak danych użytkownika",code:"registration_failed"})}}catch(i){return console.error("❌ Unexpected registration error:",i),{success:!1,error:it(i)}}},forgotPassword:async({email:e})=>{try{const{error:s}=await se.auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/update-password`});return s?{success:!1,error:it(s)}:{success:!0,successNotification:{message:"Email wysłany!",description:"Sprawdź swoją skrzynkę odbiorczą"}}}catch(s){return{success:!1,error:it(s)}}},updatePassword:async({password:e})=>{try{const{error:s}=await se.auth.updateUser({password:e});return s?{success:!1,error:it(s)}:{success:!0,redirectTo:"/login?passwordChanged=true"}}catch(s){return{success:!1,error:it(s)}}},getPermissions:async()=>{try{const e=Date.now();if(Vs&&e-bi<bd)return Vs.role;const{data:{session:s}}=await se.auth.getSession();if(!s)return null;const{data:n,error:i}=await se.from("users").select("role").eq("id",s.user.id).single();return i||!n?(console.error("Error fetching user permissions:",i),"student"):n.role}catch{return null}},onError:async e=>(console.error("Auth error:",e),e?.statusCode===401?{redirectTo:"/login",logout:!0,error:e}:{error:e})},Ia=({isLoading:e,isError:s,loadingText:n="Loading...",errorMsg:i="Error loading data"})=>e?t.jsx("div",{className:"p-6 text-gray-600 animate-reverse-pulse",children:n}):s?t.jsx("div",{className:"p-6 text-red-500",children:i}):null;function zj(e,s){let n;try{n=e()}catch{return}return{getItem:r=>{var a;const o=c=>c===null?null:JSON.parse(c,void 0),l=(a=n.getItem(r))!=null?a:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,a)=>n.setItem(r,JSON.stringify(a,void 0)),removeItem:r=>n.removeItem(r)}}const Yo=e=>s=>{try{const n=e(s);return n instanceof Promise?n:{then(i){return Yo(i)(n)},catch(i){return this}}}catch(n){return{then(i){return this},catch(i){return Yo(i)(n)}}}},Sj=(e,s)=>(n,i,r)=>{let a={storage:zj(()=>localStorage),partialize:f=>f,version:0,merge:(f,j)=>({...j,...f}),...s},o=!1;const l=new Set,c=new Set;let d=a.storage;if(!d)return e((...f)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...f)},i,r);const m=()=>{const f=a.partialize({...i()});return d.setItem(a.name,{state:f,version:a.version})},u=r.setState;r.setState=(f,j)=>{u(f,j),m()};const h=e((...f)=>{n(...f),m()},i,r);r.getInitialState=()=>h;let p;const x=()=>{var f,j;if(!d)return;o=!1,l.forEach(y=>{var w;return y((w=i())!=null?w:h)});const b=((j=a.onRehydrateStorage)==null?void 0:j.call(a,(f=i())!=null?f:h))||void 0;return Yo(d.getItem.bind(d))(a.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==a.version){if(a.migrate){const w=a.migrate(y.state,y.version);return w instanceof Promise?w.then(z=>[!0,z]):[!0,w]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var w;const[z,N]=y;if(p=a.merge(N,(w=i())!=null?w:h),n(p,!0),z)return m()}).then(()=>{b?.(p,void 0),p=i(),o=!0,c.forEach(y=>y(p))}).catch(y=>{b?.(void 0,y)})};return r.persist={setOptions:f=>{a={...a,...f},f.storage&&(d=f.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>x(),hasHydrated:()=>o,onHydrate:f=>(l.add(f),()=>{l.delete(f)}),onFinishHydration:f=>(c.add(f),()=>{c.delete(f)})},a.skipHydration||x(),p||h},Cj=Sj;class Tj{static async call(s,n,i={}){const a={message:this.interpolateTemplate(n.user,i),...n.system&&{system:n.system},...s.model&&{model:s.model}},o=await fetch(s.endpoint,{method:"POST",headers:{"Content-Type":"application/json",...s.apiKey&&{Authorization:`Bearer ${s.apiKey}`}},body:JSON.stringify(a)});let l;try{l=await o.json()}catch{throw new Error(`LLM API Error: ${o.status} ${o.statusText}`)}if(!o.ok||l.error){const d=l.message||l.error||"Nieznany błąd",m=l.suggestion?` ${l.suggestion}`:"";throw new Error(`${d}${m}`)}const c=l.response||l;return n.responseFormat==="json"?this.parseJsonResponse(c):c}static interpolateTemplate(s,n){return s.replace(/\{\{(\w+)\}\}/g,(i,r)=>n[r]!==void 0?String(n[r]):i)}static cleanJsonResponse(s){let n=s;return n=n.replace(/```json\s*\n?([\s\S]*?)\n?```/g,"$1"),n=n.replace(/```\s*\n?([\s\S]*?)\n?```/g,"$1"),n.trim()}static parseJsonResponse(s){const n=this.cleanJsonResponse(s);try{return JSON.parse(n)}catch{try{const r=n.replace(/\\(\d+)\./g,"$1.");return JSON.parse(r)}catch{const a=s.match(/\{[\s\S]*\}/);if(a)try{const o=a[0].replace(/\\(\d+)\./g,"$1.");return JSON.parse(o)}catch{throw console.error("Failed to parse JSON response:",s),new Error("Nie udało się przetworzyć odpowiedzi JSON z API")}throw console.error("Failed to parse JSON response:",s),new Error("Nie udało się przetworzyć odpowiedzi JSON z API")}}}}const fe=ky()(Cj((e,s)=>({processes:{},formData:{},llmOperations:{},registeredLLMOperations:{},register:n=>e(i=>({processes:{...i.processes,[n.id]:n}})),unregister:(n,i="all")=>e(r=>{switch(i){case"all":{const{[n]:a,...o}=r.processes,{[n]:l,...c}=r.formData,d=Object.keys(r.llmOperations).filter(u=>!u.startsWith(`${n}-`)).reduce((u,h)=>(u[h]=r.llmOperations[h],u),{}),m=Object.keys(r.registeredLLMOperations).filter(u=>!u.startsWith(`${n}-`)).reduce((u,h)=>(u[h]=r.registeredLLMOperations[h],u),{});return{processes:o,formData:c,llmOperations:d,registeredLLMOperations:m}}case"data":{const{[n]:a,...o}=r.formData;return{...r,formData:o}}default:return r}}),get:n=>s().processes[n]||null,getSchemaFragment:n=>{const[i,...r]=n.split("."),a=s().processes[i];if(!a)return null;let o=a.schema;for(const l of r)o=o?.[l];return o},setData:(n,i)=>e(r=>({formData:{...r.formData,[n]:{...r.formData[n],...i}}})),getData:n=>s().formData[n]||{},reset:n=>e(i=>({formData:{...i.formData,[n]:{}}})),registerLLMOperation:(n,i)=>e(r=>({registeredLLMOperations:{...r.registeredLLMOperations,[`${n}-${i.id}`]:i}})),unregisterLLMOperation:(n,i)=>e(r=>{const{[`${n}-${i}`]:a,...o}=r.registeredLLMOperations;return{registeredLLMOperations:o}}),executeLLMOperation:async(n,i,r={})=>{const a=`${n}-${i}`,o=s().registeredLLMOperations[a];if(!o)throw new Error(`LLM Operation not found: ${a}`);try{s().setLLMOperationState(n,i,{loading:!0,error:null});const l=s().getData(n),c={...l,...r},d=o.inputMapping?o.inputMapping(c):c,m=await Tj.call(o.config,o.prompt,d);if(o.validation&&!o.validation(m))throw new Error("LLM result failed validation");let u=m;return o.outputMapping&&(u=o.outputMapping(m,l),s().setData(n,u)),s().setLLMOperationState(n,i,{loading:!1,error:null,result:m}),m}catch(l){throw s().setLLMOperationState(n,i,{loading:!1,error:l.message||"Unknown error",result:null}),l}},setLLMOperationState:(n,i,r)=>e(a=>({llmOperations:{...a.llmOperations,[`${n}-${i}`]:r}})),getLLMOperationState:(n,i)=>s().llmOperations[`${n}-${i}`]||{loading:!1,error:null},clearLLMOperation:(n,i)=>e(r=>{const{[`${n}-${i}`]:a,...o}=r.llmOperations;return{llmOperations:o}})}),{name:"form-schema-store",version:2,partialize:e=>({processes:e.processes,formData:e.formData})})),Xn=(e,s)=>{const{registerLLMOperation:n,unregisterLLMOperation:i,executeLLMOperation:r,getLLMOperationState:a,clearLLMOperation:o}=fe();return{...a(e,s),registerOperation:h=>{n(e,h)},executeOperation:async h=>await r(e,s,h),clearOperation:()=>{o(e,s)},unregisterOperation:()=>{i(e,s)}}},Jo=g.forwardRef(({className:e,...s},n)=>t.jsx(vm,{ref:n,className:O("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...s}));Jo.displayName=vm.displayName;const Aj=g.forwardRef(({className:e,...s},n)=>t.jsx(Nm,{ref:n,className:O("aspect-square h-full w-full object-cover",e),...s}));Aj.displayName=Nm.displayName;const Xo=g.forwardRef(({className:e,...s},n)=>t.jsx(km,{ref:n,className:O("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...s}));Xo.displayName=km.displayName;function Lr({className:e,...s}){return t.jsx("div",{className:O("animate-pulse rounded-md bg-primary/10",e),...s})}const Pj=({className:e="",showRole:s=!0,showEmail:n=!0,compact:i=!1})=>{const{data:r,isLoading:a,error:o}=st(),l=h=>{switch(h){case"admin":return t.jsx(Sa,{className:"h-3 w-3"});case"teacher":return t.jsx(Qy,{className:"h-3 w-3"});case"student":return t.jsx(Es,{className:"h-3 w-3"});default:return t.jsx(ss,{className:"h-3 w-3"})}},c=h=>{switch(h){case"admin":return"Administrator";case"teacher":return"Nauczyciel";case"student":return"Uczeń";default:return"Użytkownik"}},d=h=>{switch(h){case"admin":return"text-purple-600 bg-purple-50";case"teacher":return"text-blue-600 bg-blue-50";case"student":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}};if(a)return t.jsxs("div",{className:`flex items-center space-x-3 p-3 ${e}`,children:[t.jsx(Lr,{className:"h-10 w-10 rounded-full"}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(Lr,{className:"h-4 w-28"}),t.jsx(Lr,{className:"h-3 w-20"}),s&&t.jsx(Lr,{className:"h-3 w-16"})]})]});if(o||!r)return t.jsxs("div",{className:`flex items-center space-x-3 p-3 text-muted-foreground ${e}`,children:[t.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-100 flex items-center justify-center",children:t.jsx(ss,{className:"h-5 w-5 text-gray-400"})}),t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"font-medium text-gray-500",children:"Nie zalogowano"}),t.jsx("div",{className:"text-xs opacity-70",children:"Brak danych użytkownika"})]})]});const u=(h=>{if(!h)return"U";const p=h.trim().split(" ");return p.length>=2?`${p[0][0]}${p[p.length-1][0]}`.toUpperCase():h.slice(0,2).toUpperCase()})(r.full_name||r.email);return i?t.jsxs("div",{className:`flex items-center space-x-2 p-2 ${e}`,children:[t.jsx(Jo,{className:"h-8 w-8",children:t.jsx(Xo,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white text-xs",children:u})}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx("div",{className:"font-medium text-sm truncate",children:r.full_name})})]}):t.jsxs("div",{className:`flex items-center space-x-3 px-4 pt-4 rounded-lg bg-white/50 backdrop-blur-sm border border-purple-100/20 ${e}`,children:[t.jsx(Jo,{className:"h-12 w-12 ring-2 ring-purple-100 ring-offset-2",children:t.jsx(Xo,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white font-medium",children:u})}),t.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[t.jsx("div",{className:"font-semibold text-gray-900 truncate",title:r.full_name,children:r.full_name}),n&&r.email&&t.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-500",children:[t.jsx(fs,{className:"h-3 w-3"}),t.jsx("span",{className:"truncate",title:r.email,children:r.email})]}),s&&r.role&&t.jsx("div",{className:"inline-flex items-center gap-1.5",children:t.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full text-xs font-medium ${d(r.role)}`,children:[l(r.role),c(r.role)]})})]})]})},Dj=Ca("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),le=g.forwardRef(({className:e,variant:s,...n},i)=>t.jsx("div",{ref:i,role:"alert",className:O(Dj({variant:s}),e),...n}));le.displayName="Alert";const _j=g.forwardRef(({className:e,...s},n)=>t.jsx("h5",{ref:n,className:O("mb-1 font-medium leading-none tracking-tight",e),...s}));_j.displayName="AlertTitle";const ce=g.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:O("text-sm [&_p]:leading-relaxed",e),...s}));ce.displayName="AlertDescription";const Ej=Ca("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function ne({className:e,variant:s,asChild:n=!1,...i}){const r=n?Ol:"span";return t.jsx(r,{"data-slot":"badge",className:O(Ej({variant:s}),e),...i})}const Ij=g.forwardRef(({...e},s)=>t.jsx("nav",{ref:s,"aria-label":"breadcrumb",...e}));Ij.displayName="Breadcrumb";const Mj=g.forwardRef(({className:e,...s},n)=>t.jsx("ol",{ref:n,className:O("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",e),...s}));Mj.displayName="BreadcrumbList";const Lj=g.forwardRef(({className:e,...s},n)=>t.jsx("li",{ref:n,className:O("inline-flex items-center gap-1.5",e),...s}));Lj.displayName="BreadcrumbItem";const Oj=g.forwardRef(({asChild:e,className:s,...n},i)=>{const r=e?Ol:"a";return t.jsx(r,{ref:i,className:O("transition-colors hover:text-foreground",s),...n})});Oj.displayName="BreadcrumbLink";const Rj=g.forwardRef(({className:e,...s},n)=>t.jsx("span",{ref:n,role:"link","aria-disabled":"true","aria-current":"page",className:O("font-normal text-foreground",e),...s}));Rj.displayName="BreadcrumbPage";const Fj=Ca("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),T=g.forwardRef(({className:e,variant:s,size:n,asChild:i=!1,...r},a)=>{const o=i?Ol:"button";return t.jsx(o,{className:O(Fj({variant:s,size:n,className:e})),ref:a,...r})});T.displayName="Button";const I=g.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:O("rounded-xl border bg-card text-card-foreground shadow flex flex-col overflow-hidden",e),...s}));I.displayName="Card";const V=g.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:O("flex flex-col space-y-1.5 p-6 pb-3 bg-pink-200/25",e),...s}));V.displayName="CardHeader";const q=g.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:O("text-lg font-semibold leading-tight tracking-tight pt-3",e),...s}));q.displayName="CardTitle";const Ls=g.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:O("text-sm text-muted-foreground",e),...s}));Ls.displayName="CardDescription";const M=g.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:O("p-3 lg:p-6 pt-3 space-y-3 flex-1 bg-background",e),...s}));M.displayName="CardContent";const $j=g.forwardRef(({className:e,...s},n)=>t.jsx("div",{ref:n,className:O("flex items-center justify-between p-6 pt-0",e),...s}));$j.displayName="CardFooter";const qj=Ca("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),X=g.forwardRef(({className:e,...s},n)=>t.jsx(zm,{ref:n,className:O(qj(),e),...s}));X.displayName=zm.displayName;g.createContext({});g.createContext({});const B=g.forwardRef(({className:e,type:s,...n},i)=>t.jsx("input",{type:s,className:O("flex h-9 w-full rounded-md border border-input bg-background px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:i,...n}));B.displayName="Input";const Bj=g.forwardRef(({className:e,align:s="center",sideOffset:n=4,...i},r)=>t.jsx($g,{children:t.jsx(Sm,{ref:r,align:s,sideOffset:n,className:O("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",e),...i})}));Bj.displayName=Sm.displayName;const sh=g.forwardRef(({className:e,children:s,...n},i)=>t.jsxs(Cm,{ref:i,className:O("relative overflow-hidden",e),...n,children:[t.jsx(qg,{className:"h-full w-full rounded-[inherit]",children:s}),t.jsx(nh,{}),t.jsx(Bg,{})]}));sh.displayName=Cm.displayName;const nh=g.forwardRef(({className:e,orientation:s="vertical",...n},i)=>t.jsx(Tm,{ref:i,orientation:s,className:O("flex touch-none select-none transition-colors",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:t.jsx(Vg,{className:"relative flex-1 rounded-full bg-border"})}));nh.displayName=Tm.displayName;const Te=Qg,Ae=Zg,Ne=g.forwardRef(({className:e,children:s,...n},i)=>t.jsxs(Am,{ref:i,className:O("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[s,t.jsx(Ug,{asChild:!0,children:t.jsx(Ta,{className:"h-4 w-4 opacity-50"})})]}));Ne.displayName=Am.displayName;const ih=g.forwardRef(({className:e,...s},n)=>t.jsx(Pm,{ref:n,className:O("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(Zy,{className:"h-4 w-4"})}));ih.displayName=Pm.displayName;const rh=g.forwardRef(({className:e,...s},n)=>t.jsx(Dm,{ref:n,className:O("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(Ta,{className:"h-4 w-4"})}));rh.displayName=Dm.displayName;const ke=g.forwardRef(({className:e,children:s,position:n="popper",...i},r)=>t.jsx(Wg,{children:t.jsxs(_m,{ref:r,className:O("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...i,children:[t.jsx(ih,{}),t.jsx(Kg,{className:O("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),t.jsx(rh,{})]})}));ke.displayName=_m.displayName;const Vj=g.forwardRef(({className:e,...s},n)=>t.jsx(Em,{ref:n,className:O("px-2 py-1.5 text-sm font-semibold",e),...s}));Vj.displayName=Em.displayName;const K=g.forwardRef(({className:e,children:s,...n},i)=>t.jsxs(Im,{ref:i,className:O("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[t.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(Gg,{children:t.jsx(ze,{className:"h-4 w-4"})})}),t.jsx(Hg,{children:s})]}));K.displayName=Im.displayName;const Uj=g.forwardRef(({className:e,...s},n)=>t.jsx(Mm,{ref:n,className:O("-mx-1 my-1 h-px bg-muted",e),...s}));Uj.displayName=Mm.displayName;const as=g.forwardRef(({className:e,orientation:s="horizontal",decorative:n=!0,...i},r)=>t.jsx(Lm,{ref:r,decorative:n,orientation:s,className:O("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...i}));as.displayName=Lm.displayName;const Dt=g.forwardRef(({className:e,...s},n)=>t.jsx("textarea",{className:O("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...s}));Dt.displayName="Textarea";const Wj=g.forwardRef(({className:e,...s},n)=>t.jsx(Om,{ref:n,className:O("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",e),...s}));Wj.displayName=Om.displayName;const Kj=g.forwardRef(({className:e,...s},n)=>t.jsx(Rm,{ref:n,className:O("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",e),...s}));Kj.displayName=Rm.displayName;const Gj=g.forwardRef(({className:e,...s},n)=>t.jsx(Fm,{ref:n,className:O("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));Gj.displayName=Fm.displayName;const jt=g.forwardRef(({className:e,...s},n)=>t.jsx($m,{ref:n,className:O("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:t.jsx(Yg,{className:O("flex items-center justify-center text-current"),children:t.jsx(ze,{className:"h-4 w-4"})})}));jt.displayName=$m.displayName;var Ma="Switch",[Hj,RA]=Rl(Ma),[Qj,Zj]=Hj(Ma),ah=g.forwardRef((e,s)=>{const{__scopeSwitch:n,name:i,checked:r,defaultChecked:a,required:o,disabled:l,value:c="on",onCheckedChange:d,form:m,...u}=e,[h,p]=g.useState(null),x=dn(s,w=>p(w)),f=g.useRef(!1),j=h?m||!!h.closest("form"):!0,[b,y]=qm({prop:r,defaultProp:a??!1,onChange:d,caller:Ma});return t.jsxs(Qj,{scope:n,checked:b,disabled:l,children:[t.jsx($s.button,{type:"button",role:"switch","aria-checked":b,"aria-required":o,"data-state":dh(b),"data-disabled":l?"":void 0,disabled:l,value:c,...u,ref:x,onClick:ue(e.onClick,w=>{y(z=>!z),j&&(f.current=w.isPropagationStopped(),f.current||w.stopPropagation())})}),j&&t.jsx(ch,{control:h,bubbles:!f.current,name:i,value:c,checked:b,required:o,disabled:l,form:m,style:{transform:"translateX(-100%)"}})]})});ah.displayName=Ma;var oh="SwitchThumb",lh=g.forwardRef((e,s)=>{const{__scopeSwitch:n,...i}=e,r=Zj(oh,n);return t.jsx($s.span,{"data-state":dh(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:s})});lh.displayName=oh;var Yj="SwitchBubbleInput",ch=g.forwardRef(({__scopeSwitch:e,control:s,checked:n,bubbles:i=!0,...r},a)=>{const o=g.useRef(null),l=dn(o,a),c=Jg(n),d=Xg(s);return g.useEffect(()=>{const m=o.current;if(!m)return;const u=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(u,"checked").set;if(c!==n&&p){const x=new Event("click",{bubbles:i});p.call(m,n),m.dispatchEvent(x)}},[c,n,i]),t.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...r,tabIndex:-1,ref:l,style:{...r.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ch.displayName=Yj;function dh(e){return e?"checked":"unchecked"}var uh=ah,Jj=lh;const Ut=g.forwardRef(({className:e,...s},n)=>t.jsx(uh,{className:O("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...s,ref:n,children:t.jsx(Jj,{className:O("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Ut.displayName=uh.displayName;const Qt=ty,Zt=sy,Yt=ny,Ft=g.forwardRef(({className:e,sideOffset:s=4,...n},i)=>t.jsx(ey,{children:t.jsx(Bm,{ref:i,sideOffset:s,className:O("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e),...n})}));Ft.displayName=Bm.displayName;const Xj=({onClose:e})=>{const{mutate:s}=ql(),{menuItems:n}=Ey(),{data:i}=st(),r=()=>{e&&e()},a=i?.role,o=n.filter(l=>l.meta?.roles?l.meta.roles.includes(a):!0);return t.jsxs("div",{className:"flex h-full w-64 flex-col border-r bg-background",children:[t.jsxs("div",{className:"flex h-16 items-center justify-between border-b px-6",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(Aa,{className:"h-6 w-6 mr-2"}),t.jsx("span",{className:"font-semibold",children:"Smart Up"})]}),e&&t.jsx(T,{variant:"ghost",size:"sm",onClick:e,className:"lg:hidden",children:t.jsx(lt,{className:"h-4 w-4"})})]}),t.jsx(sh,{className:"flex-1 px-3 py-4",children:t.jsx("nav",{className:"space-y-2",children:o.map(l=>t.jsxs(wy,{to:l.route??"/",onClick:r,className:({isActive:c})=>O("flex items-center rounded-md px-3 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground",c?"bg-accent text-accent-foreground":"text-muted-foreground"),children:[l.icon&&t.jsx("span",{className:"mr-3 flex items-center",children:(L.isValidElement(l.icon),l.icon)}),l.label]},l.key))})}),t.jsx(as,{}),t.jsx(Pj,{className:"border-b"}),t.jsx("div",{className:"p-4",children:t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>{s(),e&&e()},className:"w-full justify-start",children:[t.jsx(Pa,{className:"mr-2 h-4 w-4"}),"Logout"]})})]})},eb=({onClose:e})=>{const s=ka(),n=H(),{data:i}=st(),{mutate:r}=ql(),a=[{id:"dashboard",path:"/student/dashboard",label:"Dashboard",icon:Zm},{id:"courses",path:"/student/courses",label:"Kursy",icon:Ee},{id:"gamification",path:"/student/gamification",label:"Gamifikacja",icon:aa},{id:"leaderboard",path:"/student/leaderboard",label:"Ranking",icon:Je},{id:"achievements",path:"/student/achievements",label:"Osiągnięcia",icon:Bn},{id:"profile",path:"/student/profile",label:"Profil",icon:ss}],o=c=>s.pathname.startsWith(c),l=c=>{n(c),e?.()};return t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-600 to-purple-700 rounded-xl flex items-center justify-center",children:t.jsx(Je,{className:"w-5 h-5 text-white"})}),t.jsx("span",{className:"text-xl font-bold",children:"Smart Up"})]}),e&&t.jsx(T,{variant:"ghost",size:"icon",onClick:e,className:"lg:hidden",children:t.jsx(lt,{className:"h-5 w-5"})})]}),t.jsx("div",{className:"p-4 border-b",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center text-white font-bold",children:i?.full_name?.charAt(0)||"U"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium text-sm",children:i?.full_name}),t.jsx("p",{className:"text-xs text-gray-500",children:"Uczeń"})]})]})}),t.jsx("nav",{className:"flex-1 p-4 space-y-1",children:a.map(c=>t.jsxs("button",{onClick:()=>l(c.path),className:O("w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all",o(c.path)?"bg-purple-50 text-purple-700 font-medium":"text-gray-600 hover:bg-gray-50"),children:[t.jsx(c.icon,{className:"w-5 h-5"}),t.jsx("span",{children:c.label})]},c.id))}),t.jsxs("div",{className:"p-4 border-t space-y-1",children:[t.jsxs("button",{onClick:()=>l("/student/settings"),className:"w-full flex items-center gap-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition-all",children:[t.jsx(Ym,{className:"w-5 h-5"}),t.jsx("span",{children:"Ustawienia"})]}),t.jsxs("button",{onClick:()=>r(),className:"w-full flex items-center gap-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition-all",children:[t.jsx(Pa,{className:"w-5 h-5"}),t.jsx("span",{children:"Wyloguj"})]})]})]})},ur=()=>{const[e,s]=g.useState({points:0,level:1,streak:0,idle_rate:1,next_level_points:200,quizzes_completed:0,perfect_scores:0,total_time:0,rank:0}),[n,i]=g.useState(!0),r=g.useCallback(async()=>{try{i(!0);const{data:a,error:o}=await se.rpc("get_my_stats");if(o)throw o;a&&s({points:a.points||0,level:a.level||1,streak:a.streak||0,idle_rate:a.idle_rate||1,next_level_points:a.next_level_points||200,quizzes_completed:a.quizzes_completed||0,perfect_scores:a.perfect_scores||0,total_time:a.total_time||0,rank:a.rank||0})}catch(a){console.error("Error fetching stats:",a)}finally{i(!1)}},[]);return g.useEffect(()=>{r()},[r]),{stats:e,setStats:s,isLoading:n,refetch:r}},us=new Map,La=(e,s,n)=>{const i=n?.cacheKey||`${e}-${JSON.stringify(s)}`,[r,a]=g.useState(()=>us.get(i)||null),[o,l]=g.useState(!us.has(i)),[c,d]=g.useState(null),m=g.useCallback(async(h=!1)=>{if(n?.enabled!==!1){if(!h&&us.has(i)){a(us.get(i)),l(!1);return}try{l(!0),d(null);const{data:p,error:x}=await se.rpc(e,s);if(x)throw x;us.set(i,p),a(p),n?.onSuccess?.(p)}catch(p){d(p),n?.onError?.(p)}finally{l(!1)}}},[e,i,JSON.stringify(s),n?.enabled]);g.useEffect(()=>{m()},[m]);const u=g.useCallback(()=>{us.delete(i)},[i]);return{data:r,isLoading:o,error:c,refetch:()=>m(!0),invalidate:u}},el=e=>{e?Array.from(us.keys()).forEach(s=>{s.includes(e)&&us.delete(s)}):us.clear()},tb=(e,s)=>{const[n,i]=g.useState([]),[r,a]=g.useState(!0),[o,l]=g.useState(null),c=g.useCallback(async()=>{if(s?.enabled!==!1)try{a(!0),l(null);let d=se.from(e).select(s?.select||"*");s?.filters?.forEach(h=>{switch(h.operator){case"eq":d=d.eq(h.field,h.value);break;case"in":d=d.in(h.field,h.value);break;case"contains":d=d.ilike(h.field,`%${h.value}%`);break}}),s?.sorts?.forEach(h=>{d=d.order(h.field,{ascending:h.order==="asc"})}),s?.limit&&(d=d.limit(s.limit));const{data:m,error:u}=await d;if(u)throw u;i(m||[])}catch(d){l(d)}finally{a(!1)}},[e,JSON.stringify(s)]);return g.useEffect(()=>{c()},[c]),{data:n,isLoading:r,error:o,refetch:c}},sb=({onMenuClick:e})=>{const{stats:s}=ur();return t.jsx("div",{className:"sticky top-0 z-30 border-b border-purple-200/20 bg-background/80 backdrop-blur-md",children:t.jsxs("div",{className:"flex h-16 items-center justify-between px-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(T,{variant:"ghost",size:"sm",onClick:e,className:"lg:hidden hover:bg-purple-100/20 hover:text-purple-700",children:t.jsx(Aa,{className:"h-6 w-6"})}),t.jsx("span",{className:"font-semibold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent lg:hidden",children:"Smart Up"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 bg-purple-50 px-3 py-1.5 rounded-full",children:[t.jsx(Qo,{className:"w-4 h-4 text-purple-700"}),t.jsx("span",{className:"font-bold text-purple-700 text-sm",children:s.points})]}),t.jsxs("div",{className:"flex items-center gap-2 bg-orange-50 px-3 py-1.5 rounded-full",children:[t.jsx(Js,{className:"w-4 h-4 text-orange-600"}),t.jsx("span",{className:"font-bold text-orange-600 text-sm",children:s.streak})]}),t.jsxs(T,{variant:"ghost",size:"icon",className:"relative",children:[t.jsx(Vl,{className:"w-5 h-5"}),t.jsx("span",{className:"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"})]})]})]})})},W=({children:e})=>t.jsx("div",{className:"p-2 md:p-12 space-y-6 max-w-7xl mx-auto",children:e}),nb=({children:e})=>{const[s,n]=g.useState(!1),{data:i}=st(),r=i?.role==="student",a=()=>{n(!s)};return t.jsx("div",{className:"min-h-screen bg-stone-200 relative overflow-x-hidden",children:t.jsxs("div",{className:"flex relative",children:[s&&t.jsx("div",{className:"fixed inset-0 z-40 bg-purple-900/20 backdrop-blur-sm lg:hidden",onClick:()=>n(!1)}),t.jsx("aside",{className:`
            h-screen w-64 transform transition-transform duration-300 ease-in-out
            fixed left-0 top-0 z-50
            ${s?"translate-x-0":"-translate-x-full"}
            lg:translate-x-0
            bg-background/95 backdrop-blur-md border-r border-purple-200/20
          `,children:r?t.jsx(eb,{onClose:()=>n(!1)}):t.jsx(Xj,{onClose:()=>n(!1)})}),t.jsxs("main",{className:"flex-1 lg:ml-64 min-w-0 relative z-10",children:[r?t.jsx(sb,{onMenuClick:a}):t.jsxs("div",{className:"sticky top-0 z-30 flex h-16 items-center border-b border-purple-200/20 bg-background/80 backdrop-blur-md px-4 lg:hidden",children:[t.jsx(T,{variant:"ghost",size:"sm",onClick:a,className:"mr-2 hover:bg-purple-100/20 hover:text-purple-700",children:t.jsx(Aa,{className:"h-6 w-6"})}),t.jsx("span",{className:"font-semibold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Smart Up"})]}),e]})]})})},ib={"between-center":"flex justify-between items-center gap-2",center:"flex justify-center items-center gap-2",start:"flex justify-start items-center gap-2",end:"flex justify-end items-center gap-2"},R=({children:e,variant:s="between-center",className:n=""})=>{const i=ib[s],r=n?`${i} ${n}`:i;return t.jsx("div",{className:r,children:e})},rb={"1-2-3":"grid gap-6 md:grid-cols-2 lg:grid-cols-3","1-2-2":"grid gap-6 md:grid-cols-2","1-1-1":"grid gap-6","2-2-4":"grid gap-6 grid-cols-2 lg:grid-cols-4"},be=({children:e,variant:s="1-2-3",className:n=""})=>{const i=rb[s],r=n?`${i} ${n}`:i;return t.jsx("div",{className:r,children:e})},ab={card:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},lg:{wrap:"space-y-0",title:"text-3xl font-bold tracking-tight",description:"text-muted-foreground"},md:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},sm:{wrap:"space-y-1",title:"font-medium text-sm text-muted-foreground mb-1",description:"text-sm"}},ie=({title:e,description:s,variant:n="lg"})=>{const i=ab[n],r=()=>{switch(n){case"lg":return t.jsx("h1",{className:i.title,children:e});case"md":return t.jsx("h2",{className:i.title,children:e});case"sm":return t.jsx("h3",{className:i.title,children:e});default:return t.jsx("h1",{className:i.title,children:e})}};return n==="card"?t.jsxs(t.Fragment,{children:[t.jsx(q,{className:"text-lg font-semibold leading-tight flex items-center gap-2",children:e}),t.jsx(Ls,{className:"text-sm text-muted-foreground mt-2",children:s})]}):t.jsx(t.Fragment,{children:t.jsxs("div",{className:i.wrap,children:[r(),t.jsx("p",{className:`prose ${i.description}`,children:s})]})})},ob=()=>{const{data:e,isLoading:s}=st(),[n,i]=g.useState(null),[r,a]=g.useState(!0);return g.useEffect(()=>{if(s||!e?.vendor_id){a(!1);return}let o=!0;return(async()=>{try{const[c,d,m,u,h]=await Promise.all([se.from("users").select("*",{count:"exact",head:!0}).eq("vendor_id",e.vendor_id),se.from("courses").select("*",{count:"exact"}).eq("vendor_id",e.vendor_id),se.from("activities").select("*, topics!inner(course_id, courses!inner(vendor_id))",{count:"exact"}).eq("topics.courses.vendor_id",e.vendor_id),se.from("activity_progress").select("score, completed_at").not("completed_at","is",null),se.from("user_stats").select("total_points")]);if(!o)return;const p=u.data?.length?u.data.reduce((f,j)=>f+(j.score||0),0)/u.data.length:0,x=h.data?.reduce((f,j)=>f+j.total_points,0)||0;i({totalUsers:c.count||0,activeUsers:c.count||0,totalCourses:d.count||0,publishedCourses:d.data?.filter(f=>f.is_published).length||0,totalActivities:m.count||0,completedActivities:u.data?.length||0,averageScore:Math.round(p),totalPoints:x})}catch(c){console.error("Error fetching dashboard stats:",c)}finally{o&&a(!1)}})(),()=>{o=!1}},[e?.vendor_id,s]),r||s?t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e?t.jsxs(W,{children:[t.jsx(ie,{title:"Dashboard",description:"Przegląd statystyk systemu e-learning"}),t.jsxs(be,{variant:"1-2-2",children:[t.jsxs(I,{children:[t.jsxs(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(q,{className:"text-sm font-medium",children:"Użytkownicy"}),t.jsx(He,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(M,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n?.totalUsers||0}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[n?.activeUsers||0," aktywnych"]})]})]}),t.jsxs(I,{children:[t.jsxs(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(q,{className:"text-sm font-medium",children:"Kursy"}),t.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(M,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n?.totalCourses||0}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[n?.publishedCourses||0," opublikowanych"]})]})]}),t.jsxs(I,{children:[t.jsxs(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(q,{className:"text-sm font-medium",children:"Aktywności"}),t.jsx(Jm,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(M,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n?.totalActivities||0}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[n?.completedActivities||0," ukończonych"]})]})]}),t.jsxs(I,{children:[t.jsxs(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(q,{className:"text-sm font-medium",children:"Średni wynik"}),t.jsx(Ds,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(M,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[n?.averageScore||0,"%"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"z wszystkich quizów"})]})]})]}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Aktywność w ostatnich 7 dniach"})}),t.jsx(M,{children:t.jsxs("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:[t.jsx(Xs,{className:"h-8 w-8 mr-2"}),"Wykres aktywności (do implementacji)"]})})]}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Top 5 użytkowników"})}),t.jsx(M,{children:t.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(o=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Je,{className:`h-5 w-5 ${o<=3?"text-yellow-500":"text-muted-foreground"}`}),t.jsxs("span",{children:["Użytkownik ",o]})]}),t.jsxs("span",{className:"font-semibold",children:[1e3-o*100," pkt"]})]},o))})})]})]}):t.jsx(W,{children:t.jsx("div",{className:"text-center text-muted-foreground",children:"Nie można załadować danych użytkownika"})})},lb={name:"dashboard",list:"/dashboard/overview",meta:{label:"Dashboard",icon:t.jsx(Yy,{className:"h-4 w-4"})}},cb=[t.jsx(F,{path:"/dashboard/overview",element:t.jsx(ob,{})},"dashboard")],Oa=({current:e,pageSize:s,total:n,setCurrent:i,setPageSize:r,itemName:a="elementów",pageSizeOptions:o=[10,20,50]})=>{const l=Math.ceil(n/s),c=(e-1)*s+1,d=Math.min(e*s,n),m=e>1,u=e<l,h=()=>{const p=[];if(l<=5)for(let f=1;f<=l;f++)p.push(f);else{p.push(1),e>3&&p.push("...");const f=Math.max(2,e-1),j=Math.min(l-1,e+1);for(let b=f;b<=j;b++)p.push(b);e<l-2&&p.push("..."),p.push(l)}return p};return n===0?null:t.jsxs(R,{className:"mt-6",children:[t.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pokazuje ",c,"-",d," z ",n," ",a]}),t.jsxs(R,{className:"gap-2",children:[r&&t.jsxs(Te,{value:s.toString(),onValueChange:p=>{r(parseInt(p)),i(1)},children:[t.jsx(Ne,{className:"w-[100px]",children:t.jsx(Ae,{})}),t.jsx(ke,{children:o.map(p=>t.jsxs(K,{value:p.toString(),children:[p," / str."]},p))})]}),t.jsx(T,{variant:"outline",size:"sm",onClick:()=>i(e-1),disabled:!m,children:t.jsx(Jy,{className:"w-4 h-4"})}),t.jsx("div",{className:"hidden sm:flex gap-1",children:h().map((p,x)=>p==="..."?t.jsx("span",{className:"px-3 py-1 text-sm text-muted-foreground",children:"..."},`ellipsis-${x}`):t.jsx(T,{variant:e===p?"default":"outline",size:"sm",onClick:()=>i(p),className:"min-w-[40px]",children:p},p))}),t.jsxs("div",{className:"flex sm:hidden items-center px-3 text-sm",children:[e," / ",l]}),t.jsx(T,{variant:"outline",size:"sm",onClick:()=>i(e+1),disabled:!u,children:t.jsx($i,{className:"w-4 h-4"})})]})]})};var tl=["Enter"," "],db=["ArrowDown","PageUp","Home"],mh=["ArrowUp","PageDown","End"],ub=[...db,...mh],mb={ltr:[...tl,"ArrowRight"],rtl:[...tl,"ArrowLeft"]},hb={ltr:["ArrowLeft"],rtl:["ArrowRight"]},mr="Menu",[Ui,pb,fb]=iy(mr),[un,hh]=Rl(mr,[fb,Vm,Um]),Ra=Vm(),ph=Um(),[xb,mn]=un(mr),[gb,hr]=un(mr),fh=e=>{const{__scopeMenu:s,open:n=!1,children:i,dir:r,onOpenChange:a,modal:o=!0}=e,l=Ra(s),[c,d]=g.useState(null),m=g.useRef(!1),u=Km(a),h=gy(r);return g.useEffect(()=>{const p=()=>{m.current=!0,document.addEventListener("pointerdown",x,{capture:!0,once:!0}),document.addEventListener("pointermove",x,{capture:!0,once:!0})},x=()=>m.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",x,{capture:!0}),document.removeEventListener("pointermove",x,{capture:!0})}},[]),t.jsx(yy,{...l,children:t.jsx(xb,{scope:s,open:n,onOpenChange:u,content:c,onContentChange:d,children:t.jsx(gb,{scope:s,onClose:g.useCallback(()=>u(!1),[u]),isUsingKeyboardRef:m,dir:h,modal:o,children:i})})})};fh.displayName=mr;var yb="MenuAnchor",Kl=g.forwardRef((e,s)=>{const{__scopeMenu:n,...i}=e,r=Ra(n);return t.jsx(ay,{...r,...i,ref:s})});Kl.displayName=yb;var Gl="MenuPortal",[jb,xh]=un(Gl,{forceMount:void 0}),gh=e=>{const{__scopeMenu:s,forceMount:n,children:i,container:r}=e,a=mn(Gl,s);return t.jsx(jb,{scope:s,forceMount:n,children:t.jsx(Na,{present:n||a.open,children:t.jsx(ry,{asChild:!0,container:r,children:i})})})};gh.displayName=Gl;var St="MenuContent",[bb,Hl]=un(St),yh=g.forwardRef((e,s)=>{const n=xh(St,e.__scopeMenu),{forceMount:i=n.forceMount,...r}=e,a=mn(St,e.__scopeMenu),o=hr(St,e.__scopeMenu);return t.jsx(Ui.Provider,{scope:e.__scopeMenu,children:t.jsx(Na,{present:i||a.open,children:t.jsx(Ui.Slot,{scope:e.__scopeMenu,children:o.modal?t.jsx(wb,{...r,ref:s}):t.jsx(vb,{...r,ref:s})})})})}),wb=g.forwardRef((e,s)=>{const n=mn(St,e.__scopeMenu),i=g.useRef(null),r=dn(s,i);return g.useEffect(()=>{const a=i.current;if(a)return fy(a)},[]),t.jsx(Ql,{...e,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ue(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),vb=g.forwardRef((e,s)=>{const n=mn(St,e.__scopeMenu);return t.jsx(Ql,{...e,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Nb=dy("MenuContent.ScrollLock"),Ql=g.forwardRef((e,s)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:u,onInteractOutside:h,onDismiss:p,disableOutsideScroll:x,...f}=e,j=mn(St,n),b=hr(St,n),y=Ra(n),w=ph(n),z=pb(n),[N,S]=g.useState(null),k=g.useRef(null),C=dn(s,k,j.onContentChange),A=g.useRef(0),v=g.useRef(""),P=g.useRef(0),_=g.useRef(null),E=g.useRef("right"),D=g.useRef(0),ee=x?cy:g.Fragment,We=x?{as:Nb,allowPinchZoom:!0}:void 0,Z=U=>{const xe=v.current+U,Ie=z().filter(Le=>!Le.disabled),we=document.activeElement,ut=Ie.find(Le=>Le.ref.current===we)?.textValue,Mt=Ie.map(Le=>Le.textValue),bs=Mb(Mt,xe,ut),Me=Ie.find(Le=>Le.textValue===bs)?.ref.current;(function Le(Lt){v.current=Lt,window.clearTimeout(A.current),Lt!==""&&(A.current=window.setTimeout(()=>Le(""),1e3))})(xe),Me&&setTimeout(()=>Me.focus())};g.useEffect(()=>()=>window.clearTimeout(A.current),[]),ly();const J=g.useCallback(U=>E.current===_.current?.side&&Ob(U,_.current?.area),[]);return t.jsx(bb,{scope:n,searchRef:v,onItemEnter:g.useCallback(U=>{J(U)&&U.preventDefault()},[J]),onItemLeave:g.useCallback(U=>{J(U)||(k.current?.focus(),S(null))},[J]),onTriggerLeave:g.useCallback(U=>{J(U)&&U.preventDefault()},[J]),pointerGraceTimerRef:P,onPointerGraceIntentChange:g.useCallback(U=>{_.current=U},[]),children:t.jsx(ee,{...We,children:t.jsx(uy,{asChild:!0,trapped:r,onMountAutoFocus:ue(a,U=>{U.preventDefault(),k.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:t.jsx(my,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:u,onInteractOutside:h,onDismiss:p,children:t.jsx(hy,{asChild:!0,...w,dir:b.dir,orientation:"vertical",loop:i,currentTabStopId:N,onCurrentTabStopIdChange:S,onEntryFocus:ue(c,U=>{b.isUsingKeyboardRef.current||U.preventDefault()}),preventScrollOnEntryFocus:!0,children:t.jsx(py,{role:"menu","aria-orientation":"vertical","data-state":Ih(j.open),"data-radix-menu-content":"",dir:b.dir,...y,...f,ref:C,style:{outline:"none",...f.style},onKeyDown:ue(f.onKeyDown,U=>{const Ie=U.target.closest("[data-radix-menu-content]")===U.currentTarget,we=U.ctrlKey||U.altKey||U.metaKey,ut=U.key.length===1;Ie&&(U.key==="Tab"&&U.preventDefault(),!we&&ut&&Z(U.key));const Mt=k.current;if(U.target!==Mt||!ub.includes(U.key))return;U.preventDefault();const Me=z().filter(Le=>!Le.disabled).map(Le=>Le.ref.current);mh.includes(U.key)&&Me.reverse(),Eb(Me)}),onBlur:ue(e.onBlur,U=>{U.currentTarget.contains(U.target)||(window.clearTimeout(A.current),v.current="")}),onPointerMove:ue(e.onPointerMove,Wi(U=>{const xe=U.target,Ie=D.current!==U.clientX;if(U.currentTarget.contains(xe)&&Ie){const we=U.clientX>D.current?"right":"left";E.current=we,D.current=U.clientX}}))})})})})})})});yh.displayName=St;var kb="MenuGroup",Zl=g.forwardRef((e,s)=>{const{__scopeMenu:n,...i}=e;return t.jsx($s.div,{role:"group",...i,ref:s})});Zl.displayName=kb;var zb="MenuLabel",jh=g.forwardRef((e,s)=>{const{__scopeMenu:n,...i}=e;return t.jsx($s.div,{...i,ref:s})});jh.displayName=zb;var oa="MenuItem",wd="menu.itemSelect",Fa=g.forwardRef((e,s)=>{const{disabled:n=!1,onSelect:i,...r}=e,a=g.useRef(null),o=hr(oa,e.__scopeMenu),l=Hl(oa,e.__scopeMenu),c=dn(s,a),d=g.useRef(!1),m=()=>{const u=a.current;if(!n&&u){const h=new CustomEvent(wd,{bubbles:!0,cancelable:!0});u.addEventListener(wd,p=>i?.(p),{once:!0}),xy(u,h),h.defaultPrevented?d.current=!1:o.onClose()}};return t.jsx(bh,{...r,ref:c,disabled:n,onClick:ue(e.onClick,m),onPointerDown:u=>{e.onPointerDown?.(u),d.current=!0},onPointerUp:ue(e.onPointerUp,u=>{d.current||u.currentTarget?.click()}),onKeyDown:ue(e.onKeyDown,u=>{const h=l.searchRef.current!=="";n||h&&u.key===" "||tl.includes(u.key)&&(u.currentTarget.click(),u.preventDefault())})})});Fa.displayName=oa;var bh=g.forwardRef((e,s)=>{const{__scopeMenu:n,disabled:i=!1,textValue:r,...a}=e,o=Hl(oa,n),l=ph(n),c=g.useRef(null),d=dn(s,c),[m,u]=g.useState(!1),[h,p]=g.useState("");return g.useEffect(()=>{const x=c.current;x&&p((x.textContent??"").trim())},[a.children]),t.jsx(Ui.ItemSlot,{scope:n,disabled:i,textValue:r??h,children:t.jsx(oy,{asChild:!0,...l,focusable:!i,children:t.jsx($s.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...a,ref:d,onPointerMove:ue(e.onPointerMove,Wi(x=>{i?o.onItemLeave(x):(o.onItemEnter(x),x.defaultPrevented||x.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ue(e.onPointerLeave,Wi(x=>o.onItemLeave(x))),onFocus:ue(e.onFocus,()=>u(!0)),onBlur:ue(e.onBlur,()=>u(!1))})})})}),Sb="MenuCheckboxItem",wh=g.forwardRef((e,s)=>{const{checked:n=!1,onCheckedChange:i,...r}=e;return t.jsx(Sh,{scope:e.__scopeMenu,checked:n,children:t.jsx(Fa,{role:"menuitemcheckbox","aria-checked":la(n)?"mixed":n,...r,ref:s,"data-state":Jl(n),onSelect:ue(r.onSelect,()=>i?.(la(n)?!0:!n),{checkForDefaultPrevented:!1})})})});wh.displayName=Sb;var vh="MenuRadioGroup",[Cb,Tb]=un(vh,{value:void 0,onValueChange:()=>{}}),Nh=g.forwardRef((e,s)=>{const{value:n,onValueChange:i,...r}=e,a=Km(i);return t.jsx(Cb,{scope:e.__scopeMenu,value:n,onValueChange:a,children:t.jsx(Zl,{...r,ref:s})})});Nh.displayName=vh;var kh="MenuRadioItem",zh=g.forwardRef((e,s)=>{const{value:n,...i}=e,r=Tb(kh,e.__scopeMenu),a=n===r.value;return t.jsx(Sh,{scope:e.__scopeMenu,checked:a,children:t.jsx(Fa,{role:"menuitemradio","aria-checked":a,...i,ref:s,"data-state":Jl(a),onSelect:ue(i.onSelect,()=>r.onValueChange?.(n),{checkForDefaultPrevented:!1})})})});zh.displayName=kh;var Yl="MenuItemIndicator",[Sh,Ab]=un(Yl,{checked:!1}),Ch=g.forwardRef((e,s)=>{const{__scopeMenu:n,forceMount:i,...r}=e,a=Ab(Yl,n);return t.jsx(Na,{present:i||la(a.checked)||a.checked===!0,children:t.jsx($s.span,{...r,ref:s,"data-state":Jl(a.checked)})})});Ch.displayName=Yl;var Pb="MenuSeparator",Th=g.forwardRef((e,s)=>{const{__scopeMenu:n,...i}=e;return t.jsx($s.div,{role:"separator","aria-orientation":"horizontal",...i,ref:s})});Th.displayName=Pb;var Db="MenuArrow",Ah=g.forwardRef((e,s)=>{const{__scopeMenu:n,...i}=e,r=Ra(n);return t.jsx(jy,{...r,...i,ref:s})});Ah.displayName=Db;var _b="MenuSub",[FA,Ph]=un(_b),Ci="MenuSubTrigger",Dh=g.forwardRef((e,s)=>{const n=mn(Ci,e.__scopeMenu),i=hr(Ci,e.__scopeMenu),r=Ph(Ci,e.__scopeMenu),a=Hl(Ci,e.__scopeMenu),o=g.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=a,d={__scopeMenu:e.__scopeMenu},m=g.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return g.useEffect(()=>m,[m]),g.useEffect(()=>{const u=l.current;return()=>{window.clearTimeout(u),c(null)}},[l,c]),t.jsx(Kl,{asChild:!0,...d,children:t.jsx(bh,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":Ih(n.open),...e,ref:Wm(s,r.onTriggerChange),onClick:u=>{e.onClick?.(u),!(e.disabled||u.defaultPrevented)&&(u.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ue(e.onPointerMove,Wi(u=>{a.onItemEnter(u),!u.defaultPrevented&&!e.disabled&&!n.open&&!o.current&&(a.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),m()},100))})),onPointerLeave:ue(e.onPointerLeave,Wi(u=>{m();const h=n.content?.getBoundingClientRect();if(h){const p=n.content?.dataset.side,x=p==="right",f=x?-5:5,j=h[x?"left":"right"],b=h[x?"right":"left"];a.onPointerGraceIntentChange({area:[{x:u.clientX+f,y:u.clientY},{x:j,y:h.top},{x:b,y:h.top},{x:b,y:h.bottom},{x:j,y:h.bottom}],side:p}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(u),u.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:ue(e.onKeyDown,u=>{const h=a.searchRef.current!=="";e.disabled||h&&u.key===" "||mb[i.dir].includes(u.key)&&(n.onOpenChange(!0),n.content?.focus(),u.preventDefault())})})})});Dh.displayName=Ci;var _h="MenuSubContent",Eh=g.forwardRef((e,s)=>{const n=xh(St,e.__scopeMenu),{forceMount:i=n.forceMount,...r}=e,a=mn(St,e.__scopeMenu),o=hr(St,e.__scopeMenu),l=Ph(_h,e.__scopeMenu),c=g.useRef(null),d=dn(s,c);return t.jsx(Ui.Provider,{scope:e.__scopeMenu,children:t.jsx(Na,{present:i||a.open,children:t.jsx(Ui.Slot,{scope:e.__scopeMenu,children:t.jsx(Ql,{id:l.contentId,"aria-labelledby":l.triggerId,...r,ref:d,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{o.isUsingKeyboardRef.current&&c.current?.focus(),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:ue(e.onFocusOutside,m=>{m.target!==l.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:ue(e.onEscapeKeyDown,m=>{o.onClose(),m.preventDefault()}),onKeyDown:ue(e.onKeyDown,m=>{const u=m.currentTarget.contains(m.target),h=hb[o.dir].includes(m.key);u&&h&&(a.onOpenChange(!1),l.trigger?.focus(),m.preventDefault())})})})})})});Eh.displayName=_h;function Ih(e){return e?"open":"closed"}function la(e){return e==="indeterminate"}function Jl(e){return la(e)?"indeterminate":e?"checked":"unchecked"}function Eb(e){const s=document.activeElement;for(const n of e)if(n===s||(n.focus(),document.activeElement!==s))return}function Ib(e,s){return e.map((n,i)=>e[(s+i)%e.length])}function Mb(e,s,n){const r=s.length>1&&Array.from(s).every(d=>d===s[0])?s[0]:s,a=n?e.indexOf(n):-1;let o=Ib(e,Math.max(a,0));r.length===1&&(o=o.filter(d=>d!==n));const c=o.find(d=>d.toLowerCase().startsWith(r.toLowerCase()));return c!==n?c:void 0}function Lb(e,s){const{x:n,y:i}=e;let r=!1;for(let a=0,o=s.length-1;a<s.length;o=a++){const l=s[a],c=s[o],d=l.x,m=l.y,u=c.x,h=c.y;m>i!=h>i&&n<(u-d)*(i-m)/(h-m)+d&&(r=!r)}return r}function Ob(e,s){if(!s)return!1;const n={x:e.clientX,y:e.clientY};return Lb(n,s)}function Wi(e){return s=>s.pointerType==="mouse"?e(s):void 0}var Rb=fh,Fb=Kl,$b=gh,qb=yh,Bb=Zl,Vb=jh,Ub=Fa,Wb=wh,Kb=Nh,Gb=zh,Hb=Ch,Qb=Th,Zb=Ah,Yb=Dh,Jb=Eh,$a="DropdownMenu",[Xb,$A]=Rl($a,[hh]),nt=hh(),[ew,Mh]=Xb($a),Lh=e=>{const{__scopeDropdownMenu:s,children:n,dir:i,open:r,defaultOpen:a,onOpenChange:o,modal:l=!0}=e,c=nt(s),d=g.useRef(null),[m,u]=qm({prop:r,defaultProp:a??!1,onChange:o,caller:$a});return t.jsx(ew,{scope:s,triggerId:pd(),triggerRef:d,contentId:pd(),open:m,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(h=>!h),[u]),modal:l,children:t.jsx(Rb,{...c,open:m,onOpenChange:u,dir:i,modal:l,children:n})})};Lh.displayName=$a;var Oh="DropdownMenuTrigger",Rh=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...r}=e,a=Mh(Oh,n),o=nt(n);return t.jsx(Fb,{asChild:!0,...o,children:t.jsx($s.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...r,ref:Wm(s,a.triggerRef),onPointerDown:ue(e.onPointerDown,l=>{!i&&l.button===0&&l.ctrlKey===!1&&(a.onOpenToggle(),a.open||l.preventDefault())}),onKeyDown:ue(e.onKeyDown,l=>{i||(["Enter"," "].includes(l.key)&&a.onOpenToggle(),l.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});Rh.displayName=Oh;var tw="DropdownMenuPortal",Fh=e=>{const{__scopeDropdownMenu:s,...n}=e,i=nt(s);return t.jsx($b,{...i,...n})};Fh.displayName=tw;var $h="DropdownMenuContent",qh=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=Mh($h,n),a=nt(n),o=g.useRef(!1);return t.jsx(qb,{id:r.contentId,"aria-labelledby":r.triggerId,...a,...i,ref:s,onCloseAutoFocus:ue(e.onCloseAutoFocus,l=>{o.current||r.triggerRef.current?.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:ue(e.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,m=c.button===2||d;(!r.modal||m)&&(o.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});qh.displayName=$h;var sw="DropdownMenuGroup",nw=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=nt(n);return t.jsx(Bb,{...r,...i,ref:s})});nw.displayName=sw;var iw="DropdownMenuLabel",Bh=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=nt(n);return t.jsx(Vb,{...r,...i,ref:s})});Bh.displayName=iw;var rw="DropdownMenuItem",Vh=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=nt(n);return t.jsx(Ub,{...r,...i,ref:s})});Vh.displayName=rw;var aw="DropdownMenuCheckboxItem",Uh=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=nt(n);return t.jsx(Wb,{...r,...i,ref:s})});Uh.displayName=aw;var ow="DropdownMenuRadioGroup",lw=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=nt(n);return t.jsx(Kb,{...r,...i,ref:s})});lw.displayName=ow;var cw="DropdownMenuRadioItem",Wh=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=nt(n);return t.jsx(Gb,{...r,...i,ref:s})});Wh.displayName=cw;var dw="DropdownMenuItemIndicator",Kh=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=nt(n);return t.jsx(Hb,{...r,...i,ref:s})});Kh.displayName=dw;var uw="DropdownMenuSeparator",Gh=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=nt(n);return t.jsx(Qb,{...r,...i,ref:s})});Gh.displayName=uw;var mw="DropdownMenuArrow",hw=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=nt(n);return t.jsx(Zb,{...r,...i,ref:s})});hw.displayName=mw;var pw="DropdownMenuSubTrigger",Hh=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=nt(n);return t.jsx(Yb,{...r,...i,ref:s})});Hh.displayName=pw;var fw="DropdownMenuSubContent",Qh=g.forwardRef((e,s)=>{const{__scopeDropdownMenu:n,...i}=e,r=nt(n);return t.jsx(Jb,{...r,...i,ref:s,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Qh.displayName=fw;var xw=Lh,gw=Rh,yw=Fh,Zh=qh,Yh=Bh,Jh=Vh,Xh=Uh,ep=Wh,tp=Kh,sp=Gh,np=Hh,ip=Qh;const Un=xw,Wn=gw,jw=g.forwardRef(({className:e,inset:s,children:n,...i},r)=>t.jsxs(np,{ref:r,className:O("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",e),...i,children:[n,t.jsx($i,{className:"ml-auto"})]}));jw.displayName=np.displayName;const bw=g.forwardRef(({className:e,...s},n)=>t.jsx(ip,{ref:n,className:O("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...s}));bw.displayName=ip.displayName;const on=g.forwardRef(({className:e,sideOffset:s=4,...n},i)=>t.jsx(yw,{children:t.jsx(Zh,{ref:i,sideOffset:s,className:O("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...n})}));on.displayName=Zh.displayName;const oe=g.forwardRef(({className:e,inset:s,...n},i)=>t.jsx(Jh,{ref:i,className:O("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",s&&"pl-8",e),...n}));oe.displayName=Jh.displayName;const ww=g.forwardRef(({className:e,children:s,checked:n,...i},r)=>t.jsxs(Xh,{ref:r,className:O("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...i,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(tp,{children:t.jsx(ze,{className:"h-4 w-4"})})}),s]}));ww.displayName=Xh.displayName;const vw=g.forwardRef(({className:e,children:s,...n},i)=>t.jsxs(ep,{ref:i,className:O("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(tp,{children:t.jsx(Qr,{className:"h-2 w-2 fill-current"})})}),s]}));vw.displayName=ep.displayName;const rp=g.forwardRef(({className:e,inset:s,...n},i)=>t.jsx(Yh,{ref:i,className:O("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",e),...n}));rp.displayName=Yh.displayName;const Ct=g.forwardRef(({className:e,...s},n)=>t.jsx(sp,{ref:n,className:O("-mx-1 my-1 h-px bg-muted",e),...s}));Ct.displayName=sp.displayName;const Nw=()=>{const e=H(),s=ka(),n=()=>{const o=`${s.pathname}${s.search}`;sessionStorage.setItem("returnUrl",o)};return{navigateWithReturn:o=>{n(),e(o)},goBack:o=>{const l=sessionStorage.getItem("returnUrl");l?(sessionStorage.removeItem("returnUrl"),e(l)):e(o||-1)},saveReturnUrl:n,navigateToWizard:(o,l)=>{l&&sessionStorage.setItem("wizardContext",JSON.stringify(l)),n(),e(o)},currentUrl:`${s.pathname}${s.search}`}},sl=e=>{const{mutate:s,isLoading:n}=Bl();return{togglePublish:async(r,a,o,l)=>{s({resource:e,id:r,values:{is_published:!a}},{onSuccess:()=>{$.success(a?`${o} został ukryty`:`${o} został opublikowany`),l?.()},onError:c=>{$.error("Nie udało się zmienić statusu publikacji"),console.error("Publish toggle error:",c)}})},isToggling:n}},vd=e=>{const{mutate:s}=Bl(),n=Qm(),[i,r]=g.useState(!1);return{updatePosition:g.useCallback(async(o,l)=>{if(!i){r(!0);try{await new Promise((c,d)=>{s({resource:e,id:o,values:{position:l},mutationMode:"optimistic"},{onSuccess:()=>{console.log(`Updated position for ${e} ${o} to ${l}`),c()},onError:m=>d(m)})}),setTimeout(()=>{n({resource:e,invalidates:["list"]})},1e3)}catch(c){console.error("Position update error:",c),$.error("Nie udało się zaktualizować pozycji"),await n({resource:e,invalidates:["list"]})}finally{r(!1)}}},[e,s,n,i]),isUpdating:i}},kw=e=>{const{data:s,isLoading:n}=Fe({resource:"courses",id:e,queryOptions:{enabled:!!e}}),{data:i,isLoading:r,refetch:a}=_e({resource:"topics",filters:[{field:"course_id",operator:"eq",value:e}],sorters:[{field:"position",order:"asc"}],meta:{select:"*, activities(count)"},queryOptions:{enabled:!!e}}),{data:o,refetch:l}=_e({resource:"activities",filters:[{field:"topic_id",operator:"in",value:i?.data?.map(h=>h.id)||[]}],sorters:[{field:"position",order:"asc"}],meta:{select:"*, questions(count)"},queryOptions:{enabled:!!i?.data?.length}}),{data:c}=_e({resource:"course_access",filters:[{field:"course_id",operator:"eq",value:e}],queryOptions:{enabled:!!e}}),d=n||r,m={topicsCount:i?.total||0,activitiesCount:o?.total||0,accessCount:c?.total||0},u=h=>o?.data?.filter(p=>p.topic_id===h)||[];return{course:s?.data,topics:i?.data||[],activities:o?.data||[],stats:m,isLoading:d,refetchTopics:a,refetchActivities:l,getActivitiesForTopic:u}},zw=()=>{const{create:e,edit:s,show:n}=Ue(),{mutate:i}=qn(),{togglePublish:r}=sl("courses"),{tableQuery:{data:a,isLoading:o,isError:l,refetch:c},current:d,setCurrent:m,pageSize:u,setFilters:h}=za({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, topics(count), course_access(count)"}}),p=Ia({isLoading:o,isError:l});if(p)return p;const x=(j,b)=>{confirm(`Czy na pewno chcesz usunąć kurs "${b}"?`)&&i({resource:"courses",id:j},{onSuccess:()=>{$.success("Kurs został usunięty"),c()}})},f=(j,b,y)=>{b&&y&&sessionStorage.setItem("wizardContext",JSON.stringify({courseId:b,courseTitle:y})),window.location.href=j};return t.jsxs(W,{children:[t.jsxs(R,{children:[t.jsx(ie,{title:"Kursy",description:"Zarządzaj kursami w systemie"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Qt,{children:t.jsxs(Zt,{children:[t.jsx(Yt,{asChild:!0,children:t.jsxs(T,{variant:"outline",onClick:()=>f("/course-structure/step1"),children:[t.jsx(en,{className:"w-4 h-4 mr-2"}),t.jsx(Ps,{className:"w-3 h-3"})]})}),t.jsx(Ft,{children:t.jsx("p",{children:"Stwórz kurs z pomocą AI"})})]})}),t.jsxs(T,{onClick:()=>e("courses"),children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Dodaj kurs"]})]})]}),t.jsx(R,{children:t.jsx(B,{placeholder:"Szukaj kursów...",className:"max-w-sm",onChange:j=>{h([{field:"title",operator:"contains",value:j.target.value}])}})}),t.jsx(be,{children:a?.data?.map(j=>t.jsxs(I,{className:`relative cursor-pointer transition-all duration-200 ${j.is_published?"hover:shadow-lg":"opacity-80 hover:opacity-90 "}`,onClick:b=>{b.target.closest('[role="menu"]')||n("courses",j.id)},children:[t.jsx(V,{children:t.jsxs(R,{children:[t.jsxs(q,{className:"flex items-center gap-2 min-w-0",children:[t.jsx("span",{className:"flex-shrink-0",children:j.icon_emoji?t.jsx("span",{className:"text-2xl",children:j.icon_emoji}):t.jsx(Ee,{className:"w-5 h-5"})}),t.jsx(Qt,{delayDuration:200,children:t.jsxs(Zt,{children:[t.jsx(Yt,{asChild:!0,children:t.jsx("span",{className:"truncate",children:j.title})}),j.title.length>30&&t.jsx(Ft,{children:t.jsx("p",{className:"max-w-xs",children:j.title})})]})})]}),t.jsxs(Un,{children:[t.jsx(Wn,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"sm",onClick:b=>b.stopPropagation(),children:t.jsx(lr,{className:"h-4 w-4"})})}),t.jsxs(on,{align:"end",children:[t.jsxs(oe,{onClick:()=>n("courses",j.id),children:[t.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),t.jsxs(oe,{onClick:()=>s("courses",j.id),children:[t.jsx(Vt,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),t.jsx(Ct,{}),t.jsx(oe,{onClick:()=>r(j.id,j.is_published,j.title,c),children:j.is_published?t.jsxs(t.Fragment,{children:[t.jsx(Da,{className:"mr-2 h-4 w-4"}),"Ukryj kurs"]}):t.jsxs(t.Fragment,{children:[t.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Opublikuj kurs"]})}),t.jsx(Ct,{}),t.jsxs(oe,{onClick:()=>f("/educational-material/step1",j.id,j.title),className:"text-purple-600 focus:text-purple-600",children:[t.jsx(Ps,{className:"mr-2 h-4 w-4"}),"Generuj materiał z AI"]}),t.jsxs(oe,{onClick:()=>f("/quiz-wizard/step1",j.id,j.title),className:"text-blue-600 focus:text-blue-600",children:[t.jsx(Vn,{className:"mr-2 h-4 w-4"}),"Generuj quiz z AI"]}),t.jsx(Ct,{}),t.jsxs(oe,{onClick:()=>x(j.id,j.title),className:"text-red-600 focus:text-red-600",children:[t.jsx(xs,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})}),t.jsxs(M,{children:[j.description&&t.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:j.description}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex gap-2",children:t.jsx(ne,{variant:j.is_published?"default":"secondary",className:j.is_published?"bg-green-600":"",children:j.is_published?"Opublikowany":"Szkic"})}),t.jsxs("div",{className:"flex gap-3 text-sm text-muted-foreground",children:[t.jsx(Qt,{children:t.jsxs(Zt,{children:[t.jsx(Yt,{asChild:!0,children:t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(et,{className:"w-3 h-3"}),j.topics?.[0]?.count||0]})}),t.jsx(Ft,{children:t.jsx("p",{children:"Liczba tematów"})})]})}),t.jsx(Qt,{children:t.jsxs(Zt,{children:[t.jsx(Yt,{asChild:!0,children:t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(He,{className:"w-3 h-3"}),j.course_access?.[0]?.count||0]})}),t.jsx(Ft,{children:t.jsx("p",{children:"Liczba uczestników"})})]})})]})]}),j.created_at&&t.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-muted-foreground",children:[t.jsx(qt,{className:"w-3 h-3"}),t.jsxs("span",{children:["Utworzono:"," ",new Date(j.created_at).toLocaleDateString("pl-PL")]})]})]})]},j.id))}),a?.data?.length===0&&t.jsx(I,{className:"border-dashed border-2 bg-gradient-to-r from-indigo-50/50 to-purple-50/50 dark:from-indigo-950/20 dark:to-purple-950/20",children:t.jsxs(M,{className:"text-center py-12",children:[t.jsx(en,{className:"w-12 h-12 mx-auto mb-4 text-indigo-600"}),t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Brak kursów"}),t.jsx("p",{className:"text-muted-foreground mb-6",children:"Rozpocznij od stworzenia pierwszego kursu"}),t.jsxs("div",{className:"flex gap-3 justify-center",children:[t.jsxs(T,{variant:"outline",onClick:()=>e("courses"),children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Dodaj ręcznie"]}),t.jsxs(T,{onClick:()=>f("/course-structure/step1"),className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700",children:[t.jsx(Ps,{className:"w-4 h-4 mr-2"}),"Wygeneruj z AI"]})]})]})}),t.jsx(Oa,{current:d,pageSize:u,total:a?.total||0,setCurrent:m,itemName:"kursów"}),a?.data&&a.data.length>0&&t.jsx("div",{className:"fixed bottom-6 right-6",children:t.jsx(Qt,{children:t.jsxs(Zt,{children:[t.jsx(Yt,{asChild:!0,children:t.jsxs(T,{size:"lg",className:"rounded-full shadow-lg bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700",onClick:()=>f("/course-structure/step1"),children:[t.jsx(en,{className:"w-5 h-5 mr-2"}),t.jsx(Ps,{className:"w-4 h-4"})]})}),t.jsx(Ft,{side:"left",children:t.jsx("p",{children:"Stwórz nowy kurs z pomocą AI"})})]})})})]})},Et=({children:e,onSubmit:s,className:n="",...i})=>{const r="space-y-6",a=n?`${r} ${n}`:r;return t.jsx("form",{onSubmit:s,className:a,...i,children:e})},G=({children:e,label:s,htmlFor:n,error:i,required:r=!1,className:a="",hint:o})=>{const l="space-y-2",c=a?`${l} ${a}`:l,d=()=>s?typeof s=="string"?t.jsxs(X,{htmlFor:n,children:[s,r&&t.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):t.jsxs(X,{htmlFor:n,className:"flex items-center",children:[s,r&&t.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):null,m=g.isValidElement(e)?g.cloneElement(e,{className:`${e.props.className||""} ${i?"border-red-500 ring-1 ring-red-500":""}`.trim()}):e;return t.jsxs("div",{className:c,children:[d(),m,o&&!i&&t.jsx("p",{className:"text-sm text-muted-foreground",children:o}),i&&t.jsx("p",{className:"text-sm text-red-500",children:i})]})},It=({children:e,className:s=""})=>{const n="flex justify-end items-center gap-4 pt-6 border-t",i=s?`${n} ${s}`:n;return t.jsx("div",{className:i,children:e})},Sw=["📚","🎓","💡","🚀","⭐","🏆","🎯","📖","✏️","🧮"],Cw=()=>{const{list:e}=Ue(),{data:s}=st(),[n,i]=g.useState(!1),{refineCore:{onFinish:r},register:a,handleSubmit:o,setValue:l,watch:c,formState:{errors:d,isSubmitting:m}}=rs({defaultValues:{title:"",description:"",vendor_id:s?.vendor_id||0,is_published:!1,icon_emoji:"📚"}}),u=c("icon_emoji");return t.jsxs(W,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("courses"),children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsx(R,{children:t.jsx(ie,{title:"Dodaj kurs",description:"Utwórz nowy kurs w systemie"})}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Informacje o kursie"})}),t.jsx(M,{children:t.jsxs(Et,{onSubmit:o(r),children:[t.jsxs(be,{variant:"1-2-2",children:[t.jsx(G,{label:"Tytuł kursu",htmlFor:"title",error:d.title?.message?.toString(),required:!0,children:t.jsx(B,{id:"title",placeholder:"np. Podstawy programowania",...a("title",{required:"Tytuł kursu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),t.jsx(G,{label:"Ikona kursu",htmlFor:"icon_emoji",children:t.jsxs("div",{className:"relative",children:[t.jsxs(T,{type:"button",variant:"outline",className:"w-full justify-start",onClick:()=>i(!n),children:[t.jsx("span",{className:"text-2xl mr-2",children:u||"📚"}),"Wybierz ikonę"]}),n&&t.jsx("div",{className:"absolute top-full mt-2 p-2 bg-white border rounded-lg shadow-lg z-10",children:t.jsx("div",{className:"grid grid-cols-5 gap-2",children:Sw.map(h=>t.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded text-2xl",onClick:()=>{l("icon_emoji",h),i(!1)},children:h},h))})})]})})]}),t.jsx(G,{label:"Opis kursu",htmlFor:"description",error:d.description?.message?.toString(),children:t.jsx(Dt,{id:"description",placeholder:"Opisz czego uczniowie nauczą się na tym kursie...",rows:4,...a("description")})}),t.jsx(G,{label:"Status publikacji",children:t.jsxs(R,{variant:"start",children:[t.jsx(Ut,{checked:c("is_published")||!1,onCheckedChange:h=>l("is_published",h)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj kurs od razu (możesz to zmienić później)"})]})}),t.jsxs(It,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:()=>e("courses"),children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:m,children:m?"Tworzenie...":"Utwórz kurs"})]})]})})]})]})},Tw=["📚","🎓","💡","🚀","⭐","🏆","🎯","📖","✏️","🧮"],Aw=()=>{const{list:e}=Ue(),{id:s}=tt(),[n,i]=g.useState(!1),{data:r,isLoading:a}=Fe({resource:"courses",id:s,liveMode:"off"}),{refineCore:{onFinish:o},register:l,handleSubmit:c,setValue:d,watch:m,formState:{errors:u,isSubmitting:h}}=rs({refineCoreProps:{resource:"courses",id:s,liveMode:"off"}}),p=m("icon_emoji");return a?t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):t.jsxs(W,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("courses"),children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsx(R,{children:t.jsx(ie,{title:"Edytuj kurs",description:`Edycja kursu: ${r?.data?.title}`})}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Informacje o kursie"})}),t.jsx(M,{children:t.jsxs(Et,{onSubmit:c(o),children:[t.jsxs(be,{variant:"1-2-2",children:[t.jsx(G,{label:"Tytuł kursu",htmlFor:"title",error:u.title?.message,required:!0,children:t.jsx(B,{id:"title",placeholder:"np. Podstawy programowania",...l("title",{required:"Tytuł kursu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),t.jsx(G,{label:"Ikona kursu",htmlFor:"icon_emoji",children:t.jsxs("div",{className:"relative",children:[t.jsxs(T,{type:"button",variant:"outline",className:"w-full justify-start",onClick:()=>i(!n),children:[t.jsx("span",{className:"text-2xl mr-2",children:p||"📚"}),"Wybierz ikonę"]}),n&&t.jsx("div",{className:"absolute top-full mt-2 p-2 bg-white border rounded-lg shadow-lg z-10",children:t.jsx("div",{className:"grid grid-cols-5 gap-2",children:Tw.map(x=>t.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded text-2xl",onClick:()=>{d("icon_emoji",x),i(!1)},children:x},x))})})]})})]}),t.jsx(G,{label:"Opis kursu",htmlFor:"description",error:u.description?.message,children:t.jsx(Dt,{id:"description",placeholder:"Opisz czego uczniowie nauczą się na tym kursie...",rows:4,...l("description")})}),t.jsx(G,{label:"Status publikacji",children:t.jsxs(R,{variant:"start",children:[t.jsx(Ut,{checked:m("is_published")||!1,onCheckedChange:x=>d("is_published",x)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Kurs jest opublikowany i widoczny dla uczniów"})]})}),t.jsxs(It,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:()=>e("courses"),children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:h,children:h?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},Pw=({topic:e,isExpanded:s,onToggle:n,onDelete:i,onEdit:r,onTogglePublish:a,onNavigateToWizard:o,courseId:l,courseTitle:c,children:d,activitiesCount:m,dragHandleProps:u})=>{const h=H(),p=f=>{const j=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",j),h(f)},x=(f,j)=>{o&&o(f,{courseId:l,courseTitle:c,topicId:e.id,topicTitle:e.title,...j})};return t.jsxs("div",{className:`border-2 rounded-lg overflow-hidden group ${s?"shadow-lg border-primary":"border-border hover:border-primary/50"}`,children:[t.jsx("div",{className:`p-4 ${s?"bg-primary text-primary-foreground":"bg-background hover:bg-muted"}`,children:t.jsxs(R,{children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[t.jsx("button",{onClick:n,className:`p-1 rounded ${s?"text-primary-foreground hover:bg-primary-foreground/20":"hover:bg-muted"}`,"aria-label":s?"Zwiń temat":"Rozwiń temat",children:s?t.jsx(Ta,{className:"w-5 h-5"}):t.jsx($i,{className:"w-5 h-5"})}),t.jsx("div",{className:"cursor-move",...u,children:t.jsx(Xm,{className:`w-4 h-4 ${s?"text-primary-foreground/70":"text-muted-foreground"}`})}),t.jsxs("div",{className:"flex-1 cursor-pointer group",onClick:n,children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("h4",{className:`font-semibold text-base ${s?"text-primary-foreground":"group-hover:text-primary"}`,children:["Temat ",e.position,": ",e.title]}),t.jsx(ne,{variant:e.is_published?s?"secondary":"default":"outline",className:s?"bg-primary-foreground/20 text-primary-foreground border-primary-foreground/30":"",children:e.is_published?"Opublikowany":"Szkic"})]}),t.jsx("div",{className:"flex items-center gap-4 mt-1",children:t.jsxs("span",{className:`text-sm flex items-center gap-1 ${s?"text-primary-foreground/80":"text-muted-foreground"}`,children:[t.jsx(et,{className:"w-3 h-3"}),m," ",m===1?"aktywność":"aktywności"]})})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs(Un,{children:[t.jsx(Wn,{asChild:!0,children:t.jsx(T,{size:"sm",variant:s?"secondary":"ghost",title:"Dodaj aktywność",className:`h-8 w-8 p-0 ${s?"bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground":""}`,children:t.jsx(Re,{className:"h-4 w-4"})})}),t.jsxs(on,{align:"end",children:[t.jsx(rp,{children:"Dodaj treść"}),t.jsxs(oe,{onClick:()=>p(`/activities/create?topic_id=${e.id}`),children:[t.jsx(Re,{className:"mr-2 h-4 w-4"}),"Dodaj ręcznie"]}),t.jsx(Ct,{}),t.jsxs(oe,{onClick:()=>x("/educational-material/step1"),className:"text-purple-600 focus:text-purple-600",children:[t.jsx(Ps,{className:"mr-2 h-4 w-4"}),"Generuj materiał z AI"]}),t.jsxs(oe,{onClick:()=>x("/quiz-wizard/step1"),className:"text-blue-600 focus:text-blue-600",children:[t.jsx(Vn,{className:"mr-2 h-4 w-4"}),"Generuj quiz z AI"]})]})]}),t.jsxs(Un,{children:[t.jsx(Wn,{asChild:!0,children:t.jsx(T,{variant:s?"secondary":"ghost",size:"sm",className:`h-8 w-8 p-0 ${s?"bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground":""}`,children:t.jsx(lr,{className:"h-4 w-4"})})}),t.jsxs(on,{align:"end",children:[t.jsxs(oe,{onClick:()=>r("topics",e.id),children:[t.jsx(Vt,{className:"mr-2 h-4 w-4"}),"Edytuj temat"]}),t.jsx(Ct,{}),t.jsx(oe,{onClick:()=>a(e.id,e.is_published,e.title),children:e.is_published?t.jsxs(t.Fragment,{children:[t.jsx(Da,{className:"mr-2 h-4 w-4"}),"Ukryj temat"]}):t.jsxs(t.Fragment,{children:[t.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Opublikuj temat"]})}),t.jsx(Ct,{}),t.jsxs(oe,{onClick:()=>i(e.id,e.title),className:"text-red-600 focus:text-red-600",children:[t.jsx(xs,{className:"mr-2 h-4 w-4"}),"Usuń temat"]})]})]})]})]})}),s&&t.jsx("div",{className:"p-4 bg-muted/20 border-t-2 border-primary",children:t.jsx("div",{className:"space-y-2",children:d})})]})},Dw=({activity:e,topicPosition:s,onDelete:n,onEdit:i,onTogglePublish:r,dragHandleProps:a})=>{const o=H(),l=()=>e.type==="quiz"?t.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:t.jsx(ct,{className:"w-5 h-5 text-white"})}):t.jsx("div",{className:"p-2 bg-green-600 rounded-lg",children:t.jsx(et,{className:"w-5 h-5 text-white"})}),c=()=>e.type==="quiz"?"Quiz":"Materiał";return t.jsxs("div",{className:"group flex items-center gap-4 p-4 bg-white border-2 rounded-lg hover:border-primary/50 transition-all duration-200",children:[t.jsx("div",{className:"cursor-move opacity-0 group-hover:opacity-100 transition-opacity",...a,children:t.jsx(Xm,{className:"w-4 h-4 text-muted-foreground"})}),l(),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsxs("h5",{className:"font-semibold text-sm text-foreground",children:[s,".",e.position," ",e.title]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ne,{variant:e.type==="quiz"?"default":"secondary",className:"text-xs font-medium",children:c()}),e.type==="quiz"&&e._count?.questions!==void 0&&t.jsxs(ne,{variant:"outline",className:"text-xs font-medium border-2",children:[t.jsx(tn,{className:"w-3 h-3 mr-1"}),e._count.questions," ",e._count.questions===1?"pytanie":"pytań"]}),t.jsx(ne,{variant:e.is_published?"default":"outline",className:`text-xs font-medium ${e.is_published?"bg-green-600 hover:bg-green-700":"border-2"}`,children:e.is_published?t.jsxs(t.Fragment,{children:[t.jsx(Xy,{className:"w-3 h-3 mr-1"}),"Opublikowany"]}):"Szkic"})]})]}),t.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[e.duration_min&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(qt,{className:"w-3 h-3"}),t.jsxs("span",{children:[e.duration_min," min"]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(He,{className:"w-3 h-3"}),t.jsx("span",{children:"0 ukończeń"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[e.type==="quiz"&&t.jsx(T,{size:"sm",variant:"ghost",onClick:()=>o(`/questions/manage/${e.id}`),title:"Zarządzaj pytaniami",className:"h-8 w-8 p-0",children:t.jsx(tn,{className:"h-4 w-4"})}),t.jsx(T,{size:"sm",variant:"ghost",onClick:()=>o(`/activities/show/${e.id}`),title:"Podgląd",className:"h-8 w-8 p-0",children:t.jsx(Ve,{className:"h-4 w-4"})}),t.jsxs(Un,{children:[t.jsx(Wn,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:t.jsx(lr,{className:"h-4 w-4"})})}),t.jsxs(on,{align:"end",children:[t.jsxs(oe,{onClick:()=>o(`/activities/show/${e.id}`),children:[t.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),t.jsxs(oe,{onClick:()=>i("activities",e.id),children:[t.jsx(Vt,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),t.jsx(Ct,{}),t.jsx(oe,{onClick:()=>r(e.id,e.is_published,e.title),children:e.is_published?t.jsxs(t.Fragment,{children:[t.jsx(Da,{className:"mr-2 h-4 w-4"}),"Ukryj aktywność"]}):t.jsxs(t.Fragment,{children:[t.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Opublikuj aktywność"]})}),e.type==="quiz"&&t.jsxs(t.Fragment,{children:[t.jsx(Ct,{}),t.jsxs(oe,{onClick:()=>o(`/questions/manage/${e.id}`),className:"text-blue-600 focus:text-blue-600",children:[t.jsx(tn,{className:"mr-2 h-4 w-4"}),"Zarządzaj pytaniami"]}),t.jsxs(oe,{onClick:()=>o(`/questions/create?activity_id=${e.id}`),className:"text-blue-600 focus:text-blue-600",children:[t.jsx(Re,{className:"mr-2 h-4 w-4"}),"Dodaj pytanie"]})]}),t.jsx(Ct,{}),t.jsxs(oe,{onClick:()=>n(e.id,e.title),className:"text-red-600 focus:text-red-600",children:[t.jsx(xs,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})]})},_w=({course:e})=>e?t.jsx(I,{className:"flex-1",children:t.jsx(M,{className:"pt-6",children:t.jsxs("div",{className:"flex items-start gap-4",children:[e.icon_emoji&&t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-3xl",children:e.icon_emoji})})}),t.jsxs("div",{className:"flex-1 space-y-3",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-semibold",children:e.title}),t.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:e.is_published?"Opublikowany":"Szkic"}),e.created_at&&t.jsxs("span",{className:"text-sm text-muted-foreground",children:["Utworzony: ",new Date(e.created_at).toLocaleDateString("pl-PL")]})]})]}),e.description&&t.jsx("div",{className:"prose prose-sm max-w-none",children:t.jsx("p",{className:"text-muted-foreground leading-relaxed whitespace-pre-wrap",children:e.description})})]})]})})}):null;function Ew(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return g.useMemo(()=>i=>{s.forEach(r=>r(i))},s)}const qa=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ei(e){const s=Object.prototype.toString.call(e);return s==="[object Window]"||s==="[object global]"}function Xl(e){return"nodeType"in e}function dt(e){var s,n;return e?ei(e)?e:Xl(e)&&(s=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?s:window:window}function ec(e){const{Document:s}=dt(e);return e instanceof s}function pr(e){return ei(e)?!1:e instanceof dt(e).HTMLElement}function ap(e){return e instanceof dt(e).SVGElement}function ti(e){return e?ei(e)?e.document:Xl(e)?ec(e)?e:pr(e)||ap(e)?e.ownerDocument:document:document:document}const ns=qa?g.useLayoutEffect:g.useEffect;function tc(e){const s=g.useRef(e);return ns(()=>{s.current=e}),g.useCallback(function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return s.current==null?void 0:s.current(...i)},[])}function Iw(){const e=g.useRef(null),s=g.useCallback((i,r)=>{e.current=setInterval(i,r)},[]),n=g.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[s,n]}function Ki(e,s){s===void 0&&(s=[e]);const n=g.useRef(e);return ns(()=>{n.current!==e&&(n.current=e)},s),n}function fr(e,s){const n=g.useRef();return g.useMemo(()=>{const i=e(n.current);return n.current=i,i},[...s])}function ca(e){const s=tc(e),n=g.useRef(null),i=g.useCallback(r=>{r!==n.current&&s?.(r,n.current),n.current=r},[]);return[n,i]}function nl(e){const s=g.useRef();return g.useEffect(()=>{s.current=e},[e]),s.current}let go={};function xr(e,s){return g.useMemo(()=>{if(s)return s;const n=go[e]==null?0:go[e]+1;return go[e]=n,e+"-"+n},[e,s])}function op(e){return function(s){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.reduce((a,o)=>{const l=Object.entries(o);for(const[c,d]of l){const m=a[c];m!=null&&(a[c]=m+e*d)}return a},{...s})}}const Ln=op(1),Gi=op(-1);function Mw(e){return"clientX"in e&&"clientY"in e}function sc(e){if(!e)return!1;const{KeyboardEvent:s}=dt(e.target);return s&&e instanceof s}function Lw(e){if(!e)return!1;const{TouchEvent:s}=dt(e.target);return s&&e instanceof s}function il(e){if(Lw(e)){if(e.touches&&e.touches.length){const{clientX:s,clientY:n}=e.touches[0];return{x:s,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:s,clientY:n}=e.changedTouches[0];return{x:s,y:n}}}return Mw(e)?{x:e.clientX,y:e.clientY}:null}const Hi=Object.freeze({Translate:{toString(e){if(!e)return;const{x:s,y:n}=e;return"translate3d("+(s?Math.round(s):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:s,scaleY:n}=e;return"scaleX("+s+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Hi.Translate.toString(e),Hi.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:s,duration:n,easing:i}=e;return s+" "+n+"ms "+i}}}),Nd="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Ow(e){return e.matches(Nd)?e:e.querySelector(Nd)}const Rw={display:"none"};function Fw(e){let{id:s,value:n}=e;return L.createElement("div",{id:s,style:Rw},n)}function $w(e){let{id:s,announcement:n,ariaLiveType:i="assertive"}=e;const r={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return L.createElement("div",{id:s,style:r,role:"status","aria-live":i,"aria-atomic":!0},n)}function qw(){const[e,s]=g.useState("");return{announce:g.useCallback(i=>{i!=null&&s(i)},[]),announcement:e}}const lp=g.createContext(null);function Bw(e){const s=g.useContext(lp);g.useEffect(()=>{if(!s)throw new Error("useDndMonitor must be used within a children of <DndContext>");return s(e)},[e,s])}function Vw(){const[e]=g.useState(()=>new Set),s=g.useCallback(i=>(e.add(i),()=>e.delete(i)),[e]);return[g.useCallback(i=>{let{type:r,event:a}=i;e.forEach(o=>{var l;return(l=o[r])==null?void 0:l.call(o,a)})},[e]),s]}const Uw={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Ww={onDragStart(e){let{active:s}=e;return"Picked up draggable item "+s.id+"."},onDragOver(e){let{active:s,over:n}=e;return n?"Draggable item "+s.id+" was moved over droppable area "+n.id+".":"Draggable item "+s.id+" is no longer over a droppable area."},onDragEnd(e){let{active:s,over:n}=e;return n?"Draggable item "+s.id+" was dropped over droppable area "+n.id:"Draggable item "+s.id+" was dropped."},onDragCancel(e){let{active:s}=e;return"Dragging was cancelled. Draggable item "+s.id+" was dropped."}};function Kw(e){let{announcements:s=Ww,container:n,hiddenTextDescribedById:i,screenReaderInstructions:r=Uw}=e;const{announce:a,announcement:o}=qw(),l=xr("DndLiveRegion"),[c,d]=g.useState(!1);if(g.useEffect(()=>{d(!0)},[]),Bw(g.useMemo(()=>({onDragStart(u){let{active:h}=u;a(s.onDragStart({active:h}))},onDragMove(u){let{active:h,over:p}=u;s.onDragMove&&a(s.onDragMove({active:h,over:p}))},onDragOver(u){let{active:h,over:p}=u;a(s.onDragOver({active:h,over:p}))},onDragEnd(u){let{active:h,over:p}=u;a(s.onDragEnd({active:h,over:p}))},onDragCancel(u){let{active:h,over:p}=u;a(s.onDragCancel({active:h,over:p}))}}),[a,s])),!c)return null;const m=L.createElement(L.Fragment,null,L.createElement(Fw,{id:i,value:r.draggable}),L.createElement($w,{id:l,announcement:o}));return n?ki.createPortal(m,n):m}var De;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(De||(De={}));function da(){}function kd(e,s){return g.useMemo(()=>({sensor:e,options:s??{}}),[e,s])}function Gw(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return g.useMemo(()=>[...s].filter(i=>i!=null),[...s])}const Bt=Object.freeze({x:0,y:0});function cp(e,s){return Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2))}function dp(e,s){let{data:{value:n}}=e,{data:{value:i}}=s;return n-i}function Hw(e,s){let{data:{value:n}}=e,{data:{value:i}}=s;return i-n}function zd(e){let{left:s,top:n,height:i,width:r}=e;return[{x:s,y:n},{x:s+r,y:n},{x:s,y:n+i},{x:s+r,y:n+i}]}function up(e,s){if(!e||e.length===0)return null;const[n]=e;return n[s]}function Sd(e,s,n){return s===void 0&&(s=e.left),n===void 0&&(n=e.top),{x:s+e.width*.5,y:n+e.height*.5}}const Qw=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:i}=e;const r=Sd(s,s.left,s.top),a=[];for(const o of i){const{id:l}=o,c=n.get(l);if(c){const d=cp(Sd(c),r);a.push({id:l,data:{droppableContainer:o,value:d}})}}return a.sort(dp)},Zw=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:i}=e;const r=zd(s),a=[];for(const o of i){const{id:l}=o,c=n.get(l);if(c){const d=zd(c),m=r.reduce((h,p,x)=>h+cp(d[x],p),0),u=Number((m/4).toFixed(4));a.push({id:l,data:{droppableContainer:o,value:u}})}}return a.sort(dp)};function Yw(e,s){const n=Math.max(s.top,e.top),i=Math.max(s.left,e.left),r=Math.min(s.left+s.width,e.left+e.width),a=Math.min(s.top+s.height,e.top+e.height),o=r-i,l=a-n;if(i<r&&n<a){const c=s.width*s.height,d=e.width*e.height,m=o*l,u=m/(c+d-m);return Number(u.toFixed(4))}return 0}const Jw=e=>{let{collisionRect:s,droppableRects:n,droppableContainers:i}=e;const r=[];for(const a of i){const{id:o}=a,l=n.get(o);if(l){const c=Yw(l,s);c>0&&r.push({id:o,data:{droppableContainer:a,value:c}})}}return r.sort(Hw)};function Xw(e,s,n){return{...e,scaleX:s&&n?s.width/n.width:1,scaleY:s&&n?s.height/n.height:1}}function mp(e,s){return e&&s?{x:e.left-s.left,y:e.top-s.top}:Bt}function ev(e){return function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),a=1;a<i;a++)r[a-1]=arguments[a];return r.reduce((o,l)=>({...o,top:o.top+e*l.y,bottom:o.bottom+e*l.y,left:o.left+e*l.x,right:o.right+e*l.x}),{...n})}}const tv=ev(1);function sv(e){if(e.startsWith("matrix3d(")){const s=e.slice(9,-1).split(/, /);return{x:+s[12],y:+s[13],scaleX:+s[0],scaleY:+s[5]}}else if(e.startsWith("matrix(")){const s=e.slice(7,-1).split(/, /);return{x:+s[4],y:+s[5],scaleX:+s[0],scaleY:+s[3]}}return null}function nv(e,s,n){const i=sv(s);if(!i)return e;const{scaleX:r,scaleY:a,x:o,y:l}=i,c=e.left-o-(1-r)*parseFloat(n),d=e.top-l-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),m=r?e.width/r:e.width,u=a?e.height/a:e.height;return{width:m,height:u,top:d,right:c+m,bottom:d+u,left:c}}const iv={ignoreTransform:!1};function si(e,s){s===void 0&&(s=iv);let n=e.getBoundingClientRect();if(s.ignoreTransform){const{transform:d,transformOrigin:m}=dt(e).getComputedStyle(e);d&&(n=nv(n,d,m))}const{top:i,left:r,width:a,height:o,bottom:l,right:c}=n;return{top:i,left:r,width:a,height:o,bottom:l,right:c}}function Cd(e){return si(e,{ignoreTransform:!0})}function rv(e){const s=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:s,bottom:n,width:s,height:n}}function av(e,s){return s===void 0&&(s=dt(e).getComputedStyle(e)),s.position==="fixed"}function ov(e,s){s===void 0&&(s=dt(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(r=>{const a=s[r];return typeof a=="string"?n.test(a):!1})}function Ba(e,s){const n=[];function i(r){if(s!=null&&n.length>=s||!r)return n;if(ec(r)&&r.scrollingElement!=null&&!n.includes(r.scrollingElement))return n.push(r.scrollingElement),n;if(!pr(r)||ap(r)||n.includes(r))return n;const a=dt(e).getComputedStyle(r);return r!==e&&ov(r,a)&&n.push(r),av(r,a)?n:i(r.parentNode)}return e?i(e):n}function hp(e){const[s]=Ba(e,1);return s??null}function yo(e){return!qa||!e?null:ei(e)?e:Xl(e)?ec(e)||e===ti(e).scrollingElement?window:pr(e)?e:null:null}function pp(e){return ei(e)?e.scrollX:e.scrollLeft}function fp(e){return ei(e)?e.scrollY:e.scrollTop}function rl(e){return{x:pp(e),y:fp(e)}}var Oe;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Oe||(Oe={}));function xp(e){return!qa||!e?!1:e===document.scrollingElement}function gp(e){const s={x:0,y:0},n=xp(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},i={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},r=e.scrollTop<=s.y,a=e.scrollLeft<=s.x,o=e.scrollTop>=i.y,l=e.scrollLeft>=i.x;return{isTop:r,isLeft:a,isBottom:o,isRight:l,maxScroll:i,minScroll:s}}const lv={x:.2,y:.2};function cv(e,s,n,i,r){let{top:a,left:o,right:l,bottom:c}=n;i===void 0&&(i=10),r===void 0&&(r=lv);const{isTop:d,isBottom:m,isLeft:u,isRight:h}=gp(e),p={x:0,y:0},x={x:0,y:0},f={height:s.height*r.y,width:s.width*r.x};return!d&&a<=s.top+f.height?(p.y=Oe.Backward,x.y=i*Math.abs((s.top+f.height-a)/f.height)):!m&&c>=s.bottom-f.height&&(p.y=Oe.Forward,x.y=i*Math.abs((s.bottom-f.height-c)/f.height)),!h&&l>=s.right-f.width?(p.x=Oe.Forward,x.x=i*Math.abs((s.right-f.width-l)/f.width)):!u&&o<=s.left+f.width&&(p.x=Oe.Backward,x.x=i*Math.abs((s.left+f.width-o)/f.width)),{direction:p,speed:x}}function dv(e){if(e===document.scrollingElement){const{innerWidth:a,innerHeight:o}=window;return{top:0,left:0,right:a,bottom:o,width:a,height:o}}const{top:s,left:n,right:i,bottom:r}=e.getBoundingClientRect();return{top:s,left:n,right:i,bottom:r,width:e.clientWidth,height:e.clientHeight}}function yp(e){return e.reduce((s,n)=>Ln(s,rl(n)),Bt)}function uv(e){return e.reduce((s,n)=>s+pp(n),0)}function mv(e){return e.reduce((s,n)=>s+fp(n),0)}function hv(e,s){if(s===void 0&&(s=si),!e)return;const{top:n,left:i,bottom:r,right:a}=s(e);hp(e)&&(r<=0||a<=0||n>=window.innerHeight||i>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const pv=[["x",["left","right"],uv],["y",["top","bottom"],mv]];class nc{constructor(s,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const i=Ba(n),r=yp(i);this.rect={...s},this.width=s.width,this.height=s.height;for(const[a,o,l]of pv)for(const c of o)Object.defineProperty(this,c,{get:()=>{const d=l(i),m=r[a]-d;return this.rect[c]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Pi{constructor(s){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var i;return(i=this.target)==null?void 0:i.removeEventListener(...n)})},this.target=s}add(s,n,i){var r;(r=this.target)==null||r.addEventListener(s,n,i),this.listeners.push([s,n,i])}}function fv(e){const{EventTarget:s}=dt(e);return e instanceof s?e:ti(e)}function jo(e,s){const n=Math.abs(e.x),i=Math.abs(e.y);return typeof s=="number"?Math.sqrt(n**2+i**2)>s:"x"in s&&"y"in s?n>s.x&&i>s.y:"x"in s?n>s.x:"y"in s?i>s.y:!1}var zt;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(zt||(zt={}));function Td(e){e.preventDefault()}function xv(e){e.stopPropagation()}var te;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(te||(te={}));const jp={start:[te.Space,te.Enter],cancel:[te.Esc],end:[te.Space,te.Enter,te.Tab]},gv=(e,s)=>{let{currentCoordinates:n}=s;switch(e.code){case te.Right:return{...n,x:n.x+25};case te.Left:return{...n,x:n.x-25};case te.Down:return{...n,y:n.y+25};case te.Up:return{...n,y:n.y-25}}};class ic{constructor(s){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=s;const{event:{target:n}}=s;this.props=s,this.listeners=new Pi(ti(n)),this.windowListeners=new Pi(dt(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(zt.Resize,this.handleCancel),this.windowListeners.add(zt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(zt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:s,onStart:n}=this.props,i=s.node.current;i&&hv(i),n(Bt)}handleKeyDown(s){if(sc(s)){const{active:n,context:i,options:r}=this.props,{keyboardCodes:a=jp,coordinateGetter:o=gv,scrollBehavior:l="smooth"}=r,{code:c}=s;if(a.end.includes(c)){this.handleEnd(s);return}if(a.cancel.includes(c)){this.handleCancel(s);return}const{collisionRect:d}=i.current,m=d?{x:d.left,y:d.top}:Bt;this.referenceCoordinates||(this.referenceCoordinates=m);const u=o(s,{active:n,context:i.current,currentCoordinates:m});if(u){const h=Gi(u,m),p={x:0,y:0},{scrollableAncestors:x}=i.current;for(const f of x){const j=s.code,{isTop:b,isRight:y,isLeft:w,isBottom:z,maxScroll:N,minScroll:S}=gp(f),k=dv(f),C={x:Math.min(j===te.Right?k.right-k.width/2:k.right,Math.max(j===te.Right?k.left:k.left+k.width/2,u.x)),y:Math.min(j===te.Down?k.bottom-k.height/2:k.bottom,Math.max(j===te.Down?k.top:k.top+k.height/2,u.y))},A=j===te.Right&&!y||j===te.Left&&!w,v=j===te.Down&&!z||j===te.Up&&!b;if(A&&C.x!==u.x){const P=f.scrollLeft+h.x,_=j===te.Right&&P<=N.x||j===te.Left&&P>=S.x;if(_&&!h.y){f.scrollTo({left:P,behavior:l});return}_?p.x=f.scrollLeft-P:p.x=j===te.Right?f.scrollLeft-N.x:f.scrollLeft-S.x,p.x&&f.scrollBy({left:-p.x,behavior:l});break}else if(v&&C.y!==u.y){const P=f.scrollTop+h.y,_=j===te.Down&&P<=N.y||j===te.Up&&P>=S.y;if(_&&!h.x){f.scrollTo({top:P,behavior:l});return}_?p.y=f.scrollTop-P:p.y=j===te.Down?f.scrollTop-N.y:f.scrollTop-S.y,p.y&&f.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(s,Ln(Gi(u,this.referenceCoordinates),p))}}}handleMove(s,n){const{onMove:i}=this.props;s.preventDefault(),i(n)}handleEnd(s){const{onEnd:n}=this.props;s.preventDefault(),this.detach(),n()}handleCancel(s){const{onCancel:n}=this.props;s.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}ic.activators=[{eventName:"onKeyDown",handler:(e,s,n)=>{let{keyboardCodes:i=jp,onActivation:r}=s,{active:a}=n;const{code:o}=e.nativeEvent;if(i.start.includes(o)){const l=a.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),r?.({event:e.nativeEvent}),!0)}return!1}}];function Ad(e){return!!(e&&"distance"in e)}function Pd(e){return!!(e&&"delay"in e)}class rc{constructor(s,n,i){var r;i===void 0&&(i=fv(s.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=s,this.events=n;const{event:a}=s,{target:o}=a;this.props=s,this.events=n,this.document=ti(o),this.documentListeners=new Pi(this.document),this.listeners=new Pi(i),this.windowListeners=new Pi(dt(o)),this.initialCoordinates=(r=il(a))!=null?r:Bt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:s,props:{options:{activationConstraint:n,bypassActivationConstraint:i}}}=this;if(this.listeners.add(s.move.name,this.handleMove,{passive:!1}),this.listeners.add(s.end.name,this.handleEnd),s.cancel&&this.listeners.add(s.cancel.name,this.handleCancel),this.windowListeners.add(zt.Resize,this.handleCancel),this.windowListeners.add(zt.DragStart,Td),this.windowListeners.add(zt.VisibilityChange,this.handleCancel),this.windowListeners.add(zt.ContextMenu,Td),this.documentListeners.add(zt.Keydown,this.handleKeydown),n){if(i!=null&&i({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Pd(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Ad(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(s,n){const{active:i,onPending:r}=this.props;r(i,s,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:s}=this,{onStart:n}=this.props;s&&(this.activated=!0,this.documentListeners.add(zt.Click,xv,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(zt.SelectionChange,this.removeTextSelection),n(s))}handleMove(s){var n;const{activated:i,initialCoordinates:r,props:a}=this,{onMove:o,options:{activationConstraint:l}}=a;if(!r)return;const c=(n=il(s))!=null?n:Bt,d=Gi(r,c);if(!i&&l){if(Ad(l)){if(l.tolerance!=null&&jo(d,l.tolerance))return this.handleCancel();if(jo(d,l.distance))return this.handleStart()}if(Pd(l)&&jo(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}s.cancelable&&s.preventDefault(),o(c)}handleEnd(){const{onAbort:s,onEnd:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleCancel(){const{onAbort:s,onCancel:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleKeydown(s){s.code===te.Esc&&this.handleCancel()}removeTextSelection(){var s;(s=this.document.getSelection())==null||s.removeAllRanges()}}const yv={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class ac extends rc{constructor(s){const{event:n}=s,i=ti(n.target);super(s,yv,i)}}ac.activators=[{eventName:"onPointerDown",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:i}=s;return!n.isPrimary||n.button!==0?!1:(i?.({event:n}),!0)}}];const jv={move:{name:"mousemove"},end:{name:"mouseup"}};var al;(function(e){e[e.RightClick=2]="RightClick"})(al||(al={}));class bv extends rc{constructor(s){super(s,jv,ti(s.event.target))}}bv.activators=[{eventName:"onMouseDown",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:i}=s;return n.button===al.RightClick?!1:(i?.({event:n}),!0)}}];const bo={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class wv extends rc{constructor(s){super(s,bo)}static setup(){return window.addEventListener(bo.move.name,s,{capture:!1,passive:!1}),function(){window.removeEventListener(bo.move.name,s)};function s(){}}}wv.activators=[{eventName:"onTouchStart",handler:(e,s)=>{let{nativeEvent:n}=e,{onActivation:i}=s;const{touches:r}=n;return r.length>1?!1:(i?.({event:n}),!0)}}];var Di;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Di||(Di={}));var ua;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ua||(ua={}));function vv(e){let{acceleration:s,activator:n=Di.Pointer,canScroll:i,draggingRect:r,enabled:a,interval:o=5,order:l=ua.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:m,delta:u,threshold:h}=e;const p=kv({delta:u,disabled:!a}),[x,f]=Iw(),j=g.useRef({x:0,y:0}),b=g.useRef({x:0,y:0}),y=g.useMemo(()=>{switch(n){case Di.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Di.DraggableRect:return r}},[n,r,c]),w=g.useRef(null),z=g.useCallback(()=>{const S=w.current;if(!S)return;const k=j.current.x*b.current.x,C=j.current.y*b.current.y;S.scrollBy(k,C)},[]),N=g.useMemo(()=>l===ua.TreeOrder?[...d].reverse():d,[l,d]);g.useEffect(()=>{if(!a||!d.length||!y){f();return}for(const S of N){if(i?.(S)===!1)continue;const k=d.indexOf(S),C=m[k];if(!C)continue;const{direction:A,speed:v}=cv(S,C,y,s,h);for(const P of["x","y"])p[P][A[P]]||(v[P]=0,A[P]=0);if(v.x>0||v.y>0){f(),w.current=S,x(z,o),j.current=v,b.current=A;return}}j.current={x:0,y:0},b.current={x:0,y:0},f()},[s,z,i,f,a,o,JSON.stringify(y),JSON.stringify(p),x,d,N,m,JSON.stringify(h)])}const Nv={x:{[Oe.Backward]:!1,[Oe.Forward]:!1},y:{[Oe.Backward]:!1,[Oe.Forward]:!1}};function kv(e){let{delta:s,disabled:n}=e;const i=nl(s);return fr(r=>{if(n||!i||!r)return Nv;const a={x:Math.sign(s.x-i.x),y:Math.sign(s.y-i.y)};return{x:{[Oe.Backward]:r.x[Oe.Backward]||a.x===-1,[Oe.Forward]:r.x[Oe.Forward]||a.x===1},y:{[Oe.Backward]:r.y[Oe.Backward]||a.y===-1,[Oe.Forward]:r.y[Oe.Forward]||a.y===1}}},[n,s,i])}function zv(e,s){const n=s!=null?e.get(s):void 0,i=n?n.node.current:null;return fr(r=>{var a;return s==null?null:(a=i??r)!=null?a:null},[i,s])}function Sv(e,s){return g.useMemo(()=>e.reduce((n,i)=>{const{sensor:r}=i,a=r.activators.map(o=>({eventName:o.eventName,handler:s(o.handler,i)}));return[...n,...a]},[]),[e,s])}var Qi;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Qi||(Qi={}));var ol;(function(e){e.Optimized="optimized"})(ol||(ol={}));const Dd=new Map;function Cv(e,s){let{dragging:n,dependencies:i,config:r}=s;const[a,o]=g.useState(null),{frequency:l,measure:c,strategy:d}=r,m=g.useRef(e),u=j(),h=Ki(u),p=g.useCallback(function(b){b===void 0&&(b=[]),!h.current&&o(y=>y===null?b:y.concat(b.filter(w=>!y.includes(w))))},[h]),x=g.useRef(null),f=fr(b=>{if(u&&!n)return Dd;if(!b||b===Dd||m.current!==e||a!=null){const y=new Map;for(let w of e){if(!w)continue;if(a&&a.length>0&&!a.includes(w.id)&&w.rect.current){y.set(w.id,w.rect.current);continue}const z=w.node.current,N=z?new nc(c(z),z):null;w.rect.current=N,N&&y.set(w.id,N)}return y}return b},[e,a,n,u,c]);return g.useEffect(()=>{m.current=e},[e]),g.useEffect(()=>{u||p()},[n,u]),g.useEffect(()=>{a&&a.length>0&&o(null)},[JSON.stringify(a)]),g.useEffect(()=>{u||typeof l!="number"||x.current!==null||(x.current=setTimeout(()=>{p(),x.current=null},l))},[l,u,p,...i]),{droppableRects:f,measureDroppableContainers:p,measuringScheduled:a!=null};function j(){switch(d){case Qi.Always:return!1;case Qi.BeforeDragging:return n;default:return!n}}}function bp(e,s){return fr(n=>e?n||(typeof s=="function"?s(e):e):null,[s,e])}function Tv(e,s){return bp(e,s)}function Av(e){let{callback:s,disabled:n}=e;const i=tc(s),r=g.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(i)},[i,n]);return g.useEffect(()=>()=>r?.disconnect(),[r]),r}function Va(e){let{callback:s,disabled:n}=e;const i=tc(s),r=g.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(i)},[n]);return g.useEffect(()=>()=>r?.disconnect(),[r]),r}function Pv(e){return new nc(si(e),e)}function _d(e,s,n){s===void 0&&(s=Pv);const[i,r]=g.useState(null);function a(){r(c=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=c??n)!=null?d:null}const m=s(e);return JSON.stringify(c)===JSON.stringify(m)?c:m})}const o=Av({callback(c){if(e)for(const d of c){const{type:m,target:u}=d;if(m==="childList"&&u instanceof HTMLElement&&u.contains(e)){a();break}}}}),l=Va({callback:a});return ns(()=>{a(),e?(l?.observe(e),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[e]),i}function Dv(e){const s=bp(e);return mp(e,s)}const Ed=[];function _v(e){const s=g.useRef(e),n=fr(i=>e?i&&i!==Ed&&e&&s.current&&e.parentNode===s.current.parentNode?i:Ba(e):Ed,[e]);return g.useEffect(()=>{s.current=e},[e]),n}function Ev(e){const[s,n]=g.useState(null),i=g.useRef(e),r=g.useCallback(a=>{const o=yo(a.target);o&&n(l=>l?(l.set(o,rl(o)),new Map(l)):null)},[]);return g.useEffect(()=>{const a=i.current;if(e!==a){o(a);const l=e.map(c=>{const d=yo(c);return d?(d.addEventListener("scroll",r,{passive:!0}),[d,rl(d)]):null}).filter(c=>c!=null);n(l.length?new Map(l):null),i.current=e}return()=>{o(e),o(a)};function o(l){l.forEach(c=>{const d=yo(c);d?.removeEventListener("scroll",r)})}},[r,e]),g.useMemo(()=>e.length?s?Array.from(s.values()).reduce((a,o)=>Ln(a,o),Bt):yp(e):Bt,[e,s])}function Id(e,s){s===void 0&&(s=[]);const n=g.useRef(null);return g.useEffect(()=>{n.current=null},s),g.useEffect(()=>{const i=e!==Bt;i&&!n.current&&(n.current=e),!i&&n.current&&(n.current=null)},[e]),n.current?Gi(e,n.current):Bt}function Iv(e){g.useEffect(()=>{if(!qa)return;const s=e.map(n=>{let{sensor:i}=n;return i.setup==null?void 0:i.setup()});return()=>{for(const n of s)n?.()}},e.map(s=>{let{sensor:n}=s;return n}))}function Mv(e,s){return g.useMemo(()=>e.reduce((n,i)=>{let{eventName:r,handler:a}=i;return n[r]=o=>{a(o,s)},n},{}),[e,s])}function wp(e){return g.useMemo(()=>e?rv(e):null,[e])}const Md=[];function Lv(e,s){s===void 0&&(s=si);const[n]=e,i=wp(n?dt(n):null),[r,a]=g.useState(Md);function o(){a(()=>e.length?e.map(c=>xp(c)?i:new nc(s(c),c)):Md)}const l=Va({callback:o});return ns(()=>{l?.disconnect(),o(),e.forEach(c=>l?.observe(c))},[e]),r}function Ov(e){if(!e)return null;if(e.children.length>1)return e;const s=e.children[0];return pr(s)?s:e}function Rv(e){let{measure:s}=e;const[n,i]=g.useState(null),r=g.useCallback(d=>{for(const{target:m}of d)if(pr(m)){i(u=>{const h=s(m);return u?{...u,width:h.width,height:h.height}:h});break}},[s]),a=Va({callback:r}),o=g.useCallback(d=>{const m=Ov(d);a?.disconnect(),m&&a?.observe(m),i(m?s(m):null)},[s,a]),[l,c]=ca(o);return g.useMemo(()=>({nodeRef:l,rect:n,setRef:c}),[n,l,c])}const Fv=[{sensor:ac,options:{}},{sensor:ic,options:{}}],$v={current:{}},Zr={draggable:{measure:Cd},droppable:{measure:Cd,strategy:Qi.WhileDragging,frequency:ol.Optimized},dragOverlay:{measure:si}};class _i extends Map{get(s){var n;return s!=null&&(n=super.get(s))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(s=>{let{disabled:n}=s;return!n})}getNodeFor(s){var n,i;return(n=(i=this.get(s))==null?void 0:i.node.current)!=null?n:void 0}}const qv={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new _i,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:da},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Zr,measureDroppableContainers:da,windowRect:null,measuringScheduled:!1},Bv={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:da,draggableNodes:new Map,over:null,measureDroppableContainers:da},Ua=g.createContext(Bv),vp=g.createContext(qv);function Vv(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new _i}}}function Uv(e,s){switch(s.type){case De.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:s.initialCoordinates,active:s.active}};case De.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:s.coordinates.x-e.draggable.initialCoordinates.x,y:s.coordinates.y-e.draggable.initialCoordinates.y}}};case De.DragEnd:case De.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case De.RegisterDroppable:{const{element:n}=s,{id:i}=n,r=new _i(e.droppable.containers);return r.set(i,n),{...e,droppable:{...e.droppable,containers:r}}}case De.SetDroppableDisabled:{const{id:n,key:i,disabled:r}=s,a=e.droppable.containers.get(n);if(!a||i!==a.key)return e;const o=new _i(e.droppable.containers);return o.set(n,{...a,disabled:r}),{...e,droppable:{...e.droppable,containers:o}}}case De.UnregisterDroppable:{const{id:n,key:i}=s,r=e.droppable.containers.get(n);if(!r||i!==r.key)return e;const a=new _i(e.droppable.containers);return a.delete(n),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function Wv(e){let{disabled:s}=e;const{active:n,activatorEvent:i,draggableNodes:r}=g.useContext(Ua),a=nl(i),o=nl(n?.id);return g.useEffect(()=>{if(!s&&!i&&a&&o!=null){if(!sc(a)||document.activeElement===a.target)return;const l=r.get(o);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const m of[c.current,d.current]){if(!m)continue;const u=Ow(m);if(u){u.focus();break}}})}},[i,s,r,o,a]),null}function Kv(e,s){let{transform:n,...i}=s;return e!=null&&e.length?e.reduce((r,a)=>a({transform:r,...i}),n):n}function Gv(e){return g.useMemo(()=>({draggable:{...Zr.draggable,...e?.draggable},droppable:{...Zr.droppable,...e?.droppable},dragOverlay:{...Zr.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Hv(e){let{activeNode:s,measure:n,initialRect:i,config:r=!0}=e;const a=g.useRef(!1),{x:o,y:l}=typeof r=="boolean"?{x:r,y:r}:r;ns(()=>{if(!o&&!l||!s){a.current=!1;return}if(a.current||!i)return;const d=s?.node.current;if(!d||d.isConnected===!1)return;const m=n(d),u=mp(m,i);if(o||(u.x=0),l||(u.y=0),a.current=!0,Math.abs(u.x)>0||Math.abs(u.y)>0){const h=hp(d);h&&h.scrollBy({top:u.y,left:u.x})}},[s,o,l,i,n])}const Np=g.createContext({...Bt,scaleX:1,scaleY:1});var Cs;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Cs||(Cs={}));const Qv=g.memo(function(s){var n,i,r,a;let{id:o,accessibility:l,autoScroll:c=!0,children:d,sensors:m=Fv,collisionDetection:u=Jw,measuring:h,modifiers:p,...x}=s;const f=g.useReducer(Uv,void 0,Vv),[j,b]=f,[y,w]=Vw(),[z,N]=g.useState(Cs.Uninitialized),S=z===Cs.Initialized,{draggable:{active:k,nodes:C,translate:A},droppable:{containers:v}}=j,P=k!=null?C.get(k):null,_=g.useRef({initial:null,translated:null}),E=g.useMemo(()=>{var Ke;return k!=null?{id:k,data:(Ke=P?.data)!=null?Ke:$v,rect:_}:null},[k,P]),D=g.useRef(null),[ee,We]=g.useState(null),[Z,J]=g.useState(null),U=Ki(x,Object.values(x)),xe=xr("DndDescribedBy",o),Ie=g.useMemo(()=>v.getEnabled(),[v]),we=Gv(h),{droppableRects:ut,measureDroppableContainers:Mt,measuringScheduled:bs}=Cv(Ie,{dragging:S,dependencies:[A.x,A.y],config:we.droppable}),Me=zv(C,k),Le=g.useMemo(()=>Z?il(Z):null,[Z]),Lt=Og(),ls=Tv(Me,we.draggable.measure);Hv({activeNode:k!=null?C.get(k):null,config:Lt.layoutShiftCompensation,initialRect:ls,measure:we.draggable.measure});const re=_d(Me,we.draggable.measure,ls),fi=_d(Me?Me.parentElement:null),Kt=g.useRef({activatorEvent:null,active:null,activeNode:Me,collisionRect:null,collisions:null,droppableRects:ut,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:v,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),fn=v.getNodeFor((n=Kt.current.over)==null?void 0:n.id),cs=Rv({measure:we.dragOverlay.measure}),xn=(i=cs.nodeRef.current)!=null?i:Me,gn=S?(r=cs.rect)!=null?r:re:null,ad=!!(cs.nodeRef.current&&cs.rect),od=Dv(ad?null:re),uo=wp(xn?dt(xn):null),ws=_v(S?fn??Me:null),Dr=Lv(ws),_r=Kv(p,{transform:{x:A.x-od.x,y:A.y-od.y,scaleX:1,scaleY:1},activatorEvent:Z,active:E,activeNodeRect:re,containerNodeRect:fi,draggingNodeRect:gn,over:Kt.current.over,overlayNodeRect:cs.rect,scrollableAncestors:ws,scrollableAncestorRects:Dr,windowRect:uo}),ld=Le?Ln(Le,A):null,cd=Ev(ws),Pg=Id(cd),Dg=Id(cd,[re]),yn=Ln(_r,Pg),jn=gn?tv(gn,_r):null,xi=E&&jn?u({active:E,collisionRect:jn,droppableRects:ut,droppableContainers:Ie,pointerCoordinates:ld}):null,dd=up(xi,"id"),[vs,ud]=g.useState(null),_g=ad?_r:Ln(_r,Dg),Eg=Xw(_g,(a=vs?.rect)!=null?a:null,re),mo=g.useRef(null),md=g.useCallback((Ke,mt)=>{let{sensor:ht,options:Ns}=mt;if(D.current==null)return;const wt=C.get(D.current);if(!wt)return;const pt=Ke.nativeEvent,Gt=new ht({active:D.current,activeNode:wt,event:pt,options:Ns,context:Kt,onAbort($e){if(!C.get($e))return;const{onDragAbort:Ht}=U.current,ds={id:$e};Ht?.(ds),y({type:"onDragAbort",event:ds})},onPending($e,ks,Ht,ds){if(!C.get($e))return;const{onDragPending:yi}=U.current,zs={id:$e,constraint:ks,initialCoordinates:Ht,offset:ds};yi?.(zs),y({type:"onDragPending",event:zs})},onStart($e){const ks=D.current;if(ks==null)return;const Ht=C.get(ks);if(!Ht)return;const{onDragStart:ds}=U.current,gi={activatorEvent:pt,active:{id:ks,data:Ht.data,rect:_}};ki.unstable_batchedUpdates(()=>{ds?.(gi),N(Cs.Initializing),b({type:De.DragStart,initialCoordinates:$e,active:ks}),y({type:"onDragStart",event:gi}),We(mo.current),J(pt)})},onMove($e){b({type:De.DragMove,coordinates:$e})},onEnd:bn(De.DragEnd),onCancel:bn(De.DragCancel)});mo.current=Gt;function bn($e){return async function(){const{active:Ht,collisions:ds,over:gi,scrollAdjustedTranslate:yi}=Kt.current;let zs=null;if(Ht&&yi){const{cancelDrop:ji}=U.current;zs={activatorEvent:pt,active:Ht,collisions:ds,delta:yi,over:gi},$e===De.DragEnd&&typeof ji=="function"&&await Promise.resolve(ji(zs))&&($e=De.DragCancel)}D.current=null,ki.unstable_batchedUpdates(()=>{b({type:$e}),N(Cs.Uninitialized),ud(null),We(null),J(null),mo.current=null;const ji=$e===De.DragEnd?"onDragEnd":"onDragCancel";if(zs){const ho=U.current[ji];ho?.(zs),y({type:ji,event:zs})}})}}},[C]),Ig=g.useCallback((Ke,mt)=>(ht,Ns)=>{const wt=ht.nativeEvent,pt=C.get(Ns);if(D.current!==null||!pt||wt.dndKit||wt.defaultPrevented)return;const Gt={active:pt};Ke(ht,mt.options,Gt)===!0&&(wt.dndKit={capturedBy:mt.sensor},D.current=Ns,md(ht,mt))},[C,md]),hd=Sv(m,Ig);Iv(m),ns(()=>{re&&z===Cs.Initializing&&N(Cs.Initialized)},[re,z]),g.useEffect(()=>{const{onDragMove:Ke}=U.current,{active:mt,activatorEvent:ht,collisions:Ns,over:wt}=Kt.current;if(!mt||!ht)return;const pt={active:mt,activatorEvent:ht,collisions:Ns,delta:{x:yn.x,y:yn.y},over:wt};ki.unstable_batchedUpdates(()=>{Ke?.(pt),y({type:"onDragMove",event:pt})})},[yn.x,yn.y]),g.useEffect(()=>{const{active:Ke,activatorEvent:mt,collisions:ht,droppableContainers:Ns,scrollAdjustedTranslate:wt}=Kt.current;if(!Ke||D.current==null||!mt||!wt)return;const{onDragOver:pt}=U.current,Gt=Ns.get(dd),bn=Gt&&Gt.rect.current?{id:Gt.id,rect:Gt.rect.current,data:Gt.data,disabled:Gt.disabled}:null,$e={active:Ke,activatorEvent:mt,collisions:ht,delta:{x:wt.x,y:wt.y},over:bn};ki.unstable_batchedUpdates(()=>{ud(bn),pt?.($e),y({type:"onDragOver",event:$e})})},[dd]),ns(()=>{Kt.current={activatorEvent:Z,active:E,activeNode:Me,collisionRect:jn,collisions:xi,droppableRects:ut,draggableNodes:C,draggingNode:xn,draggingNodeRect:gn,droppableContainers:v,over:vs,scrollableAncestors:ws,scrollAdjustedTranslate:yn},_.current={initial:gn,translated:jn}},[E,Me,xi,jn,C,xn,gn,ut,v,vs,ws,yn]),vv({...Lt,delta:A,draggingRect:jn,pointerCoordinates:ld,scrollableAncestors:ws,scrollableAncestorRects:Dr});const Mg=g.useMemo(()=>({active:E,activeNode:Me,activeNodeRect:re,activatorEvent:Z,collisions:xi,containerNodeRect:fi,dragOverlay:cs,draggableNodes:C,droppableContainers:v,droppableRects:ut,over:vs,measureDroppableContainers:Mt,scrollableAncestors:ws,scrollableAncestorRects:Dr,measuringConfiguration:we,measuringScheduled:bs,windowRect:uo}),[E,Me,re,Z,xi,fi,cs,C,v,ut,vs,Mt,ws,Dr,we,bs,uo]),Lg=g.useMemo(()=>({activatorEvent:Z,activators:hd,active:E,activeNodeRect:re,ariaDescribedById:{draggable:xe},dispatch:b,draggableNodes:C,over:vs,measureDroppableContainers:Mt}),[Z,hd,E,re,b,xe,C,vs,Mt]);return L.createElement(lp.Provider,{value:w},L.createElement(Ua.Provider,{value:Lg},L.createElement(vp.Provider,{value:Mg},L.createElement(Np.Provider,{value:Eg},d)),L.createElement(Wv,{disabled:l?.restoreFocus===!1})),L.createElement(Kw,{...l,hiddenTextDescribedById:xe}));function Og(){const Ke=ee?.autoScrollEnabled===!1,mt=typeof c=="object"?c.enabled===!1:c===!1,ht=S&&!Ke&&!mt;return typeof c=="object"?{...c,enabled:ht}:{enabled:ht}}}),Zv=g.createContext(null),Ld="button",Yv="Draggable";function Jv(e){let{id:s,data:n,disabled:i=!1,attributes:r}=e;const a=xr(Yv),{activators:o,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:m,draggableNodes:u,over:h}=g.useContext(Ua),{role:p=Ld,roleDescription:x="draggable",tabIndex:f=0}=r??{},j=c?.id===s,b=g.useContext(j?Np:Zv),[y,w]=ca(),[z,N]=ca(),S=Mv(o,s),k=Ki(n);ns(()=>(u.set(s,{id:s,key:a,node:y,activatorNode:z,data:k}),()=>{const A=u.get(s);A&&A.key===a&&u.delete(s)}),[u,s]);const C=g.useMemo(()=>({role:p,tabIndex:f,"aria-disabled":i,"aria-pressed":j&&p===Ld?!0:void 0,"aria-roledescription":x,"aria-describedby":m.draggable}),[i,p,f,j,x,m.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:C,isDragging:j,listeners:i?void 0:S,node:y,over:h,setNodeRef:w,setActivatorNodeRef:N,transform:b}}function Xv(){return g.useContext(vp)}const e0="Droppable",t0={timeout:25};function s0(e){let{data:s,disabled:n=!1,id:i,resizeObserverConfig:r}=e;const a=xr(e0),{active:o,dispatch:l,over:c,measureDroppableContainers:d}=g.useContext(Ua),m=g.useRef({disabled:n}),u=g.useRef(!1),h=g.useRef(null),p=g.useRef(null),{disabled:x,updateMeasurementsFor:f,timeout:j}={...t0,...r},b=Ki(f??i),y=g.useCallback(()=>{if(!u.current){u.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{d(Array.isArray(b.current)?b.current:[b.current]),p.current=null},j)},[j]),w=Va({callback:y,disabled:x||!o}),z=g.useCallback((C,A)=>{w&&(A&&(w.unobserve(A),u.current=!1),C&&w.observe(C))},[w]),[N,S]=ca(z),k=Ki(s);return g.useEffect(()=>{!w||!N.current||(w.disconnect(),u.current=!1,w.observe(N.current))},[N,w]),g.useEffect(()=>(l({type:De.RegisterDroppable,element:{id:i,key:a,disabled:n,node:N,rect:h,data:k}}),()=>l({type:De.UnregisterDroppable,key:a,id:i})),[i]),g.useEffect(()=>{n!==m.current.disabled&&(l({type:De.SetDroppableDisabled,id:i,key:a,disabled:n}),m.current.disabled=n)},[i,a,n,l]),{active:o,rect:h,isOver:c?.id===i,node:N,over:c,setNodeRef:S}}function oc(e,s,n){const i=e.slice();return i.splice(n<0?i.length+n:n,0,i.splice(s,1)[0]),i}function n0(e,s){return e.reduce((n,i,r)=>{const a=s.get(i);return a&&(n[r]=a),n},Array(e.length))}function Or(e){return e!==null&&e>=0}function i0(e,s){if(e===s)return!0;if(e.length!==s.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==s[n])return!1;return!0}function r0(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const kp=e=>{let{rects:s,activeIndex:n,overIndex:i,index:r}=e;const a=oc(s,i,n),o=s[r],l=a[r];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},Rr={scaleX:1,scaleY:1},a0=e=>{var s;let{activeIndex:n,activeNodeRect:i,index:r,rects:a,overIndex:o}=e;const l=(s=a[n])!=null?s:i;if(!l)return null;if(r===n){const d=a[o];return d?{x:0,y:n<o?d.top+d.height-(l.top+l.height):d.top-l.top,...Rr}:null}const c=o0(a,r,n);return r>n&&r<=o?{x:0,y:-l.height-c,...Rr}:r<n&&r>=o?{x:0,y:l.height+c,...Rr}:{x:0,y:0,...Rr}};function o0(e,s,n){const i=e[s],r=e[s-1],a=e[s+1];return i?n<s?r?i.top-(r.top+r.height):a?a.top-(i.top+i.height):0:a?a.top-(i.top+i.height):r?i.top-(r.top+r.height):0:0}const zp="Sortable",Sp=L.createContext({activeIndex:-1,containerId:zp,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:kp,disabled:{draggable:!1,droppable:!1}});function l0(e){let{children:s,id:n,items:i,strategy:r=kp,disabled:a=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:m}=Xv(),u=xr(zp,n),h=l.rect!==null,p=g.useMemo(()=>i.map(S=>typeof S=="object"&&"id"in S?S.id:S),[i]),x=o!=null,f=o?p.indexOf(o.id):-1,j=d?p.indexOf(d.id):-1,b=g.useRef(p),y=!i0(p,b.current),w=j!==-1&&f===-1||y,z=r0(a);ns(()=>{y&&x&&m(p)},[y,p,x,m]),g.useEffect(()=>{b.current=p},[p]);const N=g.useMemo(()=>({activeIndex:f,containerId:u,disabled:z,disableTransforms:w,items:p,overIndex:j,useDragOverlay:h,sortedRects:n0(p,c),strategy:r}),[f,u,z.draggable,z.droppable,w,p,j,c,h,r]);return L.createElement(Sp.Provider,{value:N},s)}const c0=e=>{let{id:s,items:n,activeIndex:i,overIndex:r}=e;return oc(n,i,r).indexOf(s)},d0=e=>{let{containerId:s,isSorting:n,wasDragging:i,index:r,items:a,newIndex:o,previousItems:l,previousContainerId:c,transition:d}=e;return!d||!i||l!==a&&r===o?!1:n?!0:o!==r&&s===c},u0={duration:200,easing:"ease"},Cp="transform",m0=Hi.Transition.toString({property:Cp,duration:0,easing:"linear"}),h0={roleDescription:"sortable"};function p0(e){let{disabled:s,index:n,node:i,rect:r}=e;const[a,o]=g.useState(null),l=g.useRef(n);return ns(()=>{if(!s&&n!==l.current&&i.current){const c=r.current;if(c){const d=si(i.current,{ignoreTransform:!0}),m={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(m.x||m.y)&&o(m)}}n!==l.current&&(l.current=n)},[s,n,i,r]),g.useEffect(()=>{a&&o(null)},[a]),a}function f0(e){let{animateLayoutChanges:s=d0,attributes:n,disabled:i,data:r,getNewIndex:a=c0,id:o,strategy:l,resizeObserverConfig:c,transition:d=u0}=e;const{items:m,containerId:u,activeIndex:h,disabled:p,disableTransforms:x,sortedRects:f,overIndex:j,useDragOverlay:b,strategy:y}=g.useContext(Sp),w=x0(i,p),z=m.indexOf(o),N=g.useMemo(()=>({sortable:{containerId:u,index:z,items:m},...r}),[u,r,z,m]),S=g.useMemo(()=>m.slice(m.indexOf(o)),[m,o]),{rect:k,node:C,isOver:A,setNodeRef:v}=s0({id:o,data:N,disabled:w.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...c}}),{active:P,activatorEvent:_,activeNodeRect:E,attributes:D,setNodeRef:ee,listeners:We,isDragging:Z,over:J,setActivatorNodeRef:U,transform:xe}=Jv({id:o,data:N,attributes:{...h0,...n},disabled:w.draggable}),Ie=Ew(v,ee),we=!!P,ut=we&&!x&&Or(h)&&Or(j),Mt=!b&&Z,bs=Mt&&ut?xe:null,Le=ut?bs??(l??y)({rects:f,activeNodeRect:E,activeIndex:h,overIndex:j,index:z}):null,Lt=Or(h)&&Or(j)?a({id:o,items:m,activeIndex:h,overIndex:j}):z,ls=P?.id,re=g.useRef({activeId:ls,items:m,newIndex:Lt,containerId:u}),fi=m!==re.current.items,Kt=s({active:P,containerId:u,isDragging:Z,isSorting:we,id:o,index:z,items:m,newIndex:re.current.newIndex,previousItems:re.current.items,previousContainerId:re.current.containerId,transition:d,wasDragging:re.current.activeId!=null}),fn=p0({disabled:!Kt,index:z,node:C,rect:k});return g.useEffect(()=>{we&&re.current.newIndex!==Lt&&(re.current.newIndex=Lt),u!==re.current.containerId&&(re.current.containerId=u),m!==re.current.items&&(re.current.items=m)},[we,Lt,u,m]),g.useEffect(()=>{if(ls===re.current.activeId)return;if(ls!=null&&re.current.activeId==null){re.current.activeId=ls;return}const xn=setTimeout(()=>{re.current.activeId=ls},50);return()=>clearTimeout(xn)},[ls]),{active:P,activeIndex:h,attributes:D,data:N,rect:k,index:z,newIndex:Lt,items:m,isOver:A,isSorting:we,isDragging:Z,listeners:We,node:C,overIndex:j,over:J,setNodeRef:Ie,setActivatorNodeRef:U,setDroppableNodeRef:v,setDraggableNodeRef:ee,transform:fn??Le,transition:cs()};function cs(){if(fn||fi&&re.current.newIndex===z)return m0;if(!(Mt&&!sc(_)||!d)&&(we||Kt))return Hi.Transition.toString({...d,property:Cp})}}function x0(e,s){var n,i;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:s.draggable,droppable:(i=e?.droppable)!=null?i:s.droppable}}function ma(e){if(!e)return!1;const s=e.data.current;return!!(s&&"sortable"in s&&typeof s.sortable=="object"&&"containerId"in s.sortable&&"items"in s.sortable&&"index"in s.sortable)}const g0=[te.Down,te.Right,te.Up,te.Left],y0=(e,s)=>{let{context:{active:n,collisionRect:i,droppableRects:r,droppableContainers:a,over:o,scrollableAncestors:l}}=s;if(g0.includes(e.code)){if(e.preventDefault(),!n||!i)return;const c=[];a.getEnabled().forEach(u=>{if(!u||u!=null&&u.disabled)return;const h=r.get(u.id);if(h)switch(e.code){case te.Down:i.top<h.top&&c.push(u);break;case te.Up:i.top>h.top&&c.push(u);break;case te.Left:i.left>h.left&&c.push(u);break;case te.Right:i.left<h.left&&c.push(u);break}});const d=Zw({collisionRect:i,droppableRects:r,droppableContainers:c});let m=up(d,"id");if(m===o?.id&&d.length>1&&(m=d[1].id),m!=null){const u=a.get(n.id),h=a.get(m),p=h?r.get(h.id):null,x=h?.node.current;if(x&&p&&u&&h){const j=Ba(x).some((S,k)=>l[k]!==S),b=Tp(u,h),y=j0(u,h),w=j||!b?{x:0,y:0}:{x:y?i.width-p.width:0,y:y?i.height-p.height:0},z={x:p.left,y:p.top};return w.x&&w.y?z:Gi(z,w)}}}};function Tp(e,s){return!ma(e)||!ma(s)?!1:e.data.current.sortable.containerId===s.data.current.sortable.containerId}function j0(e,s){return!ma(e)||!ma(s)||!Tp(e,s)?!1:e.data.current.sortable.index<s.data.current.sortable.index}const b0=()=>t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),w0=({course:e,topicsCount:s,activitiesCount:n,accessCount:i})=>t.jsxs(be,{variant:"2-2-4",children:[t.jsxs(I,{children:[t.jsx(V,{className:"pb-2",children:t.jsx(q,{className:"text-sm font-medium",children:"Status"})}),t.jsx(M,{children:t.jsx(ne,{variant:e?.is_published?"default":"secondary",children:e?.is_published?"Opublikowany":"Szkic"})})]}),t.jsxs(I,{children:[t.jsx(V,{className:"pb-2",children:t.jsx(q,{className:"text-sm font-medium",children:"Tematy"})}),t.jsx(M,{children:t.jsx("div",{className:"text-2xl font-bold",children:s})})]}),t.jsxs(I,{children:[t.jsx(V,{className:"pb-2",children:t.jsx(q,{className:"text-sm font-medium",children:"Aktywności"})}),t.jsx(M,{children:t.jsx("div",{className:"text-2xl font-bold",children:n})})]}),t.jsxs(I,{children:[t.jsx(V,{className:"pb-2",children:t.jsx(q,{className:"text-sm font-medium",children:"Uczestników"})}),t.jsx(M,{children:t.jsx("div",{className:"text-2xl font-bold",children:i})})]})]}),v0=({id:e,disabled:s=!1,children:n})=>{const{attributes:i,listeners:r,setNodeRef:a,transform:o,transition:l,isDragging:c}=f0({id:e,disabled:s}),d={transform:Hi.Transform.toString(o),transition:l,opacity:c?.5:1,cursor:c?"grabbing":"grab"},m=s?{}:{...i,...r,style:{cursor:c?"grabbing":"grab"}};return t.jsx("div",{ref:a,style:d,className:c?"z-50":"",children:n({dragHandleProps:m,isDragging:c})})},Od=({items:e,renderItem:s,onReorder:n,className:i="space-y-2",disabled:r=!1})=>{const[a,o]=g.useState(e),[l,c]=g.useState(null),[d,m]=g.useState(null);g.useEffect(()=>{if(!d)o(e);else{const x=a.map(f=>{const j=e.find(b=>b.id===f.id);return j?{...j,position:f.position}:f});o(x)}},[e]);const u=Gw(kd(ac,{activationConstraint:{distance:8}}),kd(ic,{coordinateGetter:y0})),h=x=>{c(Number(x.active.id))},p=x=>{const{active:f,over:j}=x;if(c(null),j&&f.id!==j.id){const b=a.findIndex(w=>w.id===Number(f.id)),y=a.findIndex(w=>w.id===Number(j.id));if(b!==-1&&y!==-1&&b!==y){let w;const z=a[b];if(y===0)w=a[0].position/2;else if(y===a.length-1)w=a[a.length-1].position+1e3;else if(b<y){const k=a[y],C=y+1<a.length?a[y+1]:null;C?w=(k.position+C.position)/2:w=k.position+1e3}else{const k=y>0?a[y-1]:null,C=a[y];k?w=(k.position+C.position)/2:w=C.position/2}const S=oc(a,b,y).map(k=>k.id===z.id?{...k,position:w}:k);o(S),m({id:z.id,position:w}),n(z.id,w),setTimeout(()=>m(null),2e3)}}};return t.jsx(Qv,{sensors:u,collisionDetection:Qw,onDragStart:h,onDragEnd:p,children:t.jsx(l0,{items:a.map(x=>x.id),strategy:a0,children:t.jsx("div",{className:i,children:a.map((x,f)=>t.jsx(v0,{id:x.id,disabled:r||d!==null&&d.id!==x.id,children:j=>s(x,f,j.dragHandleProps)},x.id))})})})},N0=()=>{const{list:e,edit:s}=Ue(),{id:n}=tt(),[i,r]=ar(),{navigateWithReturn:a,navigateToWizard:o}=Nw(),{course:l,topics:c,stats:d,isLoading:m,refetchTopics:u,refetchActivities:h,getActivitiesForTopic:p}=kw(n),{togglePublish:x}=sl("topics"),{togglePublish:f}=sl("activities"),{updatePosition:j,isUpdating:b}=vd("topics"),{updatePosition:y,isUpdating:w}=vd("activities"),{mutate:z}=qn(),{mutate:N}=qn(),S=i.get("expanded");if(m)return t.jsx(b0,{});if(!l)return t.jsx(W,{children:t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-muted-foreground",children:"Nie znaleziono kursu"})})});const k=_=>{S===_.toString()?(i.delete("expanded"),r(i)):r({expanded:_.toString()})},C=(_,E)=>{confirm(`Czy na pewno chcesz usunąć temat "${E}" wraz ze wszystkimi aktywnościami?`)&&z({resource:"topics",id:_},{onSuccess:()=>{$.success("Temat został usunięty"),u(),h(),S===_.toString()&&(i.delete("expanded"),r(i))}})},A=(_,E)=>{confirm(`Czy na pewno chcesz usunąć aktywność "${E}"?`)&&N({resource:"activities",id:_},{onSuccess:()=>{$.success("Aktywność została usunięta"),h(),u()}})},v=async(_,E)=>{try{await j(_,E)}catch(D){console.error("Failed to reorder topic:",D)}},P=async(_,E)=>{try{await y(_,E)}catch(D){console.error("Failed to reorder activity:",D)}};return t.jsxs(W,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("courses"),children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Szczegóły kursu"}),t.jsxs(T,{onClick:()=>s("courses",l?.id??0),size:"sm",children:[t.jsx(Vt,{className:"w-4 h-4 mr-2"}),"Edytuj kurs"]})]}),t.jsx(_w,{course:l})]}),t.jsx(w0,{course:l,topicsCount:d.topicsCount,activitiesCount:d.activitiesCount,accessCount:d.accessCount}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsxs(R,{children:[t.jsxs(q,{className:"flex items-center gap-2",children:["Struktura kursu",(b||w)&&t.jsxs("span",{className:"text-sm font-normal text-muted-foreground flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Zapisywanie..."]})]}),t.jsxs(T,{size:"sm",onClick:()=>a(`/topics/create?course_id=${n}`),children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Dodaj temat"]})]})}),t.jsx(M,{children:c.length>0?t.jsx(Od,{items:c,onReorder:v,disabled:b||w,renderItem:(_,E,D)=>{const ee=p(_.id),We=S===_.id.toString();return t.jsx(Pw,{topic:{..._,position:E+1},isExpanded:We,onToggle:()=>k(_.id),onDelete:C,onEdit:(Z,J)=>a(`/${Z}/edit/${J}`),onTogglePublish:(Z,J,U)=>x(Z,J,U,u),activitiesCount:ee.length,onNavigateToWizard:o,courseId:Number(l?.id),courseTitle:l?.title,dragHandleProps:D,children:ee.length>0?t.jsx(Od,{items:ee,onReorder:P,disabled:w,renderItem:(Z,J,U)=>t.jsx(Dw,{activity:{...Z,position:J+1},topicPosition:E+1,onDelete:A,onEdit:(xe,Ie)=>a(`/${xe}/edit/${Ie}`),onTogglePublish:(xe,Ie,we)=>f(xe,Ie,we,h),dragHandleProps:U},Z.id)}):t.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[t.jsx("p",{children:"Brak aktywności w tym temacie"}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center mt-4",children:[t.jsxs(T,{size:"sm",variant:"outline",onClick:()=>a(`/activities/create?topic_id=${_.id}`),children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Dodaj ręcznie"]}),t.jsxs(T,{size:"sm",onClick:()=>o("/educational-material/step1",{courseId:l?.id,courseTitle:l?.title,topicId:_.id,topicTitle:_.title}),children:[t.jsx(Ps,{className:"w-4 h-4 mr-2"}),"Generuj materiał z AI"]}),t.jsxs(T,{size:"sm",variant:"secondary",onClick:()=>o("/quiz-wizard/step1",{courseId:l?.id,courseTitle:l?.title,topicId:_.id,topicTitle:_.title}),children:[t.jsx(Vn,{className:"w-4 h-4 mr-2"}),"Generuj quiz z AI"]})]})]})},_.id)}}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(et,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Brak tematów w tym kursie"}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center mt-4",children:[t.jsxs(T,{onClick:()=>a(`/topics/create?course_id=${n}`),children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Dodaj pierwszy temat"]}),t.jsxs(T,{variant:"secondary",onClick:()=>o("/course-structure/step1",{courseId:l?.id,courseTitle:l?.title,mode:"extend"}),children:[t.jsx(en,{className:"w-4 h-4 mr-2"}),"Wygeneruj strukturę z AI"]})]})]})})]}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Grupy z dostępem"})}),t.jsx(M,{children:t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(He,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Lista grup (do implementacji)"})]})})]}),t.jsxs(I,{className:"border-dashed border-2 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-950/20 dark:to-blue-950/20",children:[t.jsx(V,{children:t.jsxs(q,{className:"flex items-center gap-2",children:[t.jsx(Ps,{className:"w-5 h-5 text-purple-600"}),"Szybkie akcje AI"]})}),t.jsx(M,{children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[t.jsx(T,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white dark:bg-background",onClick:()=>o("/course-structure/step1"),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(en,{className:"w-5 h-5 text-indigo-600 mt-0.5"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:"Rozbuduj strukturę kursu"}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"Dodaj nowe tematy z AI"})]})]})}),t.jsx(T,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white dark:bg-background",onClick:()=>o("/educational-material/step1",{courseId:l?.id,courseTitle:l?.title}),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(_a,{className:"w-5 h-5 text-purple-600 mt-0.5"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:"Generuj materiał"}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"Stwórz treści z AI"})]})]})}),t.jsx(T,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white dark:bg-background",onClick:()=>o("/quiz-wizard/step1",{courseId:l?.id,courseTitle:l?.title}),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(Vn,{className:"w-5 h-5 text-blue-600 mt-0.5"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:"Stwórz quiz"}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"Quiz sprawdzający z AI"})]})]})})]})})]})]})},k0={name:"courses",list:"/courses",create:"/courses/create",edit:"/courses/edit/:id",show:"/courses/show/:id",meta:{label:"Kursy",icon:t.jsx(Ee,{className:"h-4 w-4"})}},z0=[t.jsx(F,{path:"/courses",element:t.jsx(zw,{})},"courses-list"),t.jsx(F,{path:"/courses/create",element:t.jsx(Cw,{})},"courses-create"),t.jsx(F,{path:"/courses/edit/:id",element:t.jsx(Aw,{})},"courses-edit"),t.jsx(F,{path:"/courses/show/:id",element:t.jsx(N0,{})},"courses-show")],S0=()=>{const{show:e}=Ue(),s=H(),[n]=ar(),i=n.get("course_id"),{data:r}=Fe({resource:"courses",id:i,queryOptions:{enabled:!!i}}),{data:a,isLoading:o}=_e({resource:"topics",filters:[{field:"course_id",operator:"eq",value:i}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!i}}),{refineCore:{onFinish:l},register:c,handleSubmit:d,setValue:m,watch:u,formState:{errors:h,isSubmitting:p}}=rs({defaultValues:{course_id:i?parseInt(i):void 0,is_published:!1,position:1},refineCoreProps:{successNotification:()=>({message:"Temat został utworzony",type:"success"}),redirect:!1,onMutationSuccess:()=>{i?e("courses",i):s("/courses")}}});g.useEffect(()=>{if(!o&&a&&a.data.length>0){const f=a.data[0].position+1;m("position",f)}},[a,o,m]);const x=()=>{i?e("courses",i):s("/courses")};return t.jsxs(W,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:x,children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do kursu"]}),t.jsx(R,{children:t.jsx(ie,{title:"Dodaj temat",description:r?.data?`Do kursu: ${r.data.title}`:"Utwórz nowy temat"})}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Informacje o temacie"})}),t.jsx(M,{children:t.jsxs(Et,{onSubmit:d(l),children:[t.jsx("input",{type:"hidden",...c("course_id")}),t.jsx(G,{label:"Tytuł tematu",htmlFor:"title",error:h.title?.message,required:!0,children:t.jsx(B,{id:"title",placeholder:"np. Wprowadzenie do zmiennych",...c("title",{required:"Tytuł tematu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),t.jsx(G,{label:"Pozycja",htmlFor:"position",error:h.position?.message,required:!0,children:t.jsx(B,{id:"position",type:"number",min:"1",disabled:!0,className:"bg-muted",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),t.jsx(G,{label:"Status publikacji",children:t.jsxs(R,{variant:"start",children:[t.jsx(Ut,{checked:u("is_published")||!1,onCheckedChange:f=>m("is_published",f)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj temat od razu"})]})}),t.jsxs(It,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:x,children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:p||!i,children:p?"Tworzenie...":"Utwórz temat"})]})]})})]})]})},ln=({variant:e="outline",size:s="sm",children:n="Powrót do kursu"})=>{const i=H(),r=ka(),a=()=>{const l=new URLSearchParams(r.search).get("returnUrl");i(l?decodeURIComponent(l):-1)};return t.jsxs(T,{variant:e,size:s,onClick:a,children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),n]})},C0=()=>{const{show:e}=Ue(),{id:s}=tt(),n=H(),{data:i,isLoading:r}=Fe({resource:"topics",id:s,liveMode:"off"}),a=i?.data,o=a?.course_id,{refineCore:{onFinish:l},register:c,handleSubmit:d,setValue:m,watch:u,formState:{errors:h,isSubmitting:p}}=rs({refineCoreProps:{resource:"topics",id:s,liveMode:"off",successNotification:()=>({message:"Temat został zaktualizowany",type:"success"}),redirect:!1,onMutationSuccess:()=>{const f=sessionStorage.getItem("returnUrl");f?(sessionStorage.removeItem("returnUrl"),n(f)):o&&n(`/courses/show/${o}?expanded=${s}`)}}}),x=()=>{const f=sessionStorage.getItem("returnUrl");f?(sessionStorage.removeItem("returnUrl"),n(f)):o?n(`/courses/show/${o}?expanded=${s}`):e("courses","")};return r?t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):t.jsxs(W,{children:[t.jsx(ln,{}),t.jsx(R,{children:t.jsx(ie,{title:"Edytuj temat",description:`Edycja: ${a?.title}`})}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Informacje o temacie"})}),t.jsx(M,{children:t.jsxs(Et,{onSubmit:d(l),children:[t.jsx(G,{label:"Tytuł tematu",htmlFor:"title",error:h.title?.message,required:!0,children:t.jsx(B,{id:"title",placeholder:"np. Wprowadzenie do zmiennych",...c("title",{required:"Tytuł tematu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),t.jsx(G,{label:"Pozycja",htmlFor:"position",error:h.position?.message,required:!0,children:t.jsx(B,{id:"position",type:"number",min:"1",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),t.jsx(G,{label:"Status publikacji",children:t.jsxs(R,{variant:"start",children:[t.jsx(Ut,{checked:u("is_published")||!1,onCheckedChange:f=>m("is_published",f)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Temat jest opublikowany"})]})}),t.jsxs(It,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:x,children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:p,children:p?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},T0={name:"topics",create:"/topics/create",edit:"/topics/edit/:id",meta:{label:"Tematy",icon:t.jsx(et,{className:"h-4 w-4"})}},A0=[t.jsx(F,{path:"/topics/create",element:t.jsx(S0,{})},"topics-create"),t.jsx(F,{path:"/topics/edit/:id",element:t.jsx(C0,{})},"topics-edit")],P0=()=>{const{show:e}=Ue(),s=H(),[n]=ar(),i=n.get("topic_id"),{data:r}=Fe({resource:"topics",id:i,meta:{select:"*, courses(*)"},queryOptions:{enabled:!!i}}),{data:a,isLoading:o}=_e({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:i}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!i}}),{refineCore:{onFinish:l},register:c,handleSubmit:d,setValue:m,watch:u,formState:{errors:h,isSubmitting:p}}=rs({defaultValues:{topic_id:i?parseInt(i):void 0,type:"material",is_published:!1,position:1,passing_score:70},refineCoreProps:{successNotification:!1,redirect:!1,onMutationSuccess:j=>{const b=r?.data?.course_id,y=j.data.type;if($.success("Aktywność została utworzona"),y==="quiz")$.info("Dodaj pytania do quizu"),s(`/questions/manage/${j.data.id}`);else{const w=sessionStorage.getItem("returnUrl");w?(sessionStorage.removeItem("returnUrl"),s(w)):s(b?`/courses/show/${b}?expanded=${i}`:"/courses")}}}}),x=u("type");g.useEffect(()=>{if(!o&&a&&a.data.length>0){const j=a.data[0].position+1;m("position",j)}},[a,o,m]);const f=()=>{const j=sessionStorage.getItem("returnUrl");j?(sessionStorage.removeItem("returnUrl"),s(j)):r?.data?.course_id?s(`/courses/show/${r.data.course_id}?expanded=${i}`):s("/courses")};return r?.data?.course_id,i?t.jsxs(W,{children:[t.jsx(ln,{}),t.jsx(R,{children:t.jsx(ie,{title:"Dodaj aktywność",description:r?.data?t.jsxs("div",{children:[t.jsx("div",{className:"text-lg",children:r.data.courses?.title}),t.jsxs("div",{className:"text-sm text-muted-foreground",children:["Temat ",r.data.position,": ",r.data.title]})]}):"Utwórz nowy materiał lub quiz"})}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Informacje o aktywności"})}),t.jsx(M,{children:t.jsxs(Et,{onSubmit:d(l),children:[t.jsx("input",{type:"hidden",...c("topic_id")}),t.jsxs(be,{variant:"1-2-2",children:[t.jsx(G,{label:"Typ aktywności",error:h.type?.message,required:!0,children:t.jsxs(Te,{value:x,onValueChange:j=>m("type",j),children:[t.jsx(Ne,{children:t.jsx(Ae,{placeholder:"Wybierz typ"})}),t.jsxs(ke,{children:[t.jsx(K,{value:"material",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(et,{className:"w-4 h-4"}),"Materiał"]})}),t.jsx(K,{value:"quiz",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ct,{className:"w-4 h-4"}),"Quiz"]})})]})]})}),t.jsx(G,{label:"Tytuł",htmlFor:"title",error:h.title?.message,required:!0,children:t.jsx(B,{id:"title",placeholder:x==="quiz"?"np. Test wiedzy z rozdziału":"np. Wprowadzenie do tematu",...c("title",{required:"Tytuł jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),t.jsx(G,{label:"Pozycja w temacie",htmlFor:"position",error:h.position?.message,required:!0,children:t.jsx(B,{id:"position",type:"number",min:"1",disabled:!0,className:"bg-muted",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),t.jsx(G,{label:"Czas trwania (min)",htmlFor:"duration_min",hint:"Szacowany czas potrzebny na ukończenie",children:t.jsx(B,{id:"duration_min",type:"number",min:"1",placeholder:"np. 15",...c("duration_min",{min:{value:1,message:"Czas musi być większy od 0"},valueAsNumber:!0})})})]}),x==="material"&&t.jsx(G,{label:"Treść materiału",htmlFor:"content",error:h.content?.message,required:!0,hint:"Możesz używać formatowania Markdown",children:t.jsx(Dt,{id:"content",placeholder:"Wprowadź treść materiału edukacyjnego...",rows:10,...c("content",{required:x==="material"?"Treść jest wymagana dla materiału":!1})})}),x==="quiz"&&t.jsxs(t.Fragment,{children:[t.jsxs(be,{variant:"1-1-1",children:[t.jsx(G,{label:"Próg zaliczenia (%)",htmlFor:"passing_score",error:h.passing_score?.message,hint:"Minimalny wynik do zaliczenia",children:t.jsx(B,{id:"passing_score",type:"number",min:"0",max:"100",...c("passing_score",{min:{value:0,message:"Wartość minimalna to 0"},max:{value:100,message:"Wartość maksymalna to 100"},valueAsNumber:!0})})}),t.jsx(G,{label:"Limit czasu (min)",htmlFor:"time_limit",hint:"Pozostaw puste dla braku limitu",children:t.jsx(B,{id:"time_limit",type:"number",min:"1",placeholder:"Brak limitu",...c("time_limit",{min:{value:1,message:"Limit musi być większy od 0"},valueAsNumber:!0})})}),t.jsx(G,{label:"Maksymalna liczba prób",htmlFor:"max_attempts",hint:"Pozostaw puste dla nieograniczonej liczby",children:t.jsx(B,{id:"max_attempts",type:"number",min:"1",placeholder:"Bez limitu",...c("max_attempts",{min:{value:1,message:"Minimum 1 próba"},valueAsNumber:!0})})})]}),t.jsx("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950 rounded-lg border border-blue-200 dark:border-blue-800",children:t.jsxs("p",{className:"text-sm",children:[t.jsx("strong",{className:"text-blue-700 dark:text-blue-300",children:"💡 Wskazówka:"})," ",t.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"Po utworzeniu quizu zostaniesz przekierowany do ekranu dodawania pytań."})]})})]}),t.jsx(G,{label:"Status publikacji",children:t.jsxs(R,{variant:"start",children:[t.jsx(Ut,{checked:u("is_published")||!1,onCheckedChange:j=>m("is_published",j)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj aktywność od razu (uczniowie będą mogli ją zobaczyć)"})]})}),t.jsxs(It,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:f,disabled:p,children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:p||!i,children:p?"Tworzenie...":x==="quiz"?"Utwórz i dodaj pytania":"Utwórz aktywność"})]})]})})]})]}):t.jsx(W,{children:t.jsx(I,{children:t.jsxs(M,{className:"text-center py-12",children:[t.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-4",children:"Nie wybrano tematu"}),t.jsx(T,{onClick:()=>s("/courses"),children:"Przejdź do kursów"})]})})})},D0=()=>{const{list:e}=Ue(),{id:s}=tt(),n=H(),{data:i,isLoading:r}=Fe({resource:"activities",id:s,liveMode:"off",meta:{select:"*, topics(*, courses(*))"}}),{data:a}=Fe({resource:"questions",id:s,meta:{select:"count",filter:`activity_id.eq.${s}`},queryOptions:{enabled:!!s&&i?.data?.type==="quiz"}}),{refineCore:{onFinish:o,formLoading:l},register:c,handleSubmit:d,setValue:m,watch:u,reset:h,formState:{errors:p,isSubmitting:x}}=rs({refineCoreProps:{resource:"activities",id:s,liveMode:"off",redirect:!1,successNotification:!1,onMutationSuccess:()=>{const A=i?.data?.topics?.course_id,v=i?.data?.topic_id;$.success("Aktywność została zaktualizowana");const P=sessionStorage.getItem("returnUrl");P?(sessionStorage.removeItem("returnUrl"),n(P)):A?n(`/courses/show/${A}?expanded=${v}`):e("activities")},onMutationError:A=>{console.error("Błąd podczas aktualizacji:",A),A?.code==="PGRST204"?$.error("Błąd konfiguracji - skontaktuj się z administratorem"):A?.code==="23505"?$.error("Aktywność o tej pozycji już istnieje w tym temacie"):A?.code==="23503"?$.error("Nieprawidłowe powiązanie z tematem"):A?.message?$.error(`Błąd: ${A.message}`):$.error("Wystąpił nieoczekiwany błąd. Spróbuj ponownie.")}}});g.useEffect(()=>{if(i?.data){const{topics:A,_count:v,questions:P,..._}=i.data;h(_)}},[i,h]);const f=u("type")||i?.data?.type||"material";if(r||l)return t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const j=i?.data,b=j?.topics,y=b?.courses,w=y?.id,z=j?.topic_id,N=()=>{const A=sessionStorage.getItem("returnUrl");A?(sessionStorage.removeItem("returnUrl"),n(A)):w?n(`/courses/show/${w}?expanded=${z}`):e("activities")},S=()=>f==="quiz"?t.jsx(ct,{className:"w-6 h-6 text-blue-500"}):t.jsx(et,{className:"w-6 h-6 text-green-500"}),k=()=>{const A=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",A),n(`/questions/manage/${j?.id}`)},C=a?.data?.[0]?.count||0;return t.jsxs(W,{children:[t.jsx(ln,{}),t.jsxs(R,{children:[t.jsx(ie,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[S(),"Edytuj aktywność"]}),description:t.jsxs("div",{children:[t.jsx("div",{className:"text-lg font-medium",children:j?.title}),t.jsxs("div",{className:"text-sm text-muted-foreground",children:[y?.title," → Temat ",b?.position,": ",b?.title]})]})}),f==="quiz"&&t.jsxs(T,{onClick:k,variant:"outline",children:[t.jsx(tn,{className:"w-4 h-4 mr-2"}),"Zarządzaj pytaniami (",C,")"]})]}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Informacje o aktywności"})}),t.jsx(M,{children:t.jsxs(Et,{onSubmit:d(o),children:[t.jsxs(be,{variant:"1-2-2",children:[t.jsxs(G,{label:"Typ aktywności",error:p.type?.message,required:!0,children:[t.jsxs(Te,{value:f,disabled:!0,children:[t.jsx(Ne,{className:"bg-muted",children:t.jsx(Ae,{placeholder:"Wybierz typ"})}),t.jsxs(ke,{children:[t.jsx(K,{value:"material",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(et,{className:"w-4 h-4"}),"Materiał"]})}),t.jsx(K,{value:"quiz",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ct,{className:"w-4 h-4"}),"Quiz"]})})]})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Typ aktywności nie może być zmieniony"})]}),t.jsx(G,{label:"Tytuł",htmlFor:"title",error:p.title?.message,required:!0,children:t.jsx(B,{id:"title",placeholder:f==="quiz"?"np. Test wiedzy":"np. Wprowadzenie",...c("title",{required:"Tytuł jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),t.jsx(G,{label:"Pozycja w temacie",htmlFor:"position",error:p.position?.message,required:!0,children:t.jsx(B,{id:"position",type:"number",min:"1",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),t.jsx(G,{label:"Czas trwania (min)",htmlFor:"duration_min",hint:"Szacowany czas potrzebny na ukończenie",children:t.jsx(B,{id:"duration_min",type:"number",min:"1",placeholder:"np. 15",...c("duration_min",{min:{value:1,message:"Czas musi być większy od 0"},valueAsNumber:!0})})})]}),f==="material"&&t.jsx(G,{label:"Treść materiału",htmlFor:"content",error:p.content?.message,required:!0,hint:"Możesz używać formatowania Markdown",children:t.jsx(Dt,{id:"content",placeholder:"Wprowadź treść materiału...",rows:10,...c("content",{required:f==="material"?"Treść jest wymagana dla materiału":!1})})}),f==="quiz"&&t.jsxs(t.Fragment,{children:[t.jsxs(be,{variant:"1-1-1",children:[t.jsx(G,{label:"Próg zaliczenia (%)",htmlFor:"passing_score",error:p.passing_score?.message,hint:"Minimalny wynik do zaliczenia",children:t.jsx(B,{id:"passing_score",type:"number",min:"0",max:"100",...c("passing_score",{min:{value:0,message:"Wartość minimalna to 0"},max:{value:100,message:"Wartość maksymalna to 100"},valueAsNumber:!0})})}),t.jsx(G,{label:"Limit czasu (min)",htmlFor:"time_limit",hint:"Pozostaw puste dla braku limitu",children:t.jsx(B,{id:"time_limit",type:"number",min:"1",placeholder:"Brak limitu",...c("time_limit",{min:{value:1,message:"Limit musi być większy od 0"},valueAsNumber:!0})})}),t.jsx(G,{label:"Maksymalna liczba prób",htmlFor:"max_attempts",hint:"Pozostaw puste dla nieograniczonej liczby",children:t.jsx(B,{id:"max_attempts",type:"number",min:"1",placeholder:"Bez limitu",...c("max_attempts",{min:{value:1,message:"Minimum 1 próba"},valueAsNumber:!0})})})]}),C>0&&t.jsx(I,{className:"mt-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800",children:t.jsx(M,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm font-medium",children:["Ten quiz zawiera ",C," ",C===1?"pytanie":"pytań"]}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Możesz zarządzać pytaniami klikając przycisk powyżej"})]}),t.jsx(ne,{variant:"outline",className:"text-lg px-3 py-1",children:C})]})})})]}),t.jsx(G,{label:"Status publikacji",children:t.jsxs(R,{variant:"start",children:[t.jsx(Ut,{checked:u("is_published")||!1,onCheckedChange:A=>m("is_published",A)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Aktywność jest opublikowana (uczniowie mogą ją zobaczyć)"})]})}),t.jsxs(It,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:N,disabled:x,children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:x,children:x?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})};function Rd(e,s){const n=String(e);if(typeof s!="string")throw new TypeError("Expected character");let i=0,r=n.indexOf(s);for(;r!==-1;)i++,r=n.indexOf(s,r+s.length);return i}function _0(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function E0(e,s,n){const r=Gm((n||{}).ignore||[]),a=I0(s);let o=-1;for(;++o<a.length;)zy(e,"text",l);function l(d,m){let u=-1,h;for(;++u<m.length;){const p=m[u],x=h?h.children:void 0;if(r(p,x?x.indexOf(p):void 0,h))return;h=p}if(h)return c(d,m)}function c(d,m){const u=m[m.length-1],h=a[o][0],p=a[o][1];let x=0;const j=u.children.indexOf(d);let b=!1,y=[];h.lastIndex=0;let w=h.exec(d.value);for(;w;){const z=w.index,N={index:w.index,input:w.input,stack:[...m,d]};let S=p(...w,N);if(typeof S=="string"&&(S=S.length>0?{type:"text",value:S}:void 0),S===!1?h.lastIndex=z+1:(x!==z&&y.push({type:"text",value:d.value.slice(x,z)}),Array.isArray(S)?y.push(...S):S&&y.push(S),x=z+w[0].length,b=!0),!h.global)break;w=h.exec(d.value)}return b?(x<d.value.length&&y.push({type:"text",value:d.value.slice(x)}),u.children.splice(j,1,...y)):y=[d],j+y.length}}function I0(e){const s=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!e[0]||Array.isArray(e[0])?e:[e];let i=-1;for(;++i<n.length;){const r=n[i];s.push([M0(r[0]),L0(r[1])])}return s}function M0(e){return typeof e=="string"?new RegExp(_0(e),"g"):e}function L0(e){return typeof e=="function"?e:function(){return e}}const wo="phrasing",vo=["autolink","link","image","label"];function O0(){return{transforms:[U0],enter:{literalAutolink:F0,literalAutolinkEmail:No,literalAutolinkHttp:No,literalAutolinkWww:No},exit:{literalAutolink:V0,literalAutolinkEmail:B0,literalAutolinkHttp:$0,literalAutolinkWww:q0}}}function R0(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:wo,notInConstruct:vo},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:wo,notInConstruct:vo},{character:":",before:"[ps]",after:"\\/",inConstruct:wo,notInConstruct:vo}]}}function F0(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function No(e){this.config.enter.autolinkProtocol.call(this,e)}function $0(e){this.config.exit.autolinkProtocol.call(this,e)}function q0(e){this.config.exit.data.call(this,e);const s=this.stack[this.stack.length-1];Yn(s.type==="link"),s.url="http://"+this.sliceSerialize(e)}function B0(e){this.config.exit.autolinkEmail.call(this,e)}function V0(e){this.exit(e)}function U0(e){E0(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,W0],[/(?<=^|\s|\p{P}|\p{S})([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/gu,K0]],{ignore:["link","linkReference"]})}function W0(e,s,n,i,r){let a="";if(!Ap(r)||(/^w/i.test(s)&&(n=s+n,s="",a="http://"),!G0(n)))return!1;const o=H0(n+i);if(!o[0])return!1;const l={type:"link",title:null,url:a+s+o[0],children:[{type:"text",value:s+o[0]}]};return o[1]?[l,{type:"text",value:o[1]}]:l}function K0(e,s,n,i){return!Ap(i,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+s+"@"+n,children:[{type:"text",value:s+"@"+n}]}}function G0(e){const s=e.split(".");return!(s.length<2||s[s.length-1]&&(/_/.test(s[s.length-1])||!/[a-zA-Z\d]/.test(s[s.length-1]))||s[s.length-2]&&(/_/.test(s[s.length-2])||!/[a-zA-Z\d]/.test(s[s.length-2])))}function H0(e){const s=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!s)return[e,void 0];e=e.slice(0,s.index);let n=s[0],i=n.indexOf(")");const r=Rd(e,"(");let a=Rd(e,")");for(;i!==-1&&r>a;)e+=n.slice(0,i+1),n=n.slice(i+1),i=n.indexOf(")"),a++;return[e,n]}function Ap(e,s){const n=e.input.charCodeAt(e.index-1);return(e.index===0||$n(n)||Fl(n))&&(!s||n!==47)}Pp.peek=nN;function Q0(){this.buffer()}function Z0(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function Y0(){this.buffer()}function J0(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function X0(e){const s=this.resume(),n=this.stack[this.stack.length-1];Yn(n.type==="footnoteReference"),n.identifier=or(this.sliceSerialize(e)).toLowerCase(),n.label=s}function eN(e){this.exit(e)}function tN(e){const s=this.resume(),n=this.stack[this.stack.length-1];Yn(n.type==="footnoteDefinition"),n.identifier=or(this.sliceSerialize(e)).toLowerCase(),n.label=s}function sN(e){this.exit(e)}function nN(){return"["}function Pp(e,s,n,i){const r=n.createTracker(i);let a=r.move("[^");const o=n.enter("footnoteReference"),l=n.enter("reference");return a+=r.move(n.safe(n.associationId(e),{after:"]",before:a})),l(),o(),a+=r.move("]"),a}function iN(){return{enter:{gfmFootnoteCallString:Q0,gfmFootnoteCall:Z0,gfmFootnoteDefinitionLabelString:Y0,gfmFootnoteDefinition:J0},exit:{gfmFootnoteCallString:X0,gfmFootnoteCall:eN,gfmFootnoteDefinitionLabelString:tN,gfmFootnoteDefinition:sN}}}function rN(e){let s=!1;return e&&e.firstLineBlank&&(s=!0),{handlers:{footnoteDefinition:n,footnoteReference:Pp},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(i,r,a,o){const l=a.createTracker(o);let c=l.move("[^");const d=a.enter("footnoteDefinition"),m=a.enter("label");return c+=l.move(a.safe(a.associationId(i),{before:c,after:"]"})),m(),c+=l.move("]:"),i.children&&i.children.length>0&&(l.shift(4),c+=l.move((s?`
`:" ")+a.indentLines(a.containerFlow(i,l.current()),s?Dp:aN))),d(),c}}function aN(e,s,n){return s===0?e:Dp(e,s,n)}function Dp(e,s,n){return(n?"":"    ")+e}const oN=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];_p.peek=mN;function lN(){return{canContainEols:["delete"],enter:{strikethrough:dN},exit:{strikethrough:uN}}}function cN(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:oN}],handlers:{delete:_p}}}function dN(e){this.enter({type:"delete",children:[]},e)}function uN(e){this.exit(e)}function _p(e,s,n,i){const r=n.createTracker(i),a=n.enter("strikethrough");let o=r.move("~~");return o+=n.containerPhrasing(e,{...r.current(),before:o,after:"~"}),o+=r.move("~~"),a(),o}function mN(){return"~"}function hN(e){return e.length}function pN(e,s){const n=s||{},i=(n.align||[]).concat(),r=n.stringLength||hN,a=[],o=[],l=[],c=[];let d=0,m=-1;for(;++m<e.length;){const f=[],j=[];let b=-1;for(e[m].length>d&&(d=e[m].length);++b<e[m].length;){const y=fN(e[m][b]);if(n.alignDelimiters!==!1){const w=r(y);j[b]=w,(c[b]===void 0||w>c[b])&&(c[b]=w)}f.push(y)}o[m]=f,l[m]=j}let u=-1;if(typeof i=="object"&&"length"in i)for(;++u<d;)a[u]=Fd(i[u]);else{const f=Fd(i);for(;++u<d;)a[u]=f}u=-1;const h=[],p=[];for(;++u<d;){const f=a[u];let j="",b="";f===99?(j=":",b=":"):f===108?j=":":f===114&&(b=":");let y=n.alignDelimiters===!1?1:Math.max(1,c[u]-j.length-b.length);const w=j+"-".repeat(y)+b;n.alignDelimiters!==!1&&(y=j.length+y+b.length,y>c[u]&&(c[u]=y),p[u]=y),h[u]=w}o.splice(1,0,h),l.splice(1,0,p),m=-1;const x=[];for(;++m<o.length;){const f=o[m],j=l[m];u=-1;const b=[];for(;++u<d;){const y=f[u]||"";let w="",z="";if(n.alignDelimiters!==!1){const N=c[u]-(j[u]||0),S=a[u];S===114?w=" ".repeat(N):S===99?N%2?(w=" ".repeat(N/2+.5),z=" ".repeat(N/2-.5)):(w=" ".repeat(N/2),z=w):z=" ".repeat(N)}n.delimiterStart!==!1&&!u&&b.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&y==="")&&(n.delimiterStart!==!1||u)&&b.push(" "),n.alignDelimiters!==!1&&b.push(w),b.push(y),n.alignDelimiters!==!1&&b.push(z),n.padding!==!1&&b.push(" "),(n.delimiterEnd!==!1||u!==d-1)&&b.push("|")}x.push(n.delimiterEnd===!1?b.join("").replace(/ +$/,""):b.join(""))}return x.join(`
`)}function fN(e){return e==null?"":String(e)}function Fd(e){const s=typeof e=="string"?e.codePointAt(0):0;return s===67||s===99?99:s===76||s===108?108:s===82||s===114?114:0}function xN(e,s,n,i){const r=n.enter("blockquote"),a=n.createTracker(i);a.move("> "),a.shift(2);const o=n.indentLines(n.containerFlow(e,a.current()),gN);return r(),o}function gN(e,s,n){return">"+(n?"":" ")+e}function yN(e,s){return $d(e,s.inConstruct,!0)&&!$d(e,s.notInConstruct,!1)}function $d(e,s,n){if(typeof s=="string"&&(s=[s]),!s||s.length===0)return n;let i=-1;for(;++i<s.length;)if(e.includes(s[i]))return!0;return!1}function qd(e,s,n,i){let r=-1;for(;++r<n.unsafe.length;)if(n.unsafe[r].character===`
`&&yN(n.stack,n.unsafe[r]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function jN(e,s){const n=String(e);let i=n.indexOf(s),r=i,a=0,o=0;if(typeof s!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===r?++a>o&&(o=a):a=1,r=i+s.length,i=n.indexOf(s,r);return o}function bN(e,s){return!!(s.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function wN(e){const s=e.options.fence||"`";if(s!=="`"&&s!=="~")throw new Error("Cannot serialize code with `"+s+"` for `options.fence`, expected `` ` `` or `~`");return s}function vN(e,s,n,i){const r=wN(n),a=e.value||"",o=r==="`"?"GraveAccent":"Tilde";if(bN(e,n)){const u=n.enter("codeIndented"),h=n.indentLines(a,NN);return u(),h}const l=n.createTracker(i),c=r.repeat(Math.max(jN(a,r)+1,3)),d=n.enter("codeFenced");let m=l.move(c);if(e.lang){const u=n.enter(`codeFencedLang${o}`);m+=l.move(n.safe(e.lang,{before:m,after:" ",encode:["`"],...l.current()})),u()}if(e.lang&&e.meta){const u=n.enter(`codeFencedMeta${o}`);m+=l.move(" "),m+=l.move(n.safe(e.meta,{before:m,after:`
`,encode:["`"],...l.current()})),u()}return m+=l.move(`
`),a&&(m+=l.move(a+`
`)),m+=l.move(c),d(),m}function NN(e,s,n){return(n?"":"    ")+e}function lc(e){const s=e.options.quote||'"';if(s!=='"'&&s!=="'")throw new Error("Cannot serialize title with `"+s+"` for `options.quote`, expected `\"`, or `'`");return s}function kN(e,s,n,i){const r=lc(n),a=r==='"'?"Quote":"Apostrophe",o=n.enter("definition");let l=n.enter("label");const c=n.createTracker(i);let d=c.move("[");return d+=c.move(n.safe(n.associationId(e),{before:d,after:"]",...c.current()})),d+=c.move("]: "),l(),!e.url||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),d+=c.move("<"),d+=c.move(n.safe(e.url,{before:d,after:">",...c.current()})),d+=c.move(">")):(l=n.enter("destinationRaw"),d+=c.move(n.safe(e.url,{before:d,after:e.title?" ":`
`,...c.current()}))),l(),e.title&&(l=n.enter(`title${a}`),d+=c.move(" "+r),d+=c.move(n.safe(e.title,{before:d,after:r,...c.current()})),d+=c.move(r),l()),o(),d}function zN(e){const s=e.options.emphasis||"*";if(s!=="*"&&s!=="_")throw new Error("Cannot serialize emphasis with `"+s+"` for `options.emphasis`, expected `*`, or `_`");return s}function Zi(e){return"&#x"+e.toString(16).toUpperCase()+";"}function ha(e,s,n){const i=ra(e),r=ra(s);return i===void 0?r===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}Ep.peek=SN;function Ep(e,s,n,i){const r=zN(n),a=n.enter("emphasis"),o=n.createTracker(i),l=o.move(r);let c=o.move(n.containerPhrasing(e,{after:r,before:l,...o.current()}));const d=c.charCodeAt(0),m=ha(i.before.charCodeAt(i.before.length-1),d,r);m.inside&&(c=Zi(d)+c.slice(1));const u=c.charCodeAt(c.length-1),h=ha(i.after.charCodeAt(0),u,r);h.inside&&(c=c.slice(0,-1)+Zi(u));const p=o.move(r);return a(),n.attentionEncodeSurroundingInfo={after:h.outside,before:m.outside},l+c+p}function SN(e,s,n){return n.options.emphasis||"*"}function CN(e,s){let n=!1;return Sy(e,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return n=!0,Cy}),!!((!e.depth||e.depth<3)&&Hm(e)&&(s.options.setext||n))}function TN(e,s,n,i){const r=Math.max(Math.min(6,e.depth||1),1),a=n.createTracker(i);if(CN(e,n)){const m=n.enter("headingSetext"),u=n.enter("phrasing"),h=n.containerPhrasing(e,{...a.current(),before:`
`,after:`
`});return u(),m(),h+`
`+(r===1?"=":"-").repeat(h.length-(Math.max(h.lastIndexOf("\r"),h.lastIndexOf(`
`))+1))}const o="#".repeat(r),l=n.enter("headingAtx"),c=n.enter("phrasing");a.move(o+" ");let d=n.containerPhrasing(e,{before:"# ",after:`
`,...a.current()});return/^[\t ]/.test(d)&&(d=Zi(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,n.options.closeAtx&&(d+=" "+o),c(),l(),d}Ip.peek=AN;function Ip(e){return e.value||""}function AN(){return"<"}Mp.peek=PN;function Mp(e,s,n,i){const r=lc(n),a=r==='"'?"Quote":"Apostrophe",o=n.enter("image");let l=n.enter("label");const c=n.createTracker(i);let d=c.move("![");return d+=c.move(n.safe(e.alt,{before:d,after:"]",...c.current()})),d+=c.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),d+=c.move("<"),d+=c.move(n.safe(e.url,{before:d,after:">",...c.current()})),d+=c.move(">")):(l=n.enter("destinationRaw"),d+=c.move(n.safe(e.url,{before:d,after:e.title?" ":")",...c.current()}))),l(),e.title&&(l=n.enter(`title${a}`),d+=c.move(" "+r),d+=c.move(n.safe(e.title,{before:d,after:r,...c.current()})),d+=c.move(r),l()),d+=c.move(")"),o(),d}function PN(){return"!"}Lp.peek=DN;function Lp(e,s,n,i){const r=e.referenceType,a=n.enter("imageReference");let o=n.enter("label");const l=n.createTracker(i);let c=l.move("![");const d=n.safe(e.alt,{before:c,after:"]",...l.current()});c+=l.move(d+"]["),o();const m=n.stack;n.stack=[],o=n.enter("reference");const u=n.safe(n.associationId(e),{before:c,after:"]",...l.current()});return o(),n.stack=m,a(),r==="full"||!d||d!==u?c+=l.move(u+"]"):r==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function DN(){return"!"}Op.peek=_N;function Op(e,s,n){let i=e.value||"",r="`",a=-1;for(;new RegExp("(^|[^`])"+r+"([^`]|$)").test(i);)r+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++a<n.unsafe.length;){const o=n.unsafe[a],l=n.compilePattern(o);let c;if(o.atBreak)for(;c=l.exec(i);){let d=c.index;i.charCodeAt(d)===10&&i.charCodeAt(d-1)===13&&d--,i=i.slice(0,d)+" "+i.slice(c.index+1)}}return r+i+r}function _N(){return"`"}function Rp(e,s){const n=Hm(e);return!!(!s.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}Fp.peek=EN;function Fp(e,s,n,i){const r=lc(n),a=r==='"'?"Quote":"Apostrophe",o=n.createTracker(i);let l,c;if(Rp(e,n)){const m=n.stack;n.stack=[],l=n.enter("autolink");let u=o.move("<");return u+=o.move(n.containerPhrasing(e,{before:u,after:">",...o.current()})),u+=o.move(">"),l(),n.stack=m,u}l=n.enter("link"),c=n.enter("label");let d=o.move("[");return d+=o.move(n.containerPhrasing(e,{before:d,after:"](",...o.current()})),d+=o.move("]("),c(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(c=n.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(n.safe(e.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(c=n.enter("destinationRaw"),d+=o.move(n.safe(e.url,{before:d,after:e.title?" ":")",...o.current()}))),c(),e.title&&(c=n.enter(`title${a}`),d+=o.move(" "+r),d+=o.move(n.safe(e.title,{before:d,after:r,...o.current()})),d+=o.move(r),c()),d+=o.move(")"),l(),d}function EN(e,s,n){return Rp(e,n)?"<":"["}$p.peek=IN;function $p(e,s,n,i){const r=e.referenceType,a=n.enter("linkReference");let o=n.enter("label");const l=n.createTracker(i);let c=l.move("[");const d=n.containerPhrasing(e,{before:c,after:"]",...l.current()});c+=l.move(d+"]["),o();const m=n.stack;n.stack=[],o=n.enter("reference");const u=n.safe(n.associationId(e),{before:c,after:"]",...l.current()});return o(),n.stack=m,a(),r==="full"||!d||d!==u?c+=l.move(u+"]"):r==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function IN(){return"["}function cc(e){const s=e.options.bullet||"*";if(s!=="*"&&s!=="+"&&s!=="-")throw new Error("Cannot serialize items with `"+s+"` for `options.bullet`, expected `*`, `+`, or `-`");return s}function MN(e){const s=cc(e),n=e.options.bulletOther;if(!n)return s==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===s)throw new Error("Expected `bullet` (`"+s+"`) and `bulletOther` (`"+n+"`) to be different");return n}function LN(e){const s=e.options.bulletOrdered||".";if(s!=="."&&s!==")")throw new Error("Cannot serialize items with `"+s+"` for `options.bulletOrdered`, expected `.` or `)`");return s}function qp(e){const s=e.options.rule||"*";if(s!=="*"&&s!=="-"&&s!=="_")throw new Error("Cannot serialize rules with `"+s+"` for `options.rule`, expected `*`, `-`, or `_`");return s}function ON(e,s,n,i){const r=n.enter("list"),a=n.bulletCurrent;let o=e.ordered?LN(n):cc(n);const l=e.ordered?o==="."?")":".":MN(n);let c=s&&n.bulletLastUsed?o===n.bulletLastUsed:!1;if(!e.ordered){const m=e.children?e.children[0]:void 0;if((o==="*"||o==="-")&&m&&(!m.children||!m.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(c=!0),qp(n)===o&&m){let u=-1;for(;++u<e.children.length;){const h=e.children[u];if(h&&h.type==="listItem"&&h.children&&h.children[0]&&h.children[0].type==="thematicBreak"){c=!0;break}}}}c&&(o=l),n.bulletCurrent=o;const d=n.containerFlow(e,i);return n.bulletLastUsed=o,n.bulletCurrent=a,r(),d}function RN(e){const s=e.options.listItemIndent||"one";if(s!=="tab"&&s!=="one"&&s!=="mixed")throw new Error("Cannot serialize items with `"+s+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return s}function FN(e,s,n,i){const r=RN(n);let a=n.bulletCurrent||cc(n);s&&s.type==="list"&&s.ordered&&(a=(typeof s.start=="number"&&s.start>-1?s.start:1)+(n.options.incrementListMarker===!1?0:s.children.indexOf(e))+a);let o=a.length+1;(r==="tab"||r==="mixed"&&(s&&s.type==="list"&&s.spread||e.spread))&&(o=Math.ceil(o/4)*4);const l=n.createTracker(i);l.move(a+" ".repeat(o-a.length)),l.shift(o);const c=n.enter("listItem"),d=n.indentLines(n.containerFlow(e,l.current()),m);return c(),d;function m(u,h,p){return h?(p?"":" ".repeat(o))+u:(p?a:a+" ".repeat(o-a.length))+u}}function $N(e,s,n,i){const r=n.enter("paragraph"),a=n.enter("phrasing"),o=n.containerPhrasing(e,i);return a(),r(),o}const qN=Gm(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function BN(e,s,n,i){return(e.children.some(function(o){return qN(o)})?n.containerPhrasing:n.containerFlow).call(n,e,i)}function VN(e){const s=e.options.strong||"*";if(s!=="*"&&s!=="_")throw new Error("Cannot serialize strong with `"+s+"` for `options.strong`, expected `*`, or `_`");return s}Bp.peek=UN;function Bp(e,s,n,i){const r=VN(n),a=n.enter("strong"),o=n.createTracker(i),l=o.move(r+r);let c=o.move(n.containerPhrasing(e,{after:r,before:l,...o.current()}));const d=c.charCodeAt(0),m=ha(i.before.charCodeAt(i.before.length-1),d,r);m.inside&&(c=Zi(d)+c.slice(1));const u=c.charCodeAt(c.length-1),h=ha(i.after.charCodeAt(0),u,r);h.inside&&(c=c.slice(0,-1)+Zi(u));const p=o.move(r+r);return a(),n.attentionEncodeSurroundingInfo={after:h.outside,before:m.outside},l+c+p}function UN(e,s,n){return n.options.strong||"*"}function WN(e,s,n,i){return n.safe(e.value,i)}function KN(e){const s=e.options.ruleRepetition||3;if(s<3)throw new Error("Cannot serialize rules with repetition `"+s+"` for `options.ruleRepetition`, expected `3` or more");return s}function GN(e,s,n){const i=(qp(n)+(n.options.ruleSpaces?" ":"")).repeat(KN(n));return n.options.ruleSpaces?i.slice(0,-1):i}const Vp={blockquote:xN,break:qd,code:vN,definition:kN,emphasis:Ep,hardBreak:qd,heading:TN,html:Ip,image:Mp,imageReference:Lp,inlineCode:Op,link:Fp,linkReference:$p,list:ON,listItem:FN,paragraph:$N,root:BN,strong:Bp,text:WN,thematicBreak:GN};function HN(){return{enter:{table:QN,tableData:Bd,tableHeader:Bd,tableRow:YN},exit:{codeText:JN,table:ZN,tableData:ko,tableHeader:ko,tableRow:ko}}}function QN(e){const s=e._align;this.enter({type:"table",align:s.map(function(n){return n==="none"?null:n}),children:[]},e),this.data.inTable=!0}function ZN(e){this.exit(e),this.data.inTable=void 0}function YN(e){this.enter({type:"tableRow",children:[]},e)}function ko(e){this.exit(e)}function Bd(e){this.enter({type:"tableCell",children:[]},e)}function JN(e){let s=this.resume();this.data.inTable&&(s=s.replace(/\\([\\|])/g,XN));const n=this.stack[this.stack.length-1];Yn(n.type==="inlineCode"),n.value=s,this.exit(e)}function XN(e,s){return s==="|"?s:e}function ek(e){const s=e||{},n=s.tableCellPadding,i=s.tablePipeAlign,r=s.stringLength,a=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:h,table:o,tableCell:c,tableRow:l}};function o(p,x,f,j){return d(m(p,f,j),p.align)}function l(p,x,f,j){const b=u(p,f,j),y=d([b]);return y.slice(0,y.indexOf(`
`))}function c(p,x,f,j){const b=f.enter("tableCell"),y=f.enter("phrasing"),w=f.containerPhrasing(p,{...j,before:a,after:a});return y(),b(),w}function d(p,x){return pN(p,{align:x,alignDelimiters:i,padding:n,stringLength:r})}function m(p,x,f){const j=p.children;let b=-1;const y=[],w=x.enter("table");for(;++b<j.length;)y[b]=u(j[b],x,f);return w(),y}function u(p,x,f){const j=p.children;let b=-1;const y=[],w=x.enter("tableRow");for(;++b<j.length;)y[b]=c(j[b],p,x,f);return w(),y}function h(p,x,f){let j=Vp.inlineCode(p,x,f);return f.stack.includes("tableCell")&&(j=j.replace(/\|/g,"\\$&")),j}}function tk(){return{exit:{taskListCheckValueChecked:Vd,taskListCheckValueUnchecked:Vd,paragraph:nk}}}function sk(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:ik}}}function Vd(e){const s=this.stack[this.stack.length-2];Yn(s.type==="listItem"),s.checked=e.type==="taskListCheckValueChecked"}function nk(e){const s=this.stack[this.stack.length-2];if(s&&s.type==="listItem"&&typeof s.checked=="boolean"){const n=this.stack[this.stack.length-1];Yn(n.type==="paragraph");const i=n.children[0];if(i&&i.type==="text"){const r=s.children;let a=-1,o;for(;++a<r.length;){const l=r[a];if(l.type==="paragraph"){o=l;break}}o===n&&(i.value=i.value.slice(1),i.value.length===0?n.children.shift():n.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,n.position.start=Object.assign({},i.position.start)))}}this.exit(e)}function ik(e,s,n,i){const r=e.children[0],a=typeof e.checked=="boolean"&&r&&r.type==="paragraph",o="["+(e.checked?"x":" ")+"] ",l=n.createTracker(i);a&&l.move(o);let c=Vp.listItem(e,s,n,{...i,...l.current()});return a&&(c=c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,d)),c;function d(m){return m+o}}function rk(){return[O0(),iN(),lN(),HN(),tk()]}function ak(e){return{extensions:[R0(),rN(e),cN(),ek(e),sk()]}}const ok={tokenize:hk,partial:!0},Up={tokenize:pk,partial:!0},Wp={tokenize:fk,partial:!0},Kp={tokenize:xk,partial:!0},lk={tokenize:gk,partial:!0},Gp={name:"wwwAutolink",tokenize:uk,previous:Qp},Hp={name:"protocolAutolink",tokenize:mk,previous:Zp},js={name:"emailAutolink",tokenize:dk,previous:Yp},os={};function ck(){return{text:os}}let Us=48;for(;Us<123;)os[Us]=js,Us++,Us===58?Us=65:Us===91&&(Us=97);os[43]=js;os[45]=js;os[46]=js;os[95]=js;os[72]=[js,Hp];os[104]=[js,Hp];os[87]=[js,Gp];os[119]=[js,Gp];function dk(e,s,n){const i=this;let r,a;return o;function o(u){return!ll(u)||!Yp.call(i,i.previous)||dc(i.events)?n(u):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),l(u))}function l(u){return ll(u)?(e.consume(u),l):u===64?(e.consume(u),c):n(u)}function c(u){return u===46?e.check(lk,m,d)(u):u===45||u===95||$l(u)?(a=!0,e.consume(u),c):m(u)}function d(u){return e.consume(u),r=!0,c}function m(u){return a&&r&&Fi(i.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),s(u)):n(u)}}function uk(e,s,n){const i=this;return r;function r(o){return o!==87&&o!==119||!Qp.call(i,i.previous)||dc(i.events)?n(o):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(ok,e.attempt(Up,e.attempt(Wp,a),n),n)(o))}function a(o){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),s(o)}}function mk(e,s,n){const i=this;let r="",a=!1;return o;function o(u){return(u===72||u===104)&&Zp.call(i,i.previous)&&!dc(i.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),r+=String.fromCodePoint(u),e.consume(u),l):n(u)}function l(u){if(Fi(u)&&r.length<5)return r+=String.fromCodePoint(u),e.consume(u),l;if(u===58){const h=r.toLowerCase();if(h==="http"||h==="https")return e.consume(u),c}return n(u)}function c(u){return u===47?(e.consume(u),a?d:(a=!0,c)):n(u)}function d(u){return u===null||Ty(u)||bt(u)||$n(u)||Fl(u)?n(u):e.attempt(Up,e.attempt(Wp,m),n)(u)}function m(u){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),s(u)}}function hk(e,s,n){let i=0;return r;function r(o){return(o===87||o===119)&&i<3?(i++,e.consume(o),r):o===46&&i===3?(e.consume(o),a):n(o)}function a(o){return o===null?n(o):s(o)}}function pk(e,s,n){let i,r,a;return o;function o(d){return d===46||d===95?e.check(Kp,c,l)(d):d===null||bt(d)||$n(d)||d!==45&&Fl(d)?c(d):(a=!0,e.consume(d),o)}function l(d){return d===95?i=!0:(r=i,i=void 0),e.consume(d),o}function c(d){return r||i||!a?n(d):s(d)}}function fk(e,s){let n=0,i=0;return r;function r(o){return o===40?(n++,e.consume(o),r):o===41&&i<n?a(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?e.check(Kp,s,a)(o):o===null||bt(o)||$n(o)?s(o):(e.consume(o),r)}function a(o){return o===41&&i++,e.consume(o),r}}function xk(e,s,n){return i;function i(l){return l===33||l===34||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===63||l===95||l===126?(e.consume(l),i):l===38?(e.consume(l),a):l===93?(e.consume(l),r):l===60||l===null||bt(l)||$n(l)?s(l):n(l)}function r(l){return l===null||l===40||l===91||bt(l)||$n(l)?s(l):i(l)}function a(l){return Fi(l)?o(l):n(l)}function o(l){return l===59?(e.consume(l),i):Fi(l)?(e.consume(l),o):n(l)}}function gk(e,s,n){return i;function i(a){return e.consume(a),r}function r(a){return $l(a)?n(a):s(a)}}function Qp(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||bt(e)}function Zp(e){return!Fi(e)}function Yp(e){return!(e===47||ll(e))}function ll(e){return e===43||e===45||e===46||e===95||$l(e)}function dc(e){let s=e.length,n=!1;for(;s--;){const i=e[s][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){n=!0;break}if(i._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const yk={tokenize:Sk,partial:!0};function jk(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:Nk,continuation:{tokenize:kk},exit:zk}},text:{91:{name:"gfmFootnoteCall",tokenize:vk},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:bk,resolveTo:wk}}}}function bk(e,s,n){const i=this;let r=i.events.length;const a=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o;for(;r--;){const c=i.events[r][1];if(c.type==="labelImage"){o=c;break}if(c.type==="gfmFootnoteCall"||c.type==="labelLink"||c.type==="label"||c.type==="image"||c.type==="link")break}return l;function l(c){if(!o||!o._balanced)return n(c);const d=or(i.sliceSerialize({start:o.end,end:i.now()}));return d.codePointAt(0)!==94||!a.includes(d.slice(1))?n(c):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(c),e.exit("gfmFootnoteCallLabelMarker"),s(c))}}function wk(e,s){let n=e.length;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},r={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};r.end.column++,r.end.offset++,r.end._bufferIndex++;const a={type:"gfmFootnoteCallString",start:Object.assign({},r.end),end:Object.assign({},e[e.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},a.start),end:Object.assign({},a.end)},l=[e[n+1],e[n+2],["enter",i,s],e[n+3],e[n+4],["enter",r,s],["exit",r,s],["enter",a,s],["enter",o,s],["exit",o,s],["exit",a,s],e[e.length-2],e[e.length-1],["exit",i,s]];return e.splice(n,e.length-n+1,...l),e}function vk(e,s,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let a=0,o;return l;function l(u){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),c}function c(u){return u!==94?n(u):(e.enter("gfmFootnoteCallMarker"),e.consume(u),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",d)}function d(u){if(a>999||u===93&&!o||u===null||u===91||bt(u))return n(u);if(u===93){e.exit("chunkString");const h=e.exit("gfmFootnoteCallString");return r.includes(or(i.sliceSerialize(h)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),s):n(u)}return bt(u)||(o=!0),a++,e.consume(u),u===92?m:d}function m(u){return u===91||u===92||u===93?(e.consume(u),a++,d):d(u)}}function Nk(e,s,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let a,o=0,l;return c;function c(x){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(x),e.exit("gfmFootnoteDefinitionLabelMarker"),d}function d(x){return x===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(x),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",m):n(x)}function m(x){if(o>999||x===93&&!l||x===null||x===91||bt(x))return n(x);if(x===93){e.exit("chunkString");const f=e.exit("gfmFootnoteDefinitionLabelString");return a=or(i.sliceSerialize(f)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(x),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),h}return bt(x)||(l=!0),o++,e.consume(x),x===92?u:m}function u(x){return x===91||x===92||x===93?(e.consume(x),o++,m):m(x)}function h(x){return x===58?(e.enter("definitionMarker"),e.consume(x),e.exit("definitionMarker"),r.includes(a)||r.push(a),As(e,p,"gfmFootnoteDefinitionWhitespace")):n(x)}function p(x){return s(x)}}function kk(e,s,n){return e.check(Ay,s,e.attempt(yk,s,n))}function zk(e){e.exit("gfmFootnoteDefinition")}function Sk(e,s,n){const i=this;return As(e,r,"gfmFootnoteDefinitionIndent",5);function r(a){const o=i.events[i.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?s(a):n(a)}}function Ck(e){let n=(e||{}).singleTilde;const i={name:"strikethrough",tokenize:a,resolveAll:r};return n==null&&(n=!0),{text:{126:i},insideSpan:{null:[i]},attentionMarkers:{null:[126]}};function r(o,l){let c=-1;for(;++c<o.length;)if(o[c][0]==="enter"&&o[c][1].type==="strikethroughSequenceTemporary"&&o[c][1]._close){let d=c;for(;d--;)if(o[d][0]==="exit"&&o[d][1].type==="strikethroughSequenceTemporary"&&o[d][1]._open&&o[c][1].end.offset-o[c][1].start.offset===o[d][1].end.offset-o[d][1].start.offset){o[c][1].type="strikethroughSequence",o[d][1].type="strikethroughSequence";const m={type:"strikethrough",start:Object.assign({},o[d][1].start),end:Object.assign({},o[c][1].end)},u={type:"strikethroughText",start:Object.assign({},o[d][1].end),end:Object.assign({},o[c][1].start)},h=[["enter",m,l],["enter",o[d][1],l],["exit",o[d][1],l],["enter",u,l]],p=l.parser.constructs.insideSpan.null;p&&po(h,h.length,0,Py(p,o.slice(d+1,c),l)),po(h,h.length,0,[["exit",u,l],["enter",o[c][1],l],["exit",o[c][1],l],["exit",m,l]]),po(o,d-1,c-d+3,h),c=d+h.length-2;break}}for(c=-1;++c<o.length;)o[c][1].type==="strikethroughSequenceTemporary"&&(o[c][1].type="data");return o}function a(o,l,c){const d=this.previous,m=this.events;let u=0;return h;function h(x){return d===126&&m[m.length-1][1].type!=="characterEscape"?c(x):(o.enter("strikethroughSequenceTemporary"),p(x))}function p(x){const f=ra(d);if(x===126)return u>1?c(x):(o.consume(x),u++,p);if(u<2&&!n)return c(x);const j=o.exit("strikethroughSequenceTemporary"),b=ra(x);return j._open=!b||b===2&&!!f,j._close=!f||f===2&&!!b,l(x)}}}class Tk{constructor(){this.map=[]}add(s,n,i){Ak(this,s,n,i)}consume(s){if(this.map.sort(function(a,o){return a[0]-o[0]}),this.map.length===0)return;let n=this.map.length;const i=[];for(;n>0;)n-=1,i.push(s.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),s.length=this.map[n][0];i.push(s.slice()),s.length=0;let r=i.pop();for(;r;){for(const a of r)s.push(a);r=i.pop()}this.map.length=0}}function Ak(e,s,n,i){let r=0;if(!(n===0&&i.length===0)){for(;r<e.map.length;){if(e.map[r][0]===s){e.map[r][1]+=n,e.map[r][2].push(...i);return}r+=1}e.map.push([s,n,i])}}function Pk(e,s){let n=!1;const i=[];for(;s<e.length;){const r=e[s];if(n){if(r[0]==="enter")r[1].type==="tableContent"&&i.push(e[s+1][1].type==="tableDelimiterMarker"?"left":"none");else if(r[1].type==="tableContent"){if(e[s-1][1].type==="tableDelimiterMarker"){const a=i.length-1;i[a]=i[a]==="left"?"center":"right"}}else if(r[1].type==="tableDelimiterRow")break}else r[0]==="enter"&&r[1].type==="tableDelimiterRow"&&(n=!0);s+=1}return i}function Dk(){return{flow:{null:{name:"table",tokenize:_k,resolveAll:Ek}}}}function _k(e,s,n){const i=this;let r=0,a=0,o;return l;function l(v){let P=i.events.length-1;for(;P>-1;){const D=i.events[P][1].type;if(D==="lineEnding"||D==="linePrefix")P--;else break}const _=P>-1?i.events[P][1].type:null,E=_==="tableHead"||_==="tableRow"?S:c;return E===S&&i.parser.lazy[i.now().line]?n(v):E(v)}function c(v){return e.enter("tableHead"),e.enter("tableRow"),d(v)}function d(v){return v===124||(o=!0,a+=1),m(v)}function m(v){return v===null?n(v):Si(v)?a>1?(a=0,i.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),p):n(v):Nn(v)?As(e,m,"whitespace")(v):(a+=1,o&&(o=!1,r+=1),v===124?(e.enter("tableCellDivider"),e.consume(v),e.exit("tableCellDivider"),o=!0,m):(e.enter("data"),u(v)))}function u(v){return v===null||v===124||bt(v)?(e.exit("data"),m(v)):(e.consume(v),v===92?h:u)}function h(v){return v===92||v===124?(e.consume(v),u):u(v)}function p(v){return i.interrupt=!1,i.parser.lazy[i.now().line]?n(v):(e.enter("tableDelimiterRow"),o=!1,Nn(v)?As(e,x,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(v):x(v))}function x(v){return v===45||v===58?j(v):v===124?(o=!0,e.enter("tableCellDivider"),e.consume(v),e.exit("tableCellDivider"),f):N(v)}function f(v){return Nn(v)?As(e,j,"whitespace")(v):j(v)}function j(v){return v===58?(a+=1,o=!0,e.enter("tableDelimiterMarker"),e.consume(v),e.exit("tableDelimiterMarker"),b):v===45?(a+=1,b(v)):v===null||Si(v)?z(v):N(v)}function b(v){return v===45?(e.enter("tableDelimiterFiller"),y(v)):N(v)}function y(v){return v===45?(e.consume(v),y):v===58?(o=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(v),e.exit("tableDelimiterMarker"),w):(e.exit("tableDelimiterFiller"),w(v))}function w(v){return Nn(v)?As(e,z,"whitespace")(v):z(v)}function z(v){return v===124?x(v):v===null||Si(v)?!o||r!==a?N(v):(e.exit("tableDelimiterRow"),e.exit("tableHead"),s(v)):N(v)}function N(v){return n(v)}function S(v){return e.enter("tableRow"),k(v)}function k(v){return v===124?(e.enter("tableCellDivider"),e.consume(v),e.exit("tableCellDivider"),k):v===null||Si(v)?(e.exit("tableRow"),s(v)):Nn(v)?As(e,k,"whitespace")(v):(e.enter("data"),C(v))}function C(v){return v===null||v===124||bt(v)?(e.exit("data"),k(v)):(e.consume(v),v===92?A:C)}function A(v){return v===92||v===124?(e.consume(v),C):C(v)}}function Ek(e,s){let n=-1,i=!0,r=0,a=[0,0,0,0],o=[0,0,0,0],l=!1,c=0,d,m,u;const h=new Tk;for(;++n<e.length;){const p=e[n],x=p[1];p[0]==="enter"?x.type==="tableHead"?(l=!1,c!==0&&(Ud(h,s,c,d,m),m=void 0,c=0),d={type:"table",start:Object.assign({},x.start),end:Object.assign({},x.end)},h.add(n,0,[["enter",d,s]])):x.type==="tableRow"||x.type==="tableDelimiterRow"?(i=!0,u=void 0,a=[0,0,0,0],o=[0,n+1,0,0],l&&(l=!1,m={type:"tableBody",start:Object.assign({},x.start),end:Object.assign({},x.end)},h.add(n,0,[["enter",m,s]])),r=x.type==="tableDelimiterRow"?2:m?3:1):r&&(x.type==="data"||x.type==="tableDelimiterMarker"||x.type==="tableDelimiterFiller")?(i=!1,o[2]===0&&(a[1]!==0&&(o[0]=o[1],u=Fr(h,s,a,r,void 0,u),a=[0,0,0,0]),o[2]=n)):x.type==="tableCellDivider"&&(i?i=!1:(a[1]!==0&&(o[0]=o[1],u=Fr(h,s,a,r,void 0,u)),a=o,o=[a[1],n,0,0])):x.type==="tableHead"?(l=!0,c=n):x.type==="tableRow"||x.type==="tableDelimiterRow"?(c=n,a[1]!==0?(o[0]=o[1],u=Fr(h,s,a,r,n,u)):o[1]!==0&&(u=Fr(h,s,o,r,n,u)),r=0):r&&(x.type==="data"||x.type==="tableDelimiterMarker"||x.type==="tableDelimiterFiller")&&(o[3]=n)}for(c!==0&&Ud(h,s,c,d,m),h.consume(s.events),n=-1;++n<s.events.length;){const p=s.events[n];p[0]==="enter"&&p[1].type==="table"&&(p[1]._align=Pk(s.events,n))}return e}function Fr(e,s,n,i,r,a){const o=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",l="tableContent";n[0]!==0&&(a.end=Object.assign({},kn(s.events,n[0])),e.add(n[0],0,[["exit",a,s]]));const c=kn(s.events,n[1]);if(a={type:o,start:Object.assign({},c),end:Object.assign({},c)},e.add(n[1],0,[["enter",a,s]]),n[2]!==0){const d=kn(s.events,n[2]),m=kn(s.events,n[3]),u={type:l,start:Object.assign({},d),end:Object.assign({},m)};if(e.add(n[2],0,[["enter",u,s]]),i!==2){const h=s.events[n[2]],p=s.events[n[3]];if(h[1].end=Object.assign({},p[1].end),h[1].type="chunkText",h[1].contentType="text",n[3]>n[2]+1){const x=n[2]+1,f=n[3]-n[2]-1;e.add(x,f,[])}}e.add(n[3]+1,0,[["exit",u,s]])}return r!==void 0&&(a.end=Object.assign({},kn(s.events,r)),e.add(r,0,[["exit",a,s]]),a=void 0),a}function Ud(e,s,n,i,r){const a=[],o=kn(s.events,n);r&&(r.end=Object.assign({},o),a.push(["exit",r,s])),i.end=Object.assign({},o),a.push(["exit",i,s]),e.add(n+1,0,a)}function kn(e,s){const n=e[s],i=n[0]==="enter"?"start":"end";return n[1][i]}const Ik={name:"tasklistCheck",tokenize:Lk};function Mk(){return{text:{91:Ik}}}function Lk(e,s,n){const i=this;return r;function r(c){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?n(c):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),a)}function a(c){return bt(c)?(e.enter("taskListCheckValueUnchecked"),e.consume(c),e.exit("taskListCheckValueUnchecked"),o):c===88||c===120?(e.enter("taskListCheckValueChecked"),e.consume(c),e.exit("taskListCheckValueChecked"),o):n(c)}function o(c){return c===93?(e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),l):n(c)}function l(c){return Si(c)?s(c):Nn(c)?e.check({tokenize:Ok},s,n)(c):n(c)}}function Ok(e,s,n){return As(e,i,"whitespace");function i(r){return r===null?n(r):s(r)}}function Rk(e){return Dy([ck(),jk(),Ck(e),Dk(),Mk()])}const Fk={};function cl(e){const s=this,n=e||Fk,i=s.data(),r=i.micromarkExtensions||(i.micromarkExtensions=[]),a=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),o=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);r.push(Rk(n)),a.push(rk()),o.push(ak(n))}const $k=({activity:e})=>t.jsxs("div",{className:"grid gap-6 lg:grid-cols-[1fr,300px]",children:[t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Treść materiału"})}),t.jsx(M,{children:e.content?t.jsx("div",{className:"prose max-w-none",children:t.jsx(Mn,{remarkPlugins:[cl],children:e.content})}):t.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[t.jsx(et,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Brak treści materiału"})]})})]}),t.jsx("div",{className:"space-y-4",children:t.jsxs(I,{children:[t.jsx(V,{className:"pb-3",children:t.jsx(q,{className:"text-base",children:"Informacje"})}),t.jsxs(M,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[t.jsx(qt,{className:"w-4 h-4"}),"Czas trwania"]}),t.jsxs("p",{className:"font-medium",children:[e.duration_min||"-"," minut"]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[t.jsx(ej,{className:"w-4 h-4"}),"Pozycja w temacie"]}),t.jsx("p",{className:"font-medium",children:e.position})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[t.jsx(Is,{className:"w-4 h-4"}),"Data utworzenia"]}),t.jsx("p",{className:"font-medium",children:new Date(e.created_at).toLocaleDateString("pl-PL")})]}),e.updated_at&&t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[t.jsx(Is,{className:"w-4 h-4"}),"Ostatnia aktualizacja"]}),t.jsx("p",{className:"font-medium",children:new Date(e.updated_at).toLocaleDateString("pl-PL")})]})]})]})})]}),qk=({activity:e,questionsCount:s,questionsData:n,questionsLoading:i,onNavigateToQuestions:r})=>{const a=n?.reduce((l,c)=>l+(c.points||0),0)||0,o=Math.ceil((e.passing_score||70)/100*a);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Parametry quizu"})}),t.jsx(M,{children:t.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[t.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(qt,{className:"w-4 h-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Czas trwania"})]}),t.jsxs("p",{className:"text-2xl font-bold",children:[e.duration_min||"-"," min"]})]}),t.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(Ds,{className:"w-4 h-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Próg zaliczenia"})]}),t.jsxs("p",{className:"text-2xl font-bold",children:[e.passing_score||70,"%"]})]}),t.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(tj,{className:"w-4 h-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Limit czasu"})]}),t.jsx("p",{className:"text-2xl font-bold",children:e.time_limit?`${e.time_limit} min`:"Brak"})]}),t.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(cr,{className:"w-4 h-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Liczba prób"})]}),t.jsx("p",{className:"text-2xl font-bold",children:e.max_attempts||"Bez limitu"})]})]})})]}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsxs(q,{className:"flex items-center justify-between",children:[t.jsxs("span",{children:["Pytania (",s,")"]}),s>0&&t.jsxs(T,{size:"sm",variant:"outline",onClick:()=>r(e.id),children:[t.jsx(Vt,{className:"w-3 h-3 mr-1"}),"Zarządzaj"]})]})}),t.jsx(M,{children:s===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(ct,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground/30"}),t.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-2",children:"Ten quiz nie ma jeszcze pytań"}),t.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Dodaj pytania, aby uczniowie mogli rozwiązać quiz"}),t.jsxs(T,{onClick:()=>r(e.id),children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Dodaj pierwsze pytanie"]})]}):i?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):t.jsx("div",{className:"space-y-2",children:n?.map((l,c)=>t.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-sm font-semibold",children:c+1}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.type==="single_choice"&&t.jsxs(ne,{variant:"outline",className:"text-xs",children:[t.jsx(Ms,{className:"w-3 h-3 mr-1"}),"Jednokrotny wybór"]}),l.type==="multiple_choice"&&t.jsxs(ne,{variant:"outline",className:"text-xs",children:[t.jsx(tn,{className:"w-3 h-3 mr-1"}),"Wielokrotny wybór"]}),l.type==="true_false"&&t.jsxs(ne,{variant:"outline",className:"text-xs",children:[t.jsx(Ul,{className:"w-3 h-3 mr-1"}),"Prawda/Fałsz"]}),t.jsxs(ne,{variant:"secondary",className:"text-xs",children:[l.points," pkt"]})]}),t.jsx("p",{className:"text-sm font-medium line-clamp-2",children:l.content}),l.explanation&&t.jsxs("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-1",children:[t.jsx("span",{className:"font-medium",children:"Wyjaśnienie:"})," ",l.explanation]})]})]},l.id))})})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.jsxs(I,{children:[t.jsx(V,{className:"pb-3",children:t.jsx(q,{className:"text-base",children:"Statystyki"})}),t.jsx(M,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Liczba pytań"}),t.jsx("span",{className:"font-medium",children:s})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Maksymalna liczba punktów"}),t.jsx("span",{className:"font-medium",children:a})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Wymagane punkty do zaliczenia"}),t.jsx("span",{className:"font-medium",children:o})]})]})})]}),t.jsxs(I,{children:[t.jsx(V,{className:"pb-3",children:t.jsx(q,{className:"text-base",children:"Informacje"})}),t.jsx(M,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Pozycja w temacie"}),t.jsx("span",{className:"font-medium",children:e.position})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Data utworzenia"}),t.jsx("span",{className:"font-medium",children:new Date(e.created_at).toLocaleDateString("pl-PL")})]}),e.updated_at&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Ostatnia aktualizacja"}),t.jsx("span",{className:"font-medium",children:new Date(e.updated_at).toLocaleDateString("pl-PL")})]})]})})]})]})]})},Bk=()=>{const{edit:e}=Ue(),{id:s}=tt(),n=H(),{data:i,isLoading:r}=Fe({resource:"activities",id:s,meta:{select:"*, topics(*, courses(*)), questions:questions(count)"}}),{data:a,isLoading:o}=_e({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(s)}],sorters:[{field:"position",order:"asc"}],queryOptions:{enabled:i?.data?.type==="quiz"&&!!s}});if(r)return t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const l=i?.data;if(!l)return t.jsx(W,{children:t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-muted-foreground",children:"Nie znaleziono aktywności"})})});const c=l.topics,d=c?.courses,m=l.questions?.[0]?.count||l._count?.questions||0,u=()=>{const f=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",f),e("activities",l.id??"")},h=f=>{const j=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",j),n(f)},p=()=>l.type==="quiz"?t.jsx(ct,{className:"w-5 h-5"}):t.jsx(et,{className:"w-5 h-5"}),x=()=>l.type==="quiz"?"text-blue-500":"text-green-500";return t.jsxs(W,{children:[t.jsx(ln,{}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[d?.title," → Temat ",c?.position,": ",c?.title]}),t.jsxs(R,{children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`p-2 rounded-lg bg-muted ${x()}`,children:p()}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:l.title}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx(ne,{variant:l.type==="quiz"?"default":"secondary",children:l.type==="quiz"?"Quiz":"Materiał"}),t.jsx(ne,{variant:l.is_published?"default":"outline",children:l.is_published?t.jsxs(t.Fragment,{children:[t.jsx(Ve,{className:"w-3 h-3 mr-1"})," Opublikowany"]}):t.jsxs(t.Fragment,{children:[t.jsx(Da,{className:"w-3 h-3 mr-1"})," Szkic"]})})]})]})]}),t.jsxs("div",{className:"flex gap-2",children:[l.type==="quiz"&&t.jsxs(T,{variant:"outline",onClick:()=>h(`/questions/manage/${l.id}`),children:[t.jsx(tn,{className:"w-4 h-4 mr-2"}),"Zarządzaj pytaniami (",m,")"]}),t.jsxs(T,{onClick:u,children:[t.jsx(Vt,{className:"w-4 h-4 mr-2"}),"Edytuj"]})]})]})]}),l.type==="material"?t.jsx($k,{activity:l}):t.jsx(qk,{activity:l,questionsCount:m,questionsData:a?.data,questionsLoading:o,onNavigateToQuestions:f=>h(`/questions/manage/${f}`)})]})},Vk={name:"activities",create:"/activities/create",edit:"/activities/edit/:id",show:"/activities/show/:id",meta:{label:"Aktywności",parent:"topics"}},Uk=[t.jsx(F,{path:"/activities/create",element:t.jsx(P0,{})},"activities-create"),t.jsx(F,{path:"/activities/edit/:id",element:t.jsx(D0,{})},"activities-edit"),t.jsx(F,{path:"/activities/show/:id",element:t.jsx(Bk,{})},"activities-show")],Wk=()=>{const{activityId:e}=tt();H();const[s,n]=g.useState(null),[i,r]=g.useState(!1),{data:a,isLoading:o}=Fe({resource:"activities",id:e,meta:{select:"*, topics(*, courses(*))"}}),{data:l,isLoading:c,refetch:d}=_e({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(e)}],sorters:[{field:"position",order:"asc"}],pagination:{mode:"off"}}),{mutate:m}=ps(),{mutate:u}=Bl(),{mutate:h}=qn();if(o||c)return t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const p=a?.data,x=l?.data||[];return t.jsxs(W,{children:[t.jsx(ln,{}),t.jsxs(R,{children:[t.jsx(ie,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ct,{className:"w-6 h-6 text-blue-500"}),"Pytania quizu"]}),description:t.jsxs("div",{children:[t.jsx("div",{className:"text-lg font-medium",children:p?.title}),t.jsxs("div",{className:"text-sm text-muted-foreground",children:[p?.topics?.courses?.title," → Temat"," ",p?.topics?.position,": ",p?.topics?.title]})]})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(ne,{variant:"outline",className:"text-base px-3 py-1",children:[x.length," ",x.length===1?"pytanie":"pytań"]}),t.jsxs(T,{onClick:()=>r(!0),disabled:i,children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Dodaj pytanie"]})]})]}),t.jsx(I,{className:"bg-muted/50",children:t.jsx(M,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Próg zaliczenia:"}),t.jsxs("span",{className:"ml-2 font-medium",children:[p?.passing_score||70,"%"]})]}),p?.time_limit&&t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Limit czasu:"}),t.jsxs("span",{className:"ml-2 font-medium",children:[p.time_limit," min"]})]}),p?.max_attempts&&t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Max. prób:"}),t.jsx("span",{className:"ml-2 font-medium",children:p.max_attempts})]})]})})}),i&&t.jsx(Wd,{activityId:parseInt(e),position:x.length+1,onSave:f=>{m({resource:"questions",values:f},{onSuccess:()=>{$.success("Pytanie zostało dodane"),r(!1),d()}})},onCancel:()=>r(!1)}),t.jsx("div",{className:"space-y-4",children:x.map(f=>t.jsx("div",{children:s===f.id?t.jsx(Wd,{question:f,activityId:parseInt(e),position:f.position,onSave:j=>{u({resource:"questions",id:f.id,values:j},{onSuccess:()=>{$.success("Pytanie zostało zaktualizowane"),n(null),d()}})},onCancel:()=>n(null)}):t.jsxs(I,{children:[t.jsx(V,{children:t.jsxs(R,{children:[t.jsxs(q,{className:"text-base",children:[t.jsxs("span",{className:"text-muted-foreground mr-2",children:["#",f.position]}),f.question]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(ne,{variant:"outline",children:[f.points," pkt"]}),t.jsx(T,{variant:"outline",size:"sm",onClick:()=>n(f.id),children:t.jsx(Vt,{className:"w-3 h-3"})}),t.jsx(T,{variant:"outline",size:"sm",onClick:()=>{confirm("Czy na pewno chcesz usunąć to pytanie?")&&h({resource:"questions",id:f.id},{onSuccess:()=>{$.success("Pytanie zostało usunięte"),d()}})},children:t.jsx(xs,{className:"w-3 h-3 text-red-600"})})]})]})}),t.jsxs(M,{children:[t.jsx("div",{className:"space-y-2",children:f.options.map((j,b)=>t.jsxs("div",{className:`flex items-center gap-2 p-2 rounded ${j.is_correct?"bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800":""}`,children:[j.is_correct?t.jsx(ze,{className:"w-4 h-4 text-green-600"}):t.jsx(lt,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:j.is_correct?"font-medium":"",children:j.text})]},j.id||b))}),f.explanation&&t.jsxs("div",{className:"mt-4 p-3 bg-muted rounded",children:[t.jsx("p",{className:"text-sm font-medium mb-1",children:"Wyjaśnienie:"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:f.explanation})]})]})]})},f.id))}),x.length===0&&!i&&t.jsx(I,{children:t.jsxs(M,{className:"text-center py-12",children:[t.jsx(ct,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),t.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-4",children:"Quiz nie ma jeszcze żadnych pytań"}),t.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Dodaj pierwsze pytanie, aby uczniowie mogli rozwiązać quiz"}),t.jsxs(T,{onClick:()=>r(!0),children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Dodaj pierwsze pytanie"]})]})}),x.length>0&&t.jsxs("div",{className:"flex justify-between items-center pt-6 border-t",children:[t.jsxs("div",{className:"text-sm text-muted-foreground",children:["Łącznie punktów: ",x.reduce((f,j)=>f+j.points,0)]}),t.jsx(ln,{variant:"outline",children:"Zakończ edycję"})]})]})},Wd=({question:e,activityId:s,position:n,onSave:i,onCancel:r})=>{const[a,o]=g.useState({question:e?.question||"",explanation:e?.explanation||"",points:e?.points||1,position:n,options:e?.options||[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]}),l=()=>{if(!a.question.trim()){$.error("Pytanie jest wymagane");return}const m=a.options.filter(h=>h.text.trim());if(m.length<2){$.error("Dodaj przynajmniej 2 odpowiedzi");return}if(m.filter(h=>h.is_correct).length===0){$.error("Zaznacz przynajmniej jedną poprawną odpowiedź");return}i({activity_id:s,question:a.question,explanation:a.explanation||null,points:a.points,position:a.position,options:m.map((h,p)=>({...h,position:p+1}))})},c=()=>{a.options.length<6&&o({...a,options:[...a.options,{text:"",is_correct:!1}]})},d=m=>{if(a.options.length>2){const u=a.options.filter((h,p)=>p!==m);o({...a,options:u})}};return t.jsxs(I,{className:"border-primary",children:[t.jsx(V,{children:t.jsx(q,{children:e?"Edytuj pytanie":"Nowe pytanie"})}),t.jsxs(M,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Treść pytania"}),t.jsx(Dt,{placeholder:"Wprowadź treść pytania...",value:a.question,onChange:m=>o({...a,question:m.target.value}),className:"mt-1",rows:3})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Liczba punktów"}),t.jsx(B,{type:"number",min:"1",value:a.points,onChange:m=>o({...a,points:parseInt(m.target.value)||1}),className:"mt-1"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Pozycja"}),t.jsx(B,{type:"number",min:"1",value:a.position,onChange:m=>o({...a,position:parseInt(m.target.value)||1}),className:"mt-1"})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"Odpowiedzi"}),a.options.length<6&&t.jsxs(T,{type:"button",size:"sm",variant:"outline",onClick:c,children:[t.jsx(Re,{className:"w-3 h-3 mr-1"}),"Dodaj opcję"]})]}),t.jsx("div",{className:"space-y-2",children:a.options.map((m,u)=>t.jsxs("div",{className:"flex gap-2",children:[t.jsx(jt,{checked:m.is_correct,onCheckedChange:h=>{const p=[...a.options];p[u].is_correct=h,o({...a,options:p})}}),t.jsx(B,{placeholder:`Odpowiedź ${u+1}`,value:m.text,onChange:h=>{const p=[...a.options];p[u].text=h.target.value,o({...a,options:p})},className:"flex-1"}),a.options.length>2&&t.jsx(T,{type:"button",variant:"ghost",size:"sm",onClick:()=>d(u),children:t.jsx(lt,{className:"w-4 h-4"})})]},u))}),t.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Zaznacz checkbox przy poprawnych odpowiedziach. Możesz zaznaczyć więcej niż jedną."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Wyjaśnienie (opcjonalne)"}),t.jsx(Dt,{placeholder:"Wyjaśnienie poprawnej odpowiedzi...",value:a.explanation,onChange:m=>o({...a,explanation:m.target.value}),className:"mt-1",rows:3})]}),t.jsxs(R,{children:[t.jsxs(T,{variant:"outline",onClick:r,children:[t.jsx(lt,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),t.jsxs(T,{onClick:l,children:[t.jsx(dr,{className:"w-4 h-4 mr-2"}),"Zapisz pytanie"]})]})]})]})},Kk=()=>{const[e]=ar(),s=H(),n=e.get("activity_id"),{data:i,isLoading:r}=_e({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(n)}],sorters:[{field:"position",order:"desc"}],pagination:{mode:"off"}}),[a,o]=g.useState({question:"",explanation:"",points:1,position:1,options:[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]});g.useEffect(()=>{if(i?.data){const f=i.data.reduce((j,b)=>Math.max(j,b.position||0),0);o(j=>({...j,position:f+1}))}},[i]);const{data:l,isLoading:c}=Fe({resource:"activities",id:n,meta:{select:"*, topics(*, courses(*))"}}),{mutate:d,isLoading:m}=ps();if(!n)return t.jsx(W,{children:t.jsx(I,{children:t.jsx(M,{className:"text-center py-12",children:t.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Brak ID aktywności"})})})});if(c||r)return t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const u=l?.data;if(!u||u.type!=="quiz")return t.jsx(W,{children:t.jsx(I,{children:t.jsx(M,{className:"text-center py-12",children:t.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Nieprawidłowa aktywność lub aktywność nie jest quizem"})})})});const h=()=>{if(!a.question.trim()){$.error("Pytanie jest wymagane");return}const f=a.options.filter(b=>b.text.trim());if(f.length<2){$.error("Dodaj przynajmniej 2 odpowiedzi");return}if(f.filter(b=>b.is_correct).length===0){$.error("Zaznacz przynajmniej jedną poprawną odpowiedź");return}d({resource:"questions",values:{activity_id:parseInt(n),question:a.question,explanation:a.explanation||null,points:a.points,position:a.position,options:f.map((b,y)=>({id:y+1,text:b.text,is_correct:b.is_correct}))}},{onSuccess:()=>{$.success("Pytanie zostało dodane"),s(`/questions/manage/${n}`)},onError:b=>{console.error("Błąd podczas dodawania pytania:",b);const y=b?.code||b?.statusCode,w=b?.message||b?.error?.message;y==="23505"||y===23505?w?.includes("position")?$.error("Pytanie o tej pozycji już istnieje. Zmień pozycję na inną wartość."):$.error("Wystąpił konflikt z istniejącymi danymi. Sprawdź pozycję pytania."):y==="23503"||y===23503?$.error("Nieprawidłowe powiązanie z aktywnością."):y==="22P02"||y===22002?$.error("Nieprawidłowy format danych."):w?$.error(`Błąd: ${w}`):$.error("Wystąpił nieoczekiwany błąd. Spróbuj ponownie.")}})},p=()=>{a.options.length<6&&o({...a,options:[...a.options,{text:"",is_correct:!1}]})},x=f=>{if(a.options.length>2){const j=a.options.filter((b,y)=>y!==f);o({...a,options:j})}};return t.jsxs(W,{children:[t.jsx(ln,{}),t.jsx(R,{children:t.jsx(ie,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ct,{className:"w-6 h-6 text-blue-500"}),"Dodaj pytanie do quizu"]}),description:t.jsxs("div",{children:[t.jsx("div",{className:"text-lg font-medium",children:u?.title}),t.jsxs("div",{className:"text-sm text-muted-foreground",children:[u?.topics?.courses?.title," → Temat"," ",u?.topics?.position,": ",u?.topics?.title]})]})})}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Nowe pytanie"})}),t.jsxs(M,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Treść pytania"}),t.jsx(Dt,{placeholder:"Wprowadź treść pytania...",value:a.question,onChange:f=>o({...a,question:f.target.value}),className:"mt-1",rows:3})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Liczba punktów"}),t.jsx(B,{type:"number",min:"1",value:a.points,onChange:f=>o({...a,points:parseInt(f.target.value)||1}),className:"mt-1"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Pozycja"}),t.jsx(B,{type:"number",min:"1",value:a.position,onChange:f=>o({...a,position:parseInt(f.target.value)||1}),className:"mt-1"})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"Odpowiedzi"}),a.options.length<6&&t.jsxs(T,{type:"button",size:"sm",variant:"outline",onClick:p,children:[t.jsx(Re,{className:"w-3 h-3 mr-1"}),"Dodaj opcję"]})]}),t.jsx("div",{className:"space-y-2",children:a.options.map((f,j)=>t.jsxs("div",{className:"flex gap-2",children:[t.jsx(jt,{checked:f.is_correct,onCheckedChange:b=>{const y=[...a.options];y[j].is_correct=b,o({...a,options:y})}}),t.jsx(B,{placeholder:`Odpowiedź ${j+1}`,value:f.text,onChange:b=>{const y=[...a.options];y[j].text=b.target.value,o({...a,options:y})},className:"flex-1"}),a.options.length>2&&t.jsx(T,{type:"button",variant:"ghost",size:"sm",onClick:()=>x(j),children:t.jsx(lt,{className:"w-4 h-4"})})]},j))}),t.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Zaznacz checkbox przy poprawnych odpowiedziach. Możesz zaznaczyć więcej niż jedną."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Wyjaśnienie (opcjonalne)"}),t.jsx(Dt,{placeholder:"Wyjaśnienie poprawnej odpowiedzi...",value:a.explanation,onChange:f=>o({...a,explanation:f.target.value}),className:"mt-1",rows:3})]}),t.jsxs(R,{children:[t.jsxs(T,{variant:"outline",onClick:()=>s(`/questions/manage/${n}`),children:[t.jsx(lt,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),t.jsxs(T,{onClick:h,disabled:m,children:[t.jsx(dr,{className:"w-4 h-4 mr-2"}),m?"Zapisywanie...":"Zapisz pytanie"]})]})]})]})]})},Gk=[t.jsx(F,{path:"/questions/manage/:activityId",element:t.jsx(Wk,{})},"questions-manage"),t.jsx(F,{path:"/questions/create",element:t.jsx(Kk,{})},"questions-create")],Hk=()=>{const{create:e,edit:s,show:n}=Ue(),i=H(),{mutate:r}=qn(),{tableQuery:{data:a,isLoading:o,isError:l,refetch:c},current:d,setCurrent:m,pageSize:u,setFilters:h}=za({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, group_members(count), course_access(count)"}}),p=Ia({isLoading:o,isError:l});if(p)return p;const x=(y,w)=>{confirm(`Czy na pewno chcesz usunąć grupę "${w}"? Ta akcja usunie również wszystkie przypisania uczniów i kursów.`)&&r({resource:"groups",id:y},{onSuccess:()=>{$.success("Grupa została usunięta"),c()},onError:()=>{$.error("Błąd podczas usuwania grupy")}})},f=(y,w)=>{w?.stopPropagation(),i(`/groups/${y}/assign-courses`)},j=(y,w)=>{w?.stopPropagation(),i(`/groups/${y}/assign-students`)},b=y=>!y||!Array.isArray(y)||y.length===0?0:y[0].count||0;return t.jsxs(W,{children:[t.jsxs(R,{children:[t.jsx(ie,{title:"Grupy",description:"Zarządzaj grupami uczniów i przypisuj im kursy"}),t.jsxs(T,{onClick:()=>e("groups"),children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Dodaj grupę"]})]}),t.jsx(R,{children:t.jsx(B,{placeholder:"Szukaj grup...",className:"max-w-sm",onChange:y=>{h([{field:"name",operator:"contains",value:y.target.value}])}})}),a?.data?.length===0?t.jsx(I,{className:"border-dashed border-2",children:t.jsxs(M,{className:"text-center py-12",children:[t.jsx(He,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Brak grup"}),t.jsx("p",{className:"text-muted-foreground mb-6",children:"Utwórz pierwszą grupę, aby móc przypisywać uczniów do kursów"}),t.jsxs(T,{onClick:()=>e("groups"),children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Utwórz pierwszą grupę"]})]})}):t.jsx(be,{children:a?.data?.map(y=>{const w=b(y.group_members),z=b(y.course_access);return t.jsxs(I,{className:"cursor-pointer transition-all hover:shadow-lg hover:border-primary/50 relative overflow-hidden",onClick:N=>{!N.target.closest('[role="menu"]')&&!N.target.closest(".quick-action")&&n("groups",y.id)},children:[!y.is_active&&t.jsx("div",{className:"absolute inset-0 bg-muted/50 z-10 pointer-events-none"}),t.jsx(V,{children:t.jsxs(R,{children:[t.jsxs(q,{className:"flex items-center gap-2",children:[t.jsx(He,{className:"w-5 h-5 text-primary"}),t.jsx("span",{className:"truncate",children:y.name})]}),t.jsxs(Un,{children:[t.jsx(Wn,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"sm",onClick:N=>N.stopPropagation(),className:"relative z-20",children:t.jsx(lr,{className:"h-4 w-4"})})}),t.jsxs(on,{align:"end",children:[t.jsxs(oe,{onClick:()=>n("groups",y.id),children:[t.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),t.jsxs(oe,{onClick:()=>s("groups",y.id),children:[t.jsx(Vt,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),t.jsx(Ct,{}),t.jsxs(oe,{onClick:N=>j(y.id,N),className:"text-blue-600 focus:text-blue-600",children:[t.jsx(rn,{className:"mr-2 h-4 w-4"}),"Dodaj uczniów"]}),t.jsxs(oe,{onClick:N=>f(y.id,N),className:"text-green-600 focus:text-green-600",children:[t.jsx(Ee,{className:"mr-2 h-4 w-4"}),"Przypisz kursy"]}),t.jsx(Ct,{}),t.jsxs(oe,{onClick:()=>x(y.id,y.name),className:"text-red-600 focus:text-red-600",children:[t.jsx(xs,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})}),t.jsx(M,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(Is,{className:"w-4 h-4"}),t.jsxs("span",{children:["Rok akademicki: ",y.academic_year]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-2 bg-background rounded-md",children:t.jsx(He,{className:"w-4 h-4 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Uczniowie"}),t.jsx("p",{className:"text-lg font-semibold",children:w})]})]})}),t.jsx("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-2 bg-background rounded-md",children:t.jsx(Ee,{className:"w-4 h-4 text-green-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Kursy"}),t.jsx("p",{className:"text-lg font-semibold",children:z})]})]})})]}),t.jsxs("div",{className:"flex items-center justify-between pt-2",children:[t.jsx(ne,{variant:y.is_active?"default":"secondary",className:y.is_active?"bg-green-600":"",children:y.is_active?"Aktywna":"Nieaktywna"}),t.jsxs("div",{className:"flex gap-1",children:[w===0&&t.jsx(T,{size:"sm",variant:"ghost",className:"h-8 px-2 quick-action text-blue-600 hover:text-blue-700 hover:bg-blue-50",onClick:N=>j(y.id,N),title:"Dodaj uczniów",children:t.jsx(rn,{className:"h-4 w-4"})}),t.jsxs(T,{size:"sm",variant:"ghost",className:"h-8 px-2 quick-action text-green-600 hover:text-green-700 hover:bg-green-50",onClick:N=>f(y.id,N),title:"Przypisz kursy",children:[t.jsx(Ee,{className:"h-4 w-4"}),t.jsx(Ze,{className:"h-3 w-3 ml-1"})]})]})]})]})})]},y.id)})}),t.jsx(Oa,{current:d,pageSize:u,total:a?.total||0,setCurrent:m,itemName:"grup"})]})},Qk=()=>{const{list:e}=Ue(),{data:s}=st(),{refineCore:{onFinish:n},register:i,handleSubmit:r,setValue:a,watch:o,formState:{errors:l,isSubmitting:c}}=rs({defaultValues:{name:"",vendor_id:s?.vendor_id||0,is_active:!0,academic_year:new Date().getFullYear().toString()+"/"+(new Date().getFullYear()+1).toString()}});return t.jsxs(W,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("groups"),children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsx(R,{children:t.jsx(ie,{title:"Dodaj grupę",description:"Utwórz nową grupę uczniów"})}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Informacje o grupie"})}),t.jsx(M,{children:t.jsxs(Et,{onSubmit:r(n),children:[t.jsx(G,{label:"Nazwa grupy",htmlFor:"name",error:l.name?.message?.toString(),required:!0,children:t.jsx(B,{id:"name",placeholder:"np. Klasa 1A",...i("name",{required:"Nazwa grupy jest wymagana",minLength:{value:2,message:"Nazwa musi mieć minimum 2 znaki"}})})}),t.jsx(G,{label:"Rok akademicki",htmlFor:"academic_year",error:l.academic_year?.message?.toString(),required:!0,children:t.jsx(B,{id:"academic_year",placeholder:"np. 2024/2025",...i("academic_year",{required:"Rok akademicki jest wymagany",pattern:{value:/^\d{4}\/\d{4}$/,message:"Format: RRRR/RRRR (np. 2024/2025)"}})})}),t.jsx(G,{label:"Status grupy",children:t.jsxs(R,{variant:"start",children:[t.jsx(Ut,{checked:o("is_active"),onCheckedChange:d=>a("is_active",d)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Grupa aktywna"})]})}),t.jsxs(It,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:()=>e("groups"),children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:c,children:c?"Tworzenie...":"Utwórz grupę"})]})]})})]})]})},Zk=()=>{const{list:e}=Ue(),{id:s}=tt(),{data:n,isLoading:i}=Fe({resource:"groups",id:s,liveMode:"off"}),{refineCore:{onFinish:r},register:a,handleSubmit:o,setValue:l,watch:c,reset:d,formState:{errors:m,isSubmitting:u}}=rs({refineCoreProps:{resource:"groups",id:s,redirect:"list",liveMode:"off"}});return g.useEffect(()=>{n?.data&&d({name:n.data.name,academic_year:n.data.academic_year,is_active:n.data.is_active,vendor_id:n.data.vendor_id})},[n,d]),i?t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):t.jsxs(W,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("groups"),children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsx(R,{children:t.jsx(ie,{title:"Edytuj grupę",description:`Edycja: ${n?.data?.name}`})}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Informacje o grupie"})}),t.jsx(M,{children:t.jsxs(Et,{onSubmit:o(r),children:[t.jsx(G,{label:"Nazwa grupy",htmlFor:"name",error:m.name?.message,required:!0,children:t.jsx(B,{id:"name",placeholder:"np. Klasa 1A",...a("name",{required:"Nazwa grupy jest wymagana",minLength:{value:2,message:"Nazwa musi mieć minimum 2 znaki"}})})}),t.jsx(G,{label:"Rok akademicki",htmlFor:"academic_year",error:m.academic_year?.message,required:!0,children:t.jsx(B,{id:"academic_year",placeholder:"np. 2024/2025",...a("academic_year",{required:"Rok akademicki jest wymagany",pattern:{value:/^\d{4}\/\d{4}$/,message:"Format: RRRR/RRRR (np. 2024/2025)"}})})}),t.jsx(G,{label:"Status grupy",children:t.jsxs(R,{variant:"start",children:[t.jsx(Ut,{checked:c("is_active"),onCheckedChange:h=>l("is_active",h)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Grupa aktywna"})]})}),t.jsxs(It,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:()=>e("groups"),children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:u,children:u?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},Yk=()=>{const{list:e,edit:s,show:n}=Ue(),{id:i}=tt(),r=H(),a=Qm(),{data:o,isLoading:l}=Fe({resource:"groups",id:i,liveMode:"off"}),{data:c,isLoading:d}=_e({resource:"group_members",filters:[{field:"group_id",operator:"eq",value:i}],meta:{select:"*, users(*)"},queryOptions:{enabled:!!i},liveMode:"off"}),{data:m,isLoading:u}=_e({resource:"course_access",filters:[{field:"group_id",operator:"eq",value:i}],meta:{select:"*, courses(*)"},queryOptions:{enabled:!!i},liveMode:"off"}),h=async(b,y)=>{if(confirm(`Czy na pewno chcesz odpiąć kurs "${y}" od tej grupy?`))try{const{error:w}=await se.from("course_access").delete().eq("course_id",b).eq("group_id",parseInt(i));if(w)throw w;$.success("Kurs został odpięty od grupy"),a({resource:"course_access",invalidates:["list"]})}catch(w){console.error("Error removing course:",w),$.error("Błąd podczas odpinania kursu")}},p=async(b,y)=>{if(confirm(`Czy na pewno chcesz usunąć "${y}" z tej grupy?`))try{const{error:w}=await se.from("group_members").delete().eq("user_id",b).eq("group_id",parseInt(i));if(w)throw w;$.success("Uczeń został usunięty z grupy"),a({resource:"group_members",invalidates:["list"]})}catch(w){console.error("Error removing member:",w),$.error("Błąd podczas usuwania ucznia z grupy")}};if(l||d||u)return t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const x=o?.data,f=c?.total||0,j=m?.total||0;return t.jsxs(W,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("groups"),children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsxs(R,{children:[t.jsxs("div",{children:[t.jsx(ie,{title:x?.name,description:`Rok akademicki: ${x?.academic_year}`}),!x?.is_active&&t.jsx(ne,{variant:"secondary",className:"mt-2",children:"Grupa nieaktywna"})]}),t.jsxs(T,{onClick:()=>s("groups",x?.id??""),children:[t.jsx(Vt,{className:"w-4 h-4 mr-2"}),"Edytuj grupę"]})]}),!x?.is_active&&t.jsxs(le,{children:[t.jsx(Ul,{className:"h-4 w-4"}),t.jsx(ce,{children:"Ta grupa jest nieaktywna. Uczniowie nie mają dostępu do przypisanych kursów."})]}),t.jsxs(be,{variant:"2-2-4",children:[t.jsxs(I,{children:[t.jsx(V,{className:"pb-2",children:t.jsx(q,{className:"text-sm font-medium",children:"Status"})}),t.jsx(M,{children:t.jsx(ne,{variant:x?.is_active?"default":"secondary",className:x?.is_active?"bg-green-600":"",children:x?.is_active?"Aktywna":"Nieaktywna"})})]}),t.jsxs(I,{children:[t.jsx(V,{className:"pb-2",children:t.jsx(q,{className:"text-sm font-medium",children:"Uczniowie"})}),t.jsx(M,{children:t.jsx("div",{className:"text-2xl font-bold",children:f})})]}),t.jsxs(I,{children:[t.jsx(V,{className:"pb-2",children:t.jsx(q,{className:"text-sm font-medium",children:"Kursy"})}),t.jsx(M,{children:t.jsx("div",{className:"text-2xl font-bold",children:j})})]}),t.jsxs(I,{children:[t.jsx(V,{className:"pb-2",children:t.jsx(q,{className:"text-sm font-medium",children:"Utworzono"})}),t.jsx(M,{children:t.jsx("div",{className:"text-sm",children:new Date(x?.created_at).toLocaleDateString("pl-PL")})})]})]}),t.jsxs(be,{variant:"1-2-2",children:[t.jsxs(I,{children:[t.jsx(V,{children:t.jsxs(R,{children:[t.jsx(q,{children:"Uczniowie grupy"}),t.jsxs(T,{size:"sm",onClick:()=>r(`/groups/${i}/assign-students`),children:[t.jsx(rn,{className:"w-4 h-4 mr-2"}),"Dodaj ucznia"]})]})}),t.jsx(M,{children:c?.data?.length?t.jsx("div",{className:"space-y-2",children:c.data.map(b=>t.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/30 transition-all duration-200 group",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex gap-3 flex-1 min-w-0",children:[t.jsx("div",{className:"h-10 w-10 rounded-full bg-muted/50 flex items-center justify-center flex-shrink-0",children:t.jsx(He,{className:"h-5 w-5 text-muted-foreground"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-medium text-base leading-tight truncate pr-2",children:b.users?.full_name}),t.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[t.jsx(fs,{className:"h-3.5 w-3.5 text-muted-foreground"}),t.jsx("p",{className:"text-sm text-muted-foreground truncate",children:b.users?.email})]})]})]}),t.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx(Qt,{children:t.jsxs(Zt,{children:[t.jsx(Yt,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>n("users",b.user_id),children:t.jsx(xd,{className:"h-4 w-4"})})}),t.jsx(Ft,{children:t.jsx("p",{children:"Zobacz profil"})})]})}),t.jsx(Qt,{children:t.jsxs(Zt,{children:[t.jsx(Yt,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-red-50",onClick:()=>p(b.user_id,b.users?.full_name),children:t.jsx(xs,{className:"h-4 w-4 text-red-600"})})}),t.jsx(Ft,{children:t.jsx("p",{children:"Usuń z grupy"})})]})})]})]})},b.user_id))}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(He,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Brak uczniów w grupie"}),t.jsxs(T,{size:"sm",variant:"outline",className:"mt-4",onClick:()=>r(`/groups/${i}/assign-students`),children:[t.jsx(rn,{className:"w-4 h-4 mr-2"}),"Dodaj pierwszego ucznia"]})]})})]}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsxs(R,{children:[t.jsx(q,{children:"Przypisane kursy"}),t.jsxs(T,{size:"sm",onClick:()=>r(`/groups/${i}/assign-courses`),children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Przypisz kurs"]})]})}),t.jsx(M,{children:m?.data?.length?t.jsx("div",{className:"space-y-2",children:m.data.map(b=>t.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/30 transition-all duration-200 group",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex gap-3 flex-1 min-w-0",children:[t.jsx("div",{className:"flex-shrink-0 mt-0.5",children:b.courses?.icon_emoji?t.jsx("div",{className:"h-10 w-10 rounded-lg bg-muted/50 flex items-center justify-center",children:t.jsx("span",{className:"text-xl",children:b.courses.icon_emoji})}):t.jsx("div",{className:"h-10 w-10 rounded-lg bg-muted/50 flex items-center justify-center",children:t.jsx(Ee,{className:"h-5 w-5 text-muted-foreground"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-medium text-base leading-tight truncate pr-2",children:b.courses?.title}),t.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[t.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[t.jsx(Is,{className:"h-3.5 w-3.5"}),t.jsx("span",{children:new Date(b.assigned_at).toLocaleDateString("pl-PL")})]}),t.jsx(ne,{variant:b.courses?.is_published?"default":"secondary",className:`text-xs ${b.courses?.is_published?"bg-green-100 text-green-700 hover:bg-green-100":""}`,children:b.courses?.is_published?"Opublikowany":"Szkic"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx(Qt,{children:t.jsxs(Zt,{children:[t.jsx(Yt,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>n("courses",b.course_id),children:t.jsx(xd,{className:"h-4 w-4"})})}),t.jsx(Ft,{children:t.jsx("p",{children:"Zobacz kurs"})})]})}),t.jsx(Qt,{children:t.jsxs(Zt,{children:[t.jsx(Yt,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-red-50",onClick:()=>h(b.course_id,b.courses?.title),children:t.jsx(xs,{className:"h-4 w-4 text-red-600"})})}),t.jsx(Ft,{children:t.jsx("p",{children:"Odepnij kurs"})})]})})]})]})},b.course_id))}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(Ee,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Brak przypisanych kursów"}),t.jsxs(T,{size:"sm",variant:"outline",className:"mt-4",onClick:()=>r(`/groups/${i}/assign-courses`),children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Przypisz pierwszy kurs"]})]})})]})]})]})},Jk=()=>{const{id:e}=tt(),s=H(),[n,i]=g.useState([]),[r,a]=g.useState(""),[o,l]=g.useState(!1),{data:c,isLoading:d}=Fe({resource:"groups",id:e}),{data:m,isLoading:u}=_e({resource:"courses",pagination:{mode:"off"},meta:{select:"*, topics(count)"}}),{data:h,isLoading:p}=_e({resource:"course_access",filters:[{field:"group_id",operator:"eq",value:parseInt(e)}],pagination:{mode:"off"},meta:{select:"course_id, group_id"}}),{mutate:x,isLoading:f}=ps(),j=async()=>{if(n.length===0){$.error("Wybierz przynajmniej jeden kurs");return}try{const v=n.map(P=>x({resource:"course_access",values:{course_id:P,group_id:parseInt(e)}},{onSuccess:()=>{console.log(`Course ${P} assigned successfully`)},onError:_=>{console.error("Error assigning course:",P,_)}}));await Promise.all(v),$.success(`Przypisano ${n.length} ${n.length===1?"kurs":"kursów"} do grupy`),s(`/groups/show/${e}`)}catch(v){$.error("Błąd podczas przypisywania kursów"),console.error("Error details:",v)}};if(d||u||p)return t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const b=c?.data,y=h?.data?.map(v=>v.course_id)||[];let w=m?.data?.filter(v=>!y.includes(v.id))||[];o&&(w=w.filter(v=>v.is_published));const z=w.filter(v=>v.title.toLowerCase().includes(r.toLowerCase())||v.description?.toLowerCase().includes(r.toLowerCase())),N=v=>{i(P=>P.includes(v)?P.filter(_=>_!==v):[...P,v])},S=()=>{i(z.map(v=>v.id))},k=()=>{i([])},C=w.filter(v=>v.is_published).length,A=w.length-C;return t.jsxs(W,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>s(`/groups/show/${e}`),children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do grupy"]}),t.jsx(R,{children:t.jsx(ie,{title:"Przypisz kursy",description:`Przypisywanie kursów do grupy: ${b?.name}`})}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsxs(R,{children:[t.jsxs("div",{children:[t.jsx(q,{children:"Dostępne kursy"}),w.length>0&&t.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[C," opublikowanych, ",A," szkiców"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>l(!o),className:o?"bg-primary text-primary-foreground":"",children:[t.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Tylko opublikowane"]}),t.jsxs(T,{variant:"outline",size:"sm",onClick:S,disabled:z.length===0,children:[t.jsx(ze,{className:"w-4 h-4 mr-2"}),"Zaznacz wszystkie"]}),t.jsxs(T,{variant:"outline",size:"sm",onClick:k,disabled:n.length===0,children:[t.jsx(lt,{className:"w-4 h-4 mr-2"}),"Odznacz wszystkie"]})]})]})}),t.jsxs(M,{children:[t.jsxs("div",{className:"relative mb-4",children:[t.jsx(eh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),t.jsx(B,{placeholder:"Szukaj kursów po nazwie lub opisie...",value:r,onChange:v=>a(v.target.value),className:"pl-10"})]}),z.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:w.length===0?t.jsxs(t.Fragment,{children:[t.jsx(Ee,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{className:"font-medium mb-1",children:"Wszystkie kursy są już przypisane"}),t.jsx("p",{className:"text-sm",children:"Ta grupa ma dostęp do wszystkich dostępnych kursów"}),t.jsx(T,{size:"sm",variant:"outline",className:"mt-4",onClick:()=>s("/courses"),children:"Przejdź do listy kursów"})]}):t.jsxs(t.Fragment,{children:[t.jsx(Ee,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Nie znaleziono kursów spełniających kryteria"})]})}):t.jsx("div",{className:"space-y-2",children:z.map(v=>{const P=v._count?.topics||0;return t.jsxs("div",{className:`
                      flex items-center space-x-3 p-3 border rounded-lg 
                      cursor-pointer transition-all
                      ${n.includes(v.id)?"border-primary bg-primary/5":"hover:bg-muted/50"}
                    `,onClick:()=>N(v.id),children:[t.jsx(jt,{checked:n.includes(v.id),onCheckedChange:()=>N(v.id),onClick:_=>_.stopPropagation()}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[v.icon_emoji&&t.jsx("span",{className:"text-xl",children:v.icon_emoji}),t.jsx("span",{className:"font-medium",children:v.title}),t.jsx(ne,{variant:v.is_published?"default":"secondary",className:"text-xs",children:v.is_published?"Opublikowany":"Szkic"})]}),v.description&&t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:v.description}),t.jsx("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:t.jsxs("span",{children:[P," ",P===1?"temat":"tematów"]})})]}),t.jsx(Qt,{children:t.jsxs(Zt,{children:[t.jsx(Yt,{asChild:!0,children:t.jsx(T,{size:"sm",variant:"ghost",onClick:_=>{_.stopPropagation(),s(`/courses/show/${v.id}`)},children:t.jsx(Ve,{className:"h-4 w-4"})})}),t.jsx(Ft,{children:t.jsx("p",{children:"Zobacz kurs"})})]})})]},v.id)})}),n.length>0&&t.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[t.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:["Wybrano ",n.length," kursów do przypisania"]}),t.jsxs(R,{children:[t.jsx(T,{variant:"outline",onClick:()=>s(`/groups/show/${e}`),children:"Anuluj"}),t.jsx(T,{onClick:j,disabled:f,children:f?"Przypisywanie...":"Przypisz kursy"})]})]})]})]})]})},Xk=()=>{const{id:e}=tt(),s=H(),[n,i]=g.useState([]),[r,a]=g.useState(""),{data:o,isLoading:l}=Fe({resource:"groups",id:e}),{data:c,isLoading:d}=_e({resource:"users",filters:[{field:"role",operator:"eq",value:"student"}],pagination:{mode:"off"}}),{data:m,isLoading:u}=_e({resource:"group_members",filters:[{field:"group_id",operator:"eq",value:parseInt(e)}],pagination:{mode:"off"},meta:{select:"user_id, group_id"}}),{mutate:h,isLoading:p}=ps(),x=async()=>{if(n.length===0){$.error("Wybierz przynajmniej jednego ucznia");return}try{const S=n.map(k=>h({resource:"group_members",values:{user_id:k,group_id:parseInt(e)}},{onSuccess:()=>{console.log(`Student ${k} assigned successfully`)},onError:C=>{console.error("Error assigning student:",k,C)}}));await Promise.all(S),$.success(`Dodano ${n.length} uczniów do grupy`),s(`/groups/show/${e}`)}catch(S){$.error("Błąd podczas dodawania uczniów"),console.error("Error details:",S)}};if(l||d||u)return t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const f=o?.data,j=m?.data?.map(S=>S.user_id)||[],b=c?.data?.filter(S=>!j.includes(S.id))||[],y=b.filter(S=>S.full_name.toLowerCase().includes(r.toLowerCase())||S.email.toLowerCase().includes(r.toLowerCase())),w=S=>{i(k=>k.includes(S)?k.filter(C=>C!==S):[...k,S])},z=()=>{i(y.map(S=>S.id))},N=()=>{i([])};return t.jsxs(W,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>s(`/groups/show/${e}`),children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do grupy"]}),t.jsx(R,{children:t.jsx(ie,{title:"Dodaj uczniów",description:`Dodawanie uczniów do grupy: ${f?.name}`})}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsxs(R,{children:[t.jsx(q,{children:"Dostępni uczniowie"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:z,disabled:y.length===0,children:[t.jsx(ze,{className:"w-4 h-4 mr-2"}),"Zaznacz wszystkich"]}),t.jsxs(T,{variant:"outline",size:"sm",onClick:N,disabled:n.length===0,children:[t.jsx(lt,{className:"w-4 h-4 mr-2"}),"Odznacz wszystkich"]})]})]})}),t.jsxs(M,{children:[t.jsx(B,{placeholder:"Szukaj uczniów...",value:r,onChange:S=>a(S.target.value),className:"mb-4"}),y.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:b.length===0?t.jsxs(t.Fragment,{children:[t.jsx(rn,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Wszyscy uczniowie są już w tej grupie"})]}):t.jsxs(t.Fragment,{children:[t.jsx(rn,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Nie znaleziono uczniów"})]})}):t.jsx("div",{className:"space-y-2",children:y.map(S=>t.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-muted/50 cursor-pointer",onClick:()=>w(S.id),children:[t.jsx(jt,{checked:n.includes(S.id),onCheckedChange:()=>w(S.id),onClick:k=>k.stopPropagation()}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium",children:S.full_name}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(fs,{className:"w-3 h-3"}),S.email]})]}),t.jsx(ne,{variant:"secondary",className:"text-xs",children:"Uczeń"})]},S.id))}),n.length>0&&t.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[t.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:["Wybrano ",n.length," uczniów do dodania"]}),t.jsxs(R,{children:[t.jsx(T,{variant:"outline",onClick:()=>s(`/groups/show/${e}`),children:"Anuluj"}),t.jsx(T,{onClick:x,disabled:p,children:p?"Dodawanie...":"Dodaj uczniów"})]})]})]})]})]})},ez={name:"groups",list:"/groups",create:"/groups/create",edit:"/groups/edit/:id",show:"/groups/show/:id",meta:{label:"Grupy",icon:t.jsx(He,{className:"h-4 w-4"})}},tz=[t.jsx(F,{path:"/groups",element:t.jsx(Hk,{})},"groups-list"),t.jsx(F,{path:"/groups/create",element:t.jsx(Qk,{})},"groups-create"),t.jsx(F,{path:"/groups/edit/:id",element:t.jsx(Zk,{})},"groups-edit"),t.jsx(F,{path:"/groups/show/:id",element:t.jsx(Yk,{})},"groups-show"),t.jsx(F,{path:"/groups/:id/assign-courses",element:t.jsx(Jk,{})},"groups-assign-courses"),t.jsx(F,{path:"/groups/:id/assign-students",element:t.jsx(Xk,{})},"groups-assign-students")],sz=()=>{const{create:e,edit:s,show:n}=Ue(),{mutate:i}=qn(),[r,a]=g.useState("all"),{tableQuery:{data:o,isLoading:l,isError:c},current:d,setCurrent:m,pageSize:u,setFilters:h}=za({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, user_stats(total_points, current_level)"}}),p=Ia({isLoading:l,isError:c});if(p)return p;const x=(y,w)=>{confirm(`Czy na pewno chcesz usunąć użytkownika "${w}"?`)&&i({resource:"users",id:y})},f=y=>{const w=[];y&&w.push({operator:"or",value:[{field:"full_name",operator:"contains",value:y},{field:"email",operator:"contains",value:y}]}),r!=="all"&&w.push({field:"role",operator:"eq",value:r}),h(w)},j=y=>{switch(y){case"admin":return t.jsx(Sa,{className:"w-3 h-3"});case"teacher":return t.jsx(Es,{className:"w-3 h-3"});default:return t.jsx(sj,{className:"w-3 h-3"})}},b=y=>{switch(y){case"admin":return"destructive";case"teacher":return"default";default:return"secondary"}};return t.jsxs(W,{children:[t.jsxs(R,{children:[t.jsx(ie,{title:"Użytkownicy",description:"Zarządzaj użytkownikami systemu"}),t.jsxs(T,{onClick:()=>e("users"),children:[t.jsx(Re,{className:"w-4 h-4 mr-2"}),"Dodaj użytkownika"]})]}),t.jsxs(R,{className:"gap-4",children:[t.jsxs("div",{className:"relative flex-1 max-w-sm",children:[t.jsx(eh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),t.jsx(B,{placeholder:"Szukaj po nazwie lub email...",className:"pl-10",onChange:y=>f(y.target.value)})]}),t.jsxs(Te,{value:r,onValueChange:y=>{a(y),f("")},children:[t.jsx(Ne,{className:"w-[180px]",children:t.jsx(Ae,{placeholder:"Filtruj po roli"})}),t.jsxs(ke,{children:[t.jsx(K,{value:"all",children:"Wszystkie role"}),t.jsx(K,{value:"student",children:"Studenci"}),t.jsx(K,{value:"teacher",children:"Nauczyciele"}),t.jsx(K,{value:"admin",children:"Administratorzy"})]})]})]}),t.jsx("div",{className:"space-y-4",children:o?.data?.map(y=>t.jsx(I,{children:t.jsx(M,{className:"p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center",children:t.jsx(He,{className:"h-6 w-6 text-muted-foreground"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:y.full_name}),t.jsx("p",{className:"text-sm text-muted-foreground",children:y.email})]}),t.jsxs(ne,{variant:b(y.role),children:[j(y.role),t.jsx("span",{className:"ml-1 capitalize",children:y.role})]}),t.jsx(ne,{variant:y.is_active?"outline":"secondary",children:y.is_active?"Aktywny":"Nieaktywny"})]}),t.jsxs("div",{className:"flex items-center gap-6",children:[y.user_stats&&t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Punkty"}),t.jsx("p",{className:"font-semibold",children:y.user_stats.total_points})]}),t.jsxs(Un,{children:[t.jsx(Wn,{asChild:!0,children:t.jsx(T,{variant:"ghost",size:"sm",children:t.jsx(lr,{className:"h-4 w-4"})})}),t.jsxs(on,{align:"end",children:[t.jsxs(oe,{onClick:()=>n("users",y.id),children:[t.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),t.jsxs(oe,{onClick:()=>s("users",y.id),children:[t.jsx(Vt,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),t.jsxs(oe,{onClick:()=>x(y.id,y.full_name),className:"text-red-600",children:[t.jsx(xs,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})]})})},y.id))}),t.jsx(Oa,{current:d,pageSize:u,total:o?.total||0,setCurrent:m,itemName:"użytkowników"})]})},nz=()=>{const{list:e}=Ue(),{data:s}=st(),{refineCore:{onFinish:n},register:i,handleSubmit:r,setValue:a,watch:o,formState:{errors:l,isSubmitting:c}}=rs({defaultValues:{full_name:"",email:"",vendor_id:s?.vendor_id||0,role:"student",is_active:!0}});return t.jsxs(W,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("users"),children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsx(R,{children:t.jsx(ie,{title:"Dodaj użytkownika",description:"Utwórz nowe konto użytkownika"})}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Dane użytkownika"})}),t.jsx(M,{children:t.jsxs(Et,{onSubmit:r(n),children:[t.jsxs(be,{variant:"1-2-2",children:[t.jsx(G,{label:"Imię i nazwisko",htmlFor:"full_name",error:l.full_name?.message?.toString(),required:!0,children:t.jsx(B,{id:"full_name",placeholder:"np. Jan Kowalski",...i("full_name",{required:"Imię i nazwisko są wymagane",minLength:{value:3,message:"Minimum 3 znaki"}})})}),t.jsx(G,{label:"Email",htmlFor:"email",error:l.email?.message?.toString(),required:!0,children:t.jsx(B,{id:"email",type:"email",placeholder:"np. jan.kowalski@example.com",...i("email",{required:"Email jest wymagany",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Nieprawidłowy format email"}})})}),t.jsx(G,{label:"Rola",error:l.role?.message?.toString(),required:!0,children:t.jsxs(Te,{value:o("role"),onValueChange:d=>a("role",d),children:[t.jsx(Ne,{children:t.jsx(Ae,{placeholder:"Wybierz rolę"})}),t.jsxs(ke,{children:[t.jsx(K,{value:"student",children:"Student"}),t.jsx(K,{value:"teacher",children:"Nauczyciel"}),t.jsx(K,{value:"admin",children:"Administrator"})]})]})})]}),t.jsx(G,{label:"Status konta",children:t.jsxs(R,{variant:"start",children:[t.jsx(Ut,{checked:o("is_active"),onCheckedChange:d=>a("is_active",d)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Konto aktywne (użytkownik może się zalogować)"})]})}),t.jsxs(It,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:()=>e("users"),children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:c,children:c?"Tworzenie...":"Utwórz użytkownika"})]})]})})]})]})},iz=()=>{const{list:e}=Ue(),{id:s}=tt(),{data:n,isLoading:i}=Fe({resource:"users",id:s,liveMode:"off"}),{refineCore:{onFinish:r},register:a,handleSubmit:o,setValue:l,watch:c,reset:d,formState:{errors:m,isSubmitting:u}}=rs({refineCoreProps:{resource:"users",id:s,redirect:"list",liveMode:"off"}});return g.useEffect(()=>{n?.data&&d({full_name:n.data.full_name,email:n.data.email,role:n.data.role,is_active:n.data.is_active,vendor_id:n.data.vendor_id})},[n,d]),i?t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):t.jsxs(W,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("users"),children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsx(R,{children:t.jsx(ie,{title:"Edytuj użytkownika",description:`Edycja: ${n?.data?.full_name}`})}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Dane użytkownika"})}),t.jsx(M,{children:t.jsxs(Et,{onSubmit:o(r),children:[t.jsxs(be,{variant:"1-2-2",children:[t.jsx(G,{label:"Imię i nazwisko",htmlFor:"full_name",error:m.full_name?.message,required:!0,children:t.jsx(B,{id:"full_name",placeholder:"np. Jan Kowalski",...a("full_name",{required:"Imię i nazwisko są wymagane",minLength:{value:3,message:"Minimum 3 znaki"}})})}),t.jsx(G,{label:"Email",htmlFor:"email",error:m.email?.message,required:!0,children:t.jsx(B,{id:"email",type:"email",placeholder:"np. jan.kowalski@example.com",...a("email",{required:"Email jest wymagany",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Nieprawidłowy format email"}}),disabled:!0})}),t.jsx(G,{label:"Rola",error:m.role?.message,required:!0,children:t.jsxs(Te,{value:c("role")||"student",onValueChange:h=>l("role",h),children:[t.jsx(Ne,{children:t.jsx(Ae,{placeholder:"Wybierz rolę"})}),t.jsxs(ke,{children:[t.jsx(K,{value:"student",children:"Student"}),t.jsx(K,{value:"teacher",children:"Nauczyciel"}),t.jsx(K,{value:"admin",children:"Administrator"})]})]})})]}),t.jsx(G,{label:"Status konta",children:t.jsxs(R,{variant:"start",children:[t.jsx(Ut,{checked:c("is_active")??!0,onCheckedChange:h=>l("is_active",h)}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Konto aktywne (użytkownik może się zalogować)"})]})}),t.jsxs(It,{children:[t.jsx(T,{type:"button",variant:"outline",onClick:()=>e("users"),children:"Anuluj"}),t.jsx(T,{type:"submit",disabled:u,children:u?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},rz=()=>{const{list:e,edit:s}=Ue(),{id:n}=tt(),{data:i,isLoading:r}=Fe({resource:"users",id:n,meta:{select:"*, user_stats(*)"}}),{data:a}=_e({resource:"activity_progress",filters:[{field:"user_id",operator:"eq",value:n}]});if(r)return t.jsx(W,{children:t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const o=i?.data,l=o?.user_stats?.[0]||{},c=d=>{switch(d){case"admin":return t.jsx(Sa,{className:"w-4 h-4"});case"teacher":return t.jsx(Ee,{className:"w-4 h-4"});default:return t.jsx(ss,{className:"w-4 h-4"})}};return t.jsxs(W,{children:[t.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e("users"),children:[t.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),t.jsxs(R,{children:[t.jsx(ie,{title:o?.full_name,description:o?.email}),t.jsxs(T,{onClick:()=>s("users",o?.id??""),children:[t.jsx(Vt,{className:"w-4 h-4 mr-2"}),"Edytuj użytkownika"]})]}),t.jsxs(be,{children:[t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Informacje podstawowe"})}),t.jsx(M,{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Imię i nazwisko"}),t.jsx("p",{className:"text-lg",children:o?.full_name})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),t.jsxs("p",{className:"text-lg flex items-center gap-2",children:[t.jsx(fs,{className:"w-4 h-4"}),o?.email]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Rola"}),t.jsxs(ne,{variant:"default",className:"mt-1",children:[c(o?.role),t.jsx("span",{className:"ml-1 capitalize",children:o?.role})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),t.jsx(ne,{variant:o?.is_active?"outline":"secondary",className:"mt-1",children:o?.is_active?"Aktywny":"Nieaktywny"})]})]})})]}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Statystyki gamifikacji"})}),t.jsx(M,{children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[t.jsx(Je,{className:"w-8 h-8 mx-auto mb-2 text-yellow-500"}),t.jsx("p",{className:"text-2xl font-bold",children:l.total_points||0}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Punkty"})]}),t.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[t.jsx(Ds,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),t.jsx("p",{className:"text-2xl font-bold",children:l.current_level||1}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Poziom"})]}),t.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[t.jsx(Jm,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),t.jsx("p",{className:"text-2xl font-bold",children:l.daily_streak||0}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Dni z rzędu"})]}),t.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[t.jsx(qt,{className:"w-8 h-8 mx-auto mb-2 text-purple-500"}),t.jsx("p",{className:"text-2xl font-bold",children:Math.round((l.total_time_spent||0)/60)}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Godzin nauki"})]})]})})]}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Postępy w nauce"})}),t.jsx(M,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Ukończone quizy"}),t.jsx("span",{className:"font-bold",children:l.quizzes_completed||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Wyniki perfekcyjne"}),t.jsx("span",{className:"font-bold",children:l.perfect_scores||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Ukończone aktywności"}),t.jsx("span",{className:"font-bold",children:a?.data?.filter(d=>d.completed_at).length||0})]})]})})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{className:"text-lg",children:"Daty"})}),t.jsxs(M,{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Utworzono"}),t.jsx("p",{className:"text-sm font-medium",children:new Date(o?.created_at).toLocaleDateString("pl-PL")})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Ostatnia aktywność"}),t.jsx("p",{className:"text-sm font-medium",children:l.last_active?new Date(l.last_active).toLocaleDateString("pl-PL"):"Brak aktywności"})]})]})]}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{className:"text-lg",children:"Idle Game"})}),t.jsxs(M,{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm",children:"Punkty/h"}),t.jsx("span",{className:"font-bold",children:l.idle_points_rate||1})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Ostatnie odebranie"}),t.jsx("p",{className:"text-sm font-medium",children:l.last_idle_claim?new Date(l.last_idle_claim).toLocaleString("pl-PL"):"Nigdy"})]})]})]})]})]})]})},az={name:"users",list:"/users",create:"/users/create",edit:"/users/edit/:id",show:"/users/show/:id",meta:{label:"Użytkownicy",icon:t.jsx(He,{className:"h-4 w-4"})}},oz=[t.jsx(F,{path:"/users",element:t.jsx(sz,{})},"users-list"),t.jsx(F,{path:"/users/create",element:t.jsx(nz,{})},"users-create"),t.jsx(F,{path:"/users/edit/:id",element:t.jsx(iz,{})},"users-edit"),t.jsx(F,{path:"/users/show/:id",element:t.jsx(rz,{})},"users-show")],lz=()=>{const{tableQuery:{data:e,isLoading:s,isError:n},current:i,setCurrent:r,pageSize:a,setFilters:o}=za({sorters:{initial:[{field:"created_at",order:"desc"}]}}),l=Ia({isLoading:s,isError:n});return l||t.jsxs(W,{children:[t.jsx(ie,{title:"Organizacje",description:"Lista wszystkich organizacji w systemie"}),t.jsx(R,{children:t.jsx(B,{placeholder:"Szukaj organizacji...",className:"max-w-sm",onChange:c=>{o([{operator:"or",value:[{field:"name",operator:"contains",value:c.target.value},{field:"subdomain",operator:"contains",value:c.target.value}]}])}})}),t.jsx(be,{children:e?.data?.map(c=>t.jsxs(I,{children:[t.jsx(V,{children:t.jsxs(R,{children:[t.jsxs(q,{className:"flex items-center gap-2",children:[t.jsx(th,{className:"w-5 h-5"}),c.name]}),t.jsx(ne,{variant:c.is_active?"default":"secondary",children:c.is_active?"Aktywna":"Nieaktywna"})]})}),t.jsxs(M,{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(nj,{className:"w-3 h-3"}),t.jsxs("span",{children:[c.subdomain,".example.com"]})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(Is,{className:"w-3 h-3"}),t.jsxs("span",{children:["Utworzono: ",new Date(c.created_at).toLocaleDateString("pl-PL")]})]})]})]},c.id))}),t.jsx(Oa,{current:i,pageSize:a,total:e?.total||0,setCurrent:r,itemName:"organizacji"})]})},cz={name:"vendors",list:"/vendors",meta:{label:"Organizacje",icon:t.jsx(th,{className:"h-4 w-4"})}},dz=[t.jsx(F,{path:"/vendors",element:t.jsx(lz,{})},"vendors-list")],uz=()=>{const[e,s]=g.useState("users"),[n,i]=g.useState("month"),[r,a]=g.useState(!1),o=async()=>{a(!0);try{alert("Funkcja generowania raportów będzie dostępna wkrótce")}catch(c){console.error("Error generating report:",c)}finally{a(!1)}},l=[{id:"users",name:"Raport użytkowników",description:"Statystyki użytkowników, postępy, aktywność",icon:He},{id:"courses",name:"Raport kursów",description:"Popularność kursów, wskaźniki ukończenia",icon:Ee},{id:"gamification",name:"Raport gamifikacji",description:"Punkty, poziomy, rankingi",icon:Bn},{id:"activity",name:"Raport aktywności",description:"Logi, czas nauki, częstotliwość",icon:Xs}];return t.jsxs(W,{children:[t.jsx(ie,{title:"Raporty",description:"Generuj raporty i analizy systemu"}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Generator raportów"})}),t.jsxs(M,{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"Typ raportu"}),t.jsxs(Te,{value:e,onValueChange:s,children:[t.jsx(Ne,{children:t.jsx(Ae,{})}),t.jsx(ke,{children:l.map(c=>t.jsx(K,{value:c.id,children:c.name},c.id))})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"Zakres czasowy"}),t.jsxs(Te,{value:n,onValueChange:i,children:[t.jsx(Ne,{children:t.jsx(Ae,{})}),t.jsxs(ke,{children:[t.jsx(K,{value:"week",children:"Ostatni tydzień"}),t.jsx(K,{value:"month",children:"Ostatni miesiąc"}),t.jsx(K,{value:"quarter",children:"Ostatni kwartał"}),t.jsx(K,{value:"year",children:"Ostatni rok"}),t.jsx(K,{value:"all",children:"Wszystkie dane"})]})]})]})]}),t.jsx("div",{className:"p-4 border rounded-lg bg-muted/50",children:l.find(c=>c.id===e)&&t.jsxs("div",{className:"flex items-start gap-3",children:[(()=>{const c=l.find(d=>d.id===e).icon;return t.jsx(c,{className:"w-5 h-5 mt-0.5 text-muted-foreground"})})(),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium",children:l.find(c=>c.id===e).name}),t.jsx("p",{className:"text-sm text-muted-foreground",children:l.find(c=>c.id===e).description})]})]})}),t.jsxs(T,{onClick:o,disabled:r,className:"w-full",children:[t.jsx(ij,{className:"w-4 h-4 mr-2"}),r?"Generowanie...":"Generuj raport"]})]})]}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsx(q,{children:"Ostatnie raporty"})}),t.jsx(M,{children:t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(et,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),t.jsx("p",{children:"Brak wygenerowanych raportów"}),t.jsx("p",{className:"text-sm mt-1",children:"Wygenerowane raporty będą wyświetlane tutaj"})]})})]})]})},mz={name:"reports",list:"/reports",meta:{label:"Raporty",icon:t.jsx(et,{className:"h-4 w-4"})}},hz=[t.jsx(F,{path:"/reports",element:t.jsx(uz,{})},"reports")],Kd={id:"educational-material-wizard",title:"Kreator materiałów edukacyjnych",schema:{step1:{title:"Podstawowe informacje",type:"object",properties:{subject:{type:"text",title:"Temat materiału",placeholder:"np. Wprowadzenie do programowania w Python"},targetLevel:{type:"select",title:"Poziom zaawansowania",options:[{value:"beginner",label:"Początkujący"},{value:"intermediate",label:"Średniozaawansowany"},{value:"advanced",label:"Zaawansowany"}]},ageGroup:{type:"select",title:"Grupa wiekowa",options:[{value:"7-10",label:"7-10 lat (szkoła podstawowa)"},{value:"11-14",label:"11-14 lat (klasy 4-8)"},{value:"15-18",label:"15-18 lat (szkoła średnia)"},{value:"18+",label:"18+ (dorośli)"}]}},required:["subject","targetLevel","ageGroup"]},step2:{title:"Analiza tematu",type:"object",properties:{keyTopics:{type:"tags",title:"Kluczowe zagadnienia",readOnly:!0},learningObjectives:{type:"textarea",title:"Cele nauczania",readOnly:!0},prerequisites:{type:"tags",title:"Wymagania wstępne",readOnly:!0},estimatedDuration:{type:"number",title:"Szacowany czas (min)",readOnly:!0}}},step3:{title:"Dostosowanie celów",type:"object",properties:{learningObjectives:{type:"textarea",title:"Cele nauczania (edytowalne)",placeholder:"Dostosuj cele nauczania...",rows:6},materialType:{type:"select",title:"Typ materiału",options:[{value:"lesson",label:"Lekcja z teorią"},{value:"exercise",label:"Ćwiczenia praktyczne"},{value:"mixed",label:"Teoria + ćwiczenia"}]}},required:["learningObjectives","materialType"]},step4:{title:"Podgląd materiału",type:"object",properties:{title:{type:"text",title:"Tytuł materiału",readOnly:!0},content:{type:"textarea",title:"Treść materiału",readOnly:!0},exercises:{type:"textarea",title:"Ćwiczenia",readOnly:!0},summary:{type:"textarea",title:"Podsumowanie",readOnly:!0}}},step5:{title:"Finalizacja",type:"object",properties:{courseId:{type:"select",title:"Wybierz kurs",placeholder:"Wybierz kurs..."},topicId:{type:"select",title:"Wybierz temat",placeholder:"Najpierw wybierz kurs..."},activityTitle:{type:"text",title:"Tytuł aktywności",placeholder:"np. Wprowadzenie do zmiennych"},activityType:{type:"select",title:"Typ aktywności",options:[{value:"material",label:"Materiał edukacyjny"},{value:"quiz",label:"Quiz sprawdzający"}]},content:{type:"textarea",title:"Treść materiału",placeholder:"Edytuj wygenerowaną treść...",rows:15},duration:{type:"number",title:"Czas trwania (min)",placeholder:"15"}},required:["courseId","topicId","activityTitle","activityType","content"]}}},pz={id:"analyze-topic",name:"Analiza tematu edukacyjnego",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od edukacji i tworzenia materiałów dydaktycznych.",user:`
Przeanalizuj temat edukacyjny:
Temat: {{subject}}
Poziom: {{targetLevel}}
Grupa wiekowa: {{ageGroup}}

Wygeneruj JSON:
{
  "keyTopics": ["temat1", "temat2", "temat3"],
  "learningObjectives": "<szczegółowe cele nauczania - czego uczeń się nauczy>",
  "prerequisites": ["wymaganie1", "wymaganie2"],
  "estimatedDuration": <liczba minut>
}

Wymagania:
- KeyTopics: 3-7 kluczowych zagadnień do omówienia
- LearningObjectives: konkretne, mierzalne cele (100-200 słów)
- Prerequisites: 2-5 wymagań wstępnych (może być puste dla początkujących)
- EstimatedDuration: realistyczny czas w minutach (15-90)
    `,responseFormat:"json"},inputMapping:e=>({subject:e.subject,targetLevel:e.targetLevel,ageGroup:e.ageGroup}),outputMapping:(e,s)=>({...s,keyTopics:e.keyTopics,learningObjectives:e.learningObjectives,prerequisites:e.prerequisites,estimatedDuration:e.estimatedDuration}),validation:e=>!!(e.keyTopics&&e.learningObjectives&&e.estimatedDuration)},fz={id:"generate-material",name:"Generowanie materiału edukacyjnego",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś doświadczonym nauczycielem tworzącym angażujące materiały edukacyjne.",user:`
Stwórz materiał edukacyjny:

Temat: {{subject}}
Poziom: {{targetLevel}}
Grupa wiekowa: {{ageGroup}}
Cele nauczania: {{learningObjectives}}
Typ materiału: {{materialType}}
Kluczowe zagadnienia: {{keyTopics}}

Wygeneruj JSON:
{
  "title": "<atrakcyjny tytuł materiału>",
  "content": "<treść materiału w formacie Markdown - teoria, przykłady, wyjaśnienia>",
  "exercises": "<ćwiczenia praktyczne w formacie Markdown>",
  "summary": "<podsumowanie najważniejszych punktów>"
}

Wymagania:
- Title: kreatywny i zachęcający do nauki
- Content: dostosowany do wieku, z przykładami, min. 500 słów
- Exercises: 3-5 ćwiczeń praktycznych z instrukcjami
- Summary: bullet points z najważniejszymi informacjami
- Używaj formatowania Markdown (nagłówki, listy, kod)
- Język dostosowany do grupy wiekowej
    `,responseFormat:"json"},inputMapping:e=>({subject:e.subject,targetLevel:e.targetLevel,ageGroup:e.ageGroup,learningObjectives:e.learningObjectives,materialType:e.materialType,keyTopics:Array.isArray(e.keyTopics)?e.keyTopics.join(", "):e.keyTopics}),outputMapping:(e,s)=>({...s,title:e.title,content:e.content,exercises:e.exercises,summary:e.summary}),validation:e=>!!(e.title&&e.content&&e.exercises&&e.summary)},ft={subject:{minLength:5,errorMessage:"Temat jest wymagany (5-200 znaków)"},activityTitle:{minLength:3,maxLength:100,errorMessage:"Tytuł jest wymagany (3-100 znaków)"},content:{minLength:100,errorMessage:"Treść materiału jest wymagana (min. 100 znaków)"},duration:{min:5,max:180,errorMessage:"Czas trwania musi być między 5 a 180 minut"}},ni={steps:{1:{title:"O czym chcesz stworzyć materiał?",description:"Podaj temat, poziom zaawansowania i grupę docelową - AI pomoże stworzyć angażujący materiał edukacyjny",button:"Analizuj temat",loading:"Analizuję temat..."},2:{title:"Analiza tematu",description:"AI przeanalizowała temat i zaproponowała strukturę materiału",success:"✓ Analiza zakończona pomyślnie"},3:{title:"Dostosuj cele i typ materiału",description:"Możesz zmodyfikować cele nauczania i wybrać typ materiału do wygenerowania",button:"Generuj materiał",loading:"Generuję materiał...",loadingInfo:"⚡ AI tworzy spersonalizowany materiał edukacyjny..."},4:{title:"Podgląd wygenerowanego materiału",description:"AI przygotowała kompletny materiał edukacyjny",info:"💡 W następnym kroku wybierzesz kurs i temat, do którego dodasz materiał."},5:{title:"Zapisz materiał w kursie",description:"Wybierz kurs i temat, następnie dostosuj materiał przed zapisaniem",saveInfo:"💾 Materiał zostanie zapisany jako nowa aktywność w wybranym temacie",button:"Zapisz materiał",loading:"Zapisuję...",success:"✓ Materiał został zapisany pomyślnie! Przekierowuję do kursu..."}},dashboard:{title:"Kreator materiałów edukacyjnych",description:"Twórz angażujące materiały z pomocą AI",wizardTitle:"Kreator materiałów AI",wizardDescription:"Stwórz materiał edukacyjny w 5 prostych krokach",features:["Automatyczna analiza tematu","Dostosowanie do wieku uczniów","Generowanie celów nauczania","Tworzenie ćwiczeń praktycznych","Formatowanie Markdown","Integracja z kursami"]},errors:{subjectRequired:"Podaj temat materiału",analysisError:"Błąd analizy tematu:",generationError:"Błąd generowania materiału:",saveError:"Wystąpił błąd podczas zapisu",unexpectedError:"Wystąpił nieoczekiwany błąd",noCourses:"Nie znaleziono żadnych kursów",noTopics:"Wybierz najpierw kurs"}},gt={dashboard:"/educational-material",step1:"/educational-material/step1",step2:"/educational-material/step2",step3:"/educational-material/step3",step4:"/educational-material/step4",step5:"/educational-material/step5",courses:"/courses"},xz=()=>{const e=H(),{getData:s}=fe(),n=s("educational-material-wizard"),{dashboard:i}=ni,r=n&&n.title;return t.jsxs(W,{children:[t.jsx(ie,{title:i.title,description:i.description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg border border-purple-200",children:[t.jsxs(R,{variant:"start",className:"mb-4",children:[t.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:t.jsx(Ps,{className:"w-8 h-8 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:i.wizardTitle}),t.jsx("p",{className:"text-gray-600",children:i.wizardDescription})]})]}),t.jsxs(be,{variant:"1-2-2",className:"gap-4",children:[t.jsx("div",{className:"space-y-2",children:i.features.slice(0,3).map((a,o)=>t.jsxs(R,{variant:"start",className:"text-sm text-gray-700",children:[t.jsx(ze,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),t.jsx("span",{children:a})]},o))}),t.jsx("div",{className:"space-y-2",children:i.features.slice(3).map((a,o)=>t.jsxs(R,{variant:"start",className:"text-sm text-gray-700",children:[t.jsx(ze,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),t.jsx("span",{children:a})]},o))})]}),t.jsx("div",{className:"mt-6",children:t.jsxs(T,{onClick:()=>e(gt.step1),className:"w-full md:w-auto",size:"lg",children:[t.jsx(Jn,{className:"w-4 h-4 mr-2"}),"Stwórz nowy materiał"]})})]}),r&&t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsxs(R,{variant:"between-center",className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ostatni materiał"}),t.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Zapisany"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Tytuł materiału"}),t.jsx("p",{className:"font-medium text-gray-900",children:n.title})]}),n.subject&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Temat"}),t.jsx("p",{className:"text-gray-900",children:n.subject})]}),n.targetLevel&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Poziom"}),t.jsx("p",{className:"text-gray-900",children:n.targetLevel==="beginner"?"Początkujący":n.targetLevel==="intermediate"?"Średniozaawansowany":"Zaawansowany"})]})]}),t.jsxs(R,{variant:"start",className:"mt-6 gap-3",children:[t.jsxs(T,{variant:"outline",onClick:()=>e(gt.step4),children:[t.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Podgląd"]}),t.jsxs(T,{variant:"outline",onClick:()=>e(gt.step5),children:[t.jsx(Wl,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),t.jsxs(T,{variant:"outline",onClick:()=>e(gt.step1),children:[t.jsx(cr,{className:"w-4 h-4 mr-2"}),"Nowy materiał"]})]})]}),t.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Zarządzanie kursami"}),t.jsxs(be,{variant:"1-2-3",className:"gap-4",children:[t.jsxs("button",{onClick:()=>e("/courses"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(R,{variant:"start",className:"mb-2",children:[t.jsx(Ee,{className:"w-5 h-5 text-blue-600"}),t.jsx("span",{className:"font-medium",children:"Kursy"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Zobacz wszystkie kursy"})]}),t.jsxs("button",{onClick:()=>e("/topics"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(R,{variant:"start",className:"mb-2",children:[t.jsx(et,{className:"w-5 h-5 text-purple-600"}),t.jsx("span",{className:"font-medium",children:"Tematy"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Zarządzaj tematami kursów"})]}),t.jsxs("button",{onClick:()=>e("/activities"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(R,{variant:"start",className:"mb-2",children:[t.jsx(Es,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{className:"font-medium",children:"Aktywności"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Materiały i quizy"})]})]})]})]})]})},gr=({step:e})=>{const s=H();return t.jsxs(t.Fragment,{children:[t.jsx(T,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>s("/educational-material"),children:t.jsx(lt,{className:"h-5 w-5"})}),t.jsxs("div",{className:"p-8 space-y-12 text-zinc-800",children:[t.jsx("h1",{className:"text-6xl font-black",children:"SMART UP"}),t.jsxs("h2",{className:"text-4xl",children:["Stwórzmy razem ",t.jsx("br",{}),t.jsx("span",{className:"font-bold",children:"angażujący materiał"})]}),t.jsxs("p",{children:["Krok ",e," z 5"]})]}),t.jsx(as,{className:"my-8"})]})},yr=({title:e,description:s})=>t.jsxs("header",{className:"mb-8",children:[t.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:e}),t.jsx("p",{className:"text-gray-600",children:s})]}),gz=()=>{const e=H(),{register:s,setData:n,getData:i}=fe(),r=i("educational-material-wizard"),[a,o]=g.useState(""),[l,c]=g.useState(""),[d,m]=g.useState(""),[u,h]=g.useState(""),[p,x]=g.useState(""),[f,j]=g.useState({}),[b,y]=g.useState(null),[w,z]=g.useState(!1),N=Xn("educational-material-wizard","analyze-topic"),{steps:S,errors:k}=ni,{data:C,isLoading:A}=_e({resource:"courses",meta:{select:"*, topics(*)"},sorters:[{field:"created_at",order:"desc"}]}),v=C?.data?.find(D=>D.id.toString()===a),P=v?.topics||[];g.useEffect(()=>(s(Kd),N.registerOperation(pz),()=>{N.unregisterOperation()}),[]),g.useEffect(()=>{if(!w&&C?.data){let D="",ee="",We="";const Z=sessionStorage.getItem("wizardContext");if(Z)try{const J=JSON.parse(Z);y(J),J.courseId&&(D=J.courseId.toString()),J.topicId&&(ee=J.topicId.toString()),J.topicTitle&&(We=J.topicTitle)}catch(J){console.error("Error parsing wizard context:",J)}!D&&r&&(r.courseId&&(D=r.courseId.toString()),r.topicId&&(ee=r.topicId.toString()),r.subject&&(We=r.subject),r.targetLevel&&h(r.targetLevel),r.ageGroup&&x(r.ageGroup)),D&&o(D),ee&&c(ee),We&&m(We),z(!0)}},[C,w,r]),g.useEffect(()=>{if(l&&P.length>0){const D=P.find(ee=>ee.id.toString()===l);D&&m(D.title)}},[l,P]);const _=()=>{const D={};return a||(D.courseId="Wybierz kurs"),l||(D.topicId="Wybierz temat z kursu"),(!d.trim()||d.length<ft.subject.minLength)&&(D.subject=ft.subject.errorMessage),u||(D.targetLevel="Wybierz poziom zaawansowania"),p||(D.ageGroup="Wybierz grupę wiekową"),j(D),Object.keys(D).length===0},E=async()=>{if(_())try{const D={courseId:parseInt(a),topicId:parseInt(l),subject:d.trim(),targetLevel:u,ageGroup:p,courseTitle:v?.title,topicTitle:P.find(ee=>ee.id.toString()===l)?.title};n("educational-material-wizard",D),await N.executeOperation(D),e(gt.step2)}catch(D){console.error(k.analysisError,D)}};return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(gr,{step:1}),t.jsxs("div",{className:"p-6",children:[t.jsx(yr,{title:S[1].title,description:S[1].description}),b&&t.jsxs(le,{className:"mb-4",children:[t.jsx(Ea,{className:"h-4 w-4"}),t.jsxs(ce,{children:["Tworzysz materiał dla: ",t.jsx("strong",{children:b.courseTitle}),b.topicTitle&&t.jsxs(t.Fragment,{children:[" → ",t.jsx("strong",{children:b.topicTitle})]})]})]}),N.error&&t.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:t.jsxs("span",{className:"text-red-800 text-sm",children:[k.analysisError," ",N.error]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(I,{className:"border-2 border-purple-200 bg-purple-50/50",children:t.jsxs(M,{className:"pt-6",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(Ee,{className:"w-5 h-5 text-purple-600"}),t.jsx("h3",{className:"font-semibold",children:"Wybierz miejsce w kursie"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"courseId",children:["Kurs ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs(Te,{value:a,onValueChange:D=>{o(D),c(""),m("")},disabled:N.loading||A,children:[t.jsx(Ne,{className:f.courseId?"border-red-300":"",children:t.jsx(Ae,{placeholder:"Wybierz kurs..."})}),t.jsx(ke,{children:C?.data?.map(D=>t.jsx(K,{value:D.id.toString(),children:t.jsxs("div",{className:"flex items-center gap-2",children:[D.icon_emoji&&t.jsx("span",{children:D.icon_emoji}),t.jsx("span",{children:D.title}),!D.is_published&&t.jsx("span",{className:"text-xs text-muted-foreground",children:"(szkic)"})]})},D.id))})]}),f.courseId&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.courseId})]}),t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"topicId",children:["Temat ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs(Te,{value:l,onValueChange:c,disabled:!a||N.loading,children:[t.jsx(Ne,{className:f.topicId?"border-red-300":"",children:t.jsx(Ae,{placeholder:a?"Wybierz temat...":"Najpierw wybierz kurs..."})}),t.jsx(ke,{children:P.sort((D,ee)=>D.position-ee.position).map(D=>t.jsx(K,{value:D.id.toString(),children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{children:[D.position,". ",D.title]}),D.is_published===!1&&t.jsx("span",{className:"text-xs text-muted-foreground",children:"(szkic)"})]})},D.id))})]}),f.topicId&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.topicId})]})]})]})}),t.jsx(as,{}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"subject",children:"Temat materiału"}),t.jsx(B,{id:"subject",type:"text",value:d,onChange:D=>m(D.target.value),placeholder:Kd.schema.step1.properties.subject.placeholder,disabled:N.loading,className:f.subject?"border-red-300":""}),f.subject&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.subject}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Możesz dostosować temat materiału lub pozostawić sugerowany"})]}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"targetLevel",children:"Poziom zaawansowania"}),t.jsxs(Te,{value:u,onValueChange:h,disabled:N.loading,children:[t.jsx(Ne,{className:f.targetLevel?"border-red-300":"",children:t.jsx(Ae,{placeholder:"Wybierz poziom..."})}),t.jsxs(ke,{children:[t.jsx(K,{value:"beginner",children:"Początkujący"}),t.jsx(K,{value:"intermediate",children:"Średniozaawansowany"}),t.jsx(K,{value:"advanced",children:"Zaawansowany"})]})]}),f.targetLevel&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.targetLevel})]}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"ageGroup",children:"Grupa wiekowa"}),t.jsxs(Te,{value:p,onValueChange:x,disabled:N.loading,children:[t.jsx(Ne,{className:f.ageGroup?"border-red-300":"",children:t.jsx(Ae,{placeholder:"Wybierz grupę wiekową..."})}),t.jsxs(ke,{children:[t.jsx(K,{value:"7-10",children:"7-10 lat (szkoła podstawowa)"}),t.jsx(K,{value:"11-14",children:"11-14 lat (klasy 4-8)"}),t.jsx(K,{value:"15-18",children:"15-18 lat (szkoła średnia)"}),t.jsx(K,{value:"18+",children:"18+ (dorośli)"})]})]}),f.ageGroup&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.ageGroup})]}),t.jsx("button",{onClick:E,disabled:N.loading,className:"w-full h-12 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 text-white font-medium rounded-lg flex items-center justify-center gap-2",children:N.loading?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),S[1].loading]}):S[1].button})]})]})]})})},yz=()=>{const e=H(),{getData:s}=fe(),n=s("educational-material-wizard"),{steps:i}=ni;return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(gr,{step:2}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(yr,{title:i[2].title,description:i[2].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:t.jsx("span",{className:"text-green-800 text-sm",children:i[2].success})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Temat"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800",children:n.subject})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kluczowe zagadnienia"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:n.keyTopics?.map((r,a)=>t.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm",children:r},a))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cele nauczania"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 whitespace-pre-wrap",children:n.learningObjectives})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wymagania wstępne"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:n.prerequisites?.length>0?n.prerequisites.map((r,a)=>t.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:r},a)):t.jsx("span",{className:"text-gray-500 text-sm",children:"Brak wymagań wstępnych"})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Szacowany czas"}),t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[n.estimatedDuration," minut"]})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(gt.step1),children:"Wstecz"}),t.jsx(T,{onClick:()=>e(gt.step3),children:"Kontynuuj"})]})]})]})]})})},jz=()=>{const e=H(),{getData:s,setData:n}=fe(),i=s("educational-material-wizard"),[r,a]=g.useState(i.learningObjectives||""),[o,l]=g.useState("mixed"),c=Xn("educational-material-wizard","generate-material"),{steps:d,errors:m}=ni;g.useEffect(()=>(c.registerOperation(fz),()=>{c.unregisterOperation()}),[]);const u=async()=>{if(!(!r.trim()||!o))try{const h={...i,learningObjectives:r.trim(),materialType:o};n("educational-material-wizard",h),await c.executeOperation(h),e(gt.step4)}catch(h){console.error(m.generationError,h)}};return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(gr,{step:3}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(yr,{title:d[3].title,description:d[3].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx(X,{htmlFor:"learningObjectives",children:"Cele nauczania"}),t.jsx(Dt,{id:"learningObjectives",value:r,onChange:h=>a(h.target.value),placeholder:"Dostosuj cele nauczania...",rows:6,className:"mt-1"}),t.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Możesz edytować automatycznie wygenerowane cele"})]}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"materialType",children:"Typ materiału"}),t.jsxs(Te,{value:o,onValueChange:l,children:[t.jsx(Ne,{className:"mt-1",children:t.jsx(Ae,{placeholder:"Wybierz typ materiału..."})}),t.jsxs(ke,{children:[t.jsx(K,{value:"lesson",children:"Lekcja z teorią"}),t.jsx(K,{value:"exercise",children:"Ćwiczenia praktyczne"}),t.jsx(K,{value:"mixed",children:"Teoria + ćwiczenia"})]})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(gt.step2),children:"Wstecz"}),t.jsx(T,{onClick:u,disabled:c.loading||!r.trim(),children:c.loading?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),d[3].loading]}):d[3].button})]})]}),c.loading&&t.jsx("div",{className:"mt-6 p-4 bg-purple-50 border border-purple-200 rounded-lg",children:t.jsx("span",{className:"text-purple-800 text-sm",children:d[3].loadingInfo})})]})]})})},bz=()=>{const e=H(),{getData:s}=fe(),n=s("educational-material-wizard"),{steps:i}=ni;return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(gr,{step:4}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(yr,{title:t.jsxs(t.Fragment,{children:[t.jsx(Ve,{className:"w-8 h-8 text-zinc-500"}),t.jsx("span",{children:i[4].title})]}),description:i[4].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tytuł materiału"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:n.title})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Treść materiału"}),t.jsx("div",{className:"p-4 bg-gray-50 rounded-lg max-h-96 overflow-y-auto",children:t.jsx("div",{className:"prose prose-sm max-w-none",children:t.jsx(Mn,{children:n.content})})})]}),n.exercises&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ćwiczenia"}),t.jsx("div",{className:"p-4 bg-gray-50 rounded-lg max-h-64 overflow-y-auto",children:t.jsx("div",{className:"prose prose-sm max-w-none",children:t.jsx(Mn,{children:n.exercises})})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Podsumowanie"}),t.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:t.jsx("div",{className:"prose prose-sm max-w-none",children:t.jsx(Mn,{children:n.summary})})})]})]}),t.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:t.jsx("p",{className:"text-purple-800 text-sm",children:i[4].info})}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(gt.step3),children:"Wstecz"}),t.jsx(T,{onClick:()=>e(gt.step5),children:"Zapisz w kursie"})]})]})]})})},wz=()=>{const e=H(),{getData:s,setData:n}=fe(),{mutate:i}=ps(),r=s("educational-material-wizard"),[a,o]=g.useState(r.title||""),[l,c]=g.useState(r.content+(r.exercises?`

## Ćwiczenia

${r.exercises}`:"")+(r.summary?`

## Podsumowanie

${r.summary}`:"")),[d,m]=g.useState(r.estimatedDuration||30),[u,h]=g.useState({}),[p,x]=g.useState(!1),[f,j]=g.useState(!1),{steps:b,errors:y}=ni,{data:w}=_e({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:r.topicId}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!r.topicId}}),z=w?.data?.[0]?.position?w.data[0].position+1:1,N=()=>{const k={};return(!a.trim()||a.length<ft.activityTitle.minLength)&&(k.activityTitle=ft.activityTitle.errorMessage),(!l.trim()||l.length<ft.content.minLength)&&(k.content=ft.content.errorMessage),(!d||d<ft.duration.min||d>ft.duration.max)&&(k.duration=ft.duration.errorMessage),h(k),Object.keys(k).length===0},S=async()=>{if(N()){x(!0);try{i({resource:"activities",values:{topic_id:r.topicId,type:"material",title:a.trim(),content:l.trim(),position:z,duration_min:d,is_published:!1}},{onSuccess:k=>{n("educational-material-wizard",{...r,activityTitle:a.trim(),content:l.trim(),activityId:k.data.id,saved:!0}),x(!1),j(!0);const C=sessionStorage.getItem("returnUrl");setTimeout(()=>{sessionStorage.removeItem("wizardContext"),C?(sessionStorage.removeItem("returnUrl"),e(C)):e(`${gt.courses}/show/${r.courseId}?expanded=${r.topicId}`)},2e3)},onError:k=>{x(!1),console.error(y.saveError,k),alert(y.saveError)}})}catch(k){x(!1),console.error(y.unexpectedError,k),alert(y.unexpectedError)}}};return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative",children:[t.jsx(gr,{step:5}),t.jsxs("div",{className:"p-8",children:[t.jsx(yr,{title:t.jsxs(t.Fragment,{children:[t.jsx(et,{className:"w-8 h-8 text-purple-500"}),t.jsx("span",{children:b[5].title})]}),description:b[5].description}),f&&t.jsx(le,{className:"mb-6 bg-green-50 border-green-200",children:t.jsx(ce,{className:"text-green-800",children:b[5].success})}),t.jsxs("form",{className:"space-y-6",onSubmit:k=>{k.preventDefault(),S()},children:[t.jsx(I,{className:"bg-muted/50",children:t.jsx(M,{className:"pt-6",children:t.jsxs("div",{className:"text-sm space-y-1",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Kurs:"})," ",r.courseTitle]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Temat:"})," ",r.topicTitle]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Pozycja:"})," ",z]})]})})}),t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"activityTitle",children:["Tytuł aktywności ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"activityTitle",type:"text",value:a,onChange:k=>o(k.target.value),placeholder:"np. Wprowadzenie do zmiennych",maxLength:ft.activityTitle.maxLength,className:u.activityTitle?"border-red-300":""}),u.activityTitle&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.activityTitle})]}),t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"duration",children:["Czas trwania (min) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"duration",type:"number",value:d,onChange:k=>m(parseInt(k.target.value)||0),min:ft.duration.min,max:ft.duration.max,className:u.duration?"border-red-300":""}),u.duration&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.duration})]}),t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"content",children:["Treść materiału ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Dt,{id:"content",value:l,onChange:k=>c(k.target.value),placeholder:"Treść materiału w formacie Markdown...",rows:15,className:`font-mono text-sm ${u.content?"border-red-300":""}`}),u.content&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.content}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[l.length," znaków (minimum ",ft.content.minLength,")"]})]}),t.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:t.jsx("p",{className:"text-purple-800 text-sm",children:b[5].saveInfo})}),t.jsx(as,{}),t.jsxs("footer",{className:"flex justify-between gap-4",children:[t.jsxs(T,{type:"button",variant:"outline",onClick:()=>e(gt.step4),disabled:p,className:"flex items-center gap-2",children:[t.jsx(me,{className:"w-4 h-4"}),"Wstecz"]}),t.jsx(T,{type:"submit",disabled:p||f,className:"flex items-center gap-2 min-w-[160px]",children:p?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),b[5].loading]}):t.jsxs(t.Fragment,{children:[t.jsx(dr,{className:"w-4 h-4"}),b[5].button]})})]})]})]})]})})},vz=[t.jsx(F,{path:"/educational-material",element:t.jsx(xz,{})},"material-dashboard"),t.jsx(F,{path:"/educational-material/step1",element:t.jsx(gz,{})},"material-step1"),t.jsx(F,{path:"/educational-material/step2",element:t.jsx(yz,{})},"material-step2"),t.jsx(F,{path:"/educational-material/step3",element:t.jsx(jz,{})},"material-step3"),t.jsx(F,{path:"/educational-material/step4",element:t.jsx(bz,{})},"material-step4"),t.jsx(F,{path:"/educational-material/step5",element:t.jsx(wz,{})},"material-step5")],Nz={name:"educational-materials",list:"/educational-material",create:"/educational-material/step1",meta:{canDelete:!1,label:"Kreator materiałów",icon:t.jsx(_a,{className:"h-4 w-4"})}},Gd={id:"quiz-wizard",title:"Kreator quizów",schema:{step1:{title:"Podstawowe informacje o quizie",type:"object",properties:{topic:{type:"text",title:"Temat quizu",placeholder:"np. Podstawy programowania w Python"},difficulty:{type:"select",title:"Poziom trudności",options:[{value:"easy",label:"Łatwy"},{value:"medium",label:"Średni"},{value:"hard",label:"Trudny"}]},questionsCount:{type:"number",title:"Liczba pytań",placeholder:"10",min:5,max:30},questionTypes:{type:"multiselect",title:"Typy pytań",options:[{value:"single",label:"Jednokrotny wybór"},{value:"multiple",label:"Wielokrotny wybór"},{value:"truefalse",label:"Prawda/Fałsz"}]}},required:["topic","difficulty","questionsCount"]},step2:{title:"Analiza tematu",type:"object",properties:{keyTopics:{type:"tags",title:"Kluczowe zagadnienia",readOnly:!0},learningObjectives:{type:"textarea",title:"Cele sprawdzające",readOnly:!0},suggestedTime:{type:"number",title:"Sugerowany czas (min)",readOnly:!0},passingScore:{type:"number",title:"Próg zaliczenia (%)",readOnly:!0}}},step3:{title:"Parametry quizu",type:"object",properties:{quizTitle:{type:"text",title:"Tytuł quizu",placeholder:"np. Test wiedzy - Zmienne i typy danych"},passingScore:{type:"number",title:"Próg zaliczenia (%)",placeholder:"70",min:50,max:100},timeLimit:{type:"number",title:"Limit czasu (min)",placeholder:"Pozostaw puste dla braku limitu",min:5,max:180},maxAttempts:{type:"number",title:"Maksymalna liczba podejść",placeholder:"Pozostaw puste dla nieograniczonej liczby",min:1,max:10},shuffleQuestions:{type:"checkbox",title:"Losowa kolejność pytań"},showExplanations:{type:"checkbox",title:"Pokazuj wyjaśnienia po odpowiedzi"}},required:["quizTitle","passingScore"]},step4:{title:"Podgląd wygenerowanych pytań",type:"object",properties:{questions:{type:"array",title:"Lista pytań",readOnly:!0}}},step5:{title:"Finalizacja i zapis",type:"object",properties:{courseId:{type:"select",title:"Wybierz kurs",placeholder:"Wybierz kurs..."},topicId:{type:"select",title:"Wybierz temat",placeholder:"Najpierw wybierz kurs..."},finalTitle:{type:"text",title:"Ostateczny tytuł",placeholder:"Tytuł quizu"},questions:{type:"array",title:"Pytania do edycji"}},required:["courseId","topicId","finalTitle"]}}},kz={id:"analyze-quiz-topic",name:"Analiza tematu quizu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia testów i quizów edukacyjnych.",user:`
Przeanalizuj temat dla quizu:
Temat: {{topic}}
Poziom trudności: {{difficulty}}
Liczba pytań: {{questionsCount}}

Wygeneruj JSON:
{
  "keyTopics": ["zagadnienie1", "zagadnienie2", "zagadnienie3"],
  "learningObjectives": "<cele sprawdzające - co quiz ma zweryfikować>",
  "suggestedTime": <liczba minut>,
  "passingScore": <próg zaliczenia w %>
}

Wymagania:
- KeyTopics: 5-10 kluczowych zagadnień do sprawdzenia
- LearningObjectives: konkretne umiejętności do weryfikacji (50-150 słów)
- SuggestedTime: 1-3 minuty na pytanie
- PassingScore: 60-80% w zależności od trudności
    `,responseFormat:"json"},inputMapping:e=>({topic:e.topic,difficulty:e.difficulty,questionsCount:e.questionsCount}),outputMapping:(e,s)=>({...s,keyTopics:e.keyTopics,learningObjectives:e.learningObjectives,suggestedTime:e.suggestedTime,passingScore:e.passingScore}),validation:e=>!!(e.keyTopics&&e.learningObjectives&&e.suggestedTime&&e.passingScore)},zz={id:"generate-quiz-questions",name:"Generowanie pytań quizowych",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia pytań testowych. Tworzysz rzetelne, dobrze sformułowane pytania sprawdzające wiedzę.",user:`
Stwórz pytania quizowe:

Temat: {{topic}}
Poziom trudności: {{difficulty}}
Liczba pytań: {{questionsCount}}
Typy pytań: {{questionTypes}}
Kluczowe zagadnienia: {{keyTopics}}
Cele: {{learningObjectives}}

Wygeneruj JSON z tablicą pytań:
{
  "quizTitle": "<tytuł quizu>",
  "questions": [
    {
      "question": "<treść pytania>",
      "type": "single|multiple|truefalse",
      "options": [
        {"text": "<treść opcji>", "is_correct": true/false},
        {"text": "<treść opcji>", "is_correct": true/false}
      ],
      "explanation": "<wyjaśnienie poprawnej odpowiedzi>",
      "points": <liczba punktów 1-5>
    }
  ]
}

Wymagania:
- Pytania jasne i jednoznaczne
- 4 opcje dla single/multiple, 2 dla true/false
- Dokładnie jedna poprawna dla single, 1-3 dla multiple
- Wyjaśnienia edukacyjne (30-100 słów)
- Punkty: łatwe=1-2, średnie=2-3, trudne=3-5
- Różnorodność typów pytań
- Pokrycie wszystkich kluczowych zagadnień
    `,responseFormat:"json"},inputMapping:e=>({topic:e.topic,difficulty:e.difficulty,questionsCount:e.questionsCount,questionTypes:Array.isArray(e.questionTypes)?e.questionTypes.join(", "):e.questionTypes||"single, multiple, truefalse",keyTopics:Array.isArray(e.keyTopics)?e.keyTopics.join(", "):e.keyTopics,learningObjectives:e.learningObjectives}),outputMapping:(e,s)=>({...s,quizTitle:e.quizTitle,questions:e.questions}),validation:e=>!!(e.quizTitle&&e.questions&&Array.isArray(e.questions)&&e.questions.length>0)},ae={topic:{minLength:5,errorMessage:"Temat jest wymagany (5-200 znaków)"},quizTitle:{minLength:5,maxLength:100,errorMessage:"Tytuł jest wymagany (5-100 znaków)"},questionsCount:{min:5,max:30,errorMessage:"Liczba pytań musi być między 5 a 30"},passingScore:{min:50,max:100,errorMessage:"Próg zaliczenia musi być między 50% a 100%"},timeLimit:{min:5,max:180,errorMessage:"Limit czasu musi być między 5 a 180 minut"},maxAttempts:{min:1,max:10,errorMessage:"Liczba podejść musi być między 1 a 10"}},ii={steps:{1:{title:"Jaki quiz chcesz stworzyć?",description:"Podaj temat, poziom trudności i liczbę pytań - AI wygeneruje profesjonalny quiz",button:"Analizuj temat",loading:"Analizuję temat..."},2:{title:"Analiza tematu quizu",description:"AI przeanalizowała temat i zaproponowała parametry quizu",success:"✓ Analiza zakończona pomyślnie"},3:{title:"Skonfiguruj parametry quizu",description:"Dostosuj ustawienia quizu według swoich potrzeb",button:"Generuj pytania",loading:"Generuję pytania...",loadingInfo:"⚡ AI tworzy zestaw pytań dostosowanych do tematu..."},4:{title:"Podgląd wygenerowanych pytań",description:"AI przygotowała kompletny zestaw pytań",info:"💡 W następnym kroku będziesz mógł edytować pytania i wybrać kurs."},5:{title:"Zapisz quiz w kursie",description:"Wybierz kurs i temat, sprawdź pytania przed zapisaniem",saveInfo:"💾 Quiz zostanie zapisany jako nowa aktywność z wygenerowanymi pytaniami",button:"Zapisz quiz",loading:"Zapisuję...",success:"✓ Quiz został zapisany pomyślnie! Przekierowuję do zarządzania pytaniami..."}},dashboard:{title:"Kreator quizów",description:"Twórz profesjonalne testy sprawdzające z pomocą AI",wizardTitle:"Kreator quizów AI",wizardDescription:"Stwórz quiz w 5 prostych krokach",features:["Automatyczna analiza tematu","Generowanie różnych typów pytań","Dostosowanie poziomu trudności","Inteligentne wyjaśnienia odpowiedzi","Konfiguracja parametrów quizu","Edycja i dostosowanie pytań"]},errors:{topicRequired:"Podaj temat quizu",analysisError:"Błąd analizy tematu:",generationError:"Błąd generowania pytań:",saveError:"Wystąpił błąd podczas zapisu",unexpectedError:"Wystąpił nieoczekiwany błąd",noCourses:"Nie znaleziono żadnych kursów",noTopics:"Wybierz najpierw kurs",noQuestions:"Brak pytań do zapisania"}},at={dashboard:"/quiz-wizard",step1:"/quiz-wizard/step1",step2:"/quiz-wizard/step2",step3:"/quiz-wizard/step3",step4:"/quiz-wizard/step4",step5:"/quiz-wizard/step5",questions:"/questions/manage"},Sz=()=>{const e=H(),{getData:s}=fe(),n=s("quiz-wizard"),{dashboard:i}=ii,r=n&&n.quizTitle;return t.jsxs(W,{children:[t.jsx(ie,{title:i.title,description:i.description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 p-6 rounded-lg border border-blue-200",children:[t.jsxs(R,{variant:"start",className:"mb-4",children:[t.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:t.jsx(Vn,{className:"w-8 h-8 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:i.wizardTitle}),t.jsx("p",{className:"text-gray-600",children:i.wizardDescription})]})]}),t.jsxs(be,{variant:"1-2-2",className:"gap-4",children:[t.jsx("div",{className:"space-y-2",children:i.features.slice(0,3).map((a,o)=>t.jsxs(R,{variant:"start",className:"text-sm text-gray-700",children:[t.jsx(ze,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),t.jsx("span",{children:a})]},o))}),t.jsx("div",{className:"space-y-2",children:i.features.slice(3).map((a,o)=>t.jsxs(R,{variant:"start",className:"text-sm text-gray-700",children:[t.jsx(ze,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),t.jsx("span",{children:a})]},o))})]}),t.jsx("div",{className:"mt-6",children:t.jsxs(T,{onClick:()=>e(at.step1),className:"w-full md:w-auto",size:"lg",children:[t.jsx(Jn,{className:"w-4 h-4 mr-2"}),"Stwórz nowy quiz"]})})]}),r&&t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsxs(R,{variant:"between-center",className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ostatni quiz"}),t.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Zapisany"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Tytuł quizu"}),t.jsx("p",{className:"font-medium text-gray-900",children:n.quizTitle})]}),n.topic&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Temat"}),t.jsx("p",{className:"text-gray-900",children:n.topic})]}),n.questions&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Liczba pytań"}),t.jsxs("p",{className:"text-gray-900",children:[n.questions.length," pytań"]})]})]}),t.jsxs(R,{variant:"start",className:"mt-6 gap-3",children:[t.jsxs(T,{variant:"outline",onClick:()=>e(at.step4),children:[t.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Podgląd"]}),t.jsxs(T,{variant:"outline",onClick:()=>e(at.step5),children:[t.jsx(Wl,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),t.jsxs(T,{variant:"outline",onClick:()=>e(at.step1),children:[t.jsx(cr,{className:"w-4 h-4 mr-2"}),"Nowy quiz"]})]})]}),t.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Zarządzanie quizami"}),t.jsxs(be,{variant:"1-2-3",className:"gap-4",children:[t.jsxs("button",{onClick:()=>e("/activities"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(R,{variant:"start",className:"mb-2",children:[t.jsx(ct,{className:"w-5 h-5 text-blue-600"}),t.jsx("span",{className:"font-medium",children:"Aktywności"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Wszystkie quizy i materiały"})]}),t.jsxs("button",{onClick:()=>e("/questions"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(R,{variant:"start",className:"mb-2",children:[t.jsx(tn,{className:"w-5 h-5 text-purple-600"}),t.jsx("span",{className:"font-medium",children:"Pytania"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Zarządzaj pytaniami"})]}),t.jsxs("button",{onClick:()=>e("/reports"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(R,{variant:"start",className:"mb-2",children:[t.jsx(Je,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{className:"font-medium",children:"Wyniki"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Statystyki quizów"})]})]})]})]})]})},jr=({step:e})=>{const s=H();return t.jsxs(t.Fragment,{children:[t.jsx(T,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>s("/quiz-wizard"),children:t.jsx(lt,{className:"h-5 w-5"})}),t.jsxs("div",{className:"p-8 space-y-12 text-zinc-800",children:[t.jsx("h1",{className:"text-6xl font-black",children:"QUIZWISE."}),t.jsxs("h2",{className:"text-4xl",children:["Twórzmy razem ",t.jsx("br",{}),t.jsx("span",{className:"font-bold",children:"sprawdzian wiedzy"})]}),t.jsxs("p",{children:["Krok ",e," z 5"]})]}),t.jsx(as,{className:"my-8"})]})},br=({title:e,description:s})=>t.jsxs("header",{className:"mb-8",children:[t.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:e}),t.jsx("p",{className:"text-gray-600",children:s})]}),Cz=()=>{const e=H(),{register:s,setData:n}=fe(),[i,r]=g.useState(""),[a,o]=g.useState(""),[l,c]=g.useState(""),[d,m]=g.useState(""),[u,h]=g.useState(10),[p,x]=g.useState(["single","multiple"]),[f,j]=g.useState({}),[b,y]=g.useState(null),w=Xn("quiz-wizard","analyze-quiz-topic"),{steps:z,errors:N}=ii,{data:S,isLoading:k}=_e({resource:"courses",filters:[{field:"is_published",operator:"eq",value:!0}],meta:{select:"*, topics(*)"},sorters:[{field:"created_at",order:"desc"}]}),C=S?.data?.find(E=>E.id.toString()===i),A=C?.topics||[];g.useEffect(()=>{s(Gd),w.registerOperation(kz);const E=sessionStorage.getItem("wizardContext");if(E){const D=JSON.parse(E);y(D),D.courseId&&r(D.courseId.toString()),D.topicId&&o(D.topicId.toString()),D.topicTitle&&c(D.topicTitle)}return()=>{w.unregisterOperation()}},[]),g.useEffect(()=>{if(a&&A.length>0){const E=A.find(D=>D.id.toString()===a);E&&!l&&c(E.title)}},[a,A]);const v=()=>{const E={};return i||(E.courseId="Wybierz kurs"),a||(E.topicId="Wybierz temat z kursu"),(!l.trim()||l.length<ae.topic.minLength)&&(E.topic=ae.topic.errorMessage),d||(E.difficulty="Wybierz poziom trudności"),(!u||u<ae.questionsCount.min||u>ae.questionsCount.max)&&(E.questionsCount=ae.questionsCount.errorMessage),p.length===0&&(E.questionTypes="Wybierz przynajmniej jeden typ pytań"),j(E),Object.keys(E).length===0},P=async()=>{if(v())try{const E={courseId:parseInt(i),topicId:parseInt(a),topic:l.trim(),difficulty:d,questionsCount:u,questionTypes:p,courseTitle:C?.title,topicTitle:A.find(D=>D.id.toString()===a)?.title};n("quiz-wizard",E),await w.executeOperation(E),e(at.step2)}catch(E){console.error(N.analysisError,E)}},_=E=>{x(D=>D.includes(E)?D.filter(ee=>ee!==E):[...D,E])};return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(jr,{step:1}),t.jsxs("div",{className:"p-6",children:[t.jsx(br,{title:z[1].title,description:z[1].description}),b&&t.jsxs(le,{className:"mb-4",children:[t.jsx(Ea,{className:"h-4 w-4"}),t.jsxs(ce,{children:["Tworzysz quiz dla: ",t.jsx("strong",{children:b.courseTitle}),b.topicTitle&&t.jsxs(t.Fragment,{children:[" → ",t.jsx("strong",{children:b.topicTitle})]})]})]}),w.error&&t.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:t.jsxs("span",{className:"text-red-800 text-sm",children:[N.analysisError," ",w.error]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(I,{className:"border-2 border-blue-200 bg-blue-50/50",children:t.jsxs(M,{className:"pt-6",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(Ee,{className:"w-5 h-5 text-blue-600"}),t.jsx("h3",{className:"font-semibold",children:"Wybierz miejsce w kursie"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"courseId",children:["Kurs ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs(Te,{value:i,onValueChange:E=>{r(E),o("")},disabled:w.loading||k||!!b?.courseId,children:[t.jsx(Ne,{className:f.courseId?"border-red-300":"",children:t.jsx(Ae,{placeholder:"Wybierz kurs..."})}),t.jsx(ke,{children:S?.data?.map(E=>t.jsx(K,{value:E.id.toString(),children:t.jsxs("div",{className:"flex items-center gap-2",children:[E.icon_emoji&&t.jsx("span",{children:E.icon_emoji}),E.title]})},E.id))})]}),f.courseId&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.courseId})]}),t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"topicId",children:["Temat ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs(Te,{value:a,onValueChange:o,disabled:!i||w.loading||!!b?.topicId,children:[t.jsx(Ne,{className:f.topicId?"border-red-300":"",children:t.jsx(Ae,{placeholder:i?"Wybierz temat...":"Najpierw wybierz kurs..."})}),t.jsx(ke,{children:A.sort((E,D)=>E.position-D.position).map(E=>t.jsxs(K,{value:E.id.toString(),children:[E.position,". ",E.title]},E.id))})]}),f.topicId&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.topicId})]})]})]})}),t.jsx(as,{}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"topic",children:"Temat quizu"}),t.jsx(B,{id:"topic",type:"text",value:l,onChange:E=>c(E.target.value),placeholder:Gd.schema.step1.properties.topic.placeholder,disabled:w.loading,className:f.topic?"border-red-300":""}),f.topic&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.topic}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Możesz dostosować temat quizu lub pozostawić sugerowany"})]}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"difficulty",children:"Poziom trudności"}),t.jsxs(Te,{value:d,onValueChange:m,disabled:w.loading,children:[t.jsx(Ne,{className:f.difficulty?"border-red-300":"",children:t.jsx(Ae,{placeholder:"Wybierz poziom..."})}),t.jsxs(ke,{children:[t.jsx(K,{value:"easy",children:"Łatwy"}),t.jsx(K,{value:"medium",children:"Średni"}),t.jsx(K,{value:"hard",children:"Trudny"})]})]}),f.difficulty&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.difficulty})]}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"questionsCount",children:"Liczba pytań"}),t.jsx(B,{id:"questionsCount",type:"number",value:u,onChange:E=>h(parseInt(E.target.value)||0),min:ae.questionsCount.min,max:ae.questionsCount.max,disabled:w.loading,className:f.questionsCount?"border-red-300":""}),f.questionsCount&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.questionsCount})]}),t.jsxs("div",{children:[t.jsx(X,{children:"Typy pytań"}),t.jsxs("div",{className:"space-y-2 mt-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jt,{id:"single",checked:p.includes("single"),onCheckedChange:()=>_("single"),disabled:w.loading}),t.jsx("label",{htmlFor:"single",className:"text-sm cursor-pointer",children:"Jednokrotny wybór"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jt,{id:"multiple",checked:p.includes("multiple"),onCheckedChange:()=>_("multiple"),disabled:w.loading}),t.jsx("label",{htmlFor:"multiple",className:"text-sm cursor-pointer",children:"Wielokrotny wybór"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jt,{id:"truefalse",checked:p.includes("truefalse"),onCheckedChange:()=>_("truefalse"),disabled:w.loading}),t.jsx("label",{htmlFor:"truefalse",className:"text-sm cursor-pointer",children:"Prawda/Fałsz"})]})]}),f.questionTypes&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.questionTypes})]}),t.jsx("button",{onClick:P,disabled:w.loading,className:"w-full h-12 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium rounded-lg flex items-center justify-center gap-2",children:w.loading?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),z[1].loading]}):z[1].button})]})]})]})})},Tz=()=>{const e=H(),{getData:s}=fe(),n=s("quiz-wizard"),{steps:i}=ii,r=o=>{switch(o){case"easy":return"Łatwy";case"medium":return"Średni";case"hard":return"Trudny";default:return o}},a=o=>{switch(o){case"single":return"Jednokrotny wybór";case"multiple":return"Wielokrotny wybór";case"truefalse":return"Prawda/Fałsz";default:return o}};return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(jr,{step:2}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(br,{title:i[2].title,description:i[2].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:t.jsx("span",{className:"text-green-800 text-sm",children:i[2].success})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Temat"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800",children:n.topic})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Poziom trudności"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:r(n.difficulty)})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Liczba pytań"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:n.questionsCount})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Typy pytań"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:n.questionTypes?.map(o=>t.jsxs("span",{className:"text-sm text-gray-800",children:[a(o),n.questionTypes.indexOf(o)<n.questionTypes.length-1&&", "]},o))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kluczowe zagadnienia"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:n.keyTopics?.map((o,l)=>t.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:o},l))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cele sprawdzające"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 whitespace-pre-wrap",children:n.learningObjectives})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sugerowany czas"}),t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[n.suggestedTime," minut"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sugerowany próg zaliczenia"}),t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[n.passingScore,"%"]})]})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(at.step1),children:"Wstecz"}),t.jsx(T,{onClick:()=>e(at.step3),children:"Kontynuuj"})]})]})]})]})})},Az=()=>{const e=H(),{getData:s,setData:n}=fe(),i=s("quiz-wizard"),[r,a]=g.useState(i.quizTitle||""),[o,l]=g.useState(i.passingScore||70),[c,d]=g.useState(i.timeLimit||""),[m,u]=g.useState(i.maxAttempts||""),[h,p]=g.useState(!1),[x,f]=g.useState(!0),[j,b]=g.useState({}),y=Xn("quiz-wizard","generate-quiz-questions"),{steps:w,errors:z}=ii;g.useEffect(()=>(y.registerOperation(zz),()=>{y.unregisterOperation()}),[]);const N=()=>{const k={};return(!r.trim()||r.length<ae.quizTitle.minLength)&&(k.quizTitle=ae.quizTitle.errorMessage),(!o||o<ae.passingScore.min||o>ae.passingScore.max)&&(k.passingScore=ae.passingScore.errorMessage),c&&(parseInt(c)<ae.timeLimit.min||parseInt(c)>ae.timeLimit.max)&&(k.timeLimit=ae.timeLimit.errorMessage),m&&(parseInt(m)<ae.maxAttempts.min||parseInt(m)>ae.maxAttempts.max)&&(k.maxAttempts=ae.maxAttempts.errorMessage),b(k),Object.keys(k).length===0},S=async()=>{if(N())try{const k={...i,quizTitle:r.trim(),passingScore:o,timeLimit:c?parseInt(c):null,maxAttempts:m?parseInt(m):null,shuffleQuestions:h,showExplanations:x};n("quiz-wizard",k),await y.executeOperation(k),e(at.step4)}catch(k){console.error(z.generationError,k)}};return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(jr,{step:3}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(br,{title:w[3].title,description:w[3].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"quizTitle",children:["Tytuł quizu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"quizTitle",value:r,onChange:k=>a(k.target.value),placeholder:"np. Test wiedzy - Zmienne i typy danych",className:`mt-1 ${j.quizTitle?"border-red-300":""}`}),j.quizTitle&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.quizTitle})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"passingScore",children:["Próg zaliczenia (%) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"passingScore",type:"number",value:o,onChange:k=>l(parseInt(k.target.value)||0),min:ae.passingScore.min,max:ae.passingScore.max,className:`mt-1 ${j.passingScore?"border-red-300":""}`}),j.passingScore&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.passingScore})]}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"timeLimit",children:"Limit czasu (min)"}),t.jsx(B,{id:"timeLimit",type:"number",value:c,onChange:k=>d(k.target.value),placeholder:"Pozostaw puste dla braku limitu",min:ae.timeLimit.min,max:ae.timeLimit.max,className:`mt-1 ${j.timeLimit?"border-red-300":""}`}),j.timeLimit&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.timeLimit})]})]}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"maxAttempts",children:"Maksymalna liczba podejść"}),t.jsx(B,{id:"maxAttempts",type:"number",value:m,onChange:k=>u(k.target.value),placeholder:"Pozostaw puste dla nieograniczonej liczby",min:ae.maxAttempts.min,max:ae.maxAttempts.max,className:`mt-1 ${j.maxAttempts?"border-red-300":""}`}),j.maxAttempts&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.maxAttempts})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jt,{id:"shuffleQuestions",checked:h,onCheckedChange:k=>p(k)}),t.jsx("label",{htmlFor:"shuffleQuestions",className:"text-sm cursor-pointer",children:"Losowa kolejność pytań"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jt,{id:"showExplanations",checked:x,onCheckedChange:k=>f(k)}),t.jsx("label",{htmlFor:"showExplanations",className:"text-sm cursor-pointer",children:"Pokazuj wyjaśnienia po odpowiedzi"})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(at.step2),children:"Wstecz"}),t.jsx(T,{onClick:S,disabled:y.loading,children:y.loading?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),w[3].loading]}):w[3].button})]})]}),y.loading&&t.jsx("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:t.jsx("span",{className:"text-blue-800 text-sm",children:w[3].loadingInfo})})]})]})})},Pz=()=>{const e=H(),{getData:s}=fe(),n=s("quiz-wizard"),{steps:i}=ii,r=o=>{switch(o){case"single":return"Jednokrotny wybór";case"multiple":return"Wielokrotny wybór";case"truefalse":return"Prawda/Fałsz";default:return o}},a=o=>{switch(o){case"single":return"default";case"multiple":return"secondary";case"truefalse":return"outline";default:return"default"}};return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(jr,{step:4}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(br,{title:t.jsxs(t.Fragment,{children:[t.jsx(Ve,{className:"w-8 h-8 text-zinc-500"}),t.jsx("span",{children:i[4].title})]}),description:i[4].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold mb-2",children:n.quizTitle}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Liczba pytań:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.questions?.length||0})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Próg zaliczenia:"}),t.jsxs("span",{className:"ml-2 font-medium",children:[n.passingScore,"%"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Limit czasu:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.timeLimit?`${n.timeLimit} min`:"Brak"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Max. podejść:"}),t.jsx("span",{className:"ml-2 font-medium",children:n.maxAttempts||"Bez limitu"})]})]})]}),t.jsx("div",{className:"space-y-4",children:n.questions?.map((o,l)=>t.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("h5",{className:"font-medium",children:["Pytanie ",l+1]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(ne,{variant:a(o.type),children:r(o.type)}),t.jsxs(ne,{variant:"outline",children:[o.points," pkt"]})]})]}),t.jsx("p",{className:"text-gray-700",children:o.question})]}),t.jsx("div",{className:"space-y-2 mb-3",children:o.options?.map((c,d)=>t.jsxs("div",{className:`flex items-center gap-2 p-2 rounded ${c.is_correct?"bg-green-50 border border-green-200":"bg-gray-50"}`,children:[c.is_correct?t.jsx(ze,{className:"w-4 h-4 text-green-600 flex-shrink-0"}):t.jsx(lt,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),t.jsx("span",{className:c.is_correct?"font-medium":"",children:c.text})]},d))}),o.explanation&&t.jsx("div",{className:"bg-blue-50 p-3 rounded",children:t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"font-medium",children:"Wyjaśnienie:"})," ",o.explanation]})})]},l))})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:t.jsx("p",{className:"text-blue-800 text-sm",children:i[4].info})}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(at.step3),children:"Wstecz"}),t.jsx(T,{onClick:()=>e(at.step5),children:"Zapisz w kursie"})]})]})]})})},Dz=()=>{const e=H(),{getData:s,setData:n}=fe(),{mutate:i}=ps(),{mutate:r}=ps(),a=s("quiz-wizard"),[o,l]=g.useState(a.quizTitle||""),[c,d]=g.useState({}),[m,u]=g.useState(!1),[h,p]=g.useState(!1),{steps:x,errors:f}=ii,{data:j}=_e({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:a.topicId}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!a.topicId}}),b=j?.data?.[0]?.position?j.data[0].position+1:1;g.useEffect(()=>{(!a.courseId||!a.topicId||!a.questions)&&($.error("Brak danych z poprzednich kroków. Wracam do początku..."),e(at.step1))},[a,e]);const y=()=>{const z={};return(!o.trim()||o.length<ae.quizTitle.minLength)&&(z.finalTitle=ae.quizTitle.errorMessage),(!a.questions||a.questions.length===0)&&(z.questions=f.noQuestions),d(z),Object.keys(z).length===0},w=async()=>{if(y()){u(!0),p(!1);try{i({resource:"activities",values:{topic_id:parseInt(a.topicId),type:"quiz",title:o.trim(),position:b,duration_min:a.suggestedTime||a.timeLimit||30,is_published:!1,passing_score:a.passingScore,time_limit:a.timeLimit||null,max_attempts:a.maxAttempts||null}},{onSuccess:async z=>{const N=z.data.id;try{for(let S=0;S<a.questions.length;S++){const k=a.questions[S];await new Promise((C,A)=>{r({resource:"questions",values:{activity_id:N,question:k.question,explanation:k.explanation,points:k.points,position:S+1,options:k.options.map((v,P)=>({id:P+1,text:v.text,is_correct:v.is_correct}))}},{onSuccess:C,onError:A})})}n("quiz-wizard",{...a,finalTitle:o.trim(),activityId:N,saved:!0}),u(!1),p(!0),setTimeout(()=>{e(`${at.questions}/${N}`)},2e3)}catch(S){u(!1),p(!1),console.error("Błąd podczas zapisywania pytań:",S),$.error("Wystąpił błąd podczas zapisywania pytań. Spróbuj ponownie.")}},onError:z=>{u(!1),p(!1),console.error(f.saveError,z),$.error(f.saveError)}})}catch(z){u(!1),p(!1),console.error(f.unexpectedError,z),$.error(f.unexpectedError)}}};return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative",children:[t.jsx(jr,{step:5}),t.jsxs("div",{className:"p-8",children:[t.jsx(br,{title:t.jsxs(t.Fragment,{children:[t.jsx(ct,{className:"w-8 h-8 text-blue-500"}),t.jsx("span",{children:x[5].title})]}),description:x[5].description}),h&&t.jsx(le,{className:"mb-6 bg-green-50 border-green-200",children:t.jsx(ce,{className:"text-green-800",children:x[5].success})}),t.jsxs("form",{className:"space-y-6",onSubmit:z=>{z.preventDefault(),w()},children:[t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(Ee,{className:"w-5 h-5 text-blue-600"}),t.jsx("h4",{className:"font-medium",children:"Lokalizacja quizu"})]}),t.jsxs("div",{className:"space-y-1 text-sm",children:[t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-600",children:"Kurs:"})," ",t.jsx("span",{className:"font-medium",children:a.courseTitle})]}),t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-600",children:"Temat:"})," ",t.jsx("span",{className:"font-medium",children:a.topicTitle})]})]})]}),t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"finalTitle",children:["Tytuł quizu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"finalTitle",type:"text",value:o,onChange:z=>l(z.target.value),placeholder:"Tytuł quizu",maxLength:ae.quizTitle.maxLength,className:c.finalTitle?"border-red-300":""}),c.finalTitle&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:c.finalTitle}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Możesz dostosować tytuł quizu przed zapisaniem"})]}),t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-medium mb-3",children:"Podsumowanie quizu"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Liczba pytań:"}),t.jsx("span",{className:"ml-2 font-medium",children:a.questions?.length||0})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Próg zaliczenia:"}),t.jsxs("span",{className:"ml-2 font-medium",children:[a.passingScore,"%"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Limit czasu:"}),t.jsx("span",{className:"ml-2 font-medium",children:a.timeLimit?`${a.timeLimit} min`:"Brak"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Łączna liczba punktów:"}),t.jsx("span",{className:"ml-2 font-medium",children:a.questions?.reduce((z,N)=>z+N.points,0)||0})]})]})]}),t.jsxs("div",{children:[t.jsxs("h4",{className:"font-medium mb-3",children:["Pytania (",a.questions?.length||0,")"]}),t.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2 border rounded-lg p-3",children:a.questions?.map((z,N)=>t.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[t.jsxs("span",{className:"text-sm truncate flex-1",children:[N+1,". ",z.question]}),t.jsxs("span",{className:"text-sm font-medium ml-2",children:[z.points," pkt"]})]},N))})]}),t.jsxs(le,{className:"bg-yellow-50 border-yellow-200",children:[t.jsx(Ul,{className:"h-4 w-4 text-yellow-800"}),t.jsx(ce,{className:"text-yellow-800",children:"Po zapisaniu będziesz mógł edytować pytania w panelu zarządzania quizem"})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:t.jsx("p",{className:"text-blue-800 text-sm",children:x[5].saveInfo})}),t.jsx(as,{}),t.jsxs("footer",{className:"flex justify-between gap-4",children:[t.jsxs(T,{type:"button",variant:"outline",onClick:()=>e(at.step4),disabled:m,className:"flex items-center gap-2",children:[t.jsx(me,{className:"w-4 h-4"}),"Wstecz"]}),t.jsx(T,{type:"submit",disabled:m||h,className:"flex items-center gap-2 min-w-[160px]",children:m?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),x[5].loading]}):t.jsxs(t.Fragment,{children:[t.jsx(dr,{className:"w-4 h-4"}),x[5].button]})})]})]})]})]})})},_z=[t.jsx(F,{path:"/quiz-wizard",element:t.jsx(Sz,{})},"quiz-dashboard"),t.jsx(F,{path:"/quiz-wizard/step1",element:t.jsx(Cz,{})},"quiz-step1"),t.jsx(F,{path:"/quiz-wizard/step2",element:t.jsx(Tz,{})},"quiz-step2"),t.jsx(F,{path:"/quiz-wizard/step3",element:t.jsx(Az,{})},"quiz-step3"),t.jsx(F,{path:"/quiz-wizard/step4",element:t.jsx(Pz,{})},"quiz-step4"),t.jsx(F,{path:"/quiz-wizard/step5",element:t.jsx(Dz,{})},"quiz-step5")],Ez={name:"quiz-wizard",list:"/quiz-wizard",create:"/quiz-wizard/step1",meta:{canDelete:!1,label:"Kreator quizów",icon:t.jsx(_a,{className:"h-4 w-4"})}},Iz={id:"course-structure-wizard",title:"Kreator struktury kursu",schema:{step1:{title:"Podstawowe informacje o kursie",type:"object",properties:{courseType:{type:"select",title:"Typ kursu",options:[{value:"matura",label:"Kurs maturalny"},{value:"academic",label:"Kurs akademicki"},{value:"professional",label:"Kurs zawodowy"},{value:"hobby",label:"Kurs hobbystyczny"},{value:"certification",label:"Kurs certyfikacyjny"}]},subject:{type:"text",title:"Przedmiot/Dziedzina",placeholder:"np. Matematyka, Programowanie Python, Język angielski"},level:{type:"select",title:"Poziom kursu",options:[{value:"basic",label:"Podstawowy"},{value:"extended",label:"Rozszerzony"},{value:"beginner",label:"Początkujący"},{value:"intermediate",label:"Średniozaawansowany"},{value:"advanced",label:"Zaawansowany"}]},duration:{type:"select",title:"Planowany czas trwania",options:[{value:"1month",label:"1 miesiąc"},{value:"3months",label:"3 miesiące"},{value:"6months",label:"6 miesięcy"},{value:"1year",label:"1 rok"},{value:"2years",label:"2 lata"}]}},required:["courseType","subject","level","duration"]},step2:{title:"Analiza wymagań",type:"object",properties:{courseTitle:{type:"text",title:"Proponowany tytuł kursu",readOnly:!0},description:{type:"textarea",title:"Opis kursu",readOnly:!0},objectives:{type:"tags",title:"Cele kursu",readOnly:!0},targetAudience:{type:"text",title:"Grupa docelowa",readOnly:!0},prerequisites:{type:"tags",title:"Wymagania wstępne",readOnly:!0},estimatedHours:{type:"number",title:"Szacowana liczba godzin",readOnly:!0},topicsCount:{type:"number",title:"Liczba głównych tematów",readOnly:!0}}},step3:{title:"Dostosowanie struktury",type:"object",properties:{courseTitle:{type:"text",title:"Tytuł kursu",placeholder:"np. Matematyka - Przygotowanie do matury"},description:{type:"textarea",title:"Opis kursu",rows:4},topicsPerWeek:{type:"number",title:"Liczba tematów na tydzień",min:1,max:7},includeExercises:{type:"checkbox",title:"Dodaj ćwiczenia do każdego tematu"},includeQuizzes:{type:"checkbox",title:"Dodaj quizy sprawdzające"},quizFrequency:{type:"select",title:"Częstotliwość quizów",options:[{value:"after_each",label:"Po każdym temacie"},{value:"weekly",label:"Co tydzień"},{value:"biweekly",label:"Co dwa tygodnie"},{value:"monthly",label:"Co miesiąc"},{value:"chapter_end",label:"Na koniec działu"}]}},required:["courseTitle","description","topicsPerWeek"]},step4:{title:"Podgląd struktury",type:"object",properties:{structure:{type:"array",title:"Struktura kursu",readOnly:!0}}},step5:{title:"Tworzenie kursu",type:"object",properties:{courseName:{type:"text",title:"Ostateczna nazwa kursu"},iconEmoji:{type:"text",title:"Emoji ikona",placeholder:"np. 📚 📐 🎓"},isPublished:{type:"checkbox",title:"Opublikuj od razu"}},required:["courseName"]}}},Mz={id:"analyze-course-requirements",name:"Analiza wymagań kursu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od projektowania kursów edukacyjnych i programów nauczania.",user:`
Przeanalizuj wymagania dla kursu:
Typ: {{courseType}}
Przedmiot: {{subject}}
Poziom: {{level}}
Czas trwania: {{duration}}

Wygeneruj JSON:
{
  "courseTitle": "<tytuł kursu odpowiedni do typu i poziomu>",
  "description": "<szczegółowy opis kursu 100-200 słów>",
  "objectives": ["cel1", "cel2", "cel3", "cel4", "cel5"],
  "targetAudience": "<opis grupy docelowej>",
  "prerequisites": ["wymaganie1", "wymaganie2"],
  "estimatedHours": <liczba godzin>,
  "topicsCount": <liczba głównych tematów>
}

Wymagania:
- Dla kursów maturalnych: zgodność z podstawą programową
- CourseTitle: profesjonalny i opisowy
- Description: zawiera zakres materiału i metodykę
- Objectives: 5-8 konkretnych, mierzalnych celów
- Prerequisites: realistyczne wymagania (może być pusta tablica)
- EstimatedHours: realistyczna liczba godzin
- TopicsCount: odpowiednia liczba tematów do czasu trwania
    `,responseFormat:"json"},inputMapping:e=>({courseType:e.courseType,subject:e.subject,level:e.level,duration:e.duration}),outputMapping:(e,s)=>({...s,courseTitle:e.courseTitle,description:e.description,objectives:e.objectives,targetAudience:e.targetAudience,prerequisites:e.prerequisites,estimatedHours:e.estimatedHours,topicsCount:e.topicsCount}),validation:e=>!!(e.courseTitle&&e.description&&e.objectives&&e.topicsCount)},Lz={id:"generate-course-structure",name:"Generowanie struktury kursu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia szczegółowych programów nauczania. Tworzysz logiczną, progresywną strukturę kursu.",user:`
    Stwórz szczegółową strukturę kursu:
    
    Tytuł: {{courseTitle}}
    Opis: {{description}}
    Przedmiot: {{subject}}
    Poziom: {{level}}
    Typ: {{courseType}}
    Cele: {{objectives}}
    Liczba tematów: {{topicsCount}}
    Tematy na tydzień: {{topicsPerWeek}}
    Ćwiczenia: {{includeExercises}}
    Quizy: {{includeQuizzes}}
    Częstotliwość quizów: {{quizFrequency}}
    
    WAŻNE: Wygeneruj KOMPLETNY JSON dla pierwszych 4 tygodni kursu. NIE UŻYWAJ komentarzy w JSON. NIE UŻYWAJ "...". Każdy tydzień musi być w pełni wypełniony.
    
    Wygeneruj JSON ze strukturą:
    {
      "structure": [
        {
          "weekNumber": 1,
          "topics": [
            {
              "title": "<tytuł tematu>",
              "description": "<opis tematu>",
              "objectives": ["cel1", "cel2"],
              "activities": [
                {
                  "type": "material",
                  "title": "<tytuł materiału>",
                  "duration": <czas w minutach>
                },
                {
                  "type": "quiz",
                  "title": "<tytuł quizu>",
                  "questionsCount": <liczba pytań>
                }
              ],
              "keywords": ["słowo1", "słowo2"]
            }
          ]
        }
      ],
      "summary": {
        "totalWeeks": 4,
        "totalTopics": <liczba tematów w 4 tygodniach>,
        "totalActivities": <suma wszystkich aktywności>,
        "totalQuizzes": <suma wszystkich quizów>
      }
    }
    
    Wymagania:
    - Wygeneruj DOKŁADNIE 4 tygodnie
    - Każdy tydzień ma {{topicsPerWeek}} tematów
    - Logiczna progresja trudności
    - Dla kursów maturalnych: zgodność z wymaganiami egzaminacyjnymi
    - Każdy temat ma jasno określone cele
    - Realistyczne czasy trwania (30-90 min na materiał)
    - Quizy dostosowane do poziomu (5-15 pytań)
    - NIE UŻYWAJ komentarzy ani "..." w JSON
        `,responseFormat:"json"},inputMapping:e=>({courseTitle:e.courseTitle,description:e.description,subject:e.subject,level:e.level,courseType:e.courseType,objectives:Array.isArray(e.objectives)?e.objectives.join(", "):e.objectives,topicsCount:e.topicsCount,topicsPerWeek:e.topicsPerWeek,includeExercises:e.includeExercises?"tak":"nie",includeQuizzes:e.includeQuizzes?"tak":"nie",quizFrequency:e.quizFrequency||"chapter_end"}),outputMapping:(e,s)=>({...s,structure:e.structure,summary:e.summary}),validation:e=>!!(e.structure&&Array.isArray(e.structure)&&e.structure.length>0)},Nt={subject:{minLength:3,errorMessage:"Przedmiot jest wymagany (3-100 znaków)"},courseTitle:{minLength:5,errorMessage:"Tytuł jest wymagany (5-200 znaków)"},description:{minLength:50,errorMessage:"Opis jest wymagany (50-1000 znaków)"},topicsPerWeek:{min:1,max:7,errorMessage:"Liczba tematów na tydzień musi być między 1 a 7"}},ri={steps:{1:{title:"Jaki kurs chcesz stworzyć?",description:"Określ typ, przedmiot i poziom - AI stworzy kompletną strukturę kursu",button:"Analizuj wymagania",loading:"Analizuję wymagania..."},2:{title:"Analiza wymagań kursu",description:"AI przeanalizowała wymagania i zaproponowała parametry kursu",success:"✓ Analiza zakończona pomyślnie"},3:{title:"Dostosuj strukturę kursu",description:"Określ tempo nauki i dodatkowe elementy kursu",button:"Generuj strukturę",loading:"Generuję strukturę...",loadingInfo:"⚡ AI tworzy szczegółowy plan kursu z podziałem na tygodnie..."},4:{title:"Podgląd struktury kursu",description:"AI przygotowała kompletną strukturę z harmonogramem",info:"💡 Po zapisaniu będziesz mógł dodawać materiały do utworzonych tematów."},5:{title:"Tworzenie kursu",description:"Ostatnie poprawki przed utworzeniem kursu",saveInfo:"💾 Zostanie utworzony kurs z pełną strukturą tematów. Materiały i quizy możesz dodać później.",button:"Utwórz kurs",loading:"Tworzę kurs...",success:"✓ Kurs został utworzony pomyślnie! Przekierowuję..."}},dashboard:{title:"Generator struktury kursu",description:"Twórz kompletne kursy z pomocą AI",wizardTitle:"Generator kursów AI",wizardDescription:"Stwórz pełną strukturę kursu w 5 krokach",features:["Automatyczna analiza wymagań","Generowanie harmonogramu","Podział na tygodnie i tematy","Sugestie materiałów i quizów","Zgodność z podstawą programową","Progresja poziomu trudności"]},errors:{subjectRequired:"Podaj przedmiot kursu",analysisError:"Błąd analizy wymagań:",generationError:"Błąd generowania struktury:",saveError:"Wystąpił błąd podczas tworzenia kursu",unexpectedError:"Wystąpił nieoczekiwany błąd"}},yt={dashboard:"/course-structure",step1:"/course-structure/step1",step2:"/course-structure/step2",step3:"/course-structure/step3",step4:"/course-structure/step4",step5:"/course-structure/step5",courses:"/courses"},Hd={matura:{defaultTopics:["Wprowadzenie i powtórka","Podstawowe zagadnienia","Zagadnienia rozszerzone","Zadania typu maturalnego","Próbne egzaminy","Powtórka przedegzaminacyjna"],defaultQuizFrequency:"weekly",includeExercises:!0,includeQuizzes:!0},academic:{defaultQuizFrequency:"biweekly",includeExercises:!0,includeQuizzes:!0},professional:{defaultQuizFrequency:"chapter_end",includeExercises:!0,includeQuizzes:!0},hobby:{defaultQuizFrequency:"monthly",includeExercises:!0,includeQuizzes:!1},certification:{defaultQuizFrequency:"after_each",includeExercises:!0,includeQuizzes:!0}},Oz=()=>{const e=H(),{getData:s}=fe(),n=s("course-structure-wizard"),{dashboard:i}=ri,r=n&&n.courseTitle;return t.jsxs(W,{children:[t.jsx(ie,{title:i.title,description:i.description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-blue-50 p-6 rounded-lg border border-indigo-200",children:[t.jsxs(R,{variant:"start",className:"mb-4",children:[t.jsx("div",{className:"p-3 bg-indigo-100 rounded-lg",children:t.jsx(en,{className:"w-8 h-8 text-indigo-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:i.wizardTitle}),t.jsx("p",{className:"text-gray-600",children:i.wizardDescription})]})]}),t.jsxs(be,{variant:"1-2-2",className:"gap-4",children:[t.jsx("div",{className:"space-y-2",children:i.features.slice(0,3).map((a,o)=>t.jsxs(R,{variant:"start",className:"text-sm text-gray-700",children:[t.jsx(ze,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),t.jsx("span",{children:a})]},o))}),t.jsx("div",{className:"space-y-2",children:i.features.slice(3).map((a,o)=>t.jsxs(R,{variant:"start",className:"text-sm text-gray-700",children:[t.jsx(ze,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),t.jsx("span",{children:a})]},o))})]}),t.jsx("div",{className:"mt-6",children:t.jsxs(T,{onClick:()=>e(yt.step1),className:"w-full md:w-auto",size:"lg",children:[t.jsx(Jn,{className:"w-4 h-4 mr-2"}),"Stwórz strukturę kursu"]})})]}),r&&t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsxs(R,{variant:"between-center",className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ostatnia struktura"}),t.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Wygenerowana"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Tytuł kursu"}),t.jsx("p",{className:"font-medium text-gray-900",children:n.courseTitle})]}),n.subject&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Przedmiot"}),t.jsx("p",{className:"text-gray-900",children:n.subject})]}),n.summary&&t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Liczba tygodni"}),t.jsx("p",{className:"text-gray-900 font-medium",children:n.summary.totalWeeks})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Liczba tematów"}),t.jsx("p",{className:"text-gray-900 font-medium",children:n.summary.totalTopics})]})]})]}),t.jsxs(R,{variant:"start",className:"mt-6 gap-3",children:[t.jsxs(T,{variant:"outline",onClick:()=>e(yt.step4),children:[t.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Podgląd"]}),t.jsxs(T,{variant:"outline",onClick:()=>e(yt.step3),children:[t.jsx(Wl,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),t.jsxs(T,{variant:"outline",onClick:()=>e(yt.step1),children:[t.jsx(cr,{className:"w-4 h-4 mr-2"}),"Nowa struktura"]})]})]}),t.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Zarządzanie kursami"}),t.jsxs(be,{variant:"1-2-3",className:"gap-4",children:[t.jsxs("button",{onClick:()=>e("/courses"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(R,{variant:"start",className:"mb-2",children:[t.jsx(Ee,{className:"w-5 h-5 text-blue-600"}),t.jsx("span",{className:"font-medium",children:"Kursy"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Zobacz wszystkie kursy"})]}),t.jsxs("button",{onClick:()=>e("/educational-material"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(R,{variant:"start",className:"mb-2",children:[t.jsx(Es,{className:"w-5 h-5 text-purple-600"}),t.jsx("span",{className:"font-medium",children:"Materiały"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Kreator materiałów"})]}),t.jsxs("button",{onClick:()=>e("/quiz-wizard"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[t.jsxs(R,{variant:"start",className:"mb-2",children:[t.jsx(Is,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{className:"font-medium",children:"Quizy"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Kreator quizów"})]})]})]})]})]})},wr=({step:e})=>{const s=H();return t.jsxs(t.Fragment,{children:[t.jsx(T,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>s("/course-structure"),children:t.jsx(lt,{className:"h-5 w-5"})}),t.jsxs("div",{className:"p-8 space-y-12 text-zinc-800",children:[t.jsx("h1",{className:"text-6xl font-black",children:"COURSEFORGE"}),t.jsxs("h2",{className:"text-4xl",children:["Zaprojektujmy ",t.jsx("br",{}),t.jsx("span",{className:"font-bold",children:"strukturę kursu"})]}),t.jsxs("p",{children:["Krok ",e," z 5"]})]}),t.jsx(as,{className:"my-8"})]})},vr=({title:e,description:s})=>t.jsxs("header",{className:"mb-8",children:[t.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:e}),t.jsx("p",{className:"text-gray-600",children:s})]}),Rz=()=>{const e=H(),{register:s,setData:n}=fe(),[i,r]=g.useState(""),[a,o]=g.useState(""),[l,c]=g.useState(""),[d,m]=g.useState(""),[u,h]=g.useState({}),p=Xn("course-structure-wizard","analyze-course-requirements"),{steps:x,errors:f}=ri;g.useEffect(()=>(s(Iz),p.registerOperation(Mz),()=>{p.unregisterOperation()}),[]);const j=()=>{const y={};return i||(y.courseType="Wybierz typ kursu"),(!a.trim()||a.length<Nt.subject.minLength)&&(y.subject=Nt.subject.errorMessage),l||(y.level="Wybierz poziom kursu"),d||(y.duration="Wybierz czas trwania"),h(y),Object.keys(y).length===0},b=async()=>{if(j())try{const y={courseType:i,subject:a.trim(),level:l,duration:d};n("course-structure-wizard",y),await p.executeOperation(y),e(yt.step2)}catch(y){console.error(f.analysisError,y)}};return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(wr,{step:1}),t.jsxs("div",{className:"p-6",children:[t.jsx(vr,{title:x[1].title,description:x[1].description}),p.error&&t.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:t.jsxs("span",{className:"text-red-800 text-sm",children:[f.analysisError," ",p.error]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(X,{htmlFor:"courseType",children:"Typ kursu"}),t.jsxs(Te,{value:i,onValueChange:r,disabled:p.loading,children:[t.jsx(Ne,{className:u.courseType?"border-red-300":"",children:t.jsx(Ae,{placeholder:"Wybierz typ kursu..."})}),t.jsxs(ke,{children:[t.jsx(K,{value:"matura",children:"Kurs maturalny"}),t.jsx(K,{value:"academic",children:"Kurs akademicki"}),t.jsx(K,{value:"professional",children:"Kurs zawodowy"}),t.jsx(K,{value:"hobby",children:"Kurs hobbystyczny"}),t.jsx(K,{value:"certification",children:"Kurs certyfikacyjny"})]})]}),u.courseType&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.courseType})]}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"subject",children:"Przedmiot/Dziedzina"}),t.jsx(B,{id:"subject",type:"text",value:a,onChange:y=>o(y.target.value),placeholder:"np. Matematyka, Programowanie Python, Język angielski",disabled:p.loading,className:u.subject?"border-red-300":""}),u.subject&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.subject})]}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"level",children:"Poziom kursu"}),t.jsxs(Te,{value:l,onValueChange:c,disabled:p.loading,children:[t.jsx(Ne,{className:u.level?"border-red-300":"",children:t.jsx(Ae,{placeholder:"Wybierz poziom..."})}),t.jsx(ke,{children:i==="matura"?t.jsxs(t.Fragment,{children:[t.jsx(K,{value:"basic",children:"Podstawowy"}),t.jsx(K,{value:"extended",children:"Rozszerzony"})]}):t.jsxs(t.Fragment,{children:[t.jsx(K,{value:"beginner",children:"Początkujący"}),t.jsx(K,{value:"intermediate",children:"Średniozaawansowany"}),t.jsx(K,{value:"advanced",children:"Zaawansowany"})]})})]}),u.level&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.level})]}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"duration",children:"Planowany czas trwania"}),t.jsxs(Te,{value:d,onValueChange:m,disabled:p.loading,children:[t.jsx(Ne,{className:u.duration?"border-red-300":"",children:t.jsx(Ae,{placeholder:"Wybierz czas trwania..."})}),t.jsxs(ke,{children:[t.jsx(K,{value:"1month",children:"1 miesiąc"}),t.jsx(K,{value:"3months",children:"3 miesiące"}),t.jsx(K,{value:"6months",children:"6 miesięcy"}),t.jsx(K,{value:"1year",children:"1 rok"}),t.jsx(K,{value:"2years",children:"2 lata"})]})]}),u.duration&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.duration})]}),t.jsx("button",{onClick:b,disabled:p.loading,className:"w-full h-12 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white font-medium rounded-lg flex items-center justify-center gap-2",children:p.loading?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),x[1].loading]}):x[1].button})]})]})]})})},Fz=()=>{const e=H(),{getData:s}=fe(),n=s("course-structure-wizard"),{steps:i}=ri;return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(wr,{step:2}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(vr,{title:i[2].title,description:i[2].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:t.jsx("span",{className:"text-green-800 text-sm",children:i[2].success})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Proponowany tytuł"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:n.courseTitle})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opis kursu"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 whitespace-pre-wrap",children:n.description})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cele kursu"}),t.jsx("div",{className:"space-y-2",children:n.objectives?.map((r,a)=>t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsxs("span",{className:"text-indigo-600 font-medium",children:[a+1,"."]}),t.jsx("span",{className:"text-gray-800",children:r})]},a))})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Grupa docelowa"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800",children:n.targetAudience})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wymagania wstępne"}),t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:n.prerequisites?.length>0?t.jsx("ul",{className:"list-disc list-inside space-y-1",children:n.prerequisites.map((r,a)=>t.jsx("li",{className:"text-gray-800 text-sm",children:r},a))}):t.jsx("span",{className:"text-gray-500 text-sm",children:"Brak wymagań wstępnych"})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Szacowana liczba godzin"}),t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[n.estimatedHours," godzin"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Liczba głównych tematów"}),t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[n.topicsCount," tematów"]})]})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(yt.step1),children:"Wstecz"}),t.jsx(T,{onClick:()=>e(yt.step3),children:"Kontynuuj"})]})]})]})]})})},$z=()=>{const e=H(),{getData:s,setData:n}=fe(),i=s("course-structure-wizard"),[r,a]=g.useState(i.courseTitle||""),[o,l]=g.useState(i.description||""),[c,d]=g.useState(2),[m,u]=g.useState(!0),[h,p]=g.useState(!0),[x,f]=g.useState("weekly"),[j,b]=g.useState({}),y=Xn("course-structure-wizard","generate-course-structure"),{steps:w,errors:z}=ri;g.useEffect(()=>{if(y.registerOperation(Lz),i.courseType&&i.courseType in Hd){const k=i.courseType,C=Hd[k];u(C.includeExercises),p(C.includeQuizzes),f(C.defaultQuizFrequency)}return()=>{y.unregisterOperation()}},[]);const N=()=>{const k={};return(!r.trim()||r.length<Nt.courseTitle.minLength)&&(k.courseTitle=Nt.courseTitle.errorMessage),(!o.trim()||o.length<Nt.description.minLength)&&(k.description=Nt.description.errorMessage),(!c||c<Nt.topicsPerWeek.min||c>Nt.topicsPerWeek.max)&&(k.topicsPerWeek=Nt.topicsPerWeek.errorMessage),b(k),Object.keys(k).length===0},S=async()=>{if(N())try{const k={...i,courseTitle:r.trim(),description:o.trim(),topicsPerWeek:c,includeExercises:m,includeQuizzes:h,quizFrequency:x};n("course-structure-wizard",k),await y.executeOperation(k),e(yt.step4)}catch(k){console.error(z.generationError,k)}};return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(wr,{step:3}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(vr,{title:w[3].title,description:w[3].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"courseTitle",children:["Tytuł kursu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"courseTitle",value:r,onChange:k=>a(k.target.value),placeholder:"np. Matematyka - Przygotowanie do matury",className:`mt-1 ${j.courseTitle?"border-red-300":""}`}),j.courseTitle&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.courseTitle})]}),t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"description",children:["Opis kursu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Dt,{id:"description",value:o,onChange:k=>l(k.target.value),placeholder:"Szczegółowy opis kursu...",rows:4,className:`mt-1 ${j.description?"border-red-300":""}`}),j.description&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.description}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[o.length," / ",Nt.description.minLength," ","znaków minimum"]})]}),t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"topicsPerWeek",children:["Liczba tematów na tydzień"," ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"topicsPerWeek",type:"number",value:c,onChange:k=>d(parseInt(k.target.value)||0),min:Nt.topicsPerWeek.min,max:Nt.topicsPerWeek.max,className:`mt-1 ${j.topicsPerWeek?"border-red-300":""}`}),j.topicsPerWeek&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.topicsPerWeek}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Określa tempo realizacji kursu"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jt,{id:"includeExercises",checked:m,onCheckedChange:k=>u(k)}),t.jsx("label",{htmlFor:"includeExercises",className:"text-sm cursor-pointer",children:"Dodaj ćwiczenia do każdego tematu"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jt,{id:"includeQuizzes",checked:h,onCheckedChange:k=>p(k)}),t.jsx("label",{htmlFor:"includeQuizzes",className:"text-sm cursor-pointer",children:"Dodaj quizy sprawdzające"})]}),h&&t.jsxs("div",{className:"ml-6",children:[t.jsx(X,{htmlFor:"quizFrequency",children:"Częstotliwość quizów"}),t.jsxs(Te,{value:x,onValueChange:f,children:[t.jsx(Ne,{className:"mt-1",children:t.jsx(Ae,{})}),t.jsxs(ke,{children:[t.jsx(K,{value:"after_each",children:"Po każdym temacie"}),t.jsx(K,{value:"weekly",children:"Co tydzień"}),t.jsx(K,{value:"biweekly",children:"Co dwa tygodnie"}),t.jsx(K,{value:"monthly",children:"Co miesiąc"}),t.jsx(K,{value:"chapter_end",children:"Na koniec działu"})]})]})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(yt.step2),children:"Wstecz"}),t.jsx(T,{onClick:S,disabled:y.loading,children:y.loading?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),w[3].loading]}):w[3].button})]})]}),y.loading&&t.jsx("div",{className:"mt-6 p-4 bg-indigo-50 border border-indigo-200 rounded-lg",children:t.jsx("span",{className:"text-indigo-800 text-sm",children:w[3].loadingInfo})})]})]})})},qz=()=>{const e=H(),{getData:s}=fe(),n=s("course-structure-wizard"),{steps:i}=ri,r=a=>{switch(a){case"material":return t.jsx(et,{className:"w-4 h-4"});case"quiz":return t.jsx(ct,{className:"w-4 h-4"});default:return t.jsx(Ee,{className:"w-4 h-4"})}};return t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[t.jsx(wr,{step:4}),t.jsxs("div",{className:"space-y-6 p-8",children:[t.jsx(vr,{title:t.jsxs(t.Fragment,{children:[t.jsx(Ve,{className:"w-8 h-8 text-zinc-500"}),t.jsx("span",{children:i[4].title})]}),description:i[4].description}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold mb-3",children:n.courseTitle}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:n.description}),n.summary&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:n.summary.totalWeeks}),t.jsx("div",{className:"text-gray-600",children:"tygodni"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.summary.totalTopics}),t.jsx("div",{className:"text-gray-600",children:"tematów"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.summary.totalActivities}),t.jsx("div",{className:"text-gray-600",children:"aktywności"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.summary.totalQuizzes}),t.jsx("div",{className:"text-gray-600",children:"quizów"})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"font-semibold text-lg",children:"Struktura kursu"}),n.structure?.map((a,o)=>t.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"bg-indigo-50 px-4 py-3 flex items-center gap-2",children:[t.jsx(Is,{className:"w-5 h-5 text-indigo-600"}),t.jsxs("h5",{className:"font-medium",children:["Tydzień ",a.weekNumber]}),t.jsxs(ne,{variant:"secondary",className:"ml-auto",children:[a.topics.length," ",a.topics.length===1?"temat":"tematów"]})]}),t.jsx("div",{className:"p-4 space-y-3",children:a.topics.map((l,c)=>t.jsxs("div",{className:"border-l-4 border-indigo-200 pl-4",children:[t.jsx("h6",{className:"font-medium text-gray-900",children:l.title}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.description}),l.objectives&&l.objectives.length>0&&t.jsxs("div",{className:"mt-2 space-y-1",children:[t.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Cele:"}),t.jsx("ul",{className:"text-xs text-gray-600 list-disc list-inside",children:l.objectives.map((d,m)=>t.jsx("li",{children:d},m))})]}),l.activities&&l.activities.length>0&&t.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:l.activities.map((d,m)=>t.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-100 rounded text-xs",children:[r(d.type),t.jsx("span",{children:d.title}),d.duration&&t.jsxs("span",{className:"text-gray-500",children:["(",d.duration," min)"]})]},m))}),l.keywords&&l.keywords.length>0&&t.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:l.keywords.map((d,m)=>t.jsx(ne,{variant:"outline",className:"text-xs",children:d},m))})]},c))})]},o))]})]}),t.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:t.jsx("p",{className:"text-indigo-800 text-sm",children:i[4].info})}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx(T,{variant:"outline",onClick:()=>e(yt.step3),children:"Wstecz"}),t.jsx(T,{onClick:()=>e(yt.step5),children:"Utwórz kurs"})]})]})]})})},Bz=()=>{const e=H(),{getData:s,setData:n}=fe(),{mutate:i}=ps(),{mutate:r}=ps(),{data:a}=st(),o=s("course-structure-wizard"),[l,c]=g.useState(o.courseTitle||""),[d,m]=g.useState("📚"),[u,h]=g.useState(!1),[p,x]=g.useState(!1),[f,j]=g.useState(!1),{steps:b,errors:y}=ri,w=async()=>{if(!l.trim()){$.error("Nazwa kursu jest wymagana");return}if(!a?.vendor_id){$.error("Brak informacji o vendor_id. Skontaktuj się z administratorem.");return}x(!0),j(!1);try{i({resource:"courses",values:{vendor_id:a.vendor_id,title:l.trim(),description:o.description,icon_emoji:d,is_published:u}},{onSuccess:async N=>{const S=N.data.id;let k=1;try{for(const C of o.structure)for(const A of C.topics)await new Promise((v,P)=>{r({resource:"topics",values:{course_id:S,title:A.title,position:k++,is_published:!1}},{onSuccess:v,onError:P})});n("course-structure-wizard",{...o,courseName:l.trim(),courseId:S,saved:!0}),x(!1),j(!0),setTimeout(()=>{e(`${yt.courses}/show/${S}`)},2e3)}catch(C){x(!1),console.error("Błąd podczas tworzenia tematów:",C),$.error("Wystąpił błąd podczas tworzenia struktury kursu")}},onError:N=>{x(!1),console.error(y.saveError,N),N?.code==="42501"?$.error("Brak uprawnień do tworzenia kursów. Sprawdź swoje uprawnienia."):N?.code==="23505"?$.error("Kurs o takiej nazwie już istnieje."):$.error(y.saveError)}})}catch(N){x(!1),console.error(y.unexpectedError,N),$.error(y.unexpectedError)}},z=()=>{switch(o.courseType){case"matura":return"🎓";case"academic":return"🏛️";case"professional":return"💼";case"hobby":return"🎨";case"certification":return"📜";default:return"📚"}};return L.useEffect(()=>{m(z())},[o.courseType]),t.jsx(W,{children:t.jsxs("div",{className:"border rounded-lg bg-white shadow relative",children:[t.jsx(wr,{step:5}),t.jsxs("div",{className:"p-8",children:[t.jsx(vr,{title:t.jsxs(t.Fragment,{children:[t.jsx(en,{className:"w-8 h-8 text-indigo-500"}),t.jsx("span",{children:b[5].title})]}),description:b[5].description}),f&&t.jsx(le,{className:"mb-6 bg-green-50 border-green-200",children:t.jsx(ce,{className:"text-green-800",children:b[5].success})}),t.jsxs("form",{className:"space-y-6",onSubmit:N=>{N.preventDefault(),w()},children:[t.jsxs("div",{children:[t.jsxs(X,{htmlFor:"courseName",children:["Nazwa kursu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(B,{id:"courseName",type:"text",value:l,onChange:N=>c(N.target.value),placeholder:"np. Matematyka - Kurs maturalny poziom rozszerzony",className:"mt-1"})]}),t.jsxs("div",{children:[t.jsx(X,{htmlFor:"iconEmoji",children:"Emoji ikona"}),t.jsxs("div",{className:"flex gap-2 mt-1",children:[t.jsx(B,{id:"iconEmoji",type:"text",value:d,onChange:N=>m(N.target.value),placeholder:"np. 📚 📐 🎓",className:"flex-1",maxLength:5}),t.jsx("div",{className:"flex gap-1",children:["📚","🎓","📐","🏛️","💼","🎨","📜","🚀"].map(N=>t.jsx(T,{type:"button",variant:"outline",size:"sm",onClick:()=>m(N),className:"w-10 h-10",children:N},N))})]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Wybierz emoji z listy lub wpisz własne"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jt,{id:"isPublished",checked:u,onCheckedChange:N=>h(N)}),t.jsx("label",{htmlFor:"isPublished",className:"text-sm cursor-pointer",children:"Opublikuj kurs od razu (uczniowie będą mogli go zobaczyć)"})]}),t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-medium mb-3",children:"Co zostanie utworzone:"}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-600",children:"✓"}),t.jsxs("span",{children:['Kurs "',l||o.courseTitle,'" z pełnym opisem']})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-600",children:"✓"}),t.jsxs("span",{children:[o.summary?.totalTopics||0," tematów rozłożonych na ",o.summary?.totalWeeks||0," tygodni"]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-600",children:"✓"}),t.jsx("span",{children:"Struktura gotowa do wypełnienia materiałami i quizami"})]})]})]}),t.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:t.jsx("p",{className:"text-indigo-800 text-sm",children:b[5].saveInfo})}),t.jsx(as,{}),t.jsxs("footer",{className:"flex justify-between gap-4",children:[t.jsxs(T,{type:"button",variant:"outline",onClick:()=>e(yt.step4),disabled:p,className:"flex items-center gap-2",children:[t.jsx(me,{className:"w-4 h-4"}),"Wstecz"]}),t.jsx(T,{type:"submit",disabled:p||f,className:"flex items-center gap-2 min-w-[160px]",children:p?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),b[5].loading]}):t.jsxs(t.Fragment,{children:[t.jsx(dr,{className:"w-4 h-4"}),b[5].button]})})]})]})]})]})})},Vz=[t.jsx(F,{path:"/course-structure",element:t.jsx(Oz,{})},"course-dashboard"),t.jsx(F,{path:"/course-structure/step1",element:t.jsx(Rz,{})},"course-step1"),t.jsx(F,{path:"/course-structure/step2",element:t.jsx(Fz,{})},"course-step2"),t.jsx(F,{path:"/course-structure/step3",element:t.jsx($z,{})},"course-step3"),t.jsx(F,{path:"/course-structure/step4",element:t.jsx(qz,{})},"course-step4"),t.jsx(F,{path:"/course-structure/step5",element:t.jsx(Bz,{})},"course-step5")],Uz={name:"course-structure",list:"/course-structure",create:"/course-structure/step1",meta:{canDelete:!1,label:"Generator kursów",icon:t.jsx(_a,{className:"h-4 w-4"})}},Wz=()=>t.jsxs("header",{className:"h-16 px-6 border-b relative grid place-items-center justify-start overflow-hidden",children:[t.jsx("i",{"aria-hidden":!0,className:"absolute -right-10 -top-10 w-28 h-28 rounded-3xl bg-gradient-to-br from-primary/10 via-secondary/10 to-accent/10 rotate-45"}),t.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[t.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-secondary text-white grid place-items-center shadow",children:t.jsx(Es,{className:"w-5 h-5"})}),t.jsx("strong",{className:"text-lg",children:"Smart Up"})]})]}),Jp=({name:e,level:s,streak:n})=>t.jsx("section",{className:"p-6",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-primary/10 to-secondary/10 text-primary grid place-items-center font-bold",children:e?.charAt(0)||"U"}),t.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 rounded-full bg-secondary text-white text-xs grid place-items-center font-bold",children:s})]}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"font-semibold truncate",children:e}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Poziom ",s," • ",n," dni"]})]})]})}),Xp=({points:e,idle:s,streak:n})=>t.jsx("section",{className:"px-6 -mt-2 mb-2",children:t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("article",{className:"rounded-xl border p-3 bg-primary/5 border-primary/10",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx($t,{className:"w-4 h-4 text-primary"}),t.jsx("span",{className:"text-xs text-muted-foreground",children:"Punkty"})]}),t.jsx("p",{className:"text-lg font-bold",children:e}),t.jsxs("p",{className:"text-xs text-primary",children:["+",s,"/h"]})]}),t.jsxs("article",{className:"rounded-xl border p-3 bg-destructive/5 border-destructive/10",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(Js,{className:"w-4 h-4 text-destructive"}),t.jsx("span",{className:"text-xs text-muted-foreground",children:"Seria"})]}),t.jsx("p",{className:"text-lg font-bold",children:n}),t.jsx("p",{className:"text-xs text-destructive",children:"dni z rzędu"})]})]})}),ef=({items:e,current:s,onNavigate:n})=>{const i=a=>s===a,r=a=>{const o=i(a.path);return t.jsxs("button",{onClick:()=>n(a.path),className:`relative w-full flex items-center gap-3 px-4 h-11 rounded-xl transition-colors
          ${o?"bg-primary text-primary-foreground":"hover:bg-muted/50 text-muted-foreground hover:text-foreground"}`,children:[t.jsx(a.icon,{className:"w-5 h-5"}),t.jsx("span",{className:"text-sm font-medium",children:a.label})]})};return t.jsx("nav",{className:"px-4",children:t.jsx("ul",{className:"space-y-1",children:e.map(a=>t.jsx("li",{children:t.jsx(r,{...a})},a.path))})})},tf=({onLogout:e})=>t.jsxs("button",{onClick:e,className:"w-full flex items-center justify-center gap-2 px-4 h-11 rounded-xl text-destructive border border-destructive/30 bg-destructive/5 hover:bg-destructive/10 transition-colors",title:"Wyloguj",children:[t.jsx(Pa,{className:"w-5 h-5"}),t.jsx("span",{className:"text-sm font-semibold",children:"Wyloguj"})]}),Kz=({level:e,points:s})=>{const n=Math.max(0,Math.min(100,s%100));return t.jsx("section",{className:"px-6",children:t.jsxs("div",{className:"px-2",children:[t.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-2",children:[t.jsxs("span",{children:["Poziom ",e]}),t.jsxs("span",{children:["Poziom ",e+1]})]}),t.jsx("div",{className:"h-1.5 rounded-full bg-muted overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-primary via-secondary to-accent",style:{width:`${n}%`}})})]})})},Gz=({identity:e,stats:s,menuItems:n,currentPath:i,onNavigate:r,onLogout:a})=>t.jsxs(t.Fragment,{children:[t.jsx(Wz,{}),t.jsx(Jp,{name:e?.full_name,level:s.level,streak:s.streak}),t.jsx(Xp,{points:s.points,idle:s.idle_rate,streak:s.streak}),t.jsx(ef,{items:n,current:i,onNavigate:r}),t.jsxs("footer",{className:"mt-auto p-4 border-t space-y-3",children:[t.jsx(Kz,{level:s.level,points:s.points}),t.jsx(tf,{onLogout:a})]})]}),Qd=({variant:e,open:s=!1,onClose:n,identity:i,stats:r,menuItems:a,currentPath:o,onNavigate:l,onLogout:c})=>e==="desktop"?t.jsx("aside",{className:"hidden lg:flex fixed inset-y-0 left-0 w-72 bg-card/95 backdrop-blur border-r flex-col",children:t.jsx(Gz,{identity:i,stats:r,menuItems:a,currentPath:o,onNavigate:l,onLogout:c})}):s?t.jsxs(t.Fragment,{children:[t.jsx("button",{type:"button","aria-label":"Zamknij menu",onClick:n,className:"lg:hidden fixed inset-0 bg-black/30 backdrop-blur-sm z-40"}),t.jsxs("aside",{className:"lg:hidden fixed inset-y-0 left-0 w-80 bg-card/95 backdrop-blur-xl z-50 shadow-2xl border-r flex flex-col","aria-label":"Nawigacja boczna",children:[t.jsxs("header",{className:"h-16 px-6 border-b flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-secondary text-white grid place-items-center",children:t.jsx(Es,{className:"w-5 h-5"})}),t.jsx("strong",{className:"text-lg",children:"Smart Up"})]}),t.jsx("button",{onClick:n,className:"p-2 rounded-lg hover:bg-muted focus-ring","aria-label":"Zamknij",children:t.jsx("svg",{viewBox:"0 0 24 24",className:"w-5 h-5 text-muted-foreground",children:t.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]}),t.jsxs("section",{className:"overflow-y-auto",children:[t.jsx(Jp,{name:i?.full_name,level:r.level,streak:r.streak}),t.jsx(Xp,{points:r.points,idle:r.idle_rate,streak:r.streak}),t.jsx(ef,{items:a,current:o,onNavigate:d=>{l(d),n?.()}})]}),t.jsx("footer",{className:"mt-auto p-4 border-t",children:t.jsx(tf,{onLogout:c})})]})]}):null,Hz=()=>{const e=()=>{const i=localStorage.getItem("theme");return i==="light"||i==="dark"?i:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},[s,n]=g.useState(e);return L.useEffect(()=>{document.documentElement.classList.toggle("dark",s==="dark"),localStorage.setItem("theme",s)},[s]),{theme:s,toggle:()=>n(i=>i==="dark"?"light":"dark")}},Qz=({identity:e,stats:s,menuItems:n,currentPath:i,onNavigate:r,onLogout:a,onOpenSidebar:o})=>{const{theme:l,toggle:c}=Hz(),[d,m]=g.useState(!1),u=g.useMemo(()=>n.find(p=>p.path===i)?.label||"Dashboard",[n,i]),h=g.useMemo(()=>[{label:"Profil",icon:ss,action:()=>r("/student/profile")},{label:"Ustawienia",icon:Ym,action:()=>r("/student/settings")},{label:"Pomoc",icon:ct,action:()=>r("/student/help")},{label:l==="dark"?"Tryb jasny":"Tryb ciemny",icon:l==="dark"?rj:aj,action:()=>c()},{label:"Wyloguj",icon:Pa,action:()=>a(),danger:!0}],[r,a,l,c]);return t.jsx("header",{className:"sticky top-0 z-30 h-16 bg-card/80 backdrop-blur supports-[backdrop-filter]:bg-card/60 border-b shadow-sm",children:t.jsxs("div",{className:"mx-auto max-w-6xl h-full px-4 lg:px-8 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("button",{onClick:o,className:"lg:hidden p-2.5 rounded-xl hover:bg-muted focus-ring","aria-label":"Otwórz menu",children:t.jsx(Aa,{className:"w-5 h-5"})}),t.jsxs("div",{className:"hidden lg:block min-w-0",children:[t.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:u}),t.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["Witaj, ",e?.full_name?.split(" ")[0],"!"]})]})]}),t.jsxs("div",{className:"flex items-center gap-2 lg:gap-3",children:[t.jsxs("button",{className:"relative p-2.5 rounded-xl hover:bg-muted focus-ring h-11 w-11 grid place-items-center","aria-label":"Powiadomienia",children:[t.jsx(Vl,{className:"w-5 h-5 text-muted-foreground"}),t.jsx("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-destructive rounded-full"})]}),t.jsxs("div",{className:"flex items-center gap-2 px-3 lg:px-4 h-11 rounded-xl border bg-primary/10 border-primary/20",children:[t.jsx($t,{className:"w-4 h-4 text-primary"}),t.jsx("span",{className:"font-semibold text-sm lg:text-base tabular-nums",children:s.points}),t.jsxs("span",{className:"hidden md:block text-xs text-primary",children:["+",s.idle_rate,"/h"]})]}),t.jsxs("div",{className:"relative",children:[t.jsxs("button",{onClick:()=>m(p=>!p),className:"flex items-center gap-2 px-1.5 h-11 rounded-xl hover:bg-muted focus-ring","aria-haspopup":"menu","aria-expanded":d,children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-9 h-9 lg:w-10 lg:h-10 rounded-xl bg-gradient-to-br from-primary to-secondary text-white grid place-items-center font-bold",children:e?.full_name?.charAt(0)||"U"}),t.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-4 h-4 lg:w-5 lg:h-5 rounded-full bg-accent text-white text-[10px] lg:text-xs grid place-items-center border-2 border-card",children:s.level})]}),t.jsx(Ta,{className:"w-4 h-4 text-muted-foreground"})]}),d&&t.jsxs("menu",{className:"absolute right-0 mt-2 w-64 bg-card rounded-xl border shadow-soft-lg z-50 overflow-hidden",children:[t.jsxs("section",{className:"p-4 border-b",children:[t.jsx("p",{className:"font-semibold truncate",children:e?.full_name}),t.jsx("p",{className:"text-sm text-muted-foreground truncate",children:e?.email})]}),t.jsx("ul",{className:"p-2",children:h.map((p,x)=>t.jsx("li",{children:t.jsxs("button",{onClick:()=>{p.action(),m(!1)},className:`w-full flex items-center gap-3 px-3 h-11 rounded-lg ${p.danger?"text-destructive hover:bg-destructive/10":"text-foreground/80 hover:text-foreground hover:bg-muted"}`,role:"menuitem",children:[t.jsx(p.icon,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm font-medium",children:p.label})]})},x))})]})]})]})]})})},Zz=({menuItems:e,currentPath:s,onNavigate:n})=>{const i=r=>s===r;return t.jsx("nav",{"aria-label":"Główna nawigacja dolna",className:"fixed bottom-0 z-40 left-0 right-0 lg:left-72 bg-card/80 backdrop-blur supports-[backdrop-filter]:bg-card/60 border-t shadow-sm",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:t.jsx("div",{className:"mx-auto max-w-6xl p-1.5 sm:px-4",children:t.jsx("ul",{className:"grid grid-cols-5 gap-1 p-1",children:e.map(r=>{const a=i(r.path);return t.jsx("li",{children:t.jsxs("button",{onClick:()=>n(r.path),className:`relative flex flex-col items-center justify-center gap-1 rounded-lg p-4 transition-colors ${a?"text-primary":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}`,"aria-current":a?"page":void 0,children:[t.jsx(r.icon,{className:"h-5 w-5"}),t.jsx("span",{className:"text-[11px] font-medium",children:r.label}),a&&t.jsx("i",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-6 -bottom-[3px] h-1 rounded-full bg-primary/70"})]})},r.path)})})})})},Yz=()=>t.jsx("div",{"aria-hidden":!0,className:"opacity-50  pointer-events-none fixed inset-0 z-0 overflow-hidden p-0 lg:p-4 lg:pb-28 pt-0",children:t.jsxs("div",{className:"relative w-full h-full",children:[t.jsx("div",{className:"absolute inset-0 bg-white rounded-3xl"}),t.jsxs("div",{className:"absolute inset-0 rounded-3xl",style:{WebkitMaskImage:"linear-gradient(to bottom, transparent 0%, transparent 50%, black 70%)",maskImage:"linear-gradient(to bottom, transparent 0%, transparent 50%, black 70%)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskSize:"cover",maskSize:"cover"},children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-400 via-yellow-300 to-purple-500 opacity-50 rounded-3xl"}),t.jsx("div",{className:"absolute w-[60vw] h-[60vw] top-1/2 -left-1/4 bg-orange-400 rounded-full mix-blend-multiply blur-[220px] opacity-40 animate-pulse"}),t.jsx("div",{className:"absolute w-[50vw] h-[50vw] top-[65%] left-1/2 bg-yellow-300 rounded-full mix-blend-multiply blur-[220px] opacity-40 animate-pulse"}),t.jsx("div",{className:"absolute w-[55vw] h-[55vw] top-[75%] -right-1/4 bg-purple-500 rounded-full mix-blend-multiply blur-[220px] opacity-40 animate-pulse"})]})]})}),Jz=({children:e})=>{const[s,n]=g.useState(!1),{data:i}=st(),{mutate:r}=ql(),a=H(),o=ka(),{stats:l}=ur(),c=g.useMemo(()=>[{path:"/student/dashboard",label:"Główna",icon:Zm},{path:"/student/gamification",label:"Ulepszenia",icon:aa},{path:"/student/leaderboard",label:"Ranking",icon:Je},{path:"/student/achievements",label:"Osiągnięcia",icon:Bn},{path:"/student/profile",label:"Profil",icon:ss}],[]);return t.jsxs("div",{className:"min-h-screen bg-background relative select-none",children:[t.jsx(Yz,{}),t.jsx(Qd,{variant:"desktop",identity:i,stats:l,menuItems:c,currentPath:o.pathname,onNavigate:a,onLogout:()=>r()}),t.jsxs("main",{className:"relative lg:ml-72",children:[t.jsx(Qz,{identity:i,stats:l,menuItems:c,currentPath:o.pathname,onNavigate:a,onLogout:()=>r(),onOpenSidebar:()=>n(!0)}),t.jsx("section",{className:"min-h-[calc(100vh-4rem)] pb-[104px] sm:pb-[112px] lg:pb-[120px]",children:e})]}),t.jsx(Qd,{variant:"mobile",open:s,onClose:()=>n(!1),identity:i,stats:l,menuItems:c,currentPath:o.pathname,onNavigate:a,onLogout:()=>r()}),t.jsx(Zz,{menuItems:c,currentPath:o.pathname,onNavigate:a})]})},uc=g.createContext({});function mc(e){const s=g.useRef(null);return s.current===null&&(s.current=e()),s.current}const hc=typeof window<"u",sf=hc?g.useLayoutEffect:g.useEffect,Wa=g.createContext(null);function pc(e,s){e.indexOf(s)===-1&&e.push(s)}function fc(e,s){const n=e.indexOf(s);n>-1&&e.splice(n,1)}const gs=(e,s,n)=>n>s?s:n<e?e:n;let xc=()=>{};const ys={},nf=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function rf(e){return typeof e=="object"&&e!==null}const af=e=>/^0[^.\s]+$/u.test(e);function gc(e){let s;return()=>(s===void 0&&(s=e()),s)}const Tt=e=>e,Xz=(e,s)=>n=>s(e(n)),Nr=(...e)=>e.reduce(Xz),Yi=(e,s,n)=>{const i=s-e;return i===0?1:(n-e)/i};class yc{constructor(){this.subscriptions=[]}add(s){return pc(this.subscriptions,s),()=>fc(this.subscriptions,s)}notify(s,n,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](s,n,i);else for(let a=0;a<r;a++){const o=this.subscriptions[a];o&&o(s,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Jt=e=>e*1e3,Xt=e=>e/1e3;function of(e,s){return s?e*(1e3/s):0}const lf=(e,s,n)=>(((1-3*n+3*s)*e+(3*n-6*s))*e+3*s)*e,e1=1e-7,t1=12;function s1(e,s,n,i,r){let a,o,l=0;do o=s+(n-s)/2,a=lf(o,i,r)-e,a>0?n=o:s=o;while(Math.abs(a)>e1&&++l<t1);return o}function kr(e,s,n,i){if(e===s&&n===i)return Tt;const r=a=>s1(a,0,1,e,n);return a=>a===0||a===1?a:lf(r(a),s,i)}const cf=e=>s=>s<=.5?e(2*s)/2:(2-e(2*(1-s)))/2,df=e=>s=>1-e(1-s),uf=kr(.33,1.53,.69,.99),jc=df(uf),mf=cf(jc),hf=e=>(e*=2)<1?.5*jc(e):.5*(2-Math.pow(2,-10*(e-1))),bc=e=>1-Math.sin(Math.acos(e)),pf=df(bc),ff=cf(bc),n1=kr(.42,0,1,1),i1=kr(0,0,.58,1),xf=kr(.42,0,.58,1),r1=e=>Array.isArray(e)&&typeof e[0]!="number",gf=e=>Array.isArray(e)&&typeof e[0]=="number",a1={linear:Tt,easeIn:n1,easeInOut:xf,easeOut:i1,circIn:bc,circInOut:ff,circOut:pf,backIn:jc,backInOut:mf,backOut:uf,anticipate:hf},o1=e=>typeof e=="string",Zd=e=>{if(gf(e)){xc(e.length===4);const[s,n,i,r]=e;return kr(s,n,i,r)}else if(o1(e))return a1[e];return e},$r=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function l1(e,s){let n=new Set,i=new Set,r=!1,a=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(m){o.has(m)&&(d.schedule(m),e()),m(l)}const d={schedule:(m,u=!1,h=!1)=>{const x=h&&r?n:i;return u&&o.add(m),x.has(m)||x.add(m),m},cancel:m=>{i.delete(m),o.delete(m)},process:m=>{if(l=m,r){a=!0;return}r=!0,[n,i]=[i,n],n.forEach(c),n.clear(),r=!1,a&&(a=!1,d.process(m))}};return d}const c1=40;function yf(e,s){let n=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,o=$r.reduce((w,z)=>(w[z]=l1(a),w),{}),{setup:l,read:c,resolveKeyframes:d,preUpdate:m,update:u,preRender:h,render:p,postRender:x}=o,f=()=>{const w=ys.useManualTiming?r.timestamp:performance.now();n=!1,ys.useManualTiming||(r.delta=i?1e3/60:Math.max(Math.min(w-r.timestamp,c1),1)),r.timestamp=w,r.isProcessing=!0,l.process(r),c.process(r),d.process(r),m.process(r),u.process(r),h.process(r),p.process(r),x.process(r),r.isProcessing=!1,n&&s&&(i=!1,e(f))},j=()=>{n=!0,i=!0,r.isProcessing||e(f)};return{schedule:$r.reduce((w,z)=>{const N=o[z];return w[z]=(S,k=!1,C=!1)=>(n||j(),N.schedule(S,k,C)),w},{}),cancel:w=>{for(let z=0;z<$r.length;z++)o[$r[z]].cancel(w)},state:r,steps:o}}const{schedule:he,cancel:Os,state:qe,steps:zo}=yf(typeof requestAnimationFrame<"u"?requestAnimationFrame:Tt,!0);let Yr;function d1(){Yr=void 0}const ot={now:()=>(Yr===void 0&&ot.set(qe.isProcessing||ys.useManualTiming?qe.timestamp:performance.now()),Yr),set:e=>{Yr=e,queueMicrotask(d1)}},jf=e=>s=>typeof s=="string"&&s.startsWith(e),wc=jf("--"),u1=jf("var(--"),vc=e=>u1(e)?m1.test(e.split("/*")[0].trim()):!1,m1=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,ai={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ji={...ai,transform:e=>gs(0,1,e)},qr={...ai,default:1},Ei=e=>Math.round(e*1e5)/1e5,Nc=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function h1(e){return e==null}const p1=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,kc=(e,s)=>n=>!!(typeof n=="string"&&p1.test(n)&&n.startsWith(e)||s&&!h1(n)&&Object.prototype.hasOwnProperty.call(n,s)),bf=(e,s,n)=>i=>{if(typeof i!="string")return i;const[r,a,o,l]=i.match(Nc);return{[e]:parseFloat(r),[s]:parseFloat(a),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},f1=e=>gs(0,255,e),So={...ai,transform:e=>Math.round(f1(e))},Gs={test:kc("rgb","red"),parse:bf("red","green","blue"),transform:({red:e,green:s,blue:n,alpha:i=1})=>"rgba("+So.transform(e)+", "+So.transform(s)+", "+So.transform(n)+", "+Ei(Ji.transform(i))+")"};function x1(e){let s="",n="",i="",r="";return e.length>5?(s=e.substring(1,3),n=e.substring(3,5),i=e.substring(5,7),r=e.substring(7,9)):(s=e.substring(1,2),n=e.substring(2,3),i=e.substring(3,4),r=e.substring(4,5),s+=s,n+=n,i+=i,r+=r),{red:parseInt(s,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const dl={test:kc("#"),parse:x1,transform:Gs.transform},zr=e=>({test:s=>typeof s=="string"&&s.endsWith(e)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${e}`}),Ss=zr("deg"),es=zr("%"),Q=zr("px"),g1=zr("vh"),y1=zr("vw"),Yd={...es,parse:e=>es.parse(e)/100,transform:e=>es.transform(e*100)},zn={test:kc("hsl","hue"),parse:bf("hue","saturation","lightness"),transform:({hue:e,saturation:s,lightness:n,alpha:i=1})=>"hsla("+Math.round(e)+", "+es.transform(Ei(s))+", "+es.transform(Ei(n))+", "+Ei(Ji.transform(i))+")"},Pe={test:e=>Gs.test(e)||dl.test(e)||zn.test(e),parse:e=>Gs.test(e)?Gs.parse(e):zn.test(e)?zn.parse(e):dl.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Gs.transform(e):zn.transform(e),getAnimatableNone:e=>{const s=Pe.parse(e);return s.alpha=0,Pe.transform(s)}},j1=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function b1(e){return isNaN(e)&&typeof e=="string"&&(e.match(Nc)?.length||0)+(e.match(j1)?.length||0)>0}const wf="number",vf="color",w1="var",v1="var(",Jd="${}",N1=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Xi(e){const s=e.toString(),n=[],i={color:[],number:[],var:[]},r=[];let a=0;const l=s.replace(N1,c=>(Pe.test(c)?(i.color.push(a),r.push(vf),n.push(Pe.parse(c))):c.startsWith(v1)?(i.var.push(a),r.push(w1),n.push(c)):(i.number.push(a),r.push(wf),n.push(parseFloat(c))),++a,Jd)).split(Jd);return{values:n,split:l,indexes:i,types:r}}function Nf(e){return Xi(e).values}function kf(e){const{split:s,types:n}=Xi(e),i=s.length;return r=>{let a="";for(let o=0;o<i;o++)if(a+=s[o],r[o]!==void 0){const l=n[o];l===wf?a+=Ei(r[o]):l===vf?a+=Pe.transform(r[o]):a+=r[o]}return a}}const k1=e=>typeof e=="number"?0:Pe.test(e)?Pe.getAnimatableNone(e):e;function z1(e){const s=Nf(e);return kf(e)(s.map(k1))}const Rs={test:b1,parse:Nf,createTransformer:kf,getAnimatableNone:z1};function Co(e,s,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(s-e)*6*n:n<1/2?s:n<2/3?e+(s-e)*(2/3-n)*6:e}function S1({hue:e,saturation:s,lightness:n,alpha:i}){e/=360,s/=100,n/=100;let r=0,a=0,o=0;if(!s)r=a=o=n;else{const l=n<.5?n*(1+s):n+s-n*s,c=2*n-l;r=Co(c,l,e+1/3),a=Co(c,l,e),o=Co(c,l,e-1/3)}return{red:Math.round(r*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:i}}function pa(e,s){return n=>n>0?s:e}const ge=(e,s,n)=>e+(s-e)*n,To=(e,s,n)=>{const i=e*e,r=n*(s*s-i)+i;return r<0?0:Math.sqrt(r)},C1=[dl,Gs,zn],T1=e=>C1.find(s=>s.test(e));function Xd(e){const s=T1(e);if(!s)return!1;let n=s.parse(e);return s===zn&&(n=S1(n)),n}const eu=(e,s)=>{const n=Xd(e),i=Xd(s);if(!n||!i)return pa(e,s);const r={...n};return a=>(r.red=To(n.red,i.red,a),r.green=To(n.green,i.green,a),r.blue=To(n.blue,i.blue,a),r.alpha=ge(n.alpha,i.alpha,a),Gs.transform(r))},ul=new Set(["none","hidden"]);function A1(e,s){return ul.has(e)?n=>n<=0?e:s:n=>n>=1?s:e}function P1(e,s){return n=>ge(e,s,n)}function zc(e){return typeof e=="number"?P1:typeof e=="string"?vc(e)?pa:Pe.test(e)?eu:E1:Array.isArray(e)?zf:typeof e=="object"?Pe.test(e)?eu:D1:pa}function zf(e,s){const n=[...e],i=n.length,r=e.map((a,o)=>zc(a)(a,s[o]));return a=>{for(let o=0;o<i;o++)n[o]=r[o](a);return n}}function D1(e,s){const n={...e,...s},i={};for(const r in n)e[r]!==void 0&&s[r]!==void 0&&(i[r]=zc(e[r])(e[r],s[r]));return r=>{for(const a in i)n[a]=i[a](r);return n}}function _1(e,s){const n=[],i={color:0,var:0,number:0};for(let r=0;r<s.values.length;r++){const a=s.types[r],o=e.indexes[a][i[a]],l=e.values[o]??0;n[r]=l,i[a]++}return n}const E1=(e,s)=>{const n=Rs.createTransformer(s),i=Xi(e),r=Xi(s);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?ul.has(e)&&!r.values.length||ul.has(s)&&!i.values.length?A1(e,s):Nr(zf(_1(i,r),r.values),n):pa(e,s)};function Sf(e,s,n){return typeof e=="number"&&typeof s=="number"&&typeof n=="number"?ge(e,s,n):zc(e)(e,s)}const I1=e=>{const s=({timestamp:n})=>e(n);return{start:(n=!0)=>he.update(s,n),stop:()=>Os(s),now:()=>qe.isProcessing?qe.timestamp:ot.now()}},Cf=(e,s,n=10)=>{let i="";const r=Math.max(Math.round(s/n),2);for(let a=0;a<r;a++)i+=Math.round(e(a/(r-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},fa=2e4;function Sc(e){let s=0;const n=50;let i=e.next(s);for(;!i.done&&s<fa;)s+=n,i=e.next(s);return s>=fa?1/0:s}function M1(e,s=100,n){const i=n({...e,keyframes:[0,s]}),r=Math.min(Sc(i),fa);return{type:"keyframes",ease:a=>i.next(r*a).value/s,duration:Xt(r)}}const L1=5;function Tf(e,s,n){const i=Math.max(s-L1,0);return of(n-e(i),s-i)}const ve={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Ao=.001;function O1({duration:e=ve.duration,bounce:s=ve.bounce,velocity:n=ve.velocity,mass:i=ve.mass}){let r,a,o=1-s;o=gs(ve.minDamping,ve.maxDamping,o),e=gs(ve.minDuration,ve.maxDuration,Xt(e)),o<1?(r=d=>{const m=d*o,u=m*e,h=m-n,p=ml(d,o),x=Math.exp(-u);return Ao-h/p*x},a=d=>{const u=d*o*e,h=u*n+n,p=Math.pow(o,2)*Math.pow(d,2)*e,x=Math.exp(-u),f=ml(Math.pow(d,2),o);return(-r(d)+Ao>0?-1:1)*((h-p)*x)/f}):(r=d=>{const m=Math.exp(-d*e),u=(d-n)*e+1;return-Ao+m*u},a=d=>{const m=Math.exp(-d*e),u=(n-d)*(e*e);return m*u});const l=5/e,c=F1(r,a,l);if(e=Jt(e),isNaN(c))return{stiffness:ve.stiffness,damping:ve.damping,duration:e};{const d=Math.pow(c,2)*i;return{stiffness:d,damping:o*2*Math.sqrt(i*d),duration:e}}}const R1=12;function F1(e,s,n){let i=n;for(let r=1;r<R1;r++)i=i-e(i)/s(i);return i}function ml(e,s){return e*Math.sqrt(1-s*s)}const $1=["duration","bounce"],q1=["stiffness","damping","mass"];function tu(e,s){return s.some(n=>e[n]!==void 0)}function B1(e){let s={velocity:ve.velocity,stiffness:ve.stiffness,damping:ve.damping,mass:ve.mass,isResolvedFromDuration:!1,...e};if(!tu(e,q1)&&tu(e,$1))if(e.visualDuration){const n=e.visualDuration,i=2*Math.PI/(n*1.2),r=i*i,a=2*gs(.05,1,1-(e.bounce||0))*Math.sqrt(r);s={...s,mass:ve.mass,stiffness:r,damping:a}}else{const n=O1(e);s={...s,...n,mass:ve.mass},s.isResolvedFromDuration=!0}return s}function xa(e=ve.visualDuration,s=ve.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:s}:e;let{restSpeed:i,restDelta:r}=n;const a=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],l={done:!1,value:a},{stiffness:c,damping:d,mass:m,duration:u,velocity:h,isResolvedFromDuration:p}=B1({...n,velocity:-Xt(n.velocity||0)}),x=h||0,f=d/(2*Math.sqrt(c*m)),j=o-a,b=Xt(Math.sqrt(c/m)),y=Math.abs(j)<5;i||(i=y?ve.restSpeed.granular:ve.restSpeed.default),r||(r=y?ve.restDelta.granular:ve.restDelta.default);let w;if(f<1){const N=ml(b,f);w=S=>{const k=Math.exp(-f*b*S);return o-k*((x+f*b*j)/N*Math.sin(N*S)+j*Math.cos(N*S))}}else if(f===1)w=N=>o-Math.exp(-b*N)*(j+(x+b*j)*N);else{const N=b*Math.sqrt(f*f-1);w=S=>{const k=Math.exp(-f*b*S),C=Math.min(N*S,300);return o-k*((x+f*b*j)*Math.sinh(C)+N*j*Math.cosh(C))/N}}const z={calculatedDuration:p&&u||null,next:N=>{const S=w(N);if(p)l.done=N>=u;else{let k=N===0?x:0;f<1&&(k=N===0?Jt(x):Tf(w,N,S));const C=Math.abs(k)<=i,A=Math.abs(o-S)<=r;l.done=C&&A}return l.value=l.done?o:S,l},toString:()=>{const N=Math.min(Sc(z),fa),S=Cf(k=>z.next(N*k).value,N,30);return N+"ms "+S},toTransition:()=>{}};return z}xa.applyToOptions=e=>{const s=M1(e,100,xa);return e.ease=s.ease,e.duration=Jt(s.duration),e.type="keyframes",e};function hl({keyframes:e,velocity:s=0,power:n=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:a=500,modifyTarget:o,min:l,max:c,restDelta:d=.5,restSpeed:m}){const u=e[0],h={done:!1,value:u},p=C=>l!==void 0&&C<l||c!==void 0&&C>c,x=C=>l===void 0?c:c===void 0||Math.abs(l-C)<Math.abs(c-C)?l:c;let f=n*s;const j=u+f,b=o===void 0?j:o(j);b!==j&&(f=b-u);const y=C=>-f*Math.exp(-C/i),w=C=>b+y(C),z=C=>{const A=y(C),v=w(C);h.done=Math.abs(A)<=d,h.value=h.done?b:v};let N,S;const k=C=>{p(h.value)&&(N=C,S=xa({keyframes:[h.value,x(h.value)],velocity:Tf(w,C,h.value),damping:r,stiffness:a,restDelta:d,restSpeed:m}))};return k(0),{calculatedDuration:null,next:C=>{let A=!1;return!S&&N===void 0&&(A=!0,z(C),k(C)),N!==void 0&&C>=N?S.next(C-N):(!A&&z(C),h)}}}function V1(e,s,n){const i=[],r=n||ys.mix||Sf,a=e.length-1;for(let o=0;o<a;o++){let l=r(e[o],e[o+1]);if(s){const c=Array.isArray(s)?s[o]||Tt:s;l=Nr(c,l)}i.push(l)}return i}function U1(e,s,{clamp:n=!0,ease:i,mixer:r}={}){const a=e.length;if(xc(a===s.length),a===1)return()=>s[0];if(a===2&&s[0]===s[1])return()=>s[1];const o=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),s=[...s].reverse());const l=V1(s,i,r),c=l.length,d=m=>{if(o&&m<e[0])return s[0];let u=0;if(c>1)for(;u<e.length-2&&!(m<e[u+1]);u++);const h=Yi(e[u],e[u+1],m);return l[u](h)};return n?m=>d(gs(e[0],e[a-1],m)):d}function W1(e,s){const n=e[e.length-1];for(let i=1;i<=s;i++){const r=Yi(0,s,i);e.push(ge(n,1,r))}}function K1(e){const s=[0];return W1(s,e.length-1),s}function G1(e,s){return e.map(n=>n*s)}function H1(e,s){return e.map(()=>s||xf).splice(0,e.length-1)}function Ii({duration:e=300,keyframes:s,times:n,ease:i="easeInOut"}){const r=r1(i)?i.map(Zd):Zd(i),a={done:!1,value:s[0]},o=G1(n&&n.length===s.length?n:K1(s),e),l=U1(o,s,{ease:Array.isArray(r)?r:H1(s,r)});return{calculatedDuration:e,next:c=>(a.value=l(c),a.done=c>=e,a)}}const Q1=e=>e!==null;function Cc(e,{repeat:s,repeatType:n="loop"},i,r=1){const a=e.filter(Q1),l=r<0||s&&n!=="loop"&&s%2===1?0:a.length-1;return!l||i===void 0?a[l]:i}const Z1={decay:hl,inertia:hl,tween:Ii,keyframes:Ii,spring:xa};function Af(e){typeof e.type=="string"&&(e.type=Z1[e.type])}class Tc{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(s=>{this.resolve=s})}notifyFinished(){this.resolve()}then(s,n){return this.finished.then(s,n)}}const Y1=e=>e/100;class Ac extends Tc{constructor(s){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==ot.now()&&this.tick(ot.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=s,this.initAnimation(),this.play(),s.autoplay===!1&&this.pause()}initAnimation(){const{options:s}=this;Af(s);const{type:n=Ii,repeat:i=0,repeatDelay:r=0,repeatType:a,velocity:o=0}=s;let{keyframes:l}=s;const c=n||Ii;c!==Ii&&typeof l[0]!="number"&&(this.mixKeyframes=Nr(Y1,Sf(l[0],l[1])),l=[0,100]);const d=c({...s,keyframes:l});a==="mirror"&&(this.mirroredGenerator=c({...s,keyframes:[...l].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=Sc(d));const{calculatedDuration:m}=d;this.calculatedDuration=m,this.resolvedDuration=m+r,this.totalDuration=this.resolvedDuration*(i+1)-r,this.generator=d}updateTime(s){const n=Math.round(s-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(s,n=!1){const{generator:i,totalDuration:r,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return i.next(0);const{delay:d=0,keyframes:m,repeat:u,repeatType:h,repeatDelay:p,type:x,onUpdate:f,finalKeyframe:j}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-r/this.speed,this.startTime)),n?this.currentTime=s:this.updateTime(s);const b=this.currentTime-d*(this.playbackSpeed>=0?1:-1),y=this.playbackSpeed>=0?b<0:b>r;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let w=this.currentTime,z=i;if(u){const C=Math.min(this.currentTime,r)/l;let A=Math.floor(C),v=C%1;!v&&C>=1&&(v=1),v===1&&A--,A=Math.min(A,u+1),!!(A%2)&&(h==="reverse"?(v=1-v,p&&(v-=p/l)):h==="mirror"&&(z=o)),w=gs(0,1,v)*l}const N=y?{done:!1,value:m[0]}:z.next(w);a&&(N.value=a(N.value));let{done:S}=N;!y&&c!==null&&(S=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&S);return k&&x!==hl&&(N.value=Cc(m,this.options,j,this.speed)),f&&f(N.value),k&&this.finish(),N}then(s,n){return this.finished.then(s,n)}get duration(){return Xt(this.calculatedDuration)}get time(){return Xt(this.currentTime)}set time(s){s=Jt(s),this.currentTime=s,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(s){this.updateTime(ot.now());const n=this.playbackSpeed!==s;this.playbackSpeed=s,n&&(this.time=Xt(this.currentTime))}play(){if(this.isStopped)return;const{driver:s=I1,startTime:n}=this.options;this.driver||(this.driver=s(r=>this.tick(r))),this.options.onPlay?.();const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=n??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ot.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}attachTimeline(s){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),s.observe(this)}}function J1(e){for(let s=1;s<e.length;s++)e[s]??(e[s]=e[s-1])}const Hs=e=>e*180/Math.PI,pl=e=>{const s=Hs(Math.atan2(e[1],e[0]));return fl(s)},X1={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:pl,rotateZ:pl,skewX:e=>Hs(Math.atan(e[1])),skewY:e=>Hs(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},fl=e=>(e=e%360,e<0&&(e+=360),e),su=pl,nu=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),iu=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),eS={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:nu,scaleY:iu,scale:e=>(nu(e)+iu(e))/2,rotateX:e=>fl(Hs(Math.atan2(e[6],e[5]))),rotateY:e=>fl(Hs(Math.atan2(-e[2],e[0]))),rotateZ:su,rotate:su,skewX:e=>Hs(Math.atan(e[4])),skewY:e=>Hs(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function xl(e){return e.includes("scale")?1:0}function gl(e,s){if(!e||e==="none")return xl(s);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,r;if(n)i=eS,r=n;else{const l=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=X1,r=l}if(!r)return xl(s);const a=i[s],o=r[1].split(",").map(sS);return typeof a=="function"?a(o):o[a]}const tS=(e,s)=>{const{transform:n="none"}=getComputedStyle(e);return gl(n,s)};function sS(e){return parseFloat(e.trim())}const oi=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],li=new Set(oi),ru=e=>e===ai||e===Q,nS=new Set(["x","y","z"]),iS=oi.filter(e=>!nS.has(e));function rS(e){const s=[];return iS.forEach(n=>{const i=e.getValue(n);i!==void 0&&(s.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),s}const sn={width:({x:e},{paddingLeft:s="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(s)-parseFloat(n),height:({y:e},{paddingTop:s="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(s)-parseFloat(n),top:(e,{top:s})=>parseFloat(s),left:(e,{left:s})=>parseFloat(s),bottom:({y:e},{top:s})=>parseFloat(s)+(e.max-e.min),right:({x:e},{left:s})=>parseFloat(s)+(e.max-e.min),x:(e,{transform:s})=>gl(s,"x"),y:(e,{transform:s})=>gl(s,"y")};sn.translateX=sn.x;sn.translateY=sn.y;const nn=new Set;let yl=!1,jl=!1,bl=!1;function Pf(){if(jl){const e=Array.from(nn).filter(i=>i.needsMeasurement),s=new Set(e.map(i=>i.element)),n=new Map;s.forEach(i=>{const r=rS(i);r.length&&(n.set(i,r),i.render())}),e.forEach(i=>i.measureInitialState()),s.forEach(i=>{i.render();const r=n.get(i);r&&r.forEach(([a,o])=>{i.getValue(a)?.set(o)})}),e.forEach(i=>i.measureEndState()),e.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}jl=!1,yl=!1,nn.forEach(e=>e.complete(bl)),nn.clear()}function Df(){nn.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(jl=!0)})}function aS(){bl=!0,Df(),Pf(),bl=!1}class Pc{constructor(s,n,i,r,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...s],this.onComplete=n,this.name=i,this.motionValue=r,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(nn.add(this),yl||(yl=!0,he.read(Df),he.resolveKeyframes(Pf))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:n,element:i,motionValue:r}=this;if(s[0]===null){const a=r?.get(),o=s[s.length-1];if(a!==void 0)s[0]=a;else if(i&&n){const l=i.readValue(n,o);l!=null&&(s[0]=l)}s[0]===void 0&&(s[0]=o),r&&a===void 0&&r.set(s[0])}J1(s)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(s=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,s),nn.delete(this)}cancel(){this.state==="scheduled"&&(nn.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const oS=e=>e.startsWith("--");function lS(e,s,n){oS(s)?e.style.setProperty(s,n):e.style[s]=n}const cS=gc(()=>window.ScrollTimeline!==void 0),dS={};function uS(e,s){const n=gc(e);return()=>dS[s]??n()}const _f=uS(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Ti=([e,s,n,i])=>`cubic-bezier(${e}, ${s}, ${n}, ${i})`,au={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ti([0,.65,.55,1]),circOut:Ti([.55,0,1,.45]),backIn:Ti([.31,.01,.66,-.59]),backOut:Ti([.33,1.53,.69,.99])};function Ef(e,s){if(e)return typeof e=="function"?_f()?Cf(e,s):"ease-out":gf(e)?Ti(e):Array.isArray(e)?e.map(n=>Ef(n,s)||au.easeOut):au[e]}function mS(e,s,n,{delay:i=0,duration:r=300,repeat:a=0,repeatType:o="loop",ease:l="easeOut",times:c}={},d=void 0){const m={[s]:n};c&&(m.offset=c);const u=Ef(l,r);Array.isArray(u)&&(m.easing=u);const h={delay:i,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(h.pseudoElement=d),e.animate(m,h)}function If(e){return typeof e=="function"&&"applyToOptions"in e}function hS({type:e,...s}){return If(e)&&_f()?e.applyToOptions(s):(s.duration??(s.duration=300),s.ease??(s.ease="easeOut"),s)}class pS extends Tc{constructor(s){if(super(),this.finishedTime=null,this.isStopped=!1,!s)return;const{element:n,name:i,keyframes:r,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:l,onComplete:c}=s;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=s,xc(typeof s.type!="string");const d=hS(s);this.animation=mS(n,i,r,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const m=Cc(r,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(m):lS(n,i,m),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:s}=this;s==="idle"||s==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const s=this.animation.effect?.getComputedTiming?.().duration||0;return Xt(Number(s))}get time(){return Xt(Number(this.animation.currentTime)||0)}set time(s){this.finishedTime=null,this.animation.currentTime=Jt(s)}get speed(){return this.animation.playbackRate}set speed(s){s<0&&(this.finishedTime=null),this.animation.playbackRate=s}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(s){this.animation.startTime=s}attachTimeline({timeline:s,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,s&&cS()?(this.animation.timeline=s,Tt):n(this)}}const Mf={anticipate:hf,backInOut:mf,circInOut:ff};function fS(e){return e in Mf}function xS(e){typeof e.ease=="string"&&fS(e.ease)&&(e.ease=Mf[e.ease])}const ou=10;class gS extends pS{constructor(s){xS(s),Af(s),super(s),s.startTime&&(this.startTime=s.startTime),this.options=s}updateMotionValue(s){const{motionValue:n,onUpdate:i,onComplete:r,element:a,...o}=this.options;if(!n)return;if(s!==void 0){n.set(s);return}const l=new Ac({...o,autoplay:!1}),c=Jt(this.finishedTime??this.time);n.setWithVelocity(l.sample(c-ou).value,l.sample(c).value,ou),l.stop()}}const lu=(e,s)=>s==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Rs.test(e)||e==="0")&&!e.startsWith("url("));function yS(e){const s=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==s)return!0}function jS(e,s,n,i){const r=e[0];if(r===null)return!1;if(s==="display"||s==="visibility")return!0;const a=e[e.length-1],o=lu(r,s),l=lu(a,s);return!o||!l?!1:yS(e)||(n==="spring"||If(n))&&i}function wl(e){e.duration=0,e.type}const bS=new Set(["opacity","clipPath","filter","transform"]),wS=gc(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function vS(e){const{motionValue:s,name:n,repeatDelay:i,repeatType:r,damping:a,type:o}=e;if(!(s?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=s.owner.getProps();return wS()&&n&&bS.has(n)&&(n!=="transform"||!d)&&!c&&!i&&r!=="mirror"&&a!==0&&o!=="inertia"}const NS=40;class kS extends Tc{constructor({autoplay:s=!0,delay:n=0,type:i="keyframes",repeat:r=0,repeatDelay:a=0,repeatType:o="loop",keyframes:l,name:c,motionValue:d,element:m,...u}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=ot.now();const h={autoplay:s,delay:n,type:i,repeat:r,repeatDelay:a,repeatType:o,name:c,motionValue:d,element:m,...u},p=m?.KeyframeResolver||Pc;this.keyframeResolver=new p(l,(x,f,j)=>this.onKeyframesResolved(x,f,h,!j),c,d,m),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(s,n,i,r){this.keyframeResolver=void 0;const{name:a,type:o,velocity:l,delay:c,isHandoff:d,onUpdate:m}=i;this.resolvedAt=ot.now(),jS(s,a,o,l)||((ys.instantAnimations||!c)&&m?.(Cc(s,i,n)),s[0]=s[s.length-1],wl(i),i.repeat=0);const h={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>NS?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...i,keyframes:s},p=!d&&vS(h)?new gS({...h,element:h.motionValue.owner.current}):new Ac(h);p.finished.then(()=>this.notifyFinished()).catch(Tt),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(s,n){return this.finished.finally(s).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),aS()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(s){this.animation.time=s}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(s){this.animation.speed=s}get startTime(){return this.animation.startTime}attachTimeline(s){return this._animation?this.stopTimeline=this.animation.attachTimeline(s):this.pendingTimeline=s,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const zS=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function SS(e){const s=zS.exec(e);if(!s)return[,];const[,n,i,r]=s;return[`--${n??i}`,r]}function Lf(e,s,n=1){const[i,r]=SS(e);if(!i)return;const a=window.getComputedStyle(s).getPropertyValue(i);if(a){const o=a.trim();return nf(o)?parseFloat(o):o}return vc(r)?Lf(r,s,n+1):r}function Dc(e,s){return e?.[s]??e?.default??e}const Of=new Set(["width","height","top","left","right","bottom",...oi]),CS={test:e=>e==="auto",parse:e=>e},Rf=e=>s=>s.test(e),Ff=[ai,Q,es,Ss,y1,g1,CS],cu=e=>Ff.find(Rf(e));function TS(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||af(e):!0}const AS=new Set(["brightness","contrast","saturate","opacity"]);function PS(e){const[s,n]=e.slice(0,-1).split("(");if(s==="drop-shadow")return e;const[i]=n.match(Nc)||[];if(!i)return e;const r=n.replace(i,"");let a=AS.has(s)?1:0;return i!==n&&(a*=100),s+"("+a+r+")"}const DS=/\b([a-z-]*)\(.*?\)/gu,vl={...Rs,getAnimatableNone:e=>{const s=e.match(DS);return s?s.map(PS).join(" "):e}},du={...ai,transform:Math.round},_S={rotate:Ss,rotateX:Ss,rotateY:Ss,rotateZ:Ss,scale:qr,scaleX:qr,scaleY:qr,scaleZ:qr,skew:Ss,skewX:Ss,skewY:Ss,distance:Q,translateX:Q,translateY:Q,translateZ:Q,x:Q,y:Q,z:Q,perspective:Q,transformPerspective:Q,opacity:Ji,originX:Yd,originY:Yd,originZ:Q},_c={borderWidth:Q,borderTopWidth:Q,borderRightWidth:Q,borderBottomWidth:Q,borderLeftWidth:Q,borderRadius:Q,radius:Q,borderTopLeftRadius:Q,borderTopRightRadius:Q,borderBottomRightRadius:Q,borderBottomLeftRadius:Q,width:Q,maxWidth:Q,height:Q,maxHeight:Q,top:Q,right:Q,bottom:Q,left:Q,padding:Q,paddingTop:Q,paddingRight:Q,paddingBottom:Q,paddingLeft:Q,margin:Q,marginTop:Q,marginRight:Q,marginBottom:Q,marginLeft:Q,backgroundPositionX:Q,backgroundPositionY:Q,..._S,zIndex:du,fillOpacity:Ji,strokeOpacity:Ji,numOctaves:du},ES={..._c,color:Pe,backgroundColor:Pe,outlineColor:Pe,fill:Pe,stroke:Pe,borderColor:Pe,borderTopColor:Pe,borderRightColor:Pe,borderBottomColor:Pe,borderLeftColor:Pe,filter:vl,WebkitFilter:vl},$f=e=>ES[e];function qf(e,s){let n=$f(e);return n!==vl&&(n=Rs),n.getAnimatableNone?n.getAnimatableNone(s):void 0}const IS=new Set(["auto","none","0"]);function MS(e,s,n){let i=0,r;for(;i<e.length&&!r;){const a=e[i];typeof a=="string"&&!IS.has(a)&&Xi(a).values.length&&(r=e[i]),i++}if(r&&n)for(const a of s)e[a]=qf(n,r)}class LS extends Pc{constructor(s,n,i,r,a){super(s,n,i,r,a,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:n,name:i}=this;if(!n||!n.current)return;super.readKeyframes();for(let c=0;c<s.length;c++){let d=s[c];if(typeof d=="string"&&(d=d.trim(),vc(d))){const m=Lf(d,n.current);m!==void 0&&(s[c]=m),c===s.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!Of.has(i)||s.length!==2)return;const[r,a]=s,o=cu(r),l=cu(a);if(o!==l)if(ru(o)&&ru(l))for(let c=0;c<s.length;c++){const d=s[c];typeof d=="string"&&(s[c]=parseFloat(d))}else sn[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:n}=this,i=[];for(let r=0;r<s.length;r++)(s[r]===null||TS(s[r]))&&i.push(r);i.length&&MS(s,i,n)}measureInitialState(){const{element:s,unresolvedKeyframes:n,name:i}=this;if(!s||!s.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=sn[i](s.measureViewportBox(),window.getComputedStyle(s.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&s.getValue(i,r).jump(r,!1)}measureEndState(){const{element:s,name:n,unresolvedKeyframes:i}=this;if(!s||!s.current)return;const r=s.getValue(n);r&&r.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=sn[n](s.measureViewportBox(),window.getComputedStyle(s.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,c])=>{s.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function OS(e,s,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let i=document;const r=n?.[e]??i.querySelectorAll(e);return r?Array.from(r):[]}return Array.from(e)}const Bf=(e,s)=>s&&typeof e=="number"?s.transform(e):e;function Vf(e){return rf(e)&&"offsetHeight"in e}const uu=30,RS=e=>!isNaN(parseFloat(e));class FS{constructor(s,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{const r=ot.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(s),this.owner=n.owner}setCurrent(s){this.current=s,this.updatedAt=ot.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=RS(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,n){this.events[s]||(this.events[s]=new yc);const i=this.events[s].add(n);return s==="change"?()=>{i(),he.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,n){this.passiveEffect=s,this.stopPassiveEffect=n}set(s){this.passiveEffect?this.passiveEffect(s,this.updateAndNotify):this.updateAndNotify(s)}setWithVelocity(s,n,i){this.set(n),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-i}jump(s,n=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(s){this.dependents||(this.dependents=new Set),this.dependents.add(s)}removeDependent(s){this.dependents&&this.dependents.delete(s)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const s=ot.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>uu)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,uu);return of(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(s){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=s(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Kn(e,s){return new FS(e,s)}const{schedule:Ec}=yf(queueMicrotask,!1),Rt={x:!1,y:!1};function Uf(){return Rt.x||Rt.y}function $S(e){return e==="x"||e==="y"?Rt[e]?null:(Rt[e]=!0,()=>{Rt[e]=!1}):Rt.x||Rt.y?null:(Rt.x=Rt.y=!0,()=>{Rt.x=Rt.y=!1})}function Wf(e,s){const n=OS(e),i=new AbortController,r={passive:!0,...s,signal:i.signal};return[n,r,()=>i.abort()]}function mu(e){return!(e.pointerType==="touch"||Uf())}function qS(e,s,n={}){const[i,r,a]=Wf(e,n),o=l=>{if(!mu(l))return;const{target:c}=l,d=s(c,l);if(typeof d!="function"||!c)return;const m=u=>{mu(u)&&(d(u),c.removeEventListener("pointerleave",m))};c.addEventListener("pointerleave",m,r)};return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),a}const Kf=(e,s)=>s?e===s?!0:Kf(e,s.parentElement):!1,Ic=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,BS=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function VS(e){return BS.has(e.tagName)||e.tabIndex!==-1}const Jr=new WeakSet;function hu(e){return s=>{s.key==="Enter"&&e(s)}}function Po(e,s){e.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const US=(e,s)=>{const n=e.currentTarget;if(!n)return;const i=hu(()=>{if(Jr.has(n))return;Po(n,"down");const r=hu(()=>{Po(n,"up")}),a=()=>Po(n,"cancel");n.addEventListener("keyup",r,s),n.addEventListener("blur",a,s)});n.addEventListener("keydown",i,s),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),s)};function pu(e){return Ic(e)&&!Uf()}function WS(e,s,n={}){const[i,r,a]=Wf(e,n),o=l=>{const c=l.currentTarget;if(!pu(l))return;Jr.add(c);const d=s(c,l),m=(p,x)=>{window.removeEventListener("pointerup",u),window.removeEventListener("pointercancel",h),Jr.has(c)&&Jr.delete(c),pu(p)&&typeof d=="function"&&d(p,{success:x})},u=p=>{m(p,c===window||c===document||n.useGlobalTarget||Kf(c,p.target))},h=p=>{m(p,!1)};window.addEventListener("pointerup",u,r),window.addEventListener("pointercancel",h,r)};return i.forEach(l=>{(n.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),Vf(l)&&(l.addEventListener("focus",d=>US(d,r)),!VS(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),a}function Gf(e){return rf(e)&&"ownerSVGElement"in e}function KS(e){return Gf(e)&&e.tagName==="svg"}const Ge=e=>!!(e&&e.getVelocity),GS=[...Ff,Pe,Rs],HS=e=>GS.find(Rf(e)),Mc=g.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class QS extends g.Component{getSnapshotBeforeUpdate(s){const n=this.props.childRef.current;if(n&&s.isPresent&&!this.props.isPresent){const i=n.offsetParent,r=Vf(i)&&i.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=r-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function ZS({children:e,isPresent:s,anchorX:n,root:i}){const r=g.useId(),a=g.useRef(null),o=g.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=g.useContext(Mc);return g.useInsertionEffect(()=>{const{width:c,height:d,top:m,left:u,right:h}=o.current;if(s||!a.current||!c||!d)return;const p=n==="left"?`left: ${u}`:`right: ${h}`;a.current.dataset.motionPopId=r;const x=document.createElement("style");l&&(x.nonce=l);const f=i??document.head;return f.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${d}px !important;
            ${p}px !important;
            top: ${m}px !important;
          }
        `),()=>{f.contains(x)&&f.removeChild(x)}},[s]),t.jsx(QS,{isPresent:s,childRef:a,sizeRef:o,children:g.cloneElement(e,{ref:a})})}const YS=({children:e,initial:s,isPresent:n,onExitComplete:i,custom:r,presenceAffectsLayout:a,mode:o,anchorX:l,root:c})=>{const d=mc(JS),m=g.useId();let u=!0,h=g.useMemo(()=>(u=!1,{id:m,initial:s,isPresent:n,custom:r,onExitComplete:p=>{d.set(p,!0);for(const x of d.values())if(!x)return;i&&i()},register:p=>(d.set(p,!1),()=>d.delete(p))}),[n,d,i]);return a&&u&&(h={...h}),g.useMemo(()=>{d.forEach((p,x)=>d.set(x,!1))},[n]),g.useEffect(()=>{!n&&!d.size&&i&&i()},[n]),o==="popLayout"&&(e=t.jsx(ZS,{isPresent:n,anchorX:l,root:c,children:e})),t.jsx(Wa.Provider,{value:h,children:e})};function JS(){return new Map}function Hf(e=!0){const s=g.useContext(Wa);if(s===null)return[!0,null];const{isPresent:n,onExitComplete:i,register:r}=s,a=g.useId();g.useEffect(()=>{if(e)return r(a)},[e]);const o=g.useCallback(()=>e&&i&&i(a),[a,i,e]);return!n&&i?[!1,o]:[!0]}const Br=e=>e.key||"";function fu(e){const s=[];return g.Children.forEach(e,n=>{g.isValidElement(n)&&s.push(n)}),s}const XS=({children:e,custom:s,initial:n=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:a="sync",propagate:o=!1,anchorX:l="left",root:c})=>{const[d,m]=Hf(o),u=g.useMemo(()=>fu(e),[e]),h=o&&!d?[]:u.map(Br),p=g.useRef(!0),x=g.useRef(u),f=mc(()=>new Map),[j,b]=g.useState(u),[y,w]=g.useState(u);sf(()=>{p.current=!1,x.current=u;for(let S=0;S<y.length;S++){const k=Br(y[S]);h.includes(k)?f.delete(k):f.get(k)!==!0&&f.set(k,!1)}},[y,h.length,h.join("-")]);const z=[];if(u!==j){let S=[...u];for(let k=0;k<y.length;k++){const C=y[k],A=Br(C);h.includes(A)||(S.splice(k,0,C),z.push(C))}return a==="wait"&&z.length&&(S=z),w(fu(S)),b(u),null}const{forceRender:N}=g.useContext(uc);return t.jsx(t.Fragment,{children:y.map(S=>{const k=Br(S),C=o&&!d?!1:u===y||h.includes(k),A=()=>{if(f.has(k))f.set(k,!0);else return;let v=!0;f.forEach(P=>{P||(v=!1)}),v&&(N?.(),w(x.current),o&&m?.(),i&&i())};return t.jsx(YS,{isPresent:C,initial:!p.current||n?void 0:!1,custom:s,presenceAffectsLayout:r,mode:a,root:c,onExitComplete:C?void 0:A,anchorX:l,children:S},k)})})},Qf=g.createContext({strict:!1}),xu={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Gn={};for(const e in xu)Gn[e]={isEnabled:s=>xu[e].some(n=>!!s[n])};function eC(e){for(const s in e)Gn[s]={...Gn[s],...e[s]}}const tC=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function ga(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||tC.has(e)}let Zf=e=>!ga(e);function sC(e){typeof e=="function"&&(Zf=s=>s.startsWith("on")?!ga(s):e(s))}try{sC(require("@emotion/is-prop-valid").default)}catch{}function nC(e,s,n){const i={};for(const r in e)r==="values"&&typeof e.values=="object"||(Zf(r)||n===!0&&ga(r)||!s&&!ga(r)||e.draggable&&r.startsWith("onDrag"))&&(i[r]=e[r]);return i}const Ka=g.createContext({});function Ga(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function er(e){return typeof e=="string"||Array.isArray(e)}const Lc=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Oc=["initial",...Lc];function Ha(e){return Ga(e.animate)||Oc.some(s=>er(e[s]))}function Yf(e){return!!(Ha(e)||e.variants)}function iC(e,s){if(Ha(e)){const{initial:n,animate:i}=e;return{initial:n===!1||er(n)?n:void 0,animate:er(i)?i:void 0}}return e.inherit!==!1?s:{}}function rC(e){const{initial:s,animate:n}=iC(e,g.useContext(Ka));return g.useMemo(()=>({initial:s,animate:n}),[gu(s),gu(n)])}function gu(e){return Array.isArray(e)?e.join(" "):e}const tr={};function aC(e){for(const s in e)tr[s]=e[s],wc(s)&&(tr[s].isCSSVariable=!0)}function Jf(e,{layout:s,layoutId:n}){return li.has(e)||e.startsWith("origin")||(s||n!==void 0)&&(!!tr[e]||e==="opacity")}const oC={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},lC=oi.length;function cC(e,s,n){let i="",r=!0;for(let a=0;a<lC;a++){const o=oi[a],l=e[o];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(o.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||n){const d=Bf(l,_c[o]);if(!c){r=!1;const m=oC[o]||o;i+=`${m}(${d}) `}n&&(s[o]=d)}}return i=i.trim(),n?i=n(s,r?"":i):r&&(i="none"),i}function Rc(e,s,n){const{style:i,vars:r,transformOrigin:a}=e;let o=!1,l=!1;for(const c in s){const d=s[c];if(li.has(c)){o=!0;continue}else if(wc(c)){r[c]=d;continue}else{const m=Bf(d,_c[c]);c.startsWith("origin")?(l=!0,a[c]=m):i[c]=m}}if(s.transform||(o||n?i.transform=cC(s,e.transform,n):i.transform&&(i.transform="none")),l){const{originX:c="50%",originY:d="50%",originZ:m=0}=a;i.transformOrigin=`${c} ${d} ${m}`}}const Fc=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Xf(e,s,n){for(const i in s)!Ge(s[i])&&!Jf(i,n)&&(e[i]=s[i])}function dC({transformTemplate:e},s){return g.useMemo(()=>{const n=Fc();return Rc(n,s,e),Object.assign({},n.vars,n.style)},[s])}function uC(e,s){const n=e.style||{},i={};return Xf(i,n,e),Object.assign(i,dC(e,s)),i}function mC(e,s){const n={},i=uC(e,s);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n}const hC={offset:"stroke-dashoffset",array:"stroke-dasharray"},pC={offset:"strokeDashoffset",array:"strokeDasharray"};function fC(e,s,n=1,i=0,r=!0){e.pathLength=1;const a=r?hC:pC;e[a.offset]=Q.transform(-i);const o=Q.transform(s),l=Q.transform(n);e[a.array]=`${o} ${l}`}function ex(e,{attrX:s,attrY:n,attrScale:i,pathLength:r,pathSpacing:a=1,pathOffset:o=0,...l},c,d,m){if(Rc(e,l,d),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:u,style:h}=e;u.transform&&(h.transform=u.transform,delete u.transform),(h.transform||u.transformOrigin)&&(h.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),h.transform&&(h.transformBox=m?.transformBox??"fill-box",delete u.transformBox),s!==void 0&&(u.x=s),n!==void 0&&(u.y=n),i!==void 0&&(u.scale=i),r!==void 0&&fC(u,r,a,o,!1)}const tx=()=>({...Fc(),attrs:{}}),sx=e=>typeof e=="string"&&e.toLowerCase()==="svg";function xC(e,s,n,i){const r=g.useMemo(()=>{const a=tx();return ex(a,s,sx(i),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[s]);if(e.style){const a={};Xf(a,e.style,e),r.style={...a,...r.style}}return r}const gC=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function $c(e){return typeof e!="string"||e.includes("-")?!1:!!(gC.indexOf(e)>-1||/[A-Z]/u.test(e))}function yC(e,s,n,{latestValues:i},r,a=!1){const l=($c(e)?xC:mC)(s,i,r,e),c=nC(s,typeof e=="string",a),d=e!==g.Fragment?{...c,...l,ref:n}:{},{children:m}=s,u=g.useMemo(()=>Ge(m)?m.get():m,[m]);return g.createElement(e,{...d,children:u})}function yu(e){const s=[{},{}];return e?.values.forEach((n,i)=>{s[0][i]=n.get(),s[1][i]=n.getVelocity()}),s}function qc(e,s,n,i){if(typeof s=="function"){const[r,a]=yu(i);s=s(n!==void 0?n:e.custom,r,a)}if(typeof s=="string"&&(s=e.variants&&e.variants[s]),typeof s=="function"){const[r,a]=yu(i);s=s(n!==void 0?n:e.custom,r,a)}return s}function Xr(e){return Ge(e)?e.get():e}function jC({scrapeMotionValuesFromProps:e,createRenderState:s},n,i,r){return{latestValues:bC(n,i,r,e),renderState:s()}}function bC(e,s,n,i){const r={},a=i(e,{});for(const h in a)r[h]=Xr(a[h]);let{initial:o,animate:l}=e;const c=Ha(e),d=Yf(e);s&&d&&!c&&e.inherit!==!1&&(o===void 0&&(o=s.initial),l===void 0&&(l=s.animate));let m=n?n.initial===!1:!1;m=m||o===!1;const u=m?l:o;if(u&&typeof u!="boolean"&&!Ga(u)){const h=Array.isArray(u)?u:[u];for(let p=0;p<h.length;p++){const x=qc(e,h[p]);if(x){const{transitionEnd:f,transition:j,...b}=x;for(const y in b){let w=b[y];if(Array.isArray(w)){const z=m?w.length-1:0;w=w[z]}w!==null&&(r[y]=w)}for(const y in f)r[y]=f[y]}}}return r}const nx=e=>(s,n)=>{const i=g.useContext(Ka),r=g.useContext(Wa),a=()=>jC(e,s,i,r);return n?a():mc(a)};function Bc(e,s,n){const{style:i}=e,r={};for(const a in i)(Ge(i[a])||s.style&&Ge(s.style[a])||Jf(a,e)||n?.getValue(a)?.liveStyle!==void 0)&&(r[a]=i[a]);return r}const wC=nx({scrapeMotionValuesFromProps:Bc,createRenderState:Fc});function ix(e,s,n){const i=Bc(e,s,n);for(const r in e)if(Ge(e[r])||Ge(s[r])){const a=oi.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[a]=e[r]}return i}const vC=nx({scrapeMotionValuesFromProps:ix,createRenderState:tx}),NC=Symbol.for("motionComponentSymbol");function Sn(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function kC(e,s,n){return g.useCallback(i=>{i&&e.onMount&&e.onMount(i),s&&(i?s.mount(i):s.unmount()),n&&(typeof n=="function"?n(i):Sn(n)&&(n.current=i))},[s])}const Vc=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),zC="framerAppearId",rx="data-"+Vc(zC),ax=g.createContext({});function SC(e,s,n,i,r){const{visualElement:a}=g.useContext(Ka),o=g.useContext(Qf),l=g.useContext(Wa),c=g.useContext(Mc).reducedMotion,d=g.useRef(null);i=i||o.renderer,!d.current&&i&&(d.current=i(e,{visualState:s,parent:a,props:n,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:c}));const m=d.current,u=g.useContext(ax);m&&!m.projection&&r&&(m.type==="html"||m.type==="svg")&&CC(d.current,n,r,u);const h=g.useRef(!1);g.useInsertionEffect(()=>{m&&h.current&&m.update(n,l)});const p=n[rx],x=g.useRef(!!p&&!window.MotionHandoffIsComplete?.(p)&&window.MotionHasOptimisedAnimation?.(p));return sf(()=>{m&&(h.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),x.current&&m.animationState&&m.animationState.animateChanges())}),g.useEffect(()=>{m&&(!x.current&&m.animationState&&m.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(p)}),x.current=!1),m.enteringChildren=void 0)}),m}function CC(e,s,n,i){const{layoutId:r,layout:a,drag:o,dragConstraints:l,layoutScroll:c,layoutRoot:d,layoutCrossfade:m}=s;e.projection=new n(e.latestValues,s["data-framer-portal-id"]?void 0:ox(e.parent)),e.projection.setOptions({layoutId:r,layout:a,alwaysMeasureLayout:!!o||l&&Sn(l),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:i,crossfade:m,layoutScroll:c,layoutRoot:d})}function ox(e){if(e)return e.options.allowProjection!==!1?e.projection:ox(e.parent)}function Do(e,{forwardMotionProps:s=!1}={},n,i){n&&eC(n);const r=$c(e)?vC:wC;function a(l,c){let d;const m={...g.useContext(Mc),...l,layoutId:TC(l)},{isStatic:u}=m,h=rC(l),p=r(l,u);if(!u&&hc){AC();const x=PC(m);d=x.MeasureLayout,h.visualElement=SC(e,p,m,i,x.ProjectionNode)}return t.jsxs(Ka.Provider,{value:h,children:[d&&h.visualElement?t.jsx(d,{visualElement:h.visualElement,...m}):null,yC(e,l,kC(p,h.visualElement,c),p,u,s)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const o=g.forwardRef(a);return o[NC]=e,o}function TC({layoutId:e}){const s=g.useContext(uc).id;return s&&e!==void 0?s+"-"+e:e}function AC(e,s){g.useContext(Qf).strict}function PC(e){const{drag:s,layout:n}=Gn;if(!s&&!n)return{};const i={...s,...n};return{MeasureLayout:s?.isEnabled(e)||n?.isEnabled(e)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}function DC(e,s){if(typeof Proxy>"u")return Do;const n=new Map,i=(a,o)=>Do(a,o,e,s),r=(a,o)=>i(a,o);return new Proxy(r,{get:(a,o)=>o==="create"?i:(n.has(o)||n.set(o,Do(o,void 0,e,s)),n.get(o))})}function lx({top:e,left:s,right:n,bottom:i}){return{x:{min:s,max:n},y:{min:e,max:i}}}function _C({x:e,y:s}){return{top:s.min,right:e.max,bottom:s.max,left:e.min}}function EC(e,s){if(!s)return e;const n=s({x:e.left,y:e.top}),i=s({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function _o(e){return e===void 0||e===1}function Nl({scale:e,scaleX:s,scaleY:n}){return!_o(e)||!_o(s)||!_o(n)}function Ks(e){return Nl(e)||cx(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function cx(e){return ju(e.x)||ju(e.y)}function ju(e){return e&&e!=="0%"}function ya(e,s,n){const i=e-n,r=s*i;return n+r}function bu(e,s,n,i,r){return r!==void 0&&(e=ya(e,r,i)),ya(e,n,i)+s}function kl(e,s=0,n=1,i,r){e.min=bu(e.min,s,n,i,r),e.max=bu(e.max,s,n,i,r)}function dx(e,{x:s,y:n}){kl(e.x,s.translate,s.scale,s.originPoint),kl(e.y,n.translate,n.scale,n.originPoint)}const wu=.999999999999,vu=1.0000000000001;function IC(e,s,n,i=!1){const r=n.length;if(!r)return;s.x=s.y=1;let a,o;for(let l=0;l<r;l++){a=n[l],o=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Tn(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(s.x*=o.x.scale,s.y*=o.y.scale,dx(e,o)),i&&Ks(a.latestValues)&&Tn(e,a.latestValues))}s.x<vu&&s.x>wu&&(s.x=1),s.y<vu&&s.y>wu&&(s.y=1)}function Cn(e,s){e.min=e.min+s,e.max=e.max+s}function Nu(e,s,n,i,r=.5){const a=ge(e.min,e.max,r);kl(e,s,n,a,i)}function Tn(e,s){Nu(e.x,s.x,s.scaleX,s.scale,s.originX),Nu(e.y,s.y,s.scaleY,s.scale,s.originY)}function ux(e,s){return lx(EC(e.getBoundingClientRect(),s))}function MC(e,s,n){const i=ux(e,n),{scroll:r}=s;return r&&(Cn(i.x,r.offset.x),Cn(i.y,r.offset.y)),i}const ku=()=>({translate:0,scale:1,origin:0,originPoint:0}),An=()=>({x:ku(),y:ku()}),zu=()=>({min:0,max:0}),Se=()=>({x:zu(),y:zu()}),zl={current:null},mx={current:!1};function LC(){if(mx.current=!0,!!hc)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),s=()=>zl.current=e.matches;e.addEventListener("change",s),s()}else zl.current=!1}const OC=new WeakMap;function RC(e,s,n){for(const i in s){const r=s[i],a=n[i];if(Ge(r))e.addValue(i,r);else if(Ge(a))e.addValue(i,Kn(r,{owner:e}));else if(a!==r)if(e.hasValue(i)){const o=e.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=e.getStaticValue(i);e.addValue(i,Kn(o!==void 0?o:r,{owner:e}))}}for(const i in n)s[i]===void 0&&e.removeValue(i);return s}const Su=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class FC{scrapeMotionValuesFromProps(s,n,i){return{}}constructor({parent:s,props:n,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:a,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Pc,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=ot.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,he.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=o;this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=d,this.parent=s,this.props=n,this.presenceContext=i,this.depth=s?s.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!a,this.isControllingVariants=Ha(n),this.isVariantNode=Yf(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:m,...u}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in u){const p=u[h];c[h]!==void 0&&Ge(p)&&p.set(c[h])}}mount(s){this.current=s,OC.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),mx.current||LC(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:zl.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Os(this.notifyUpdate),Os(this.render),this.valueSubscriptions.forEach(s=>s()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const s in this.events)this.events[s].clear();for(const s in this.features){const n=this.features[s];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(s){this.children.add(s),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(s)}removeChild(s){this.children.delete(s),this.enteringChildren&&this.enteringChildren.delete(s)}bindToMotionValue(s,n){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const i=li.has(s);i&&this.onBindTransform&&this.onBindTransform();const r=n.on("change",o=>{this.latestValues[s]=o,this.props.onUpdate&&he.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,s,n)),this.valueSubscriptions.set(s,()=>{r(),a&&a(),n.owner&&n.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in Gn){const n=Gn[s];if(!n)continue;const{isEnabled:i,Feature:r}=n;if(!this.features[s]&&r&&i(this.props)&&(this.features[s]=new r(this)),this.features[s]){const a=this.features[s];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Se()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,n){this.latestValues[s]=n}update(s,n){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<Su.length;i++){const r=Su[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const a="on"+r,o=s[a];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=RC(this,this.scrapeMotionValuesFromProps(s,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(s),()=>n.variantChildren.delete(s)}addValue(s,n){const i=this.values.get(s);n!==i&&(i&&this.removeValue(s),this.bindToMotionValue(s,n),this.values.set(s,n),this.latestValues[s]=n.get())}removeValue(s){this.values.delete(s);const n=this.valueSubscriptions.get(s);n&&(n(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,n){if(this.props.values&&this.props.values[s])return this.props.values[s];let i=this.values.get(s);return i===void 0&&n!==void 0&&(i=Kn(n===null?void 0:n,{owner:this}),this.addValue(s,i)),i}readValue(s,n){let i=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:this.getBaseTargetFromProps(this.props,s)??this.readValueFromInstance(this.current,s,this.options);return i!=null&&(typeof i=="string"&&(nf(i)||af(i))?i=parseFloat(i):!HS(i)&&Rs.test(n)&&(i=qf(s,n)),this.setBaseTarget(s,Ge(i)?i.get():i)),Ge(i)?i.get():i}setBaseTarget(s,n){this.baseTarget[s]=n}getBaseTarget(s){const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const a=qc(this.props,n,this.presenceContext?.custom);a&&(i=a[s])}if(n&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,s);return r!==void 0&&!Ge(r)?r:this.initialValues[s]!==void 0&&i===void 0?void 0:this.baseTarget[s]}on(s,n){return this.events[s]||(this.events[s]=new yc),this.events[s].add(n)}notify(s,...n){this.events[s]&&this.events[s].notify(...n)}scheduleRenderMicrotask(){Ec.render(this.render)}}class hx extends FC{constructor(){super(...arguments),this.KeyframeResolver=LS}sortInstanceNodePosition(s,n){return s.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(s,n){return s.style?s.style[n]:void 0}removeValueFromRenderState(s,{vars:n,style:i}){delete n[s],delete i[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;Ge(s)&&(this.childSubscription=s.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function px(e,{style:s,vars:n},i,r){const a=e.style;let o;for(o in s)a[o]=s[o];r?.applyProjectionStyles(a,i);for(o in n)a.setProperty(o,n[o])}function $C(e){return window.getComputedStyle(e)}class qC extends hx{constructor(){super(...arguments),this.type="html",this.renderInstance=px}readValueFromInstance(s,n){if(li.has(n))return this.projection?.isProjecting?xl(n):tS(s,n);{const i=$C(s),r=(wc(n)?i.getPropertyValue(n):i[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(s,{transformPagePoint:n}){return ux(s,n)}build(s,n,i){Rc(s,n,i.transformTemplate)}scrapeMotionValuesFromProps(s,n,i){return Bc(s,n,i)}}const fx=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function BC(e,s,n,i){px(e,s,void 0,i);for(const r in s.attrs)e.setAttribute(fx.has(r)?r:Vc(r),s.attrs[r])}class VC extends hx{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Se}getBaseTargetFromProps(s,n){return s[n]}readValueFromInstance(s,n){if(li.has(n)){const i=$f(n);return i&&i.default||0}return n=fx.has(n)?n:Vc(n),s.getAttribute(n)}scrapeMotionValuesFromProps(s,n,i){return ix(s,n,i)}build(s,n,i){ex(s,n,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(s,n,i,r){BC(s,n,i,r)}mount(s){this.isSVGTag=sx(s.tagName),super.mount(s)}}const UC=(e,s)=>$c(e)?new VC(s):new qC(s,{allowProjection:e!==g.Fragment});function On(e,s,n){const i=e.getProps();return qc(i,s,n!==void 0?n:i.custom,e)}const Sl=e=>Array.isArray(e);function WC(e,s,n){e.hasValue(s)?e.getValue(s).set(n):e.addValue(s,Kn(n))}function KC(e){return Sl(e)?e[e.length-1]||0:e}function GC(e,s){const n=On(e,s);let{transitionEnd:i={},transition:r={},...a}=n||{};a={...a,...i};for(const o in a){const l=KC(a[o]);WC(e,o,l)}}function HC(e){return!!(Ge(e)&&e.add)}function Cl(e,s){const n=e.getValue("willChange");if(HC(n))return n.add(s);if(!n&&ys.WillChange){const i=new ys.WillChange("auto");e.addValue("willChange",i),i.add(s)}}function xx(e){return e.props[rx]}const QC=e=>e!==null;function ZC(e,{repeat:s,repeatType:n="loop"},i){const r=e.filter(QC),a=s&&n!=="loop"&&s%2===1?0:r.length-1;return r[a]}const YC={type:"spring",stiffness:500,damping:25,restSpeed:10},JC=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),XC={type:"keyframes",duration:.8},e2={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},t2=(e,{keyframes:s})=>s.length>2?XC:li.has(e)?e.startsWith("scale")?JC(s[1]):YC:e2;function s2({when:e,delay:s,delayChildren:n,staggerChildren:i,staggerDirection:r,repeat:a,repeatType:o,repeatDelay:l,from:c,elapsed:d,...m}){return!!Object.keys(m).length}const Uc=(e,s,n,i={},r,a)=>o=>{const l=Dc(i,e)||{},c=l.delay||i.delay||0;let{elapsed:d=0}=i;d=d-Jt(c);const m={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:s.getVelocity(),...l,delay:-d,onUpdate:h=>{s.set(h),l.onUpdate&&l.onUpdate(h)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:e,motionValue:s,element:a?void 0:r};s2(l)||Object.assign(m,t2(e,m)),m.duration&&(m.duration=Jt(m.duration)),m.repeatDelay&&(m.repeatDelay=Jt(m.repeatDelay)),m.from!==void 0&&(m.keyframes[0]=m.from);let u=!1;if((m.type===!1||m.duration===0&&!m.repeatDelay)&&(wl(m),m.delay===0&&(u=!0)),(ys.instantAnimations||ys.skipAnimations)&&(u=!0,wl(m),m.delay=0),m.allowFlatten=!l.type&&!l.ease,u&&!a&&s.get()!==void 0){const h=ZC(m.keyframes,l);if(h!==void 0){he.update(()=>{m.onUpdate(h),m.onComplete()});return}}return l.isSync?new Ac(m):new kS(m)};function n2({protectedKeys:e,needsAnimating:s},n){const i=e.hasOwnProperty(n)&&s[n]!==!0;return s[n]=!1,i}function gx(e,s,{delay:n=0,transitionOverride:i,type:r}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:o,...l}=s;i&&(a=i);const c=[],d=r&&e.animationState&&e.animationState.getState()[r];for(const m in l){const u=e.getValue(m,e.latestValues[m]??null),h=l[m];if(h===void 0||d&&n2(d,m))continue;const p={delay:n,...Dc(a||{},m)},x=u.get();if(x!==void 0&&!u.isAnimating&&!Array.isArray(h)&&h===x&&!p.velocity)continue;let f=!1;if(window.MotionHandoffAnimation){const b=xx(e);if(b){const y=window.MotionHandoffAnimation(b,m,he);y!==null&&(p.startTime=y,f=!0)}}Cl(e,m),u.start(Uc(m,u,h,e.shouldReduceMotion&&Of.has(m)?{type:!1}:p,e,f));const j=u.animation;j&&c.push(j)}return o&&Promise.all(c).then(()=>{he.update(()=>{o&&GC(e,o)})}),c}function yx(e,s,n,i=0,r=1){const a=Array.from(e).sort((d,m)=>d.sortNodePosition(m)).indexOf(s),o=e.size,l=(o-1)*i;return typeof n=="function"?n(a,o):r===1?a*i:l-a*i}function Tl(e,s,n={}){const i=On(e,s,n.type==="exit"?e.presenceContext?.custom:void 0);let{transition:r=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const a=i?()=>Promise.all(gx(e,i,n)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:m,staggerDirection:u}=r;return i2(e,s,c,d,m,u,n)}:()=>Promise.resolve(),{when:l}=r;if(l){const[c,d]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>d())}else return Promise.all([a(),o(n.delay)])}function i2(e,s,n=0,i=0,r=0,a=1,o){const l=[];for(const c of e.variantChildren)c.notify("AnimationStart",s),l.push(Tl(c,s,{...o,delay:n+(typeof i=="function"?0:i)+yx(e.variantChildren,c,i,r,a)}).then(()=>c.notify("AnimationComplete",s)));return Promise.all(l)}function r2(e,s,n={}){e.notify("AnimationStart",s);let i;if(Array.isArray(s)){const r=s.map(a=>Tl(e,a,n));i=Promise.all(r)}else if(typeof s=="string")i=Tl(e,s,n);else{const r=typeof s=="function"?On(e,s,n.custom):s;i=Promise.all(gx(e,r,n))}return i.then(()=>{e.notify("AnimationComplete",s)})}function jx(e,s){if(!Array.isArray(s))return!1;const n=s.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(s[i]!==e[i])return!1;return!0}const a2=Oc.length;function bx(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?bx(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const s={};for(let n=0;n<a2;n++){const i=Oc[n],r=e.props[i];(er(r)||r===!1)&&(s[i]=r)}return s}const o2=[...Lc].reverse(),l2=Lc.length;function c2(e){return s=>Promise.all(s.map(({animation:n,options:i})=>r2(e,n,i)))}function d2(e){let s=c2(e),n=Cu(),i=!0;const r=c=>(d,m)=>{const u=On(e,m,c==="exit"?e.presenceContext?.custom:void 0);if(u){const{transition:h,transitionEnd:p,...x}=u;d={...d,...x,...p}}return d};function a(c){s=c(e)}function o(c){const{props:d}=e,m=bx(e.parent)||{},u=[],h=new Set;let p={},x=1/0;for(let j=0;j<l2;j++){const b=o2[j],y=n[b],w=d[b]!==void 0?d[b]:m[b],z=er(w),N=b===c?y.isActive:null;N===!1&&(x=j);let S=w===m[b]&&w!==d[b]&&z;if(S&&i&&e.manuallyAnimateOnMount&&(S=!1),y.protectedKeys={...p},!y.isActive&&N===null||!w&&!y.prevProp||Ga(w)||typeof w=="boolean")continue;const k=u2(y.prevProp,w);let C=k||b===c&&y.isActive&&!S&&z||j>x&&z,A=!1;const v=Array.isArray(w)?w:[w];let P=v.reduce(r(b),{});N===!1&&(P={});const{prevResolvedValues:_={}}=y,E={..._,...P},D=Z=>{C=!0,h.has(Z)&&(A=!0,h.delete(Z)),y.needsAnimating[Z]=!0;const J=e.getValue(Z);J&&(J.liveStyle=!1)};for(const Z in E){const J=P[Z],U=_[Z];if(p.hasOwnProperty(Z))continue;let xe=!1;Sl(J)&&Sl(U)?xe=!jx(J,U):xe=J!==U,xe?J!=null?D(Z):h.add(Z):J!==void 0&&h.has(Z)?D(Z):y.protectedKeys[Z]=!0}y.prevProp=w,y.prevResolvedValues=P,y.isActive&&(p={...p,...P}),i&&e.blockInitialAnimation&&(C=!1);const ee=S&&k;C&&(!ee||A)&&u.push(...v.map(Z=>{const J={type:b};if(typeof Z=="string"&&i&&!ee&&e.manuallyAnimateOnMount&&e.parent){const{parent:U}=e,xe=On(U,Z);if(U.enteringChildren&&xe){const{delayChildren:Ie}=xe.transition||{};J.delay=yx(U.enteringChildren,e,Ie)}}return{animation:Z,options:J}}))}if(h.size){const j={};if(typeof d.initial!="boolean"){const b=On(e,Array.isArray(d.initial)?d.initial[0]:d.initial);b&&b.transition&&(j.transition=b.transition)}h.forEach(b=>{const y=e.getBaseTarget(b),w=e.getValue(b);w&&(w.liveStyle=!0),j[b]=y??null}),u.push({animation:j})}let f=!!u.length;return i&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(f=!1),i=!1,f?s(u):Promise.resolve()}function l(c,d){if(n[c].isActive===d)return Promise.resolve();e.variantChildren?.forEach(u=>u.animationState?.setActive(c,d)),n[c].isActive=d;const m=o(c);for(const u in n)n[u].protectedKeys={};return m}return{animateChanges:o,setActive:l,setAnimateFunction:a,getState:()=>n,reset:()=>{n=Cu(),i=!0}}}function u2(e,s){return typeof s=="string"?s!==e:Array.isArray(s)?!jx(s,e):!1}function Ws(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Cu(){return{animate:Ws(!0),whileInView:Ws(),whileHover:Ws(),whileTap:Ws(),whileDrag:Ws(),whileFocus:Ws(),exit:Ws()}}class qs{constructor(s){this.isMounted=!1,this.node=s}update(){}}class m2 extends qs{constructor(s){super(s),s.animationState||(s.animationState=d2(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();Ga(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:n}=this.node.prevProps||{};s!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let h2=0;class p2 extends qs{constructor(){super(...arguments),this.id=h2++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===i)return;const r=this.node.animationState.setActive("exit",!s);n&&!s&&r.then(()=>{n(this.id)})}mount(){const{register:s,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),s&&(this.unmount=s(this.id))}unmount(){}}const f2={animation:{Feature:m2},exit:{Feature:p2}};function sr(e,s,n,i={passive:!0}){return e.addEventListener(s,n,i),()=>e.removeEventListener(s,n)}function Sr(e){return{point:{x:e.pageX,y:e.pageY}}}const x2=e=>s=>Ic(s)&&e(s,Sr(s));function Mi(e,s,n,i){return sr(e,s,x2(n),i)}const wx=1e-4,g2=1-wx,y2=1+wx,vx=.01,j2=0-vx,b2=0+vx;function Xe(e){return e.max-e.min}function w2(e,s,n){return Math.abs(e-s)<=n}function Tu(e,s,n,i=.5){e.origin=i,e.originPoint=ge(s.min,s.max,e.origin),e.scale=Xe(n)/Xe(s),e.translate=ge(n.min,n.max,e.origin)-e.originPoint,(e.scale>=g2&&e.scale<=y2||isNaN(e.scale))&&(e.scale=1),(e.translate>=j2&&e.translate<=b2||isNaN(e.translate))&&(e.translate=0)}function Li(e,s,n,i){Tu(e.x,s.x,n.x,i?i.originX:void 0),Tu(e.y,s.y,n.y,i?i.originY:void 0)}function Au(e,s,n){e.min=n.min+s.min,e.max=e.min+Xe(s)}function v2(e,s,n){Au(e.x,s.x,n.x),Au(e.y,s.y,n.y)}function Pu(e,s,n){e.min=s.min-n.min,e.max=e.min+Xe(s)}function Oi(e,s,n){Pu(e.x,s.x,n.x),Pu(e.y,s.y,n.y)}function kt(e){return[e("x"),e("y")]}const Nx=({current:e})=>e?e.ownerDocument.defaultView:null,Du=(e,s)=>Math.abs(e-s);function N2(e,s){const n=Du(e.x,s.x),i=Du(e.y,s.y);return Math.sqrt(n**2+i**2)}class kx{constructor(s,n,{transformPagePoint:i,contextWindow:r=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Io(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,x=N2(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!x)return;const{point:f}=h,{timestamp:j}=qe;this.history.push({...f,timestamp:j});const{onStart:b,onMove:y}=this.handlers;p||(b&&b(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),y&&y(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=Eo(p,this.transformPagePoint),he.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:x,onSessionEnd:f,resumeAnimation:j}=this.handlers;if(this.dragSnapToOrigin&&j&&j(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=Io(h.type==="pointercancel"?this.lastMoveEventInfo:Eo(p,this.transformPagePoint),this.history);this.startEvent&&x&&x(h,b),f&&f(h,b)},!Ic(s))return;this.dragSnapToOrigin=a,this.handlers=n,this.transformPagePoint=i,this.distanceThreshold=o,this.contextWindow=r||window;const l=Sr(s),c=Eo(l,this.transformPagePoint),{point:d}=c,{timestamp:m}=qe;this.history=[{...d,timestamp:m}];const{onSessionStart:u}=n;u&&u(s,Io(c,this.history)),this.removeListeners=Nr(Mi(this.contextWindow,"pointermove",this.handlePointerMove),Mi(this.contextWindow,"pointerup",this.handlePointerUp),Mi(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),Os(this.updatePoint)}}function Eo(e,s){return s?{point:s(e.point)}:e}function _u(e,s){return{x:e.x-s.x,y:e.y-s.y}}function Io({point:e},s){return{point:e,delta:_u(e,zx(s)),offset:_u(e,k2(s)),velocity:z2(s,.1)}}function k2(e){return e[0]}function zx(e){return e[e.length-1]}function z2(e,s){if(e.length<2)return{x:0,y:0};let n=e.length-1,i=null;const r=zx(e);for(;n>=0&&(i=e[n],!(r.timestamp-i.timestamp>Jt(s)));)n--;if(!i)return{x:0,y:0};const a=Xt(r.timestamp-i.timestamp);if(a===0)return{x:0,y:0};const o={x:(r.x-i.x)/a,y:(r.y-i.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function S2(e,{min:s,max:n},i){return s!==void 0&&e<s?e=i?ge(s,e,i.min):Math.max(e,s):n!==void 0&&e>n&&(e=i?ge(n,e,i.max):Math.min(e,n)),e}function Eu(e,s,n){return{min:s!==void 0?e.min+s:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function C2(e,{top:s,left:n,bottom:i,right:r}){return{x:Eu(e.x,n,r),y:Eu(e.y,s,i)}}function Iu(e,s){let n=s.min-e.min,i=s.max-e.max;return s.max-s.min<e.max-e.min&&([n,i]=[i,n]),{min:n,max:i}}function T2(e,s){return{x:Iu(e.x,s.x),y:Iu(e.y,s.y)}}function A2(e,s){let n=.5;const i=Xe(e),r=Xe(s);return r>i?n=Yi(s.min,s.max-i,e.min):i>r&&(n=Yi(e.min,e.max-r,s.min)),gs(0,1,n)}function P2(e,s){const n={};return s.min!==void 0&&(n.min=s.min-e.min),s.max!==void 0&&(n.max=s.max-e.min),n}const Al=.35;function D2(e=Al){return e===!1?e=0:e===!0&&(e=Al),{x:Mu(e,"left","right"),y:Mu(e,"top","bottom")}}function Mu(e,s,n){return{min:Lu(e,s),max:Lu(e,n)}}function Lu(e,s){return typeof e=="number"?e:e[s]||0}const _2=new WeakMap;class E2{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Se(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=s}start(s,{snapToCursor:n=!1,distanceThreshold:i}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const a=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Sr(u).point)},o=(u,h)=>{const{drag:p,dragPropagation:x,onDragStart:f}=this.getProps();if(p&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=$S(p),!this.openDragLock))return;this.latestPointerEvent=u,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),kt(b=>{let y=this.getAxisMotionValue(b).get()||0;if(es.test(y)){const{projection:w}=this.visualElement;if(w&&w.layout){const z=w.layout.layoutBox[b];z&&(y=Xe(z)*(parseFloat(y)/100))}}this.originPoint[b]=y}),f&&he.postRender(()=>f(u,h)),Cl(this.visualElement,"transform");const{animationState:j}=this.visualElement;j&&j.setActive("whileDrag",!0)},l=(u,h)=>{this.latestPointerEvent=u,this.latestPanInfo=h;const{dragPropagation:p,dragDirectionLock:x,onDirectionLock:f,onDrag:j}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:b}=h;if(x&&this.currentDirection===null){this.currentDirection=I2(b),this.currentDirection!==null&&f&&f(this.currentDirection);return}this.updateAxis("x",h.point,b),this.updateAxis("y",h.point,b),this.visualElement.render(),j&&j(u,h)},c=(u,h)=>{this.latestPointerEvent=u,this.latestPanInfo=h,this.stop(u,h),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>kt(u=>this.getAnimationState(u)==="paused"&&this.getAxisMotionValue(u).animation?.play()),{dragSnapToOrigin:m}=this.getProps();this.panSession=new kx(s,{onSessionStart:a,onStart:o,onMove:l,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:m,distanceThreshold:i,contextWindow:Nx(this.visualElement)})}stop(s,n){const i=s||this.latestPointerEvent,r=n||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!r||!i)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:l}=this.getProps();l&&he.postRender(()=>l(i,r))}cancel(){this.isDragging=!1;const{projection:s,animationState:n}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(s,n,i){const{drag:r}=this.getProps();if(!i||!Vr(s,r,this.currentDirection))return;const a=this.getAxisMotionValue(s);let o=this.originPoint[s]+i[s];this.constraints&&this.constraints[s]&&(o=S2(o,this.constraints[s],this.elastic[s])),a.set(o)}resolveConstraints(){const{dragConstraints:s,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,r=this.constraints;s&&Sn(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&i?this.constraints=C2(i.layoutBox,s):this.constraints=!1,this.elastic=D2(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&kt(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=P2(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:n}=this.getProps();if(!s||!Sn(s))return!1;const i=s.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const a=MC(i,r.root,this.visualElement.getTransformPagePoint());let o=T2(r.layout.layoutBox,a);if(n){const l=n(_C(o));this.hasMutatedConstraints=!!l,l&&(o=lx(l))}return o}startAnimation(s){const{drag:n,dragMomentum:i,dragElastic:r,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=kt(m=>{if(!Vr(m,n,this.currentDirection))return;let u=c&&c[m]||{};o&&(u={min:0,max:0});const h=r?200:1e6,p=r?40:1e7,x={type:"inertia",velocity:i?s[m]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...a,...u};return this.startAxisValueAnimation(m,x)});return Promise.all(d).then(l)}startAxisValueAnimation(s,n){const i=this.getAxisMotionValue(s);return Cl(this.visualElement,s),i.start(Uc(s,i,0,n,this.visualElement,!1))}stopAnimation(){kt(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){kt(s=>this.getAxisMotionValue(s).animation?.pause())}getAnimationState(s){return this.getAxisMotionValue(s).animation?.state}getAxisMotionValue(s){const n=`_drag${s.toUpperCase()}`,i=this.visualElement.getProps(),r=i[n];return r||this.visualElement.getValue(s,(i.initial?i.initial[s]:void 0)||0)}snapToCursor(s){kt(n=>{const{drag:i}=this.getProps();if(!Vr(n,i,this.currentDirection))return;const{projection:r}=this.visualElement,a=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[n];a.set(s[n]-ge(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!Sn(n)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};kt(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const c=l.get();r[o]=A2({min:c,max:c},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),kt(o=>{if(!Vr(o,s,null))return;const l=this.getAxisMotionValue(o),{min:c,max:d}=this.constraints[o];l.set(ge(c,d,r[o]))})}addListeners(){if(!this.visualElement.current)return;_2.set(this.visualElement,this);const s=this.visualElement.current,n=Mi(s,"pointerdown",c=>{const{drag:d,dragListener:m=!0}=this.getProps();d&&m&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();Sn(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,a=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),he.read(i);const o=sr(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(kt(m=>{const u=this.getAxisMotionValue(m);u&&(this.originPoint[m]+=c[m].translate,u.set(u.get()+c[m].translate))}),this.visualElement.render())});return()=>{o(),n(),a(),l&&l()}}getProps(){const s=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:a=!1,dragElastic:o=Al,dragMomentum:l=!0}=s;return{...s,drag:n,dragDirectionLock:i,dragPropagation:r,dragConstraints:a,dragElastic:o,dragMomentum:l}}}function Vr(e,s,n){return(s===!0||s===e)&&(n===null||n===e)}function I2(e,s=10){let n=null;return Math.abs(e.y)>s?n="y":Math.abs(e.x)>s&&(n="x"),n}class M2 extends qs{constructor(s){super(s),this.removeGroupControls=Tt,this.removeListeners=Tt,this.controls=new E2(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Tt}unmount(){this.removeGroupControls(),this.removeListeners()}}const Ou=e=>(s,n)=>{e&&he.postRender(()=>e(s,n))};class L2 extends qs{constructor(){super(...arguments),this.removePointerDownListener=Tt}onPointerDown(s){this.session=new kx(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Nx(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:n,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:Ou(s),onStart:Ou(n),onMove:i,onEnd:(a,o)=>{delete this.session,r&&he.postRender(()=>r(a,o))}}}mount(){this.removePointerDownListener=Mi(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const ea={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Ru(e,s){return s.max===s.min?0:e/(s.max-s.min)*100}const wi={correct:(e,s)=>{if(!s.target)return e;if(typeof e=="string")if(Q.test(e))e=parseFloat(e);else return e;const n=Ru(e,s.target.x),i=Ru(e,s.target.y);return`${n}% ${i}%`}},O2={correct:(e,{treeScale:s,projectionDelta:n})=>{const i=e,r=Rs.parse(e);if(r.length>5)return i;const a=Rs.createTransformer(e),o=typeof r[0]!="number"?1:0,l=n.x.scale*s.x,c=n.y.scale*s.y;r[0+o]/=l,r[1+o]/=c;const d=ge(l,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=d),typeof r[3+o]=="number"&&(r[3+o]/=d),a(r)}};let Mo=!1;class R2 extends g.Component{componentDidMount(){const{visualElement:s,layoutGroup:n,switchLayoutGroup:i,layoutId:r}=this.props,{projection:a}=s;aC(F2),a&&(n.group&&n.group.add(a),i&&i.register&&r&&i.register(a),Mo&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),ea.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:n,visualElement:i,drag:r,isPresent:a}=this.props,{projection:o}=i;return o&&(o.isPresent=a,Mo=!0,r||s.layoutDependency!==n||n===void 0||s.isPresent!==a?o.willUpdate():this.safeToRemove(),s.isPresent!==a&&(a?o.promote():o.relegate()||he.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),Ec.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:r}=s;Mo=!0,r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function Sx(e){const[s,n]=Hf(),i=g.useContext(uc);return t.jsx(R2,{...e,layoutGroup:i,switchLayoutGroup:g.useContext(ax),isPresent:s,safeToRemove:n})}const F2={borderRadius:{...wi,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:wi,borderTopRightRadius:wi,borderBottomLeftRadius:wi,borderBottomRightRadius:wi,boxShadow:O2};function $2(e,s,n){const i=Ge(e)?e:Kn(e);return i.start(Uc("",i,s,n)),i.animation}const q2=(e,s)=>e.depth-s.depth;class B2{constructor(){this.children=[],this.isDirty=!1}add(s){pc(this.children,s),this.isDirty=!0}remove(s){fc(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(q2),this.isDirty=!1,this.children.forEach(s)}}function V2(e,s){const n=ot.now(),i=({timestamp:r})=>{const a=r-n;a>=s&&(Os(i),e(a-s))};return he.setup(i,!0),()=>Os(i)}const Cx=["TopLeft","TopRight","BottomLeft","BottomRight"],U2=Cx.length,Fu=e=>typeof e=="string"?parseFloat(e):e,$u=e=>typeof e=="number"||Q.test(e);function W2(e,s,n,i,r,a){r?(e.opacity=ge(0,n.opacity??1,K2(i)),e.opacityExit=ge(s.opacity??1,0,G2(i))):a&&(e.opacity=ge(s.opacity??1,n.opacity??1,i));for(let o=0;o<U2;o++){const l=`border${Cx[o]}Radius`;let c=qu(s,l),d=qu(n,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||$u(c)===$u(d)?(e[l]=Math.max(ge(Fu(c),Fu(d),i),0),(es.test(d)||es.test(c))&&(e[l]+="%")):e[l]=d}(s.rotate||n.rotate)&&(e.rotate=ge(s.rotate||0,n.rotate||0,i))}function qu(e,s){return e[s]!==void 0?e[s]:e.borderRadius}const K2=Tx(0,.5,pf),G2=Tx(.5,.95,Tt);function Tx(e,s,n){return i=>i<e?0:i>s?1:n(Yi(e,s,i))}function Bu(e,s){e.min=s.min,e.max=s.max}function vt(e,s){Bu(e.x,s.x),Bu(e.y,s.y)}function Vu(e,s){e.translate=s.translate,e.scale=s.scale,e.originPoint=s.originPoint,e.origin=s.origin}function Uu(e,s,n,i,r){return e-=s,e=ya(e,1/n,i),r!==void 0&&(e=ya(e,1/r,i)),e}function H2(e,s=0,n=1,i=.5,r,a=e,o=e){if(es.test(s)&&(s=parseFloat(s),s=ge(o.min,o.max,s/100)-o.min),typeof s!="number")return;let l=ge(a.min,a.max,i);e===a&&(l-=s),e.min=Uu(e.min,s,n,l,r),e.max=Uu(e.max,s,n,l,r)}function Wu(e,s,[n,i,r],a,o){H2(e,s[n],s[i],s[r],s.scale,a,o)}const Q2=["x","scaleX","originX"],Z2=["y","scaleY","originY"];function Ku(e,s,n,i){Wu(e.x,s,Q2,n?n.x:void 0,i?i.x:void 0),Wu(e.y,s,Z2,n?n.y:void 0,i?i.y:void 0)}function Gu(e){return e.translate===0&&e.scale===1}function Ax(e){return Gu(e.x)&&Gu(e.y)}function Hu(e,s){return e.min===s.min&&e.max===s.max}function Y2(e,s){return Hu(e.x,s.x)&&Hu(e.y,s.y)}function Qu(e,s){return Math.round(e.min)===Math.round(s.min)&&Math.round(e.max)===Math.round(s.max)}function Px(e,s){return Qu(e.x,s.x)&&Qu(e.y,s.y)}function Zu(e){return Xe(e.x)/Xe(e.y)}function Yu(e,s){return e.translate===s.translate&&e.scale===s.scale&&e.originPoint===s.originPoint}class J2{constructor(){this.members=[]}add(s){pc(this.members,s),s.scheduleRender()}remove(s){if(fc(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(s){const n=this.members.findIndex(r=>s===r);if(n===0)return!1;let i;for(let r=n;r>=0;r--){const a=this.members[r];if(a.isPresent!==!1){i=a;break}}return i?(this.promote(i),!0):!1}promote(s,n){const i=this.lead;if(s!==i&&(this.prevLead=i,this.lead=s,s.show(),i)){i.instance&&i.scheduleRender(),s.scheduleRender(),s.resumeFrom=i,n&&(s.resumeFrom.preserveOpacity=!0),i.snapshot&&(s.snapshot=i.snapshot,s.snapshot.latestValues=i.animationValues||i.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0);const{crossfade:r}=s.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:n,resumingFrom:i}=s;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function X2(e,s,n){let i="";const r=e.x.translate/s.x,a=e.y.translate/s.y,o=n?.z||0;if((r||a||o)&&(i=`translate3d(${r}px, ${a}px, ${o}px) `),(s.x!==1||s.y!==1)&&(i+=`scale(${1/s.x}, ${1/s.y}) `),n){const{transformPerspective:d,rotate:m,rotateX:u,rotateY:h,skewX:p,skewY:x}=n;d&&(i=`perspective(${d}px) ${i}`),m&&(i+=`rotate(${m}deg) `),u&&(i+=`rotateX(${u}deg) `),h&&(i+=`rotateY(${h}deg) `),p&&(i+=`skewX(${p}deg) `),x&&(i+=`skewY(${x}deg) `)}const l=e.x.scale*s.x,c=e.y.scale*s.y;return(l!==1||c!==1)&&(i+=`scale(${l}, ${c})`),i||"none"}const Lo=["","X","Y","Z"],eT=1e3;let tT=0;function Oo(e,s,n,i){const{latestValues:r}=s;r[e]&&(n[e]=r[e],s.setStaticValue(e,0),i&&(i[e]=0))}function Dx(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:s}=e.options;if(!s)return;const n=xx(s);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",he,!(r||a))}const{parent:i}=e;i&&!i.hasCheckedOptimisedAppear&&Dx(i)}function _x({attachResizeListener:e,defaultParent:s,measureScroll:n,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=s?.()){this.id=tT++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(iT),this.nodes.forEach(lT),this.nodes.forEach(cT),this.nodes.forEach(rT)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new B2)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new yc),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=Gf(o)&&!KS(o),this.instance=o;const{layoutId:l,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),e){let m,u=0;const h=()=>this.root.updateBlockedByResize=!1;he.read(()=>{u=window.innerWidth}),e(o,()=>{const p=window.innerWidth;p!==u&&(u=p,this.root.updateBlockedByResize=!0,m&&m(),m=V2(h,250),ea.hasAnimatedSinceResize&&(ea.hasAnimatedSinceResize=!1,this.nodes.forEach(em)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&d&&(l||c)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:u,hasRelativeLayoutChanged:h,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||d.getDefaultTransition()||pT,{onLayoutAnimationStart:f,onLayoutAnimationComplete:j}=d.getProps(),b=!this.targetLayout||!Px(this.targetLayout,p),y=!u&&h;if(this.options.layoutRoot||this.resumeFrom||y||u&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const w={...Dc(x,"layout"),onPlay:f,onComplete:j};(d.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w),this.setAnimationOrigin(m,y)}else u||em(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Os(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(dT),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Dx(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let m=0;m<this.path.length;m++){const u=this.path[m];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Ju);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Xu);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(oT),this.nodes.forEach(sT),this.nodes.forEach(nT)):this.nodes.forEach(Xu),this.clearAllSnapshots();const l=ot.now();qe.delta=gs(0,1e3/60,l-qe.timestamp),qe.timestamp=l,qe.isProcessing=!0,zo.update.process(qe),zo.preRender.process(qe),zo.render.process(qe),qe.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Ec.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(aT),this.sharedNodes.forEach(uT)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,he.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){he.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Xe(this.snapshot.measuredBox.x)&&!Xe(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Se(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!Ax(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,m=d!==this.prevTransformTemplateValue;o&&this.instance&&(l||Ks(this.latestValues)||m)&&(r(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),fT(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Se();const l=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(xT))){const{scroll:d}=this.root;d&&(Cn(l.x,d.offset.x),Cn(l.y,d.offset.y))}return l}removeElementScroll(o){const l=Se();if(vt(l,o),this.scroll?.wasRoot)return l;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:m,options:u}=d;d!==this.root&&m&&u.layoutScroll&&(m.wasRoot&&vt(l,o),Cn(l.x,m.offset.x),Cn(l.y,m.offset.y))}return l}applyTransform(o,l=!1){const c=Se();vt(c,o);for(let d=0;d<this.path.length;d++){const m=this.path[d];!l&&m.options.layoutScroll&&m.scroll&&m!==m.root&&Tn(c,{x:-m.scroll.offset.x,y:-m.scroll.offset.y}),Ks(m.latestValues)&&Tn(c,m.latestValues)}return Ks(this.latestValues)&&Tn(c,this.latestValues),c}removeTransform(o){const l=Se();vt(l,o);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Ks(d.latestValues))continue;Nl(d.latestValues)&&d.updateSnapshot();const m=Se(),u=d.measurePageBox();vt(m,u),Ku(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,m)}return Ks(this.latestValues)&&Ku(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==qe.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:u}=this.options;if(!(!this.layout||!(m||u))){if(this.resolvedRelativeTargetAt=qe.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Se(),this.relativeTargetOrigin=Se(),Oi(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),vt(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Se(),this.targetWithTransforms=Se()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),v2(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):vt(this.target,this.layout.layoutBox),dx(this.target,this.targetDelta)):vt(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Se(),this.relativeTargetOrigin=Se(),Oi(this.relativeTargetOrigin,this.target,h.target),vt(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Nl(this.parent.latestValues)||cx(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===qe.timestamp&&(c=!1),c)return;const{layout:d,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||m))return;vt(this.layoutCorrected,this.layout.layoutBox);const u=this.treeScale.x,h=this.treeScale.y;IC(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Se());const{target:p}=o;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Vu(this.prevProjectionDelta.x,this.projectionDelta.x),Vu(this.prevProjectionDelta.y,this.projectionDelta.y)),Li(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==u||this.treeScale.y!==h||!Yu(this.projectionDelta.x,this.prevProjectionDelta.x)||!Yu(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=An(),this.projectionDelta=An(),this.projectionDeltaWithTransform=An()}setAnimationOrigin(o,l=!1){const c=this.snapshot,d=c?c.latestValues:{},m={...this.latestValues},u=An();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=Se(),p=c?c.source:void 0,x=this.layout?this.layout.source:void 0,f=p!==x,j=this.getStack(),b=!j||j.members.length<=1,y=!!(f&&!b&&this.options.crossfade===!0&&!this.path.some(hT));this.animationProgress=0;let w;this.mixTargetDelta=z=>{const N=z/1e3;tm(u.x,o.x,N),tm(u.y,o.y,N),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Oi(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mT(this.relativeTarget,this.relativeTargetOrigin,h,N),w&&Y2(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=Se()),vt(w,this.relativeTarget)),f&&(this.animationValues=m,W2(m,d,this.latestValues,N,y,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Os(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=he.update(()=>{ea.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Kn(0)),this.currentAnimation=$2(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(eT),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:m}=o;if(!(!l||!c||!d)){if(this!==o&&this.layout&&d&&Ex(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||Se();const u=Xe(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+u;const h=Xe(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+h}vt(l,c),Tn(l,m),Li(this.projectionDeltaWithTransform,this.layoutCorrected,l,m)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new J2),this.sharedNodes.get(o).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const d={};c.z&&Oo("z",o,d,this.animationValues);for(let m=0;m<Lo.length;m++)Oo(`rotate${Lo[m]}`,o,d,this.animationValues),Oo(`skew${Lo[m]}`,o,d,this.animationValues);o.render();for(const m in d)o.setStaticValue(m,d[m]),this.animationValues&&(this.animationValues[m]=d[m]);o.scheduleRender()}applyProjectionStyles(o,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Xr(l?.pointerEvents)||"",o.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Xr(l?.pointerEvents)||""),this.hasProjected&&!Ks(this.latestValues)&&(o.transform=c?c({},""):"none",this.hasProjected=!1);return}o.visibility="";const m=d.animationValues||d.latestValues;this.applyTransformsToTarget();let u=X2(this.projectionDeltaWithTransform,this.treeScale,m);c&&(u=c(m,u)),o.transform=u;const{x:h,y:p}=this.projectionDelta;o.transformOrigin=`${h.origin*100}% ${p.origin*100}% 0`,d.animationValues?o.opacity=d===this?m.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:o.opacity=d===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const x in tr){if(m[x]===void 0)continue;const{correct:f,applyTo:j,isCSSVariable:b}=tr[x],y=u==="none"?m[x]:f(m[x],d);if(j){const w=j.length;for(let z=0;z<w;z++)o[j[z]]=y}else b?this.options.visualElement.renderState.vars[x]=y:o[x]=y}this.options.layoutId&&(o.pointerEvents=d===this?Xr(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(Ju),this.root.sharedNodes.clear()}}}function sT(e){e.updateLayout()}function nT(e){const s=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=e.layout,{animationType:r}=e.options,a=s.source!==e.layout.source;r==="size"?kt(m=>{const u=a?s.measuredBox[m]:s.layoutBox[m],h=Xe(u);u.min=n[m].min,u.max=u.min+h}):Ex(r,s.layoutBox,n)&&kt(m=>{const u=a?s.measuredBox[m]:s.layoutBox[m],h=Xe(n[m]);u.max=u.min+h,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[m].max=e.relativeTarget[m].min+h)});const o=An();Li(o,n,s.layoutBox);const l=An();a?Li(l,e.applyTransform(i,!0),s.measuredBox):Li(l,n,s.layoutBox);const c=!Ax(o);let d=!1;if(!e.resumeFrom){const m=e.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:u,layout:h}=m;if(u&&h){const p=Se();Oi(p,s.layoutBox,u.layoutBox);const x=Se();Oi(x,n,h.layoutBox),Px(p,x)||(d=!0),m.options.layoutRoot&&(e.relativeTarget=x,e.relativeTargetOrigin=p,e.relativeParent=m)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:s,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:d})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function iT(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function rT(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function aT(e){e.clearSnapshot()}function Ju(e){e.clearMeasurements()}function Xu(e){e.isLayoutDirty=!1}function oT(e){const{visualElement:s}=e.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),e.resetTransform()}function em(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function lT(e){e.resolveTargetDelta()}function cT(e){e.calcProjection()}function dT(e){e.resetSkewAndRotation()}function uT(e){e.removeLeadSnapshot()}function tm(e,s,n){e.translate=ge(s.translate,0,n),e.scale=ge(s.scale,1,n),e.origin=s.origin,e.originPoint=s.originPoint}function sm(e,s,n,i){e.min=ge(s.min,n.min,i),e.max=ge(s.max,n.max,i)}function mT(e,s,n,i){sm(e.x,s.x,n.x,i),sm(e.y,s.y,n.y,i)}function hT(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const pT={duration:.45,ease:[.4,0,.1,1]},nm=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),im=nm("applewebkit/")&&!nm("chrome/")?Math.round:Tt;function rm(e){e.min=im(e.min),e.max=im(e.max)}function fT(e){rm(e.x),rm(e.y)}function Ex(e,s,n){return e==="position"||e==="preserve-aspect"&&!w2(Zu(s),Zu(n),.2)}function xT(e){return e!==e.root&&e.scroll?.wasRoot}const gT=_x({attachResizeListener:(e,s)=>sr(e,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ro={current:void 0},Ix=_x({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Ro.current){const e=new gT({});e.mount(window),e.setOptions({layoutScroll:!0}),Ro.current=e}return Ro.current},resetTransform:(e,s)=>{e.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),yT={pan:{Feature:L2},drag:{Feature:M2,ProjectionNode:Ix,MeasureLayout:Sx}};function am(e,s,n){const{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,a=i[r];a&&he.postRender(()=>a(s,Sr(s)))}class jT extends qs{mount(){const{current:s}=this.node;s&&(this.unmount=qS(s,(n,i)=>(am(this.node,i,"Start"),r=>am(this.node,r,"End"))))}unmount(){}}class bT extends qs{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Nr(sr(this.node.current,"focus",()=>this.onFocus()),sr(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function om(e,s,n){const{props:i}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&i.whileTap&&e.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),a=i[r];a&&he.postRender(()=>a(s,Sr(s)))}class wT extends qs{mount(){const{current:s}=this.node;s&&(this.unmount=WS(s,(n,i)=>(om(this.node,i,"Start"),(r,{success:a})=>om(this.node,r,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Pl=new WeakMap,Fo=new WeakMap,vT=e=>{const s=Pl.get(e.target);s&&s(e)},NT=e=>{e.forEach(vT)};function kT({root:e,...s}){const n=e||document;Fo.has(n)||Fo.set(n,{});const i=Fo.get(n),r=JSON.stringify(s);return i[r]||(i[r]=new IntersectionObserver(NT,{root:e,...s})),i[r]}function zT(e,s,n){const i=kT(s);return Pl.set(e,n),i.observe(e),()=>{Pl.delete(e),i.unobserve(e)}}const ST={some:0,all:1};class CT extends qs{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:n,margin:i,amount:r="some",once:a}=s,o={root:n?n.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:ST[r]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:m,onViewportLeave:u}=this.node.getProps(),h=d?m:u;h&&h(c)};return zT(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:n}=this.node;["amount","margin","root"].some(TT(s,n))&&this.startObserver()}unmount(){}}function TT({viewport:e={}},{viewport:s={}}={}){return n=>e[n]!==s[n]}const AT={inView:{Feature:CT},tap:{Feature:wT},focus:{Feature:bT},hover:{Feature:jT}},PT={layout:{ProjectionNode:Ix,MeasureLayout:Sx}},DT={...f2,...AT,...yT,...PT},Ce=DC(DT,UC),Qa={normal:.3,slow:.5},_T={stagger:.05},ET={default:[.4,0,.2,1]},IT={hidden:{opacity:0,y:20},visible:(e=0)=>({opacity:1,y:0,transition:{delay:e*_T.stagger,duration:Qa.normal,ease:ET.default}})},MT=(e,s=Qa.slow)=>{const[n,i]=L.useState(0),r=L.useRef(0);return L.useEffect(()=>{const a=r.current,o=e,l=Date.now(),c=()=>{const d=(Date.now()-l)/1e3,m=Math.min(d/s,1),u=1-Math.pow(1-m,3),h=Math.floor(a+(o-a)*u);i(h),m<1?requestAnimationFrame(c):r.current=o};requestAnimationFrame(c)},[e,s]),n},Cr=({children:e,index:s=0,className:n="",...i})=>t.jsx(Ce.div,{variants:IT,initial:"hidden",animate:"visible",custom:s,className:n,...i,children:e}),Hn=({value:e,className:s="bg-gray-100 rounded-full overflow-hidden",barClassName:n="h-full bg-gray-900",height:i="h-2"})=>t.jsx("div",{className:`${i} ${s}`,children:t.jsx(Ce.div,{initial:{width:0},animate:{width:`${e}%`},transition:{duration:Qa.slow,ease:"easeOut"},className:n})}),Be=({value:e,className:s="",duration:n=Qa.slow,prefix:i="",suffix:r=""})=>{const a=MT(e,n);return t.jsxs("span",{className:s,children:[i,a.toLocaleString("pl-PL"),r]})},LT=()=>t.jsxs("div",{className:"rounded-2xl border bg-card p-5 shadow-soft animate-pulse",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("div",{className:"h-8 w-8 rounded-md bg-muted/70"}),t.jsx("div",{className:"h-4 w-40 rounded bg-muted/70"})]}),t.jsx("div",{className:"h-5 w-16 rounded-full bg-muted/70"})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("div",{className:"h-2 w-full rounded-full bg-muted/60"}),t.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[t.jsx("div",{className:"h-3 w-16 rounded bg-muted/60"}),t.jsx("div",{className:"h-3 w-20 rounded bg-muted/60"})]})]}),t.jsx("div",{className:"mt-4 h-9 w-2/3 rounded-lg bg-muted/60"}),t.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[t.jsx("div",{className:"h-6 w-16 rounded bg-muted/60"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("div",{className:"h-9 w-24 rounded-lg bg-muted/60"}),t.jsx("div",{className:"h-9 w-10 rounded-lg bg-muted/60"})]})]})]}),OT=()=>{const e=H(),{data:s}=st(),{stats:n,refetch:i}=ur(),{data:r,isLoading:a}=La("get_my_courses"),[o,l]=L.useState(0),c=r||[],d=!a&&c.length===0;L.useEffect(()=>{const u=async()=>{try{const{data:p}=await se.rpc("check_claimable_rewards");l(p?.claimable_points||0)}catch{}};u();const h=setInterval(u,3e4);return()=>clearInterval(h)},[]);const m=async()=>{try{const{data:u,error:h}=await se.rpc("claim_daily_rewards");if(h)throw h;u&&($.success(`Odebrano ${u.total_earned} punktów`),i(),l(0))}catch{$.error("Nie można odebrać nagród")}};return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs(Ce.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),t.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),t.jsxs("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:[t.jsxs("div",{className:"space-y-6 md:hidden",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsx("h2",{className:"text-xl font-bold tracking-tight",children:"Twoje tempo nauki"}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.streak>0&&t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1.5 shadow-soft",children:[t.jsx(Js,{className:"h-4 w-4 text-destructive"}),t.jsxs("span",{className:"text-sm font-medium",children:["Seria: ",t.jsx("span",{className:"tabular-nums",children:n.streak})," ","dni"]})]}),o>0&&t.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 rounded-lg bg-primary px-3 py-1.5 text-sm text-primary-foreground hover:bg-primary/90 focus-ring",children:[t.jsx(gd,{className:"h-4 w-4"}),"Odbierz ",o," pkt"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[t.jsxs("div",{className:"rounded-xl border bg-card p-4 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Punkty"}),t.jsx($t,{className:"h-4 w-4 text-primary"})]}),t.jsxs("div",{className:"flex items-end gap-2",children:[t.jsx("span",{className:"text-3xl font-semibold tabular-nums text-primary leading-none",children:t.jsx(Be,{value:n.points})}),t.jsx("span",{className:"mb-1 text-sm text-muted-foreground",children:"pkt"})]}),t.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["+",t.jsx(Be,{value:n.idle_rate}),"/h"]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"rounded-xl border bg-card p-4 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Poziom"}),t.jsx(qi,{className:"h-4 w-4 text-secondary"})]}),t.jsx("span",{className:"text-2xl font-semibold text-secondary",children:n.level}),t.jsx("div",{className:"mt-2 h-1.5 w-full rounded-full bg-muted",children:t.jsx("div",{className:"h-full rounded-full bg-secondary transition-all",style:{width:`${n.points%100}%`}})})]}),t.jsxs("div",{className:"rounded-xl border bg-card p-4 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Tempo"}),t.jsx(Xs,{className:"h-4 w-4 text-accent"})]}),t.jsxs("span",{className:"text-2xl font-semibold text-accent",children:["+",t.jsx(Be,{value:n.idle_rate})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"pkt/h"})]})]})]})]}),t.jsxs("div",{className:"hidden md:grid gap-8 md:grid-cols-12 md:items-center",children:[t.jsxs("div",{className:"md:col-span-4 space-y-4",children:[t.jsx("h2",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Twoje tempo nauki"}),n.streak>0&&t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1.5 shadow-soft",children:[t.jsx(Js,{className:"h-4 w-4 text-destructive"}),t.jsxs("span",{className:"text-sm font-medium",children:["Seria: ",t.jsx("span",{className:"tabular-nums",children:n.streak})," ","dni"]})]}),o>0&&t.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90 focus-ring",children:[t.jsx(gd,{className:"h-4 w-4"}),"Odbierz ",o," pkt"]})]}),t.jsx("div",{className:"md:col-span-8",children:t.jsxs("div",{className:"grid grid-cols-3 gap-4 md:gap-6",children:[t.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Punkty"}),t.jsx($t,{className:"h-4 w-4 text-primary"})]}),t.jsxs("div",{className:"mt-2 flex items-end gap-2",children:[t.jsx("span",{className:"text-4xl md:text-5xl font-semibold tabular-nums text-primary leading-none",children:t.jsx(Be,{value:n.points})}),t.jsx("span",{className:"mb-[2px] text-sm text-muted-foreground",children:"pkt"})]}),t.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["+",t.jsx(Be,{value:n.idle_rate}),"/h"]})]}),t.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Poziom"}),t.jsx(qi,{className:"h-4 w-4 text-secondary"})]}),t.jsx("div",{className:"mt-2 flex items-center gap-2",children:t.jsx("span",{className:"text-4xl md:text-5xl font-semibold text-secondary leading-none",children:n.level})}),t.jsx("div",{className:"mt-3 h-2 w-full rounded-full bg-muted",children:t.jsx("div",{className:"h-full rounded-full bg-secondary transition-all",style:{width:`${n.points%100}%`}})}),t.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["Do kolejnego: ",100-n.points%100," pkt"]})]}),t.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Tempo"}),t.jsx(Xs,{className:"h-4 w-4 text-accent"})]}),t.jsxs("div",{className:"mt-2 flex items-end gap-2",children:[t.jsxs("span",{className:"text-4xl md:text-5xl font-semibold text-accent leading-none",children:["+",t.jsx(Be,{value:n.idle_rate})]}),t.jsx("span",{className:"mb-[2px] text-sm text-muted-foreground",children:"pkt/h"})]}),t.jsx("button",{onClick:()=>e("/student/gamification"),className:"mt-3 w-full rounded-lg border px-3 py-2 hover:bg-primary/5 focus-ring",children:"Gamifikacja"})]})]})})]})]})]}),t.jsxs(Ce.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between gap-4",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-semibold tracking-tight",children:"Twoje kursy"}),t.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"To jest Twoja główna ścieżka — kontynuuj naukę tam, gdzie skończyłeś."})]}),t.jsxs("button",{onClick:()=>e("/student/courses"),className:"inline-flex items-center gap-1 sm:gap-2 rounded-lg border px-2 sm:px-3 py-1.5 sm:py-2 text-sm hover:bg-primary/5 focus-ring whitespace-nowrap",children:[t.jsx("span",{className:"hidden sm:inline",children:"Zobacz wszystkie"}),t.jsx("span",{className:"sm:hidden",children:"Wszystkie"}),t.jsx(Ze,{className:"h-4 w-4"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-5",children:[a&&Array.from({length:6}).map((u,h)=>t.jsx(LT,{},h)),!a&&c.slice(0,9).map(u=>{const h=u.progress_percent===100;return t.jsxs("div",{className:"group relative rounded-2xl border bg-card p-4 sm:p-5 shadow-soft hover:bg-muted/40 transition-colors",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("span",{className:"text-2xl sm:text-3xl shrink-0 leading-none",children:u.icon_emoji||"📚"}),t.jsx("h4",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:u.title})]}),h?t.jsx("span",{className:"inline-flex items-center gap-1 rounded-full border border-green-600/30 bg-green-500/10 text-green-700 dark:text-green-400 px-2 sm:px-2.5 py-0.5 sm:py-1 text-[10px] sm:text-[11px] font-semibold",children:"Ukończono"}):t.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-primary/30 text-primary px-2 sm:px-2.5 py-0.5 sm:py-1 text-[10px] sm:text-[11px] font-semibold",children:[u.progress_percent,"%"]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("div",{className:"h-2 w-full rounded-full bg-muted",children:t.jsx("div",{className:`h-full rounded-full transition-all ${h?"bg-green-600":"bg-primary"}`,style:{width:`${u.progress_percent||0}%`}})}),t.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-muted-foreground",children:[t.jsx("span",{children:"Ukończono"}),t.jsxs("span",{className:"font-medium text-foreground",children:[u.completed_lessons||0,"/",u.total_lessons||10," lekcji"]})]})]}),u.next_activity&&t.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-2 rounded-lg border bg-background/60 px-2.5 sm:px-3 py-1.5 sm:py-2",children:[t.jsx(oj,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-primary"}),t.jsx("p",{className:"text-xs sm:text-sm font-medium truncate",children:u.next_activity})]}),t.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center justify-between",children:[u.points_available?t.jsxs("span",{className:"inline-flex rounded-md bg-orange-500/10 text-[10px] sm:text-[11px] font-semibold px-2 py-0.5 sm:py-1 text-orange-600",children:["+",u.points_available," pkt"]}):t.jsx("span",{}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>e(`/student/courses/${u.course_id}`),className:"rounded-lg bg-primary px-3 sm:px-4 py-1.5 sm:py-2 text-sm text-primary-foreground hover:bg-primary/90 focus-ring",children:"Kontynuuj"}),t.jsx("button",{onClick:()=>e(`/student/courses/${u.course_id}`),className:"rounded-lg border px-2.5 sm:px-3 py-1.5 sm:py-2 hover:bg-primary/5 focus-ring",title:"Szczegóły",children:t.jsx(Ze,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4"})})]})]})]},u.course_id)}),d&&t.jsxs("div",{className:"col-span-full rounded-2xl border bg-card p-8 sm:p-10 text-center shadow-soft",children:[t.jsx("div",{className:"text-4xl sm:text-5xl",children:"🚀"}),t.jsx("h4",{className:"mt-3 sm:mt-4 text-base sm:text-lg font-semibold",children:"Zacznij swoją przygodę"}),t.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:"Dołącz do kursu i odkryj nowy sposób nauki."}),t.jsx("button",{onClick:()=>e("/student/courses"),className:"mt-4 sm:mt-6 rounded-lg bg-secondary px-4 sm:px-5 py-2 sm:py-2.5 text-sm text-white hover:opacity-95 focus-ring",children:"Odkryj kursy"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[t.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Punkty"}),t.jsx($t,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-primary"})]}),t.jsx("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold tabular-nums text-foreground",children:t.jsx(Be,{value:n.points})}),t.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:["+",t.jsx(Be,{value:n.idle_rate}),"/h"]})]}),t.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Poziom"}),t.jsx(Je,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-secondary"})]}),t.jsx("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold text-foreground",children:n.level}),t.jsx("div",{className:"mt-2 sm:mt-3",children:t.jsx(Hn,{value:n.points%100})})]}),t.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Seria dni"}),t.jsx(Js,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-destructive"})]}),t.jsx("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold text-foreground",children:t.jsx(Be,{value:n.streak})}),t.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"dni z rzędu"})]}),t.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Tempo"}),t.jsx(Xs,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-accent"})]}),t.jsxs("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold text-foreground",children:["+",t.jsx(Be,{value:n.idle_rate})]}),t.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"punktów/h"})]})]})]})},RT=()=>t.jsxs("div",{className:"rounded-2xl border bg-card p-5 md:p-6 shadow-soft animate-pulse",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-12 w-12 rounded-xl bg-muted/60"}),t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsx("div",{className:"h-5 w-1/2 rounded bg-muted/60"}),t.jsx("div",{className:"h-4 w-3/4 rounded bg-muted/60"})]}),t.jsx("div",{className:"h-9 w-36 rounded-lg bg-muted/60"})]}),t.jsxs("div",{className:"mt-5",children:[t.jsx("div",{className:"h-2 w-full rounded-full bg-muted/60"}),t.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[t.jsx("div",{className:"h-3 w-16 rounded bg-muted/60"}),t.jsx("div",{className:"h-3 w-10 rounded bg-muted/60"})]})]})]}),FT=()=>t.jsxs("div",{className:"rounded-2xl border bg-card p-4 md:p-5 shadow-soft animate-pulse",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("div",{className:"h-10 w-10 rounded-full bg-muted/60"}),t.jsx("div",{className:"h-4 w-2/5 rounded bg-muted/60"})]}),t.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((e,s)=>t.jsx("div",{className:"h-14 rounded-xl border bg-muted/40"},s))})]}),$T=()=>{const{courseId:e}=tt(),s=H(),{data:n,isLoading:i}=La("get_course_structure",{p_course_id:parseInt(e)},{enabled:!!e}),{data:r}=tb("courses",{filters:[{field:"id",operator:"eq",value:parseInt(e)}],enabled:!!e}),a=L.useMemo(()=>{if(!n)return[];const d=n.reduce((u,h)=>{const p=`${h.topic_id}-${h.topic_title}`;return u[p]||(u[p]={id:h.topic_id,title:h.topic_title,position:h.topic_position,activities:[]}),h.activity_id&&u[p].activities.push({id:h.activity_id,title:h.activity_title,type:h.activity_type,position:h.activity_position,completed:h.is_completed,score:h.score}),u},{}),m=Object.values(d).sort((u,h)=>u.position-h.position);return m.map((u,h)=>{const p=u.activities.length>0&&u.activities.every(f=>f.completed),x=h===0||m[h-1].activities.length>0&&m[h-1].activities.every(f=>f.completed);return u.activities.sort((f,j)=>f.position-j.position),{...u,isCompleted:p,isUnlocked:x}})},[n]),o=L.useMemo(()=>{const d=a.flatMap(h=>h.activities),m=d.filter(h=>h.completed).length,u=d.length;return{totalActivities:u,completedActivities:m,progress:u>0?Math.round(m/u*100):0}},[a]),l=r?.[0],c=L.useMemo(()=>{for(const d of a){if(!d.isUnlocked)break;const m=d.activities.find(u=>!u.completed);if(m)return{topicId:d.id,activity:m,path:m.type==="quiz"?`/student/courses/${e}/quiz/${m.id}`:`/student/courses/${e}/lesson/${m.id}`}}return null},[a,e]);return i?t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8",children:[t.jsxs("button",{className:"inline-flex items-center gap-2 text-muted-foreground cursor-default",disabled:!0,children:[t.jsx(me,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Powrót"})]}),t.jsx(RT,{}),t.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((d,m)=>t.jsx(FT,{},m))})]}):l?t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs("button",{onClick:()=>s("/student/dashboard#courses"),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[t.jsx(me,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Powrót"})]}),t.jsxs(Ce.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),t.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),t.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:t.jsxs("div",{className:"grid md:grid-cols-12 gap-6 md:items-center",children:[t.jsxs("div",{className:"md:col-span-7 flex items-start gap-4 min-w-0",children:[t.jsx("div",{className:"text-5xl md:text-6xl leading-none shrink-0",children:l.icon_emoji||"📚"}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h1",{className:"text-xl md:text-3xl font-bold tracking-tight",children:l.title}),l.description&&t.jsx("p",{className:"mt-2 text-sm md:text-base text-muted-foreground line-clamp-3",children:l.description}),t.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[t.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1.5 shadow-soft",children:[t.jsx(qt,{className:"h-4 w-4"}),t.jsxs("span",{className:"text-sm font-medium",children:["Ukończone:"," ",t.jsx("span",{className:"tabular-nums",children:t.jsx(Be,{value:o.completedActivities})}),"/",o.totalActivities]})]}),o.progress===100&&t.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-green-600/30 bg-green-500/10 text-green-700 dark:text-green-400 px-3 py-1.5 shadow-soft text-sm font-semibold",children:[t.jsx(ze,{className:"h-4 w-4"}),"Kurs ukończony"]})]})]})]}),t.jsx("div",{className:"md:col-span-5",children:t.jsxs("div",{className:"rounded-xl border bg-card p-4 md:p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Postęp kursu"}),t.jsxs("span",{className:"text-sm font-semibold",children:[o.progress,"%"]})]}),t.jsx("div",{className:"mt-2",children:t.jsx(Hn,{value:o.progress})}),t.jsxs("div",{className:"mt-3 flex gap-2",children:[c?t.jsxs("button",{onClick:()=>s(c.path),className:"flex-1 inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90 focus-ring",children:["Kontynuuj",t.jsx(Ze,{className:"h-4 w-4"})]}):t.jsx("button",{disabled:!0,className:"flex-1 rounded-lg border px-4 py-2 text-muted-foreground cursor-default",title:"Brak kolejnej aktywności",children:"Wszystko ukończone"}),t.jsx("button",{onClick:()=>s("/student/courses"),className:"rounded-lg border px-3 py-2 hover:bg-primary/5 focus-ring",title:"Wróć do listy",children:t.jsx(me,{className:"h-4 w-4"})})]})]})})]})})]}),t.jsx("div",{className:"space-y-6",children:a.map((d,m)=>t.jsxs(Cr,{index:m,className:O("relative rounded-2xl border bg-card p-4 md:p-5 shadow-soft",!d.isUnlocked&&"opacity-60"),children:[t.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3 md:mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:O("w-10 h-10 rounded-full flex items-center justify-center",d.isCompleted?"bg-green-600 text-white":d.isUnlocked?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),"aria-label":d.isCompleted?"Temat ukończony":d.isUnlocked?"Temat odblokowany":"Temat zablokowany",children:d.isCompleted?t.jsx(ze,{className:"w-5 h-5"}):d.isUnlocked?t.jsx("span",{className:"font-semibold",children:d.position}):t.jsx(Bi,{className:"w-4 h-4"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:d.title}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[d.activities.filter(u=>u.completed).length," ","z ",d.activities.length," ukończonych"]})]})]}),t.jsx("div",{className:"hidden md:block w-40",children:t.jsx(Hn,{value:d.activities.length?Math.round(d.activities.filter(u=>u.completed).length/d.activities.length*100):0})})]}),t.jsx("div",{className:"mt-3 md:mt-4 space-y-3",children:d.activities.map(u=>{const h=u.type==="quiz",p=u.type==="quiz"?`/student/courses/${e}/quiz/${u.id}`:`/student/courses/${e}/lesson/${u.id}`;return t.jsxs(Ce.button,{whileHover:d.isUnlocked?{x:2}:{},whileTap:d.isUnlocked?{scale:.98}:{},onClick:()=>{d.isUnlocked&&s(p)},disabled:!d.isUnlocked,className:O("w-full flex items-center justify-between p-4 rounded-xl border transition-colors focus-ring",d.isUnlocked?"bg-background/60 hover:bg-primary/5":"bg-muted/40 cursor-not-allowed"),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:O("w-8 h-8 rounded-lg flex items-center justify-center shrink-0",h?"bg-purple-100":"bg-blue-100"),children:h?t.jsx($t,{className:"w-4 h-4 text-purple-600"}):t.jsx(qt,{className:"w-4 h-4 text-blue-600"})}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium text-foreground",children:u.title}),t.jsxs("div",{className:"text-sm text-muted-foreground",children:[h?"Quiz":"Materiał",u.score!==null&&` • ${u.score}%`]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[!u.completed&&d.isUnlocked&&t.jsx("span",{className:"hidden sm:inline text-xs text-muted-foreground",children:"Przejdź"}),u.completed?t.jsx(ze,{className:"w-5 h-5 text-green-600"}):t.jsx(Ze,{className:"w-5 h-5 text-muted-foreground"})]})]},u.id)})})]},d.id))})]}):t.jsxs("div",{className:"container mx-auto px-4 py-12 text-center",children:[t.jsx("div",{className:"text-5xl",children:"🤷‍♂️"}),t.jsx("h2",{className:"mt-3 text-xl font-semibold",children:"Nie znaleziono kursu"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Spróbuj wrócić do listy kursów i wybrać ponownie."}),t.jsx("button",{onClick:()=>s("/student/courses"),className:"mt-6 rounded-lg bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90 focus-ring",children:"Przejdź do kursów"})]})},Wc=Symbol.for("yaml.alias"),Dl=Symbol.for("yaml.document"),_s=Symbol.for("yaml.map"),Mx=Symbol.for("yaml.pair"),is=Symbol.for("yaml.scalar"),ci=Symbol.for("yaml.seq"),_t=Symbol.for("yaml.node.type"),Bs=e=>!!e&&typeof e=="object"&&e[_t]===Wc,hn=e=>!!e&&typeof e=="object"&&e[_t]===Dl,di=e=>!!e&&typeof e=="object"&&e[_t]===_s,pe=e=>!!e&&typeof e=="object"&&e[_t]===Mx,de=e=>!!e&&typeof e=="object"&&e[_t]===is,ui=e=>!!e&&typeof e=="object"&&e[_t]===ci;function ye(e){if(e&&typeof e=="object")switch(e[_t]){case _s:case ci:return!0}return!1}function je(e){if(e&&typeof e=="object")switch(e[_t]){case Wc:case _s:case is:case ci:return!0}return!1}const Lx=e=>(de(e)||ye(e))&&!!e.anchor,rt=Symbol("break visit"),Ox=Symbol("skip children"),ts=Symbol("remove node");function pn(e,s){const n=Rx(s);hn(e)?Pn(null,e.contents,n,Object.freeze([e]))===ts&&(e.contents=null):Pn(null,e,n,Object.freeze([]))}pn.BREAK=rt;pn.SKIP=Ox;pn.REMOVE=ts;function Pn(e,s,n,i){const r=Fx(e,s,n,i);if(je(r)||pe(r))return $x(e,i,r),Pn(e,r,n,i);if(typeof r!="symbol"){if(ye(s)){i=Object.freeze(i.concat(s));for(let a=0;a<s.items.length;++a){const o=Pn(a,s.items[a],n,i);if(typeof o=="number")a=o-1;else{if(o===rt)return rt;o===ts&&(s.items.splice(a,1),a-=1)}}}else if(pe(s)){i=Object.freeze(i.concat(s));const a=Pn("key",s.key,n,i);if(a===rt)return rt;a===ts&&(s.key=null);const o=Pn("value",s.value,n,i);if(o===rt)return rt;o===ts&&(s.value=null)}}return r}async function Za(e,s){const n=Rx(s);hn(e)?await Dn(null,e.contents,n,Object.freeze([e]))===ts&&(e.contents=null):await Dn(null,e,n,Object.freeze([]))}Za.BREAK=rt;Za.SKIP=Ox;Za.REMOVE=ts;async function Dn(e,s,n,i){const r=await Fx(e,s,n,i);if(je(r)||pe(r))return $x(e,i,r),Dn(e,r,n,i);if(typeof r!="symbol"){if(ye(s)){i=Object.freeze(i.concat(s));for(let a=0;a<s.items.length;++a){const o=await Dn(a,s.items[a],n,i);if(typeof o=="number")a=o-1;else{if(o===rt)return rt;o===ts&&(s.items.splice(a,1),a-=1)}}}else if(pe(s)){i=Object.freeze(i.concat(s));const a=await Dn("key",s.key,n,i);if(a===rt)return rt;a===ts&&(s.key=null);const o=await Dn("value",s.value,n,i);if(o===rt)return rt;o===ts&&(s.value=null)}}return r}function Rx(e){return typeof e=="object"&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function Fx(e,s,n,i){if(typeof n=="function")return n(e,s,i);if(di(s))return n.Map?.(e,s,i);if(ui(s))return n.Seq?.(e,s,i);if(pe(s))return n.Pair?.(e,s,i);if(de(s))return n.Scalar?.(e,s,i);if(Bs(s))return n.Alias?.(e,s,i)}function $x(e,s,n){const i=s[s.length-1];if(ye(i))i.items[e]=n;else if(pe(i))e==="key"?i.key=n:i.value=n;else if(hn(i))i.contents=n;else{const r=Bs(i)?"alias":"scalar";throw new Error(`Cannot replace node with ${r} parent`)}}const qT={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},BT=e=>e.replace(/[!,[\]{}]/g,s=>qT[s]);class Ye{constructor(s,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},Ye.defaultYaml,s),this.tags=Object.assign({},Ye.defaultTags,n)}clone(){const s=new Ye(this.yaml,this.tags);return s.docStart=this.docStart,s}atDocument(){const s=new Ye(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:Ye.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},Ye.defaultTags);break}return s}add(s,n){this.atNextDocument&&(this.yaml={explicit:Ye.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},Ye.defaultTags),this.atNextDocument=!1);const i=s.trim().split(/[ \t]+/),r=i.shift();switch(r){case"%TAG":{if(i.length!==2&&(n(0,"%TAG directive should contain exactly two parts"),i.length<2))return!1;const[a,o]=i;return this.tags[a]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,i.length!==1)return n(0,"%YAML directive should contain exactly one part"),!1;const[a]=i;if(a==="1.1"||a==="1.2")return this.yaml.version=a,!0;{const o=/^\d+\.\d+$/.test(a);return n(6,`Unsupported YAML version ${a}`,o),!1}}default:return n(0,`Unknown directive ${r}`,!0),!1}}tagName(s,n){if(s==="!")return"!";if(s[0]!=="!")return n(`Not a valid tag: ${s}`),null;if(s[1]==="<"){const o=s.slice(2,-1);return o==="!"||o==="!!"?(n(`Verbatim tags aren't resolved, so ${s} is invalid.`),null):(s[s.length-1]!==">"&&n("Verbatim tags must end with a >"),o)}const[,i,r]=s.match(/^(.*!)([^!]*)$/s);r||n(`The ${s} tag has no suffix`);const a=this.tags[i];if(a)try{return a+decodeURIComponent(r)}catch(o){return n(String(o)),null}return i==="!"?s:(n(`Could not resolve tag: ${s}`),null)}tagString(s){for(const[n,i]of Object.entries(this.tags))if(s.startsWith(i))return n+BT(s.substring(i.length));return s[0]==="!"?s:`!<${s}>`}toString(s){const n=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],i=Object.entries(this.tags);let r;if(s&&i.length>0&&je(s.contents)){const a={};pn(s.contents,(o,l)=>{je(l)&&l.tag&&(a[l.tag]=!0)}),r=Object.keys(a)}else r=[];for(const[a,o]of i)a==="!!"&&o==="tag:yaml.org,2002:"||(!s||r.some(l=>l.startsWith(o)))&&n.push(`%TAG ${a} ${o}`);return n.join(`
`)}}Ye.defaultYaml={explicit:!1,version:"1.2"};Ye.defaultTags={"!!":"tag:yaml.org,2002:"};function qx(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){const n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(e)}`;throw new Error(n)}return!0}function Bx(e){const s=new Set;return pn(e,{Value(n,i){i.anchor&&s.add(i.anchor)}}),s}function Vx(e,s){for(let n=1;;++n){const i=`${e}${n}`;if(!s.has(i))return i}}function VT(e,s){const n=[],i=new Map;let r=null;return{onAnchor:a=>{n.push(a),r??(r=Bx(e));const o=Vx(s,r);return r.add(o),o},setAnchors:()=>{for(const a of n){const o=i.get(a);if(typeof o=="object"&&o.anchor&&(de(o.node)||ye(o.node)))o.node.anchor=o.anchor;else{const l=new Error("Failed to resolve repeated object (this should not happen)");throw l.source=a,l}}},sourceObjects:i}}function _n(e,s,n,i){if(i&&typeof i=="object")if(Array.isArray(i))for(let r=0,a=i.length;r<a;++r){const o=i[r],l=_n(e,i,String(r),o);l===void 0?delete i[r]:l!==o&&(i[r]=l)}else if(i instanceof Map)for(const r of Array.from(i.keys())){const a=i.get(r),o=_n(e,i,r,a);o===void 0?i.delete(r):o!==a&&i.set(r,o)}else if(i instanceof Set)for(const r of Array.from(i)){const a=_n(e,i,r,r);a===void 0?i.delete(r):a!==r&&(i.delete(r),i.add(a))}else for(const[r,a]of Object.entries(i)){const o=_n(e,i,r,a);o===void 0?delete i[r]:o!==a&&(i[r]=o)}return e.call(s,n,i)}function At(e,s,n){if(Array.isArray(e))return e.map((i,r)=>At(i,String(r),n));if(e&&typeof e.toJSON=="function"){if(!n||!Lx(e))return e.toJSON(s,n);const i={aliasCount:0,count:1,res:void 0};n.anchors.set(e,i),n.onCreate=a=>{i.res=a,delete n.onCreate};const r=e.toJSON(s,n);return n.onCreate&&n.onCreate(r),r}return typeof e=="bigint"&&!n?.keep?Number(e):e}class Kc{constructor(s){Object.defineProperty(this,_t,{value:s})}clone(){const s=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(s.range=this.range.slice()),s}toJS(s,{mapAsMap:n,maxAliasCount:i,onAnchor:r,reviver:a}={}){if(!hn(s))throw new TypeError("A document argument is required");const o={anchors:new Map,doc:s,keep:!0,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},l=At(this,"",o);if(typeof r=="function")for(const{count:c,res:d}of o.anchors.values())r(d,c);return typeof a=="function"?_n(a,{"":l},"",l):l}}class Ya extends Kc{constructor(s){super(Wc),this.source=s,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(s,n){let i;n?.aliasResolveCache?i=n.aliasResolveCache:(i=[],pn(s,{Node:(a,o)=>{(Bs(o)||Lx(o))&&i.push(o)}}),n&&(n.aliasResolveCache=i));let r;for(const a of i){if(a===this)break;a.anchor===this.source&&(r=a)}return r}toJSON(s,n){if(!n)return{source:this.source};const{anchors:i,doc:r,maxAliasCount:a}=n,o=this.resolve(r,n);if(!o){const c=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(c)}let l=i.get(o);if(l||(At(o,null,n),l=i.get(o)),!l||l.res===void 0){const c="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(c)}if(a>=0&&(l.count+=1,l.aliasCount===0&&(l.aliasCount=ta(r,o,i)),l.count*l.aliasCount>a)){const c="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(c)}return l.res}toString(s,n,i){const r=`*${this.source}`;if(s){if(qx(this.source),s.options.verifyAliasOrder&&!s.anchors.has(this.source)){const a=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(a)}if(s.implicitKey)return`${r} `}return r}}function ta(e,s,n){if(Bs(s)){const i=s.resolve(e),r=n&&i&&n.get(i);return r?r.count*r.aliasCount:0}else if(ye(s)){let i=0;for(const r of s.items){const a=ta(e,r,n);a>i&&(i=a)}return i}else if(pe(s)){const i=ta(e,s.key,n),r=ta(e,s.value,n);return Math.max(i,r)}return 1}const Ux=e=>!e||typeof e!="function"&&typeof e!="object";class Y extends Kc{constructor(s){super(is),this.value=s}toJSON(s,n){return n?.keep?this.value:At(this.value,s,n)}toString(){return String(this.value)}}Y.BLOCK_FOLDED="BLOCK_FOLDED";Y.BLOCK_LITERAL="BLOCK_LITERAL";Y.PLAIN="PLAIN";Y.QUOTE_DOUBLE="QUOTE_DOUBLE";Y.QUOTE_SINGLE="QUOTE_SINGLE";const UT="tag:yaml.org,2002:";function WT(e,s,n){if(s){const i=n.filter(a=>a.tag===s),r=i.find(a=>!a.format)??i[0];if(!r)throw new Error(`Tag ${s} not found`);return r}return n.find(i=>i.identify?.(e)&&!i.format)}function nr(e,s,n){if(hn(e)&&(e=e.contents),je(e))return e;if(pe(e)){const u=n.schema[_s].createNode?.(n.schema,null,n);return u.items.push(e),u}(e instanceof String||e instanceof Number||e instanceof Boolean||typeof BigInt<"u"&&e instanceof BigInt)&&(e=e.valueOf());const{aliasDuplicateObjects:i,onAnchor:r,onTagObj:a,schema:o,sourceObjects:l}=n;let c;if(i&&e&&typeof e=="object"){if(c=l.get(e),c)return c.anchor??(c.anchor=r(e)),new Ya(c.anchor);c={anchor:null,node:null},l.set(e,c)}s?.startsWith("!!")&&(s=UT+s.slice(2));let d=WT(e,s,o.tags);if(!d){if(e&&typeof e.toJSON=="function"&&(e=e.toJSON()),!e||typeof e!="object"){const u=new Y(e);return c&&(c.node=u),u}d=e instanceof Map?o[_s]:Symbol.iterator in Object(e)?o[ci]:o[_s]}a&&(a(d),delete n.onTagObj);const m=d?.createNode?d.createNode(n.schema,e,n):typeof d?.nodeClass?.from=="function"?d.nodeClass.from(n.schema,e,n):new Y(e);return s?m.tag=s:d.default||(m.tag=d.tag),c&&(c.node=m),m}function ja(e,s,n){let i=n;for(let r=s.length-1;r>=0;--r){const a=s[r];if(typeof a=="number"&&Number.isInteger(a)&&a>=0){const o=[];o[a]=i,i=o}else i=new Map([[a,i]])}return nr(i,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}const Ai=e=>e==null||typeof e=="object"&&!!e[Symbol.iterator]().next().done;class Wx extends Kc{constructor(s,n){super(s),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(s){const n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return s&&(n.schema=s),n.items=n.items.map(i=>je(i)||pe(i)?i.clone(s):i),this.range&&(n.range=this.range.slice()),n}addIn(s,n){if(Ai(s))this.add(n);else{const[i,...r]=s,a=this.get(i,!0);if(ye(a))a.addIn(r,n);else if(a===void 0&&this.schema)this.set(i,ja(this.schema,r,n));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${r}`)}}deleteIn(s){const[n,...i]=s;if(i.length===0)return this.delete(n);const r=this.get(n,!0);if(ye(r))return r.deleteIn(i);throw new Error(`Expected YAML collection at ${n}. Remaining path: ${i}`)}getIn(s,n){const[i,...r]=s,a=this.get(i,!0);return r.length===0?!n&&de(a)?a.value:a:ye(a)?a.getIn(r,n):void 0}hasAllNullValues(s){return this.items.every(n=>{if(!pe(n))return!1;const i=n.value;return i==null||s&&de(i)&&i.value==null&&!i.commentBefore&&!i.comment&&!i.tag})}hasIn(s){const[n,...i]=s;if(i.length===0)return this.has(n);const r=this.get(n,!0);return ye(r)?r.hasIn(i):!1}setIn(s,n){const[i,...r]=s;if(r.length===0)this.set(i,n);else{const a=this.get(i,!0);if(ye(a))a.setIn(r,n);else if(a===void 0&&this.schema)this.set(i,ja(this.schema,r,n));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${r}`)}}}const KT=e=>e.replace(/^(?!$)(?: $)?/gm,"#");function ms(e,s){return/^\n+$/.test(e)?e.substring(1):s?e.replace(/^(?! *$)/gm,s):e}const Qs=(e,s,n)=>e.endsWith(`
`)?ms(n,s):n.includes(`
`)?`
`+ms(n,s):(e.endsWith(" ")?"":" ")+n,Kx="flow",_l="block",sa="quoted";function Ja(e,s,n="flow",{indentAtStart:i,lineWidth:r=80,minContentWidth:a=20,onFold:o,onOverflow:l}={}){if(!r||r<0)return e;r<a&&(a=0);const c=Math.max(1+a,1+r-s.length);if(e.length<=c)return e;const d=[],m={};let u=r-s.length;typeof i=="number"&&(i>r-Math.max(2,a)?d.push(0):u=r-i);let h,p,x=!1,f=-1,j=-1,b=-1;n===_l&&(f=lm(e,f,s.length),f!==-1&&(u=f+c));for(let w;w=e[f+=1];){if(n===sa&&w==="\\"){switch(j=f,e[f+1]){case"x":f+=3;break;case"u":f+=5;break;case"U":f+=9;break;default:f+=1}b=f}if(w===`
`)n===_l&&(f=lm(e,f,s.length)),u=f+s.length+c,h=void 0;else{if(w===" "&&p&&p!==" "&&p!==`
`&&p!=="	"){const z=e[f+1];z&&z!==" "&&z!==`
`&&z!=="	"&&(h=f)}if(f>=u)if(h)d.push(h),u=h+c,h=void 0;else if(n===sa){for(;p===" "||p==="	";)p=w,w=e[f+=1],x=!0;const z=f>b+1?f-2:j-1;if(m[z])return e;d.push(z),m[z]=!0,u=z+c,h=void 0}else x=!0}p=w}if(x&&l&&l(),d.length===0)return e;o&&o();let y=e.slice(0,d[0]);for(let w=0;w<d.length;++w){const z=d[w],N=d[w+1]||e.length;z===0?y=`
${s}${e.slice(0,N)}`:(n===sa&&m[z]&&(y+=`${e[z]}\\`),y+=`
${s}${e.slice(z+1,N)}`)}return y}function lm(e,s,n){let i=s,r=s+1,a=e[r];for(;a===" "||a==="	";)if(s<r+n)a=e[++s];else{do a=e[++s];while(a&&a!==`
`);i=s,r=s+1,a=e[r]}return i}const Xa=(e,s)=>({indentAtStart:s?e.indent.length:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),eo=e=>/^(%|---|\.\.\.)/m.test(e);function GT(e,s,n){if(!s||s<0)return!1;const i=s-n,r=e.length;if(r<=i)return!1;for(let a=0,o=0;a<r;++a)if(e[a]===`
`){if(a-o>i)return!0;if(o=a+1,r-o<=i)return!1}return!0}function Ri(e,s){const n=JSON.stringify(e);if(s.options.doubleQuotedAsJSON)return n;const{implicitKey:i}=s,r=s.options.doubleQuotedMinMultiLineLength,a=s.indent||(eo(e)?"  ":"");let o="",l=0;for(let c=0,d=n[c];d;d=n[++c])if(d===" "&&n[c+1]==="\\"&&n[c+2]==="n"&&(o+=n.slice(l,c)+"\\ ",c+=1,l=c,d="\\"),d==="\\")switch(n[c+1]){case"u":{o+=n.slice(l,c);const m=n.substr(c+2,4);switch(m){case"0000":o+="\\0";break;case"0007":o+="\\a";break;case"000b":o+="\\v";break;case"001b":o+="\\e";break;case"0085":o+="\\N";break;case"00a0":o+="\\_";break;case"2028":o+="\\L";break;case"2029":o+="\\P";break;default:m.substr(0,2)==="00"?o+="\\x"+m.substr(2):o+=n.substr(c,6)}c+=5,l=c+1}break;case"n":if(i||n[c+2]==='"'||n.length<r)c+=1;else{for(o+=n.slice(l,c)+`

`;n[c+2]==="\\"&&n[c+3]==="n"&&n[c+4]!=='"';)o+=`
`,c+=2;o+=a,n[c+2]===" "&&(o+="\\"),c+=1,l=c+1}break;default:c+=1}return o=l?o+n.slice(l):n,i?o:Ja(o,a,sa,Xa(s,!1))}function El(e,s){if(s.options.singleQuote===!1||s.implicitKey&&e.includes(`
`)||/[ \t]\n|\n[ \t]/.test(e))return Ri(e,s);const n=s.indent||(eo(e)?"  ":""),i="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&
${n}`)+"'";return s.implicitKey?i:Ja(i,n,Kx,Xa(s,!1))}function En(e,s){const{singleQuote:n}=s.options;let i;if(n===!1)i=Ri;else{const r=e.includes('"'),a=e.includes("'");r&&!a?i=El:a&&!r?i=Ri:i=n?El:Ri}return i(e,s)}let Il;try{Il=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{Il=/\n+(?!\n|$)/g}function na({comment:e,type:s,value:n},i,r,a){const{blockQuote:o,commentString:l,lineWidth:c}=i.options;if(!o||/\n[\t ]+$/.test(n)||/^\s*$/.test(n))return En(n,i);const d=i.indent||(i.forceBlockIndent||eo(n)?"  ":""),m=o==="literal"?!0:o==="folded"||s===Y.BLOCK_FOLDED?!1:s===Y.BLOCK_LITERAL?!0:!GT(n,c,d.length);if(!n)return m?`|
`:`>
`;let u,h;for(h=n.length;h>0;--h){const N=n[h-1];if(N!==`
`&&N!=="	"&&N!==" ")break}let p=n.substring(h);const x=p.indexOf(`
`);x===-1?u="-":n===p||x!==p.length-1?(u="+",a&&a()):u="",p&&(n=n.slice(0,-p.length),p[p.length-1]===`
`&&(p=p.slice(0,-1)),p=p.replace(Il,`$&${d}`));let f=!1,j,b=-1;for(j=0;j<n.length;++j){const N=n[j];if(N===" ")f=!0;else if(N===`
`)b=j;else break}let y=n.substring(0,b<j?b+1:j);y&&(n=n.substring(y.length),y=y.replace(/\n+/g,`$&${d}`));let z=(f?d?"2":"1":"")+u;if(e&&(z+=" "+l(e.replace(/ ?[\r\n]+/g," ")),r&&r()),!m){const N=n.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${d}`);let S=!1;const k=Xa(i,!0);o!=="folded"&&s!==Y.BLOCK_FOLDED&&(k.onOverflow=()=>{S=!0});const C=Ja(`${y}${N}${p}`,d,_l,k);if(!S)return`>${z}
${d}${C}`}return n=n.replace(/\n+/g,`$&${d}`),`|${z}
${d}${y}${n}${p}`}function HT(e,s,n,i){const{type:r,value:a}=e,{actualString:o,implicitKey:l,indent:c,indentStep:d,inFlow:m}=s;if(l&&a.includes(`
`)||m&&/[[\]{},]/.test(a))return En(a,s);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(a))return l||m||!a.includes(`
`)?En(a,s):na(e,s,n,i);if(!l&&!m&&r!==Y.PLAIN&&a.includes(`
`))return na(e,s,n,i);if(eo(a)){if(c==="")return s.forceBlockIndent=!0,na(e,s,n,i);if(l&&c===d)return En(a,s)}const u=a.replace(/\n+/g,`$&
${c}`);if(o){const h=f=>f.default&&f.tag!=="tag:yaml.org,2002:str"&&f.test?.test(u),{compat:p,tags:x}=s.doc.schema;if(x.some(h)||p?.some(h))return En(a,s)}return l?u:Ja(u,c,Kx,Xa(s,!1))}function Tr(e,s,n,i){const{implicitKey:r,inFlow:a}=s,o=typeof e.value=="string"?e:Object.assign({},e,{value:String(e.value)});let{type:l}=e;l!==Y.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(o.value)&&(l=Y.QUOTE_DOUBLE);const c=m=>{switch(m){case Y.BLOCK_FOLDED:case Y.BLOCK_LITERAL:return r||a?En(o.value,s):na(o,s,n,i);case Y.QUOTE_DOUBLE:return Ri(o.value,s);case Y.QUOTE_SINGLE:return El(o.value,s);case Y.PLAIN:return HT(o,s,n,i);default:return null}};let d=c(l);if(d===null){const{defaultKeyType:m,defaultStringType:u}=s.options,h=r&&m||u;if(d=c(h),d===null)throw new Error(`Unsupported default string type ${h}`)}return d}function Gx(e,s){const n=Object.assign({blockQuote:!0,commentString:KT,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,s);let i;switch(n.collectionStyle){case"block":i=!1;break;case"flow":i=!0;break;default:i=null}return{anchors:new Set,doc:e,flowCollectionPadding:n.flowCollectionPadding?" ":"",indent:"",indentStep:typeof n.indent=="number"?" ".repeat(n.indent):"  ",inFlow:i,options:n}}function QT(e,s){if(s.tag){const r=e.filter(a=>a.tag===s.tag);if(r.length>0)return r.find(a=>a.format===s.format)??r[0]}let n,i;if(de(s)){i=s.value;let r=e.filter(a=>a.identify?.(i));if(r.length>1){const a=r.filter(o=>o.test);a.length>0&&(r=a)}n=r.find(a=>a.format===s.format)??r.find(a=>!a.format)}else i=s,n=e.find(r=>r.nodeClass&&i instanceof r.nodeClass);if(!n){const r=i?.constructor?.name??(i===null?"null":typeof i);throw new Error(`Tag not resolved for ${r} value`)}return n}function ZT(e,s,{anchors:n,doc:i}){if(!i.directives)return"";const r=[],a=(de(e)||ye(e))&&e.anchor;a&&qx(a)&&(n.add(a),r.push(`&${a}`));const o=e.tag??(s.default?null:s.tag);return o&&r.push(i.directives.tagString(o)),r.join(" ")}function Qn(e,s,n,i){if(pe(e))return e.toString(s,n,i);if(Bs(e)){if(s.doc.directives)return e.toString(s);if(s.resolvedAliases?.has(e))throw new TypeError("Cannot stringify circular structure without alias nodes");s.resolvedAliases?s.resolvedAliases.add(e):s.resolvedAliases=new Set([e]),e=e.resolve(s.doc)}let r;const a=je(e)?e:s.doc.createNode(e,{onTagObj:c=>r=c});r??(r=QT(s.doc.schema.tags,a));const o=ZT(a,r,s);o.length>0&&(s.indentAtStart=(s.indentAtStart??0)+o.length+1);const l=typeof r.stringify=="function"?r.stringify(a,s,n,i):de(a)?Tr(a,s,n,i):a.toString(s,n,i);return o?de(a)||l[0]==="{"||l[0]==="["?`${o} ${l}`:`${o}
${s.indent}${l}`:l}function YT({key:e,value:s},n,i,r){const{allNullValues:a,doc:o,indent:l,indentStep:c,options:{commentString:d,indentSeq:m,simpleKeys:u}}=n;let h=je(e)&&e.comment||null;if(u){if(h)throw new Error("With simple keys, key nodes cannot have comments");if(ye(e)||!je(e)&&typeof e=="object"){const k="With simple keys, collection cannot be used as a key value";throw new Error(k)}}let p=!u&&(!e||h&&s==null&&!n.inFlow||ye(e)||(de(e)?e.type===Y.BLOCK_FOLDED||e.type===Y.BLOCK_LITERAL:typeof e=="object"));n=Object.assign({},n,{allNullValues:!1,implicitKey:!p&&(u||!a),indent:l+c});let x=!1,f=!1,j=Qn(e,n,()=>x=!0,()=>f=!0);if(!p&&!n.inFlow&&j.length>1024){if(u)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");p=!0}if(n.inFlow){if(a||s==null)return x&&i&&i(),j===""?"?":p?`? ${j}`:j}else if(a&&!u||s==null&&p)return j=`? ${j}`,h&&!x?j+=Qs(j,n.indent,d(h)):f&&r&&r(),j;x&&(h=null),p?(h&&(j+=Qs(j,n.indent,d(h))),j=`? ${j}
${l}:`):(j=`${j}:`,h&&(j+=Qs(j,n.indent,d(h))));let b,y,w;je(s)?(b=!!s.spaceBefore,y=s.commentBefore,w=s.comment):(b=!1,y=null,w=null,s&&typeof s=="object"&&(s=o.createNode(s))),n.implicitKey=!1,!p&&!h&&de(s)&&(n.indentAtStart=j.length+1),f=!1,!m&&c.length>=2&&!n.inFlow&&!p&&ui(s)&&!s.flow&&!s.tag&&!s.anchor&&(n.indent=n.indent.substring(2));let z=!1;const N=Qn(s,n,()=>z=!0,()=>f=!0);let S=" ";if(h||b||y){if(S=b?`
`:"",y){const k=d(y);S+=`
${ms(k,n.indent)}`}N===""&&!n.inFlow?S===`
`&&(S=`

`):S+=`
${n.indent}`}else if(!p&&ye(s)){const k=N[0],C=N.indexOf(`
`),A=C!==-1,v=n.inFlow??s.flow??s.items.length===0;if(A||!v){let P=!1;if(A&&(k==="&"||k==="!")){let _=N.indexOf(" ");k==="&"&&_!==-1&&_<C&&N[_+1]==="!"&&(_=N.indexOf(" ",_+1)),(_===-1||C<_)&&(P=!0)}P||(S=`
${n.indent}`)}}else(N===""||N[0]===`
`)&&(S="");return j+=S+N,n.inFlow?z&&i&&i():w&&!z?j+=Qs(j,n.indent,d(w)):f&&r&&r(),j}function Hx(e,s){(e==="debug"||e==="warn")&&console.warn(s)}const Ur="<<",hs={identify:e=>e===Ur||typeof e=="symbol"&&e.description===Ur,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new Y(Symbol(Ur)),{addToJSMap:Qx}),stringify:()=>Ur},JT=(e,s)=>(hs.identify(s)||de(s)&&(!s.type||s.type===Y.PLAIN)&&hs.identify(s.value))&&e?.doc.schema.tags.some(n=>n.tag===hs.tag&&n.default);function Qx(e,s,n){if(n=e&&Bs(n)?n.resolve(e.doc):n,ui(n))for(const i of n.items)$o(e,s,i);else if(Array.isArray(n))for(const i of n)$o(e,s,i);else $o(e,s,n)}function $o(e,s,n){const i=e&&Bs(n)?n.resolve(e.doc):n;if(!di(i))throw new Error("Merge sources must be maps or map aliases");const r=i.toJSON(null,e,Map);for(const[a,o]of r)s instanceof Map?s.has(a)||s.set(a,o):s instanceof Set?s.add(a):Object.prototype.hasOwnProperty.call(s,a)||Object.defineProperty(s,a,{value:o,writable:!0,enumerable:!0,configurable:!0});return s}function Zx(e,s,{key:n,value:i}){if(je(n)&&n.addToJSMap)n.addToJSMap(e,s,i);else if(JT(e,n))Qx(e,s,i);else{const r=At(n,"",e);if(s instanceof Map)s.set(r,At(i,r,e));else if(s instanceof Set)s.add(r);else{const a=XT(n,r,e),o=At(i,a,e);a in s?Object.defineProperty(s,a,{value:o,writable:!0,enumerable:!0,configurable:!0}):s[a]=o}}return s}function XT(e,s,n){if(s===null)return"";if(typeof s!="object")return String(s);if(je(e)&&n?.doc){const i=Gx(n.doc,{});i.anchors=new Set;for(const a of n.anchors.keys())i.anchors.add(a.anchor);i.inFlow=!0,i.inStringifyKey=!0;const r=e.toString(i);if(!n.mapKeyWarned){let a=JSON.stringify(r);a.length>40&&(a=a.substring(0,36)+'..."'),Hx(n.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${a}. Set mapAsMap: true to use object keys.`),n.mapKeyWarned=!0}return r}return JSON.stringify(s)}function Gc(e,s,n){const i=nr(e,void 0,n),r=nr(s,void 0,n);return new Qe(i,r)}class Qe{constructor(s,n=null){Object.defineProperty(this,_t,{value:Mx}),this.key=s,this.value=n}clone(s){let{key:n,value:i}=this;return je(n)&&(n=n.clone(s)),je(i)&&(i=i.clone(s)),new Qe(n,i)}toJSON(s,n){const i=n?.mapAsMap?new Map:{};return Zx(n,i,this)}toString(s,n,i){return s?.doc?YT(this,s,n,i):JSON.stringify(this)}}function Yx(e,s,n){return(s.inFlow??e.flow?t4:e4)(e,s,n)}function e4({comment:e,items:s},n,{blockItemPrefix:i,flowChars:r,itemIndent:a,onChompKeep:o,onComment:l}){const{indent:c,options:{commentString:d}}=n,m=Object.assign({},n,{indent:a,type:null});let u=!1;const h=[];for(let x=0;x<s.length;++x){const f=s[x];let j=null;if(je(f))!u&&f.spaceBefore&&h.push(""),ba(n,h,f.commentBefore,u),f.comment&&(j=f.comment);else if(pe(f)){const y=je(f.key)?f.key:null;y&&(!u&&y.spaceBefore&&h.push(""),ba(n,h,y.commentBefore,u))}u=!1;let b=Qn(f,m,()=>j=null,()=>u=!0);j&&(b+=Qs(b,a,d(j))),u&&j&&(u=!1),h.push(i+b)}let p;if(h.length===0)p=r.start+r.end;else{p=h[0];for(let x=1;x<h.length;++x){const f=h[x];p+=f?`
${c}${f}`:`
`}}return e?(p+=`
`+ms(d(e),c),l&&l()):u&&o&&o(),p}function t4({items:e},s,{flowChars:n,itemIndent:i}){const{indent:r,indentStep:a,flowCollectionPadding:o,options:{commentString:l}}=s;i+=a;const c=Object.assign({},s,{indent:i,inFlow:!0,type:null});let d=!1,m=0;const u=[];for(let x=0;x<e.length;++x){const f=e[x];let j=null;if(je(f))f.spaceBefore&&u.push(""),ba(s,u,f.commentBefore,!1),f.comment&&(j=f.comment);else if(pe(f)){const y=je(f.key)?f.key:null;y&&(y.spaceBefore&&u.push(""),ba(s,u,y.commentBefore,!1),y.comment&&(d=!0));const w=je(f.value)?f.value:null;w?(w.comment&&(j=w.comment),w.commentBefore&&(d=!0)):f.value==null&&y?.comment&&(j=y.comment)}j&&(d=!0);let b=Qn(f,c,()=>j=null);x<e.length-1&&(b+=","),j&&(b+=Qs(b,i,l(j))),!d&&(u.length>m||b.includes(`
`))&&(d=!0),u.push(b),m=u.length}const{start:h,end:p}=n;if(u.length===0)return h+p;if(!d){const x=u.reduce((f,j)=>f+j.length+2,2);d=s.options.lineWidth>0&&x>s.options.lineWidth}if(d){let x=h;for(const f of u)x+=f?`
${a}${r}${f}`:`
`;return`${x}
${r}${p}`}else return`${h}${o}${u.join(" ")}${o}${p}`}function ba({indent:e,options:{commentString:s}},n,i,r){if(i&&r&&(i=i.replace(/^\n+/,"")),i){const a=ms(s(i),e);n.push(a.trimStart())}}function Zs(e,s){const n=de(s)?s.value:s;for(const i of e)if(pe(i)&&(i.key===s||i.key===n||de(i.key)&&i.key.value===n))return i}class xt extends Wx{static get tagName(){return"tag:yaml.org,2002:map"}constructor(s){super(_s,s),this.items=[]}static from(s,n,i){const{keepUndefined:r,replacer:a}=i,o=new this(s),l=(c,d)=>{if(typeof a=="function")d=a.call(n,c,d);else if(Array.isArray(a)&&!a.includes(c))return;(d!==void 0||r)&&o.items.push(Gc(c,d,i))};if(n instanceof Map)for(const[c,d]of n)l(c,d);else if(n&&typeof n=="object")for(const c of Object.keys(n))l(c,n[c]);return typeof s.sortMapEntries=="function"&&o.items.sort(s.sortMapEntries),o}add(s,n){let i;pe(s)?i=s:!s||typeof s!="object"||!("key"in s)?i=new Qe(s,s?.value):i=new Qe(s.key,s.value);const r=Zs(this.items,i.key),a=this.schema?.sortMapEntries;if(r){if(!n)throw new Error(`Key ${i.key} already set`);de(r.value)&&Ux(i.value)?r.value.value=i.value:r.value=i.value}else if(a){const o=this.items.findIndex(l=>a(i,l)<0);o===-1?this.items.push(i):this.items.splice(o,0,i)}else this.items.push(i)}delete(s){const n=Zs(this.items,s);return n?this.items.splice(this.items.indexOf(n),1).length>0:!1}get(s,n){const r=Zs(this.items,s)?.value;return(!n&&de(r)?r.value:r)??void 0}has(s){return!!Zs(this.items,s)}set(s,n){this.add(new Qe(s,n),!0)}toJSON(s,n,i){const r=i?new i:n?.mapAsMap?new Map:{};n?.onCreate&&n.onCreate(r);for(const a of this.items)Zx(n,r,a);return r}toString(s,n,i){if(!s)return JSON.stringify(this);for(const r of this.items)if(!pe(r))throw new Error(`Map items must all be pairs; found ${JSON.stringify(r)} instead`);return!s.allNullValues&&this.hasAllNullValues(!1)&&(s=Object.assign({},s,{allNullValues:!0})),Yx(this,s,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:s.indent||"",onChompKeep:i,onComment:n})}}const mi={collection:"map",default:!0,nodeClass:xt,tag:"tag:yaml.org,2002:map",resolve(e,s){return di(e)||s("Expected a mapping for this tag"),e},createNode:(e,s,n)=>xt.from(e,s,n)};class Fs extends Wx{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(s){super(ci,s),this.items=[]}add(s){this.items.push(s)}delete(s){const n=Wr(s);return typeof n!="number"?!1:this.items.splice(n,1).length>0}get(s,n){const i=Wr(s);if(typeof i!="number")return;const r=this.items[i];return!n&&de(r)?r.value:r}has(s){const n=Wr(s);return typeof n=="number"&&n<this.items.length}set(s,n){const i=Wr(s);if(typeof i!="number")throw new Error(`Expected a valid index, not ${s}.`);const r=this.items[i];de(r)&&Ux(n)?r.value=n:this.items[i]=n}toJSON(s,n){const i=[];n?.onCreate&&n.onCreate(i);let r=0;for(const a of this.items)i.push(At(a,String(r++),n));return i}toString(s,n,i){return s?Yx(this,s,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(s.indent||"")+"  ",onChompKeep:i,onComment:n}):JSON.stringify(this)}static from(s,n,i){const{replacer:r}=i,a=new this(s);if(n&&Symbol.iterator in Object(n)){let o=0;for(let l of n){if(typeof r=="function"){const c=n instanceof Set?l:String(o++);l=r.call(n,c,l)}a.items.push(nr(l,void 0,i))}}return a}}function Wr(e){let s=de(e)?e.value:e;return s&&typeof s=="string"&&(s=Number(s)),typeof s=="number"&&Number.isInteger(s)&&s>=0?s:null}const hi={collection:"seq",default:!0,nodeClass:Fs,tag:"tag:yaml.org,2002:seq",resolve(e,s){return ui(e)||s("Expected a sequence for this tag"),e},createNode:(e,s,n)=>Fs.from(e,s,n)},to={identify:e=>typeof e=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify(e,s,n,i){return s=Object.assign({actualString:!0},s),Tr(e,s,n,i)}},so={identify:e=>e==null,createNode:()=>new Y(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new Y(null),stringify:({source:e},s)=>typeof e=="string"&&so.test.test(e)?e:s.options.nullStr},Hc={identify:e=>typeof e=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new Y(e[0]==="t"||e[0]==="T"),stringify({source:e,value:s},n){if(e&&Hc.test.test(e)){const i=e[0]==="t"||e[0]==="T";if(s===i)return e}return s?n.options.trueStr:n.options.falseStr}};function Wt({format:e,minFractionDigits:s,tag:n,value:i}){if(typeof i=="bigint")return String(i);const r=typeof i=="number"?i:Number(i);if(!isFinite(r))return isNaN(r)?".nan":r<0?"-.inf":".inf";let a=JSON.stringify(i);if(!e&&s&&(!n||n==="tag:yaml.org,2002:float")&&/^\d/.test(a)){let o=a.indexOf(".");o<0&&(o=a.length,a+=".");let l=s-(a.length-o-1);for(;l-- >0;)a+="0"}return a}const Jx={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>e.slice(-3).toLowerCase()==="nan"?NaN:e[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Wt},Xx={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){const s=Number(e.value);return isFinite(s)?s.toExponential():Wt(e)}},eg={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){const s=new Y(parseFloat(e)),n=e.indexOf(".");return n!==-1&&e[e.length-1]==="0"&&(s.minFractionDigits=e.length-n-1),s},stringify:Wt},no=e=>typeof e=="bigint"||Number.isInteger(e),Qc=(e,s,n,{intAsBigInt:i})=>i?BigInt(e):parseInt(e.substring(s),n);function tg(e,s,n){const{value:i}=e;return no(i)&&i>=0?n+i.toString(s):Wt(e)}const sg={identify:e=>no(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,s,n)=>Qc(e,2,8,n),stringify:e=>tg(e,8,"0o")},ng={identify:no,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,s,n)=>Qc(e,0,10,n),stringify:Wt},ig={identify:e=>no(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,s,n)=>Qc(e,2,16,n),stringify:e=>tg(e,16,"0x")},s4=[mi,hi,to,so,Hc,sg,ng,ig,Jx,Xx,eg];function cm(e){return typeof e=="bigint"||Number.isInteger(e)}const Kr=({value:e})=>JSON.stringify(e),n4=[{identify:e=>typeof e=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:Kr},{identify:e=>e==null,createNode:()=>new Y(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:Kr},{identify:e=>typeof e=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:e=>e==="true",stringify:Kr},{identify:cm,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,s,{intAsBigInt:n})=>n?BigInt(e):parseInt(e,10),stringify:({value:e})=>cm(e)?e.toString():JSON.stringify(e)},{identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:Kr}],i4={default:!0,tag:"",test:/^/,resolve(e,s){return s(`Unresolved plain scalar ${JSON.stringify(e)}`),e}},r4=[mi,hi].concat(n4,i4),Zc={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,s){if(typeof atob=="function"){const n=atob(e.replace(/[\n\r]/g,"")),i=new Uint8Array(n.length);for(let r=0;r<n.length;++r)i[r]=n.charCodeAt(r);return i}else return s("This environment does not support reading binary tags; either Buffer or atob is required"),e},stringify({comment:e,type:s,value:n},i,r,a){if(!n)return"";const o=n;let l;if(typeof btoa=="function"){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);l=btoa(c)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(s??(s=Y.BLOCK_LITERAL),s!==Y.QUOTE_DOUBLE){const c=Math.max(i.options.lineWidth-i.indent.length,i.options.minContentWidth),d=Math.ceil(l.length/c),m=new Array(d);for(let u=0,h=0;u<d;++u,h+=c)m[u]=l.substr(h,c);l=m.join(s===Y.BLOCK_LITERAL?`
`:" ")}return Tr({comment:e,type:s,value:l},i,r,a)}};function rg(e,s){if(ui(e))for(let n=0;n<e.items.length;++n){let i=e.items[n];if(!pe(i)){if(di(i)){i.items.length>1&&s("Each pair must have its own sequence indicator");const r=i.items[0]||new Qe(new Y(null));if(i.commentBefore&&(r.key.commentBefore=r.key.commentBefore?`${i.commentBefore}
${r.key.commentBefore}`:i.commentBefore),i.comment){const a=r.value??r.key;a.comment=a.comment?`${i.comment}
${a.comment}`:i.comment}i=r}e.items[n]=pe(i)?i:new Qe(i)}}else s("Expected a sequence for this tag");return e}function ag(e,s,n){const{replacer:i}=n,r=new Fs(e);r.tag="tag:yaml.org,2002:pairs";let a=0;if(s&&Symbol.iterator in Object(s))for(let o of s){typeof i=="function"&&(o=i.call(s,String(a++),o));let l,c;if(Array.isArray(o))if(o.length===2)l=o[0],c=o[1];else throw new TypeError(`Expected [key, value] tuple: ${o}`);else if(o&&o instanceof Object){const d=Object.keys(o);if(d.length===1)l=d[0],c=o[l];else throw new TypeError(`Expected tuple with one key, not ${d.length} keys`)}else l=o;r.items.push(Gc(l,c,n))}return r}const Yc={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:rg,createNode:ag};class Rn extends Fs{constructor(){super(),this.add=xt.prototype.add.bind(this),this.delete=xt.prototype.delete.bind(this),this.get=xt.prototype.get.bind(this),this.has=xt.prototype.has.bind(this),this.set=xt.prototype.set.bind(this),this.tag=Rn.tag}toJSON(s,n){if(!n)return super.toJSON(s);const i=new Map;n?.onCreate&&n.onCreate(i);for(const r of this.items){let a,o;if(pe(r)?(a=At(r.key,"",n),o=At(r.value,a,n)):a=At(r,"",n),i.has(a))throw new Error("Ordered maps must not include duplicate keys");i.set(a,o)}return i}static from(s,n,i){const r=ag(s,n,i),a=new this;return a.items=r.items,a}}Rn.tag="tag:yaml.org,2002:omap";const Jc={collection:"seq",identify:e=>e instanceof Map,nodeClass:Rn,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,s){const n=rg(e,s),i=[];for(const{key:r}of n.items)de(r)&&(i.includes(r.value)?s(`Ordered maps must not include duplicate keys: ${r.value}`):i.push(r.value));return Object.assign(new Rn,n)},createNode:(e,s,n)=>Rn.from(e,s,n)};function og({value:e,source:s},n){return s&&(e?lg:cg).test.test(s)?s:e?n.options.trueStr:n.options.falseStr}const lg={identify:e=>e===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new Y(!0),stringify:og},cg={identify:e=>e===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new Y(!1),stringify:og},a4={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>e.slice(-3).toLowerCase()==="nan"?NaN:e[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Wt},o4={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){const s=Number(e.value);return isFinite(s)?s.toExponential():Wt(e)}},l4={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){const s=new Y(parseFloat(e.replace(/_/g,""))),n=e.indexOf(".");if(n!==-1){const i=e.substring(n+1).replace(/_/g,"");i[i.length-1]==="0"&&(s.minFractionDigits=i.length)}return s},stringify:Wt},Ar=e=>typeof e=="bigint"||Number.isInteger(e);function io(e,s,n,{intAsBigInt:i}){const r=e[0];if((r==="-"||r==="+")&&(s+=1),e=e.substring(s).replace(/_/g,""),i){switch(n){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`;break}const o=BigInt(e);return r==="-"?BigInt(-1)*o:o}const a=parseInt(e,n);return r==="-"?-1*a:a}function Xc(e,s,n){const{value:i}=e;if(Ar(i)){const r=i.toString(s);return i<0?"-"+n+r.substr(1):n+r}return Wt(e)}const c4={identify:Ar,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,s,n)=>io(e,2,2,n),stringify:e=>Xc(e,2,"0b")},d4={identify:Ar,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,s,n)=>io(e,1,8,n),stringify:e=>Xc(e,8,"0")},u4={identify:Ar,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,s,n)=>io(e,0,10,n),stringify:Wt},m4={identify:Ar,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,s,n)=>io(e,2,16,n),stringify:e=>Xc(e,16,"0x")};class Fn extends xt{constructor(s){super(s),this.tag=Fn.tag}add(s){let n;pe(s)?n=s:s&&typeof s=="object"&&"key"in s&&"value"in s&&s.value===null?n=new Qe(s.key,null):n=new Qe(s,null),Zs(this.items,n.key)||this.items.push(n)}get(s,n){const i=Zs(this.items,s);return!n&&pe(i)?de(i.key)?i.key.value:i.key:i}set(s,n){if(typeof n!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);const i=Zs(this.items,s);i&&!n?this.items.splice(this.items.indexOf(i),1):!i&&n&&this.items.push(new Qe(s))}toJSON(s,n){return super.toJSON(s,n,Set)}toString(s,n,i){if(!s)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},s,{allNullValues:!0}),n,i);throw new Error("Set items must all have null values")}static from(s,n,i){const{replacer:r}=i,a=new this(s);if(n&&Symbol.iterator in Object(n))for(let o of n)typeof r=="function"&&(o=r.call(n,o,o)),a.items.push(Gc(o,null,i));return a}}Fn.tag="tag:yaml.org,2002:set";const ed={collection:"map",identify:e=>e instanceof Set,nodeClass:Fn,default:!1,tag:"tag:yaml.org,2002:set",createNode:(e,s,n)=>Fn.from(e,s,n),resolve(e,s){if(di(e)){if(e.hasAllNullValues(!0))return Object.assign(new Fn,e);s("Set items must all have null values")}else s("Expected a mapping for this tag");return e}};function td(e,s){const n=e[0],i=n==="-"||n==="+"?e.substring(1):e,r=o=>s?BigInt(o):Number(o),a=i.replace(/_/g,"").split(":").reduce((o,l)=>o*r(60)+r(l),r(0));return n==="-"?r(-1)*a:a}function dg(e){let{value:s}=e,n=o=>o;if(typeof s=="bigint")n=o=>BigInt(o);else if(isNaN(s)||!isFinite(s))return Wt(e);let i="";s<0&&(i="-",s*=n(-1));const r=n(60),a=[s%r];return s<60?a.unshift(0):(s=(s-a[0])/r,a.unshift(s%r),s>=60&&(s=(s-a[0])/r,a.unshift(s))),i+a.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const ug={identify:e=>typeof e=="bigint"||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,s,{intAsBigInt:n})=>td(e,n),stringify:dg},mg={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>td(e,!1),stringify:dg},ro={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){const s=e.match(ro.test);if(!s)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,n,i,r,a,o,l]=s.map(Number),c=s[7]?Number((s[7]+"00").substr(1,3)):0;let d=Date.UTC(n,i-1,r,a||0,o||0,l||0,c);const m=s[8];if(m&&m!=="Z"){let u=td(m,!1);Math.abs(u)<30&&(u*=60),d-=6e4*u}return new Date(d)},stringify:({value:e})=>e?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""},dm=[mi,hi,to,so,lg,cg,c4,d4,u4,m4,a4,o4,l4,Zc,hs,Jc,Yc,ed,ug,mg,ro],um=new Map([["core",s4],["failsafe",[mi,hi,to]],["json",r4],["yaml11",dm],["yaml-1.1",dm]]),mm={binary:Zc,bool:Hc,float:eg,floatExp:Xx,floatNaN:Jx,floatTime:mg,int:ng,intHex:ig,intOct:sg,intTime:ug,map:mi,merge:hs,null:so,omap:Jc,pairs:Yc,seq:hi,set:ed,timestamp:ro},h4={"tag:yaml.org,2002:binary":Zc,"tag:yaml.org,2002:merge":hs,"tag:yaml.org,2002:omap":Jc,"tag:yaml.org,2002:pairs":Yc,"tag:yaml.org,2002:set":ed,"tag:yaml.org,2002:timestamp":ro};function qo(e,s,n){const i=um.get(s);if(i&&!e)return n&&!i.includes(hs)?i.concat(hs):i.slice();let r=i;if(!r)if(Array.isArray(e))r=[];else{const a=Array.from(um.keys()).filter(o=>o!=="yaml11").map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown schema "${s}"; use one of ${a} or define customTags array`)}if(Array.isArray(e))for(const a of e)r=r.concat(a);else typeof e=="function"&&(r=e(r.slice()));return n&&(r=r.concat(hs)),r.reduce((a,o)=>{const l=typeof o=="string"?mm[o]:o;if(!l){const c=JSON.stringify(o),d=Object.keys(mm).map(m=>JSON.stringify(m)).join(", ");throw new Error(`Unknown custom tag ${c}; use one of ${d}`)}return a.includes(l)||a.push(l),a},[])}const p4=(e,s)=>e.key<s.key?-1:e.key>s.key?1:0;class ao{constructor({compat:s,customTags:n,merge:i,resolveKnownTags:r,schema:a,sortMapEntries:o,toStringDefaults:l}){this.compat=Array.isArray(s)?qo(s,"compat"):s?qo(null,s):null,this.name=typeof a=="string"&&a||"core",this.knownTags=r?h4:{},this.tags=qo(n,this.name,i),this.toStringOptions=l??null,Object.defineProperty(this,_s,{value:mi}),Object.defineProperty(this,is,{value:to}),Object.defineProperty(this,ci,{value:hi}),this.sortMapEntries=typeof o=="function"?o:o===!0?p4:null}clone(){const s=Object.create(ao.prototype,Object.getOwnPropertyDescriptors(this));return s.tags=this.tags.slice(),s}}function f4(e,s){const n=[];let i=s.directives===!0;if(s.directives!==!1&&e.directives){const c=e.directives.toString(e);c?(n.push(c),i=!0):e.directives.docStart&&(i=!0)}i&&n.push("---");const r=Gx(e,s),{commentString:a}=r.options;if(e.commentBefore){n.length!==1&&n.unshift("");const c=a(e.commentBefore);n.unshift(ms(c,""))}let o=!1,l=null;if(e.contents){if(je(e.contents)){if(e.contents.spaceBefore&&i&&n.push(""),e.contents.commentBefore){const m=a(e.contents.commentBefore);n.push(ms(m,""))}r.forceBlockIndent=!!e.comment,l=e.contents.comment}const c=l?void 0:()=>o=!0;let d=Qn(e.contents,r,()=>l=null,c);l&&(d+=Qs(d,"",a(l))),(d[0]==="|"||d[0]===">")&&n[n.length-1]==="---"?n[n.length-1]=`--- ${d}`:n.push(d)}else n.push(Qn(e.contents,r));if(e.directives?.docEnd)if(e.comment){const c=a(e.comment);c.includes(`
`)?(n.push("..."),n.push(ms(c,""))):n.push(`... ${c}`)}else n.push("...");else{let c=e.comment;c&&o&&(c=c.replace(/^\n+/,"")),c&&((!o||l)&&n[n.length-1]!==""&&n.push(""),n.push(ms(a(c),"")))}return n.join(`
`)+`
`}class pi{constructor(s,n,i){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,_t,{value:Dl});let r=null;typeof n=="function"||Array.isArray(n)?r=n:i===void 0&&n&&(i=n,n=void 0);const a=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},i);this.options=a;let{version:o}=a;i?._directives?(this.directives=i._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new Ye({version:o}),this.setSchema(o,i),this.contents=s===void 0?null:this.createNode(s,r,i)}clone(){const s=Object.create(pi.prototype,{[_t]:{value:Dl}});return s.commentBefore=this.commentBefore,s.comment=this.comment,s.errors=this.errors.slice(),s.warnings=this.warnings.slice(),s.options=Object.assign({},this.options),this.directives&&(s.directives=this.directives.clone()),s.schema=this.schema.clone(),s.contents=je(this.contents)?this.contents.clone(s.schema):this.contents,this.range&&(s.range=this.range.slice()),s}add(s){wn(this.contents)&&this.contents.add(s)}addIn(s,n){wn(this.contents)&&this.contents.addIn(s,n)}createAlias(s,n){if(!s.anchor){const i=Bx(this);s.anchor=!n||i.has(n)?Vx(n||"a",i):n}return new Ya(s.anchor)}createNode(s,n,i){let r;if(typeof n=="function")s=n.call({"":s},"",s),r=n;else if(Array.isArray(n)){const j=y=>typeof y=="number"||y instanceof String||y instanceof Number,b=n.filter(j).map(String);b.length>0&&(n=n.concat(b)),r=n}else i===void 0&&n&&(i=n,n=void 0);const{aliasDuplicateObjects:a,anchorPrefix:o,flow:l,keepUndefined:c,onTagObj:d,tag:m}=i??{},{onAnchor:u,setAnchors:h,sourceObjects:p}=VT(this,o||"a"),x={aliasDuplicateObjects:a??!0,keepUndefined:c??!1,onAnchor:u,onTagObj:d,replacer:r,schema:this.schema,sourceObjects:p},f=nr(s,m,x);return l&&ye(f)&&(f.flow=!0),h(),f}createPair(s,n,i={}){const r=this.createNode(s,null,i),a=this.createNode(n,null,i);return new Qe(r,a)}delete(s){return wn(this.contents)?this.contents.delete(s):!1}deleteIn(s){return Ai(s)?this.contents==null?!1:(this.contents=null,!0):wn(this.contents)?this.contents.deleteIn(s):!1}get(s,n){return ye(this.contents)?this.contents.get(s,n):void 0}getIn(s,n){return Ai(s)?!n&&de(this.contents)?this.contents.value:this.contents:ye(this.contents)?this.contents.getIn(s,n):void 0}has(s){return ye(this.contents)?this.contents.has(s):!1}hasIn(s){return Ai(s)?this.contents!==void 0:ye(this.contents)?this.contents.hasIn(s):!1}set(s,n){this.contents==null?this.contents=ja(this.schema,[s],n):wn(this.contents)&&this.contents.set(s,n)}setIn(s,n){Ai(s)?this.contents=n:this.contents==null?this.contents=ja(this.schema,Array.from(s),n):wn(this.contents)&&this.contents.setIn(s,n)}setSchema(s,n={}){typeof s=="number"&&(s=String(s));let i;switch(s){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Ye({version:"1.1"}),i={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=s:this.directives=new Ye({version:s}),i={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,i=null;break;default:{const r=JSON.stringify(s);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${r}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(i)this.schema=new ao(Object.assign(i,n));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:s,jsonArg:n,mapAsMap:i,maxAliasCount:r,onAnchor:a,reviver:o}={}){const l={anchors:new Map,doc:this,keep:!s,mapAsMap:i===!0,mapKeyWarned:!1,maxAliasCount:typeof r=="number"?r:100},c=At(this.contents,n??"",l);if(typeof a=="function")for(const{count:d,res:m}of l.anchors.values())a(m,d);return typeof o=="function"?_n(o,{"":c},"",c):c}toJSON(s,n){return this.toJS({json:!0,jsonArg:s,mapAsMap:!1,onAnchor:n})}toString(s={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in s&&(!Number.isInteger(s.indent)||Number(s.indent)<=0)){const n=JSON.stringify(s.indent);throw new Error(`"indent" option must be a positive integer, not ${n}`)}return f4(this,s)}}function wn(e){if(ye(e))return!0;throw new Error("Expected a YAML collection as document contents")}class sd extends Error{constructor(s,n,i,r){super(),this.name=s,this.code=i,this.message=r,this.pos=n}}class Ys extends sd{constructor(s,n,i){super("YAMLParseError",s,n,i)}}class hg extends sd{constructor(s,n,i){super("YAMLWarning",s,n,i)}}const wa=(e,s)=>n=>{if(n.pos[0]===-1)return;n.linePos=n.pos.map(l=>s.linePos(l));const{line:i,col:r}=n.linePos[0];n.message+=` at line ${i}, column ${r}`;let a=r-1,o=e.substring(s.lineStarts[i-1],s.lineStarts[i]).replace(/[\n\r]+$/,"");if(a>=60&&o.length>80){const l=Math.min(a-39,o.length-79);o="…"+o.substring(l),a-=l-1}if(o.length>80&&(o=o.substring(0,79)+"…"),i>1&&/^ *$/.test(o.substring(0,a))){let l=e.substring(s.lineStarts[i-2],s.lineStarts[i-1]);l.length>80&&(l=l.substring(0,79)+`…
`),o=l+o}if(/[^ ]/.test(o)){let l=1;const c=n.linePos[1];c&&c.line===i&&c.col>r&&(l=Math.max(1,Math.min(c.col-r,80-a)));const d=" ".repeat(a)+"^".repeat(l);n.message+=`:

${o}
${d}
`}};function Zn(e,{flow:s,indicator:n,next:i,offset:r,onError:a,parentIndent:o,startOnNewline:l}){let c=!1,d=l,m=l,u="",h="",p=!1,x=!1,f=null,j=null,b=null,y=null,w=null,z=null,N=null;for(const C of e)switch(x&&(C.type!=="space"&&C.type!=="newline"&&C.type!=="comma"&&a(C.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),x=!1),f&&(d&&C.type!=="comment"&&C.type!=="newline"&&a(f,"TAB_AS_INDENT","Tabs are not allowed as indentation"),f=null),C.type){case"space":!s&&(n!=="doc-start"||i?.type!=="flow-collection")&&C.source.includes("	")&&(f=C),m=!0;break;case"comment":{m||a(C,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const A=C.source.substring(1)||" ";u?u+=h+A:u=A,h="",d=!1;break}case"newline":d?u?u+=C.source:(!z||n!=="seq-item-ind")&&(c=!0):h+=C.source,d=!0,p=!0,(j||b)&&(y=C),m=!0;break;case"anchor":j&&a(C,"MULTIPLE_ANCHORS","A node can have at most one anchor"),C.source.endsWith(":")&&a(C.offset+C.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),j=C,N??(N=C.offset),d=!1,m=!1,x=!0;break;case"tag":{b&&a(C,"MULTIPLE_TAGS","A node can have at most one tag"),b=C,N??(N=C.offset),d=!1,m=!1,x=!0;break}case n:(j||b)&&a(C,"BAD_PROP_ORDER",`Anchors and tags must be after the ${C.source} indicator`),z&&a(C,"UNEXPECTED_TOKEN",`Unexpected ${C.source} in ${s??"collection"}`),z=C,d=n==="seq-item-ind"||n==="explicit-key-ind",m=!1;break;case"comma":if(s){w&&a(C,"UNEXPECTED_TOKEN",`Unexpected , in ${s}`),w=C,d=!1,m=!1;break}default:a(C,"UNEXPECTED_TOKEN",`Unexpected ${C.type} token`),d=!1,m=!1}const S=e[e.length-1],k=S?S.offset+S.source.length:r;return x&&i&&i.type!=="space"&&i.type!=="newline"&&i.type!=="comma"&&(i.type!=="scalar"||i.source!=="")&&a(i.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),f&&(d&&f.indent<=o||i?.type==="block-map"||i?.type==="block-seq")&&a(f,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:w,found:z,spaceBefore:c,comment:u,hasNewline:p,anchor:j,tag:b,newlineAfterProp:y,end:k,start:N??k}}function ir(e){if(!e)return null;switch(e.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(e.source.includes(`
`))return!0;if(e.end){for(const s of e.end)if(s.type==="newline")return!0}return!1;case"flow-collection":for(const s of e.items){for(const n of s.start)if(n.type==="newline")return!0;if(s.sep){for(const n of s.sep)if(n.type==="newline")return!0}if(ir(s.key)||ir(s.value))return!0}return!1;default:return!0}}function Ml(e,s,n){if(s?.type==="flow-collection"){const i=s.end[0];i.indent===e&&(i.source==="]"||i.source==="}")&&ir(s)&&n(i,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function pg(e,s,n){const{uniqueKeys:i}=e.options;if(i===!1)return!1;const r=typeof i=="function"?i:(a,o)=>a===o||de(a)&&de(o)&&a.value===o.value;return s.some(a=>r(a.key,n))}const hm="All mapping items must start at the same column";function x4({composeNode:e,composeEmptyNode:s},n,i,r,a){const o=a?.nodeClass??xt,l=new o(n.schema);n.atRoot&&(n.atRoot=!1);let c=i.offset,d=null;for(const m of i.items){const{start:u,key:h,sep:p,value:x}=m,f=Zn(u,{indicator:"explicit-key-ind",next:h??p?.[0],offset:c,onError:r,parentIndent:i.indent,startOnNewline:!0}),j=!f.found;if(j){if(h&&(h.type==="block-seq"?r(c,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in h&&h.indent!==i.indent&&r(c,"BAD_INDENT",hm)),!f.anchor&&!f.tag&&!p){d=f.end,f.comment&&(l.comment?l.comment+=`
`+f.comment:l.comment=f.comment);continue}(f.newlineAfterProp||ir(h))&&r(h??u[u.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else f.found?.indent!==i.indent&&r(c,"BAD_INDENT",hm);n.atKey=!0;const b=f.end,y=h?e(n,h,f,r):s(n,b,u,null,f,r);n.schema.compat&&Ml(i.indent,h,r),n.atKey=!1,pg(n,l.items,y)&&r(b,"DUPLICATE_KEY","Map keys must be unique");const w=Zn(p??[],{indicator:"map-value-ind",next:x,offset:y.range[2],onError:r,parentIndent:i.indent,startOnNewline:!h||h.type==="block-scalar"});if(c=w.end,w.found){j&&(x?.type==="block-map"&&!w.hasNewline&&r(c,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),n.options.strict&&f.start<w.found.offset-1024&&r(y.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const z=x?e(n,x,w,r):s(n,c,p,null,w,r);n.schema.compat&&Ml(i.indent,x,r),c=z.range[2];const N=new Qe(y,z);n.options.keepSourceTokens&&(N.srcToken=m),l.items.push(N)}else{j&&r(y.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),w.comment&&(y.comment?y.comment+=`
`+w.comment:y.comment=w.comment);const z=new Qe(y);n.options.keepSourceTokens&&(z.srcToken=m),l.items.push(z)}}return d&&d<c&&r(d,"IMPOSSIBLE","Map comment with trailing content"),l.range=[i.offset,c,d??c],l}function g4({composeNode:e,composeEmptyNode:s},n,i,r,a){const o=a?.nodeClass??Fs,l=new o(n.schema);n.atRoot&&(n.atRoot=!1),n.atKey&&(n.atKey=!1);let c=i.offset,d=null;for(const{start:m,value:u}of i.items){const h=Zn(m,{indicator:"seq-item-ind",next:u,offset:c,onError:r,parentIndent:i.indent,startOnNewline:!0});if(!h.found)if(h.anchor||h.tag||u)u&&u.type==="block-seq"?r(h.end,"BAD_INDENT","All sequence items must start at the same column"):r(c,"MISSING_CHAR","Sequence item without - indicator");else{d=h.end,h.comment&&(l.comment=h.comment);continue}const p=u?e(n,u,h,r):s(n,h.end,m,null,h,r);n.schema.compat&&Ml(i.indent,u,r),c=p.range[2],l.items.push(p)}return l.range=[i.offset,c,d??c],l}function Pr(e,s,n,i){let r="";if(e){let a=!1,o="";for(const l of e){const{source:c,type:d}=l;switch(d){case"space":a=!0;break;case"comment":{n&&!a&&i(l,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const m=c.substring(1)||" ";r?r+=o+m:r=m,o="";break}case"newline":r&&(o+=c),a=!0;break;default:i(l,"UNEXPECTED_TOKEN",`Unexpected ${d} at node end`)}s+=c.length}}return{comment:r,offset:s}}const Bo="Block collections are not allowed within flow collections",Vo=e=>e&&(e.type==="block-map"||e.type==="block-seq");function y4({composeNode:e,composeEmptyNode:s},n,i,r,a){const o=i.start.source==="{",l=o?"flow map":"flow sequence",c=a?.nodeClass??(o?xt:Fs),d=new c(n.schema);d.flow=!0;const m=n.atRoot;m&&(n.atRoot=!1),n.atKey&&(n.atKey=!1);let u=i.offset+i.start.source.length;for(let j=0;j<i.items.length;++j){const b=i.items[j],{start:y,key:w,sep:z,value:N}=b,S=Zn(y,{flow:l,indicator:"explicit-key-ind",next:w??z?.[0],offset:u,onError:r,parentIndent:i.indent,startOnNewline:!1});if(!S.found){if(!S.anchor&&!S.tag&&!z&&!N){j===0&&S.comma?r(S.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${l}`):j<i.items.length-1&&r(S.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${l}`),S.comment&&(d.comment?d.comment+=`
`+S.comment:d.comment=S.comment),u=S.end;continue}!o&&n.options.strict&&ir(w)&&r(w,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(j===0)S.comma&&r(S.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${l}`);else if(S.comma||r(S.start,"MISSING_CHAR",`Missing , between ${l} items`),S.comment){let k="";e:for(const C of y)switch(C.type){case"comma":case"space":break;case"comment":k=C.source.substring(1);break e;default:break e}if(k){let C=d.items[d.items.length-1];pe(C)&&(C=C.value??C.key),C.comment?C.comment+=`
`+k:C.comment=k,S.comment=S.comment.substring(k.length+1)}}if(!o&&!z&&!S.found){const k=N?e(n,N,S,r):s(n,S.end,z,null,S,r);d.items.push(k),u=k.range[2],Vo(N)&&r(k.range,"BLOCK_IN_FLOW",Bo)}else{n.atKey=!0;const k=S.end,C=w?e(n,w,S,r):s(n,k,y,null,S,r);Vo(w)&&r(C.range,"BLOCK_IN_FLOW",Bo),n.atKey=!1;const A=Zn(z??[],{flow:l,indicator:"map-value-ind",next:N,offset:C.range[2],onError:r,parentIndent:i.indent,startOnNewline:!1});if(A.found){if(!o&&!S.found&&n.options.strict){if(z)for(const _ of z){if(_===A.found)break;if(_.type==="newline"){r(_,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}S.start<A.found.offset-1024&&r(A.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else N&&("source"in N&&N.source&&N.source[0]===":"?r(N,"MISSING_CHAR",`Missing space after : in ${l}`):r(A.start,"MISSING_CHAR",`Missing , or : between ${l} items`));const v=N?e(n,N,A,r):A.found?s(n,A.end,z,null,A,r):null;v?Vo(N)&&r(v.range,"BLOCK_IN_FLOW",Bo):A.comment&&(C.comment?C.comment+=`
`+A.comment:C.comment=A.comment);const P=new Qe(C,v);if(n.options.keepSourceTokens&&(P.srcToken=b),o){const _=d;pg(n,_.items,C)&&r(k,"DUPLICATE_KEY","Map keys must be unique"),_.items.push(P)}else{const _=new xt(n.schema);_.flow=!0,_.items.push(P);const E=(v??C).range;_.range=[C.range[0],E[1],E[2]],d.items.push(_)}u=v?v.range[2]:A.end}}const h=o?"}":"]",[p,...x]=i.end;let f=u;if(p&&p.source===h)f=p.offset+p.source.length;else{const j=l[0].toUpperCase()+l.substring(1),b=m?`${j} must end with a ${h}`:`${j} in block collection must be sufficiently indented and end with a ${h}`;r(u,m?"MISSING_CHAR":"BAD_INDENT",b),p&&p.source.length!==1&&x.unshift(p)}if(x.length>0){const j=Pr(x,f,n.options.strict,r);j.comment&&(d.comment?d.comment+=`
`+j.comment:d.comment=j.comment),d.range=[i.offset,f,j.offset]}else d.range=[i.offset,f,f];return d}function Uo(e,s,n,i,r,a){const o=n.type==="block-map"?x4(e,s,n,i,a):n.type==="block-seq"?g4(e,s,n,i,a):y4(e,s,n,i,a),l=o.constructor;return r==="!"||r===l.tagName?(o.tag=l.tagName,o):(r&&(o.tag=r),o)}function j4(e,s,n,i,r){const a=i.tag,o=a?s.directives.tagName(a.source,h=>r(a,"TAG_RESOLVE_FAILED",h)):null;if(n.type==="block-seq"){const{anchor:h,newlineAfterProp:p}=i,x=h&&a?h.offset>a.offset?h:a:h??a;x&&(!p||p.offset<x.offset)&&r(x,"MISSING_CHAR","Missing newline after block sequence props")}const l=n.type==="block-map"?"map":n.type==="block-seq"?"seq":n.start.source==="{"?"map":"seq";if(!a||!o||o==="!"||o===xt.tagName&&l==="map"||o===Fs.tagName&&l==="seq")return Uo(e,s,n,r,o);let c=s.schema.tags.find(h=>h.tag===o&&h.collection===l);if(!c){const h=s.schema.knownTags[o];if(h&&h.collection===l)s.schema.tags.push(Object.assign({},h,{default:!1})),c=h;else return h?r(a,"BAD_COLLECTION_TYPE",`${h.tag} used for ${l} collection, but expects ${h.collection??"scalar"}`,!0):r(a,"TAG_RESOLVE_FAILED",`Unresolved tag: ${o}`,!0),Uo(e,s,n,r,o)}const d=Uo(e,s,n,r,o,c),m=c.resolve?.(d,h=>r(a,"TAG_RESOLVE_FAILED",h),s.options)??d,u=je(m)?m:new Y(m);return u.range=d.range,u.tag=o,c?.format&&(u.format=c.format),u}function fg(e,s,n){const i=s.offset,r=b4(s,e.options.strict,n);if(!r)return{value:"",type:null,comment:"",range:[i,i,i]};const a=r.mode===">"?Y.BLOCK_FOLDED:Y.BLOCK_LITERAL,o=s.source?w4(s.source):[];let l=o.length;for(let f=o.length-1;f>=0;--f){const j=o[f][1];if(j===""||j==="\r")l=f;else break}if(l===0){const f=r.chomp==="+"&&o.length>0?`
`.repeat(Math.max(1,o.length-1)):"";let j=i+r.length;return s.source&&(j+=s.source.length),{value:f,type:a,comment:r.comment,range:[i,j,j]}}let c=s.indent+r.indent,d=s.offset+r.length,m=0;for(let f=0;f<l;++f){const[j,b]=o[f];if(b===""||b==="\r")r.indent===0&&j.length>c&&(c=j.length);else{j.length<c&&n(d+j.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),r.indent===0&&(c=j.length),m=f,c===0&&!e.atRoot&&n(d,"BAD_INDENT","Block scalar values in collections must be indented");break}d+=j.length+b.length+1}for(let f=o.length-1;f>=l;--f)o[f][0].length>c&&(l=f+1);let u="",h="",p=!1;for(let f=0;f<m;++f)u+=o[f][0].slice(c)+`
`;for(let f=m;f<l;++f){let[j,b]=o[f];d+=j.length+b.length+1;const y=b[b.length-1]==="\r";if(y&&(b=b.slice(0,-1)),b&&j.length<c){const z=`Block scalar lines must not be less indented than their ${r.indent?"explicit indentation indicator":"first line"}`;n(d-b.length-(y?2:1),"BAD_INDENT",z),j=""}a===Y.BLOCK_LITERAL?(u+=h+j.slice(c)+b,h=`
`):j.length>c||b[0]==="	"?(h===" "?h=`
`:!p&&h===`
`&&(h=`

`),u+=h+j.slice(c)+b,h=`
`,p=!0):b===""?h===`
`?u+=`
`:h=`
`:(u+=h+b,h=" ",p=!1)}switch(r.chomp){case"-":break;case"+":for(let f=l;f<o.length;++f)u+=`
`+o[f][0].slice(c);u[u.length-1]!==`
`&&(u+=`
`);break;default:u+=`
`}const x=i+r.length+s.source.length;return{value:u,type:a,comment:r.comment,range:[i,x,x]}}function b4({offset:e,props:s},n,i){if(s[0].type!=="block-scalar-header")return i(s[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:r}=s[0],a=r[0];let o=0,l="",c=-1;for(let h=1;h<r.length;++h){const p=r[h];if(!l&&(p==="-"||p==="+"))l=p;else{const x=Number(p);!o&&x?o=x:c===-1&&(c=e+h)}}c!==-1&&i(c,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${r}`);let d=!1,m="",u=r.length;for(let h=1;h<s.length;++h){const p=s[h];switch(p.type){case"space":d=!0;case"newline":u+=p.source.length;break;case"comment":n&&!d&&i(p,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),u+=p.source.length,m=p.source.substring(1);break;case"error":i(p,"UNEXPECTED_TOKEN",p.message),u+=p.source.length;break;default:{const x=`Unexpected token in block scalar header: ${p.type}`;i(p,"UNEXPECTED_TOKEN",x);const f=p.source;f&&typeof f=="string"&&(u+=f.length)}}}return{mode:a,indent:o,chomp:l,comment:m,length:u}}function w4(e){const s=e.split(/\n( *)/),n=s[0],i=n.match(/^( *)/),a=[i?.[1]?[i[1],n.slice(i[1].length)]:["",n]];for(let o=1;o<s.length;o+=2)a.push([s[o],s[o+1]]);return a}function xg(e,s,n){const{offset:i,type:r,source:a,end:o}=e;let l,c;const d=(h,p,x)=>n(i+h,p,x);switch(r){case"scalar":l=Y.PLAIN,c=v4(a,d);break;case"single-quoted-scalar":l=Y.QUOTE_SINGLE,c=N4(a,d);break;case"double-quoted-scalar":l=Y.QUOTE_DOUBLE,c=k4(a,d);break;default:return n(e,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${r}`),{value:"",type:null,comment:"",range:[i,i+a.length,i+a.length]}}const m=i+a.length,u=Pr(o,m,s,n);return{value:c,type:l,comment:u.comment,range:[i,m,u.offset]}}function v4(e,s){let n="";switch(e[0]){case"	":n="a tab character";break;case",":n="flow indicator character ,";break;case"%":n="directive indicator character %";break;case"|":case">":{n=`block scalar indicator ${e[0]}`;break}case"@":case"`":{n=`reserved character ${e[0]}`;break}}return n&&s(0,"BAD_SCALAR_START",`Plain value cannot start with ${n}`),gg(e)}function N4(e,s){return(e[e.length-1]!=="'"||e.length===1)&&s(e.length,"MISSING_CHAR","Missing closing 'quote"),gg(e.slice(1,-1)).replace(/''/g,"'")}function gg(e){let s,n;try{s=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),n=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{s=/(.*?)[ \t]*\r?\n/sy,n=/[ \t]*(.*?)[ \t]*\r?\n/sy}let i=s.exec(e);if(!i)return e;let r=i[1],a=" ",o=s.lastIndex;for(n.lastIndex=o;i=n.exec(e);)i[1]===""?a===`
`?r+=a:a=`
`:(r+=a+i[1],a=" "),o=n.lastIndex;const l=/[ \t]*(.*)/sy;return l.lastIndex=o,i=l.exec(e),r+a+(i?.[1]??"")}function k4(e,s){let n="";for(let i=1;i<e.length-1;++i){const r=e[i];if(!(r==="\r"&&e[i+1]===`
`))if(r===`
`){const{fold:a,offset:o}=z4(e,i);n+=a,i=o}else if(r==="\\"){let a=e[++i];const o=S4[a];if(o)n+=o;else if(a===`
`)for(a=e[i+1];a===" "||a==="	";)a=e[++i+1];else if(a==="\r"&&e[i+1]===`
`)for(a=e[++i+1];a===" "||a==="	";)a=e[++i+1];else if(a==="x"||a==="u"||a==="U"){const l={x:2,u:4,U:8}[a];n+=C4(e,i+1,l,s),i+=l}else{const l=e.substr(i-1,2);s(i-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${l}`),n+=l}}else if(r===" "||r==="	"){const a=i;let o=e[i+1];for(;o===" "||o==="	";)o=e[++i+1];o!==`
`&&!(o==="\r"&&e[i+2]===`
`)&&(n+=i>a?e.slice(a,i+1):r)}else n+=r}return(e[e.length-1]!=='"'||e.length===1)&&s(e.length,"MISSING_CHAR",'Missing closing "quote'),n}function z4(e,s){let n="",i=e[s+1];for(;(i===" "||i==="	"||i===`
`||i==="\r")&&!(i==="\r"&&e[s+2]!==`
`);)i===`
`&&(n+=`
`),s+=1,i=e[s+1];return n||(n=" "),{fold:n,offset:s}}const S4={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function C4(e,s,n,i){const r=e.substr(s,n),o=r.length===n&&/^[0-9a-fA-F]+$/.test(r)?parseInt(r,16):NaN;if(isNaN(o)){const l=e.substr(s-2,n+2);return i(s-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${l}`),l}return String.fromCodePoint(o)}function yg(e,s,n,i){const{value:r,type:a,comment:o,range:l}=s.type==="block-scalar"?fg(e,s,i):xg(s,e.options.strict,i),c=n?e.directives.tagName(n.source,u=>i(n,"TAG_RESOLVE_FAILED",u)):null;let d;e.options.stringKeys&&e.atKey?d=e.schema[is]:c?d=T4(e.schema,r,c,n,i):s.type==="scalar"?d=A4(e,r,s,i):d=e.schema[is];let m;try{const u=d.resolve(r,h=>i(n??s,"TAG_RESOLVE_FAILED",h),e.options);m=de(u)?u:new Y(u)}catch(u){const h=u instanceof Error?u.message:String(u);i(n??s,"TAG_RESOLVE_FAILED",h),m=new Y(r)}return m.range=l,m.source=r,a&&(m.type=a),c&&(m.tag=c),d.format&&(m.format=d.format),o&&(m.comment=o),m}function T4(e,s,n,i,r){if(n==="!")return e[is];const a=[];for(const l of e.tags)if(!l.collection&&l.tag===n)if(l.default&&l.test)a.push(l);else return l;for(const l of a)if(l.test?.test(s))return l;const o=e.knownTags[n];return o&&!o.collection?(e.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(r(i,"TAG_RESOLVE_FAILED",`Unresolved tag: ${n}`,n!=="tag:yaml.org,2002:str"),e[is])}function A4({atKey:e,directives:s,schema:n},i,r,a){const o=n.tags.find(l=>(l.default===!0||e&&l.default==="key")&&l.test?.test(i))||n[is];if(n.compat){const l=n.compat.find(c=>c.default&&c.test?.test(i))??n[is];if(o.tag!==l.tag){const c=s.tagString(o.tag),d=s.tagString(l.tag),m=`Value may be parsed as either ${c} or ${d}`;a(r,"TAG_RESOLVE_FAILED",m,!0)}}return o}function P4(e,s,n){if(s){n??(n=s.length);for(let i=n-1;i>=0;--i){let r=s[i];switch(r.type){case"space":case"comment":case"newline":e-=r.source.length;continue}for(r=s[++i];r?.type==="space";)e+=r.source.length,r=s[++i];break}}return e}const D4={composeNode:jg,composeEmptyNode:nd};function jg(e,s,n,i){const r=e.atKey,{spaceBefore:a,comment:o,anchor:l,tag:c}=n;let d,m=!0;switch(s.type){case"alias":d=_4(e,s,i),(l||c)&&i(s,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":d=yg(e,s,c,i),l&&(d.anchor=l.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":d=j4(D4,e,s,n,i),l&&(d.anchor=l.source.substring(1));break;default:{const u=s.type==="error"?s.message:`Unsupported token (type: ${s.type})`;i(s,"UNEXPECTED_TOKEN",u),d=nd(e,s.offset,void 0,null,n,i),m=!1}}return l&&d.anchor===""&&i(l,"BAD_ALIAS","Anchor cannot be an empty string"),r&&e.options.stringKeys&&(!de(d)||typeof d.value!="string"||d.tag&&d.tag!=="tag:yaml.org,2002:str")&&i(c??s,"NON_STRING_KEY","With stringKeys, all keys must be strings"),a&&(d.spaceBefore=!0),o&&(s.type==="scalar"&&s.source===""?d.comment=o:d.commentBefore=o),e.options.keepSourceTokens&&m&&(d.srcToken=s),d}function nd(e,s,n,i,{spaceBefore:r,comment:a,anchor:o,tag:l,end:c},d){const m={type:"scalar",offset:P4(s,n,i),indent:-1,source:""},u=yg(e,m,l,d);return o&&(u.anchor=o.source.substring(1),u.anchor===""&&d(o,"BAD_ALIAS","Anchor cannot be an empty string")),r&&(u.spaceBefore=!0),a&&(u.comment=a,u.range[2]=c),u}function _4({options:e},{offset:s,source:n,end:i},r){const a=new Ya(n.substring(1));a.source===""&&r(s,"BAD_ALIAS","Alias cannot be an empty string"),a.source.endsWith(":")&&r(s+n.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const o=s+n.length,l=Pr(i,o,e.strict,r);return a.range=[s,o,l.offset],l.comment&&(a.comment=l.comment),a}function E4(e,s,{offset:n,start:i,value:r,end:a},o){const l=Object.assign({_directives:s},e),c=new pi(void 0,l),d={atKey:!1,atRoot:!0,directives:c.directives,options:c.options,schema:c.schema},m=Zn(i,{indicator:"doc-start",next:r??a?.[0],offset:n,onError:o,parentIndent:0,startOnNewline:!0});m.found&&(c.directives.docStart=!0,r&&(r.type==="block-map"||r.type==="block-seq")&&!m.hasNewline&&o(m.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),c.contents=r?jg(d,r,m,o):nd(d,m.end,i,null,m,o);const u=c.contents.range[2],h=Pr(a,u,!1,o);return h.comment&&(c.comment=h.comment),c.range=[n,u,h.offset],c}function vi(e){if(typeof e=="number")return[e,e+1];if(Array.isArray(e))return e.length===2?e:[e[0],e[1]];const{offset:s,source:n}=e;return[s,s+(typeof n=="string"?n.length:1)]}function pm(e){let s="",n=!1,i=!1;for(let r=0;r<e.length;++r){const a=e[r];switch(a[0]){case"#":s+=(s===""?"":i?`

`:`
`)+(a.substring(1)||" "),n=!0,i=!1;break;case"%":e[r+1]?.[0]!=="#"&&(r+=1),n=!1;break;default:n||(i=!0),n=!1}}return{comment:s,afterEmptyLine:i}}class id{constructor(s={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(n,i,r,a)=>{const o=vi(n);a?this.warnings.push(new hg(o,i,r)):this.errors.push(new Ys(o,i,r))},this.directives=new Ye({version:s.version||"1.2"}),this.options=s}decorate(s,n){const{comment:i,afterEmptyLine:r}=pm(this.prelude);if(i){const a=s.contents;if(n)s.comment=s.comment?`${s.comment}
${i}`:i;else if(r||s.directives.docStart||!a)s.commentBefore=i;else if(ye(a)&&!a.flow&&a.items.length>0){let o=a.items[0];pe(o)&&(o=o.key);const l=o.commentBefore;o.commentBefore=l?`${i}
${l}`:i}else{const o=a.commentBefore;a.commentBefore=o?`${i}
${o}`:i}}n?(Array.prototype.push.apply(s.errors,this.errors),Array.prototype.push.apply(s.warnings,this.warnings)):(s.errors=this.errors,s.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:pm(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(s,n=!1,i=-1){for(const r of s)yield*this.next(r);yield*this.end(n,i)}*next(s){switch(s.type){case"directive":this.directives.add(s.source,(n,i,r)=>{const a=vi(s);a[0]+=n,this.onError(a,"BAD_DIRECTIVE",i,r)}),this.prelude.push(s.source),this.atDirectives=!0;break;case"document":{const n=E4(this.options,this.directives,s,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(s,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(s.source);break;case"error":{const n=s.source?`${s.message}: ${JSON.stringify(s.source)}`:s.message,i=new Ys(vi(s),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(i):this.doc.errors.push(i);break}case"doc-end":{if(!this.doc){const i="Unexpected doc-end without preceding document";this.errors.push(new Ys(vi(s),"UNEXPECTED_TOKEN",i));break}this.doc.directives.docEnd=!0;const n=Pr(s.end,s.offset+s.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){const i=this.doc.comment;this.doc.comment=i?`${i}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new Ys(vi(s),"UNEXPECTED_TOKEN",`Unsupported token ${s.type}`))}}*end(s=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(s){const i=Object.assign({_directives:this.directives},this.options),r=new pi(void 0,i);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),r.range=[0,n,n],this.decorate(r,!1),yield r}}}function I4(e,s=!0,n){if(e){const i=(r,a,o)=>{const l=typeof r=="number"?r:Array.isArray(r)?r[0]:r.offset;if(n)n(l,a,o);else throw new Ys([l,l+1],a,o)};switch(e.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return xg(e,s,i);case"block-scalar":return fg({options:{strict:s}},e,i)}}return null}function M4(e,s){const{implicitKey:n=!1,indent:i,inFlow:r=!1,offset:a=-1,type:o="PLAIN"}=s,l=Tr({type:o,value:e},{implicitKey:n,indent:i>0?" ".repeat(i):"",inFlow:r,options:{blockQuote:!0,lineWidth:-1}}),c=s.end??[{type:"newline",offset:-1,indent:i,source:`
`}];switch(l[0]){case"|":case">":{const d=l.indexOf(`
`),m=l.substring(0,d),u=l.substring(d+1)+`
`,h=[{type:"block-scalar-header",offset:a,indent:i,source:m}];return bg(h,c)||h.push({type:"newline",offset:-1,indent:i,source:`
`}),{type:"block-scalar",offset:a,indent:i,props:h,source:u}}case'"':return{type:"double-quoted-scalar",offset:a,indent:i,source:l,end:c};case"'":return{type:"single-quoted-scalar",offset:a,indent:i,source:l,end:c};default:return{type:"scalar",offset:a,indent:i,source:l,end:c}}}function L4(e,s,n={}){let{afterKey:i=!1,implicitKey:r=!1,inFlow:a=!1,type:o}=n,l="indent"in e?e.indent:null;if(i&&typeof l=="number"&&(l+=2),!o)switch(e.type){case"single-quoted-scalar":o="QUOTE_SINGLE";break;case"double-quoted-scalar":o="QUOTE_DOUBLE";break;case"block-scalar":{const d=e.props[0];if(d.type!=="block-scalar-header")throw new Error("Invalid block scalar header");o=d.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:o="PLAIN"}const c=Tr({type:o,value:s},{implicitKey:r||l===null,indent:l!==null&&l>0?" ".repeat(l):"",inFlow:a,options:{blockQuote:!0,lineWidth:-1}});switch(c[0]){case"|":case">":O4(e,c);break;case'"':Wo(e,c,"double-quoted-scalar");break;case"'":Wo(e,c,"single-quoted-scalar");break;default:Wo(e,c,"scalar")}}function O4(e,s){const n=s.indexOf(`
`),i=s.substring(0,n),r=s.substring(n+1)+`
`;if(e.type==="block-scalar"){const a=e.props[0];if(a.type!=="block-scalar-header")throw new Error("Invalid block scalar header");a.source=i,e.source=r}else{const{offset:a}=e,o="indent"in e?e.indent:-1,l=[{type:"block-scalar-header",offset:a,indent:o,source:i}];bg(l,"end"in e?e.end:void 0)||l.push({type:"newline",offset:-1,indent:o,source:`
`});for(const c of Object.keys(e))c!=="type"&&c!=="offset"&&delete e[c];Object.assign(e,{type:"block-scalar",indent:o,props:l,source:r})}}function bg(e,s){if(s)for(const n of s)switch(n.type){case"space":case"comment":e.push(n);break;case"newline":return e.push(n),!0}return!1}function Wo(e,s,n){switch(e.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":e.type=n,e.source=s;break;case"block-scalar":{const i=e.props.slice(1);let r=s.length;e.props[0].type==="block-scalar-header"&&(r-=e.props[0].source.length);for(const a of i)a.offset+=r;delete e.props,Object.assign(e,{type:n,source:s,end:i});break}case"block-map":case"block-seq":{const r={type:"newline",offset:e.offset+s.length,indent:e.indent,source:`
`};delete e.items,Object.assign(e,{type:n,source:s,end:[r]});break}default:{const i="indent"in e?e.indent:-1,r="end"in e&&Array.isArray(e.end)?e.end.filter(a=>a.type==="space"||a.type==="comment"||a.type==="newline"):[];for(const a of Object.keys(e))a!=="type"&&a!=="offset"&&delete e[a];Object.assign(e,{type:n,indent:i,source:s,end:r})}}}const R4=e=>"type"in e?va(e):ia(e);function va(e){switch(e.type){case"block-scalar":{let s="";for(const n of e.props)s+=va(n);return s+e.source}case"block-map":case"block-seq":{let s="";for(const n of e.items)s+=ia(n);return s}case"flow-collection":{let s=e.start.source;for(const n of e.items)s+=ia(n);for(const n of e.end)s+=n.source;return s}case"document":{let s=ia(e);if(e.end)for(const n of e.end)s+=n.source;return s}default:{let s=e.source;if("end"in e&&e.end)for(const n of e.end)s+=n.source;return s}}}function ia({start:e,key:s,sep:n,value:i}){let r="";for(const a of e)r+=a.source;if(s&&(r+=va(s)),n)for(const a of n)r+=a.source;return i&&(r+=va(i)),r}const Ll=Symbol("break visit"),F4=Symbol("skip children"),wg=Symbol("remove item");function cn(e,s){"type"in e&&e.type==="document"&&(e={start:e.start,value:e.value}),vg(Object.freeze([]),e,s)}cn.BREAK=Ll;cn.SKIP=F4;cn.REMOVE=wg;cn.itemAtPath=(e,s)=>{let n=e;for(const[i,r]of s){const a=n?.[i];if(a&&"items"in a)n=a.items[r];else return}return n};cn.parentCollection=(e,s)=>{const n=cn.itemAtPath(e,s.slice(0,-1)),i=s[s.length-1][0],r=n?.[i];if(r&&"items"in r)return r;throw new Error("Parent collection not found")};function vg(e,s,n){let i=n(s,e);if(typeof i=="symbol")return i;for(const r of["key","value"]){const a=s[r];if(a&&"items"in a){for(let o=0;o<a.items.length;++o){const l=vg(Object.freeze(e.concat([[r,o]])),a.items[o],n);if(typeof l=="number")o=l-1;else{if(l===Ll)return Ll;l===wg&&(a.items.splice(o,1),o-=1)}}typeof i=="function"&&r==="key"&&(i=i(s,e))}}return typeof i=="function"?i(s,e):i}const oo="\uFEFF",lo="",co="",rr="",$4=e=>!!e&&"items"in e,q4=e=>!!e&&(e.type==="scalar"||e.type==="single-quoted-scalar"||e.type==="double-quoted-scalar"||e.type==="block-scalar");function B4(e){switch(e){case oo:return"<BOM>";case lo:return"<DOC>";case co:return"<FLOW_END>";case rr:return"<SCALAR>";default:return JSON.stringify(e)}}function Ng(e){switch(e){case oo:return"byte-order-mark";case lo:return"doc-mode";case co:return"flow-error-end";case rr:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(e[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const V4=Object.freeze(Object.defineProperty({__proto__:null,BOM:oo,DOCUMENT:lo,FLOW_END:co,SCALAR:rr,createScalarToken:M4,isCollection:$4,isScalar:q4,prettyToken:B4,resolveAsScalar:I4,setScalarValue:L4,stringify:R4,tokenType:Ng,visit:cn},Symbol.toStringTag,{value:"Module"}));function Ot(e){switch(e){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const fm=new Set("0123456789ABCDEFabcdef"),U4=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),Gr=new Set(",[]{}"),W4=new Set(` ,[]{}
\r	`),Ko=e=>!e||W4.has(e);class kg{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(s,n=!1){if(s){if(typeof s!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+s:s,this.lineEndPos=null}this.atEnd=!n;let i=this.next??"stream";for(;i&&(n||this.hasChars(1));)i=yield*this.parseNext(i)}atLineEnd(){let s=this.pos,n=this.buffer[s];for(;n===" "||n==="	";)n=this.buffer[++s];return!n||n==="#"||n===`
`?!0:n==="\r"?this.buffer[s+1]===`
`:!1}charAt(s){return this.buffer[this.pos+s]}continueScalar(s){let n=this.buffer[s];if(this.indentNext>0){let i=0;for(;n===" ";)n=this.buffer[++i+s];if(n==="\r"){const r=this.buffer[i+s+1];if(r===`
`||!r&&!this.atEnd)return s+i+1}return n===`
`||i>=this.indentNext||!n&&!this.atEnd?s+i:-1}if(n==="-"||n==="."){const i=this.buffer.substr(s,3);if((i==="---"||i==="...")&&Ot(this.buffer[s+3]))return-1}return s}getLine(){let s=this.lineEndPos;return(typeof s!="number"||s!==-1&&s<this.pos)&&(s=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=s),s===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[s-1]==="\r"&&(s-=1),this.buffer.substring(this.pos,s))}hasChars(s){return this.pos+s<=this.buffer.length}setNext(s){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=s,null}peek(s){return this.buffer.substr(this.pos,s)}*parseNext(s){switch(s){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let s=this.getLine();if(s===null)return this.setNext("stream");if(s[0]===oo&&(yield*this.pushCount(1),s=s.substring(1)),s[0]==="%"){let n=s.length,i=s.indexOf("#");for(;i!==-1;){const a=s[i-1];if(a===" "||a==="	"){n=i-1;break}else i=s.indexOf("#",i+1)}for(;;){const a=s[n-1];if(a===" "||a==="	")n-=1;else break}const r=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(s.length-r),this.pushNewline(),"stream"}if(this.atLineEnd()){const n=yield*this.pushSpaces(!0);return yield*this.pushCount(s.length-n),yield*this.pushNewline(),"stream"}return yield lo,yield*this.parseLineStart()}*parseLineStart(){const s=this.charAt(0);if(!s&&!this.atEnd)return this.setNext("line-start");if(s==="-"||s==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const n=this.peek(3);if((n==="---"||n==="...")&&Ot(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,n==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!Ot(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[s,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if((s==="-"||s==="?"||s===":")&&Ot(n)){const i=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=i,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const s=this.getLine();if(s===null)return this.setNext("doc");let n=yield*this.pushIndicators();switch(s[n]){case"#":yield*this.pushCount(s.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Ko),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=yield*this.parseBlockScalarHeader(),n+=yield*this.pushSpaces(!0),yield*this.pushCount(s.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let s,n,i=-1;do s=yield*this.pushNewline(),s>0?(n=yield*this.pushSpaces(!1),this.indentValue=i=n):n=0,n+=yield*this.pushSpaces(!0);while(s+n>0);const r=this.getLine();if(r===null)return this.setNext("flow");if((i!==-1&&i<this.indentNext&&r[0]!=="#"||i===0&&(r.startsWith("---")||r.startsWith("..."))&&Ot(r[3]))&&!(i===this.indentNext-1&&this.flowLevel===1&&(r[0]==="]"||r[0]==="}")))return this.flowLevel=0,yield co,yield*this.parseLineStart();let a=0;for(;r[a]===",";)a+=yield*this.pushCount(1),a+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(a+=yield*this.pushIndicators(),r[a]){case void 0:return"flow";case"#":return yield*this.pushCount(r.length-a),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Ko),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const o=this.charAt(1);if(this.flowKey||Ot(o)||o===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const s=this.charAt(0);let n=this.buffer.indexOf(s,this.pos+1);if(s==="'")for(;n!==-1&&this.buffer[n+1]==="'";)n=this.buffer.indexOf("'",n+2);else for(;n!==-1;){let a=0;for(;this.buffer[n-1-a]==="\\";)a+=1;if(a%2===0)break;n=this.buffer.indexOf('"',n+1)}const i=this.buffer.substring(0,n);let r=i.indexOf(`
`,this.pos);if(r!==-1){for(;r!==-1;){const a=this.continueScalar(r+1);if(a===-1)break;r=i.indexOf(`
`,a)}r!==-1&&(n=r-(i[r-1]==="\r"?2:1))}if(n===-1){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let s=this.pos;for(;;){const n=this.buffer[++s];if(n==="+")this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if(n!=="-")break}return yield*this.pushUntil(n=>Ot(n)||n==="#")}*parseBlockScalar(){let s=this.pos-1,n=0,i;e:for(let a=this.pos;i=this.buffer[a];++a)switch(i){case" ":n+=1;break;case`
`:s=a,n=0;break;case"\r":{const o=this.buffer[a+1];if(!o&&!this.atEnd)return this.setNext("block-scalar");if(o===`
`)break}default:break e}if(!i&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=n:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{const a=this.continueScalar(s+1);if(a===-1)break;s=this.buffer.indexOf(`
`,a)}while(s!==-1);if(s===-1){if(!this.atEnd)return this.setNext("block-scalar");s=this.buffer.length}}let r=s+1;for(i=this.buffer[r];i===" ";)i=this.buffer[++r];if(i==="	"){for(;i==="	"||i===" "||i==="\r"||i===`
`;)i=this.buffer[++r];s=r-1}else if(!this.blockScalarKeep)do{let a=s-1,o=this.buffer[a];o==="\r"&&(o=this.buffer[--a]);const l=a;for(;o===" ";)o=this.buffer[--a];if(o===`
`&&a>=this.pos&&a+1+n>l)s=a;else break}while(!0);return yield rr,yield*this.pushToIndex(s+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const s=this.flowLevel>0;let n=this.pos-1,i=this.pos-1,r;for(;r=this.buffer[++i];)if(r===":"){const a=this.buffer[i+1];if(Ot(a)||s&&Gr.has(a))break;n=i}else if(Ot(r)){let a=this.buffer[i+1];if(r==="\r"&&(a===`
`?(i+=1,r=`
`,a=this.buffer[i+1]):n=i),a==="#"||s&&Gr.has(a))break;if(r===`
`){const o=this.continueScalar(i+1);if(o===-1)break;i=Math.max(i,o-2)}}else{if(s&&Gr.has(r))break;n=i}return!r&&!this.atEnd?this.setNext("plain-scalar"):(yield rr,yield*this.pushToIndex(n+1,!0),s?"flow":"doc")}*pushCount(s){return s>0?(yield this.buffer.substr(this.pos,s),this.pos+=s,s):0}*pushToIndex(s,n){const i=this.buffer.slice(this.pos,s);return i?(yield i,this.pos+=i.length,i.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Ko))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const s=this.flowLevel>0,n=this.charAt(1);if(Ot(n)||s&&Gr.has(n))return s?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let s=this.pos+2,n=this.buffer[s];for(;!Ot(n)&&n!==">";)n=this.buffer[++s];return yield*this.pushToIndex(n===">"?s+1:s,!1)}else{let s=this.pos+1,n=this.buffer[s];for(;n;)if(U4.has(n))n=this.buffer[++s];else if(n==="%"&&fm.has(this.buffer[s+1])&&fm.has(this.buffer[s+2]))n=this.buffer[s+=3];else break;return yield*this.pushToIndex(s,!1)}}*pushNewline(){const s=this.buffer[this.pos];return s===`
`?yield*this.pushCount(1):s==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(s){let n=this.pos-1,i;do i=this.buffer[++n];while(i===" "||s&&i==="	");const r=n-this.pos;return r>0&&(yield this.buffer.substr(this.pos,r),this.pos=n),r}*pushUntil(s){let n=this.pos,i=this.buffer[n];for(;!s(i);)i=this.buffer[++n];return yield*this.pushToIndex(n,!1)}}class zg{constructor(){this.lineStarts=[],this.addNewLine=s=>this.lineStarts.push(s),this.linePos=s=>{let n=0,i=this.lineStarts.length;for(;n<i;){const a=n+i>>1;this.lineStarts[a]<s?n=a+1:i=a}if(this.lineStarts[n]===s)return{line:n+1,col:1};if(n===0)return{line:0,col:s};const r=this.lineStarts[n-1];return{line:n,col:s-r+1}}}}function Ts(e,s){for(let n=0;n<e.length;++n)if(e[n].type===s)return!0;return!1}function xm(e){for(let s=0;s<e.length;++s)switch(e[s].type){case"space":case"comment":case"newline":break;default:return s}return-1}function Sg(e){switch(e?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function Hr(e){switch(e.type){case"document":return e.start;case"block-map":{const s=e.items[e.items.length-1];return s.sep??s.start}case"block-seq":return e.items[e.items.length-1].start;default:return[]}}function vn(e){if(e.length===0)return[];let s=e.length;e:for(;--s>=0;)switch(e[s].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;e[++s]?.type==="space";);return e.splice(s,e.length)}function gm(e){if(e.start.type==="flow-seq-start")for(const s of e.items)s.sep&&!s.value&&!Ts(s.start,"explicit-key-ind")&&!Ts(s.sep,"map-value-ind")&&(s.key&&(s.value=s.key),delete s.key,Sg(s.value)?s.value.end?Array.prototype.push.apply(s.value.end,s.sep):s.value.end=s.sep:Array.prototype.push.apply(s.start,s.sep),delete s.sep)}class rd{constructor(s){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new kg,this.onNewLine=s}*parse(s,n=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const i of this.lexer.lex(s,n))yield*this.next(i);n||(yield*this.end())}*next(s){if(this.source=s,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=s.length;return}const n=Ng(s);if(n)if(n==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+s.length);break;case"space":this.atNewLine&&s[0]===" "&&(this.indent+=s.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=s.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=s.length}else{const i=`Not a YAML token: ${s}`;yield*this.pop({type:"error",offset:this.offset,message:i,source:s}),this.offset+=s.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const s=this.peek(1);if(this.type==="doc-end"&&(!s||s.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!s)return yield*this.stream();switch(s.type){case"document":return yield*this.document(s);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(s);case"block-scalar":return yield*this.blockScalar(s);case"block-map":return yield*this.blockMap(s);case"block-seq":return yield*this.blockSequence(s);case"flow-collection":return yield*this.flowCollection(s);case"doc-end":return yield*this.documentEnd(s)}yield*this.pop()}peek(s){return this.stack[this.stack.length-s]}*pop(s){const n=s??this.stack.pop();if(!n)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield n;else{const i=this.peek(1);switch(n.type==="block-scalar"?n.indent="indent"in i?i.indent:0:n.type==="flow-collection"&&i.type==="document"&&(n.indent=0),n.type==="flow-collection"&&gm(n),i.type){case"document":i.value=n;break;case"block-scalar":i.props.push(n);break;case"block-map":{const r=i.items[i.items.length-1];if(r.value){i.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}else if(r.sep)r.value=n;else{Object.assign(r,{key:n,sep:[]}),this.onKeyLine=!r.explicitKey;return}break}case"block-seq":{const r=i.items[i.items.length-1];r.value?i.items.push({start:[],value:n}):r.value=n;break}case"flow-collection":{const r=i.items[i.items.length-1];!r||r.value?i.items.push({start:[],key:n,sep:[]}):r.sep?r.value=n:Object.assign(r,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if((i.type==="document"||i.type==="block-map"||i.type==="block-seq")&&(n.type==="block-map"||n.type==="block-seq")){const r=n.items[n.items.length-1];r&&!r.sep&&!r.value&&r.start.length>0&&xm(r.start)===-1&&(n.indent===0||r.start.every(a=>a.type!=="comment"||a.indent<n.indent))&&(i.type==="document"?i.end=r.start:i.items.push({start:r.start}),n.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const s={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&s.start.push(this.sourceToken),this.stack.push(s);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(s){if(s.value)return yield*this.lineEnd(s);switch(this.type){case"doc-start":{xm(s.start)!==-1?(yield*this.pop(),yield*this.step()):s.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":s.start.push(this.sourceToken);return}const n=this.startBlockValue(s);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(s){if(this.type==="map-value-ind"){const n=Hr(this.peek(2)),i=vn(n);let r;s.end?(r=s.end,r.push(this.sourceToken),delete s.end):r=[this.sourceToken];const a={type:"block-map",offset:s.offset,indent:s.indent,items:[{start:i,key:s,sep:r}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(s)}*blockScalar(s){switch(this.type){case"space":case"comment":case"newline":s.props.push(this.sourceToken);return;case"scalar":if(s.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(s){const n=s.items[s.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,n.value){const i="end"in n.value?n.value.end:void 0;(Array.isArray(i)?i[i.length-1]:void 0)?.type==="comment"?i?.push(this.sourceToken):s.items.push({start:[this.sourceToken]})}else n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)s.items.push({start:[this.sourceToken]});else if(n.sep)n.sep.push(this.sourceToken);else{if(this.atIndentedComment(n.start,s.indent)){const r=s.items[s.items.length-2]?.value?.end;if(Array.isArray(r)){Array.prototype.push.apply(r,n.start),r.push(this.sourceToken),s.items.pop();return}}n.start.push(this.sourceToken)}return}if(this.indent>=s.indent){const i=!this.onKeyLine&&this.indent===s.indent,r=i&&(n.sep||n.explicitKey)&&this.type!=="seq-item-ind";let a=[];if(r&&n.sep&&!n.value){const o=[];for(let l=0;l<n.sep.length;++l){const c=n.sep[l];switch(c.type){case"newline":o.push(l);break;case"space":break;case"comment":c.indent>s.indent&&(o.length=0);break;default:o.length=0}}o.length>=2&&(a=n.sep.splice(o[1]))}switch(this.type){case"anchor":case"tag":r||n.value?(a.push(this.sourceToken),s.items.push({start:a}),this.onKeyLine=!0):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"explicit-key-ind":!n.sep&&!n.explicitKey?(n.start.push(this.sourceToken),n.explicitKey=!0):r||n.value?(a.push(this.sourceToken),s.items.push({start:a,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(n.explicitKey)if(n.sep)if(n.value)s.items.push({start:[],key:null,sep:[this.sourceToken]});else if(Ts(n.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]});else if(Sg(n.key)&&!Ts(n.sep,"newline")){const o=vn(n.start),l=n.key,c=n.sep;c.push(this.sourceToken),delete n.key,delete n.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:l,sep:c}]})}else a.length>0?n.sep=n.sep.concat(a,this.sourceToken):n.sep.push(this.sourceToken);else if(Ts(n.start,"newline"))Object.assign(n,{key:null,sep:[this.sourceToken]});else{const o=vn(n.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:null,sep:[this.sourceToken]}]})}else n.sep?n.value||r?s.items.push({start:a,key:null,sep:[this.sourceToken]}):Ts(n.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const o=this.flowScalar(this.type);r||n.value?(s.items.push({start:a,key:o,sep:[]}),this.onKeyLine=!0):n.sep?this.stack.push(o):(Object.assign(n,{key:o,sep:[]}),this.onKeyLine=!0);return}default:{const o=this.startBlockValue(s);if(o){if(o.type==="block-seq"){if(!n.explicitKey&&n.sep&&!Ts(n.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else i&&s.items.push({start:a});this.stack.push(o);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(s){const n=s.items[s.items.length-1];switch(this.type){case"newline":if(n.value){const i="end"in n.value?n.value.end:void 0;(Array.isArray(i)?i[i.length-1]:void 0)?.type==="comment"?i?.push(this.sourceToken):s.items.push({start:[this.sourceToken]})}else n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)s.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(n.start,s.indent)){const r=s.items[s.items.length-2]?.value?.end;if(Array.isArray(r)){Array.prototype.push.apply(r,n.start),r.push(this.sourceToken),s.items.pop();return}}n.start.push(this.sourceToken)}return;case"anchor":case"tag":if(n.value||this.indent<=s.indent)break;n.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==s.indent)break;n.value||Ts(n.start,"seq-item-ind")?s.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return}if(this.indent>s.indent){const i=this.startBlockValue(s);if(i){this.stack.push(i);return}}yield*this.pop(),yield*this.step()}*flowCollection(s){const n=s.items[s.items.length-1];if(this.type==="flow-error-end"){let i;do yield*this.pop(),i=this.peek(1);while(i&&i.type==="flow-collection")}else if(s.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?s.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?s.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?s.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const r=this.flowScalar(this.type);!n||n.value?s.items.push({start:[],key:r,sep:[]}):n.sep?this.stack.push(r):Object.assign(n,{key:r,sep:[]});return}case"flow-map-end":case"flow-seq-end":s.end.push(this.sourceToken);return}const i=this.startBlockValue(s);i?this.stack.push(i):(yield*this.pop(),yield*this.step())}else{const i=this.peek(2);if(i.type==="block-map"&&(this.type==="map-value-ind"&&i.indent===s.indent||this.type==="newline"&&!i.items[i.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&i.type!=="flow-collection"){const r=Hr(i),a=vn(r);gm(s);const o=s.end.splice(1,s.end.length);o.push(this.sourceToken);const l={type:"block-map",offset:s.offset,indent:s.indent,items:[{start:a,key:s,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=l}else yield*this.lineEnd(s)}}flowScalar(s){if(this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}return{type:s,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(s){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const n=Hr(s),i=vn(n);return i.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const n=Hr(s),i=vn(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(s,n){return this.type!=="comment"||this.indent<=n?!1:s.every(i=>i.type==="newline"||i.type==="space")}*documentEnd(s){this.type!=="doc-mode"&&(s.end?s.end.push(this.sourceToken):s.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(s){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:s.end?s.end.push(this.sourceToken):s.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function Cg(e){const s=e.prettyErrors!==!1;return{lineCounter:e.lineCounter||s&&new zg||null,prettyErrors:s}}function K4(e,s={}){const{lineCounter:n,prettyErrors:i}=Cg(s),r=new rd(n?.addNewLine),a=new id(s),o=Array.from(a.compose(r.parse(e)));if(i&&n)for(const l of o)l.errors.forEach(wa(e,n)),l.warnings.forEach(wa(e,n));return o.length>0?o:Object.assign([],{empty:!0},a.streamInfo())}function Tg(e,s={}){const{lineCounter:n,prettyErrors:i}=Cg(s),r=new rd(n?.addNewLine),a=new id(s);let o=null;for(const l of a.compose(r.parse(e),!0,e.length))if(!o)o=l;else if(o.options.logLevel!=="silent"){o.errors.push(new Ys(l.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return i&&n&&(o.errors.forEach(wa(e,n)),o.warnings.forEach(wa(e,n))),o}function G4(e,s,n){let i;typeof s=="function"?i=s:n===void 0&&s&&typeof s=="object"&&(n=s);const r=Tg(e,n);if(!r)return null;if(r.warnings.forEach(a=>Hx(r.options.logLevel,a)),r.errors.length>0){if(r.options.logLevel!=="silent")throw r.errors[0];r.errors=[]}return r.toJS(Object.assign({reviver:i},n))}function H4(e,s,n){let i=null;if(typeof s=="function"||Array.isArray(s)?i=s:n===void 0&&s&&(n=s),typeof n=="string"&&(n=n.length),typeof n=="number"){const r=Math.round(n);n=r<1?void 0:r>8?{indent:8}:{indent:r}}if(e===void 0){const{keepUndefined:r}=n??s??{};if(!r)return}return hn(e)&&!i?e.toString(n):new pi(e,i,n).toString(n)}const Q4=Object.freeze(Object.defineProperty({__proto__:null,Alias:Ya,CST:V4,Composer:id,Document:pi,Lexer:kg,LineCounter:zg,Pair:Qe,Parser:rd,Scalar:Y,Schema:ao,YAMLError:sd,YAMLMap:xt,YAMLParseError:Ys,YAMLSeq:Fs,YAMLWarning:hg,isAlias:Bs,isCollection:ye,isDocument:hn,isMap:di,isNode:je,isPair:pe,isScalar:de,isSeq:ui,parse:G4,parseAllDocuments:K4,parseDocument:Tg,stringify:H4,visit:pn,visitAsync:Za},Symbol.toStringTag,{value:"Module"})),ym=e=>e.toLowerCase().replace(/[^\p{Letter}\p{Number}]+/gu,"-").replace(/(^-|-$)/g,"")||"sekcja",Z4=(e,s)=>{const n=e.split(/\n(?=##\s+)/g);return n.length<=1&&!/^##\s+/.test(e)?[{id:ym(s||"Sekcja 1"),title:s||"Sekcja 1",content:e}]:n.map((i,r)=>{const o=(i.match(/^##\s+(.+?)\s*$/m)?.[1]||`Sekcja ${r+1}`).trim(),l=i.replace(/^##\s+.+?\n/,"").trim();return{id:ym(o),title:o,content:l}})},Y4=/```quiz\s*?\n([\s\S]*?)```/g,J4=(e,s,n)=>{try{const i=Q4.parse(e),r=(i?.options||[]).map(String);return!i?.question||!Array.isArray(i?.options)||typeof i?.answerIndex!="number"||i.answerIndex<0||i.answerIndex>=r.length?null:{question:i.question,options:r,answerIndex:i.answerIndex,key:`${s}:${n}`}}catch{return null}},X4=e=>new Map(e.map(s=>[s.id,[...s.content.matchAll(Y4)].map((n,i)=>J4(n[1],s.id,i)).filter(Boolean)])),eA=()=>t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6",children:[t.jsx("div",{className:"h-5 w-24 rounded bg-muted/60"}),t.jsxs("div",{className:"rounded-2xl border bg-card p-6 shadow-soft animate-pulse",children:[t.jsx("div",{className:"h-6 w-2/3 rounded bg-muted/60 mb-2"}),t.jsx("div",{className:"h-4 w-40 rounded bg-muted/60"})]}),t.jsx("div",{className:"space-y-3",children:Array.from({length:10}).map((e,s)=>t.jsx("div",{className:"h-4 w-full rounded bg-muted/50"},s))}),t.jsx("div",{className:"h-10 w-48 rounded-lg bg-muted/60 ml-auto"})]}),jm={code:({inline:e,className:s="",children:n,...i})=>{const r=(s||"").toLowerCase();return!e&&r.includes("language-quiz")?null:t.jsx("code",{className:s,...i,children:n})},pre:e=>((Array.isArray(e.children)?e.children[0]:e.children)?.props?.className?.toLowerCase?.()||"").includes("language-quiz")?null:t.jsx("pre",{...e})},tA=({quiz:e,onClose:s,onPass:n})=>{const[i,r]=L.useState(null),[a,o]=L.useState(!1),l=()=>{const c=i!==null&&i===e.answerIndex;o(c),c?($.success("Poprawna odpowiedź!"),setTimeout(n,200)):$.error("Niepoprawna odpowiedź — spróbuj ponownie.")};return t.jsxs("div",{className:"fixed inset-0 z-[90] flex items-end sm:items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:s}),t.jsxs("div",{className:"relative z-[91] w-full sm:max-w-lg bg-background rounded-t-2xl sm:rounded-2xl border shadow-2xl p-4 sm:p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:"Pytanie kontrolne"}),t.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-muted","aria-label":"Zamknij",children:t.jsx(lt,{className:"h-5 w-5"})})]}),t.jsx("p",{className:"mb-3 text-sm sm:text-base",children:e.question}),t.jsx("div",{className:"space-y-2 mb-4",children:e.options.map((c,d)=>t.jsxs("label",{className:"flex items-center gap-2 rounded-md border px-3 py-2 cursor-pointer hover:bg-muted",children:[t.jsx("input",{type:"radio",name:"quiz-choice",className:"h-4 w-4",checked:i===d,onChange:()=>r(d),disabled:a}),t.jsx("span",{className:"text-sm",children:c})]},d))}),t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:s,className:"rounded-lg border px-3 py-1.5 text-sm hover:bg-muted",children:"Anuluj"}),t.jsx("button",{onClick:l,className:"rounded-lg border px-3 py-1.5 text-sm font-medium hover:bg-muted",disabled:a,children:"Zatwierdź"})]})]})]})},sA=()=>{const e=L.useRef(null);return{ref:e,say:n=>{e.current&&(e.current.textContent="",setTimeout(()=>e.current&&(e.current.textContent=n),30))}}},bm=(e,s)=>{const[n,i]=L.useState(()=>{try{const r=localStorage.getItem(e);return r?JSON.parse(r):s}catch{return s}});return L.useEffect(()=>{try{localStorage.setItem(e,JSON.stringify(n))}catch(r){console.error("Błąd zapisu do localStorage:",r)}},[e,n]),[n,i]},nA=()=>{const{courseId:e,lessonId:s}=tt(),n=H(),{data:i,isLoading:r}=Fe({resource:"activities",id:s,meta:{select:"*, topics(title, course_id, courses(title, icon_emoji))"}}),a=i?.data??{},o=a?.content_md??a?.markdown??a?.content,l=L.useMemo(()=>o?Z4(o,a?.title??"Sekcja"):[],[o,a?.title]),c=L.useMemo(()=>X4(l),[l]),d=`lesson-progress:${s}`,m=`lesson-quiz:${s}`,[u,h]=bm(d,Object.fromEntries(l.map(A=>[A.id,!1]))),[p,x]=bm(m,{}),[f,j]=L.useState(null);L.useEffect(()=>{l.length&&h(A=>{const v={};return l.forEach(P=>v[P.id]=A[P.id]??!1),v})},[l.map(A=>A.id).join("|")]);const{ref:b,say:y}=sA(),w=l.findIndex(A=>!u[A.id]),z=w===-1,N=A=>{const[v]=c.get(A)??[];v&&j(v)},S=A=>{const v=l[A];if(!v||!(w===-1||A<=w)&&!u[v.id])return;if(u[v.id]){h(E=>({...E,[v.id]:!1})),y(`Sekcja ${A+1} cofnięta.`);return}(c.get(v.id)??[]).length>0?N(v.id):(h(E=>({...E,[v.id]:!0})),y(`Sekcja ${A+1} odhaczona.`))},k=()=>{const A=f;if(j(null),!A)return;x(_=>({..._,[A.key]:!0}));const v=A.key.split(":")[0];h(_=>({..._,[v]:!0}));const P=l.findIndex(_=>_.id===v);y(`Sekcja ${P+1} odhaczona po pytaniu kontrolnym.`)},C=async()=>{if(!z)return $.info("Najpierw odhacz wszystkie sekcje po kolei.");try{await se.rpc("start_activity",{p_activity_id:parseInt(s)});const{data:A,error:v}=await se.rpc("complete_material",{p_activity_id:parseInt(s)});if(v)throw v;if(A){$.success("Lekcja ukończona!"),el("get_course_structure"),el("get_my_courses");try{localStorage.removeItem(d),localStorage.removeItem(m)}catch(P){console.error("Błąd zapisu do localStorage:",P)}n(`/student/courses/${e}`)}}catch{$.error("Nie udało się ukończyć lekcji")}};return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-10 pb-28 lg:pb-16",children:[t.jsx("div",{ref:b,"aria-live":"polite",className:"sr-only"}),t.jsxs("button",{onClick:()=>n(`/student/courses/${e}`),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[t.jsx(me,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Powrót do kursu"})]}),t.jsx("section",{className:"relative overflow-hidden rounded-2xl border bg-white dark:bg-card",children:t.jsx("div",{className:"relative z-10 p-5 sm:p-7 md:p-10",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"text-4xl md:text-5xl leading-none",children:a?.topics?.courses?.icon_emoji||"📚"}),t.jsxs("div",{className:"min-w-0",children:[t.jsxs("div",{className:"text-xs sm:text-sm text-muted-foreground flex items-center gap-2",children:[t.jsx("span",{className:"truncate",children:a?.topics?.courses?.title||"…"}),t.jsx("span",{children:"•"}),t.jsx("span",{className:"truncate",children:a?.topics?.title||"…"})]}),t.jsx("h1",{className:"mt-1 text-xl md:text-3xl font-bold tracking-tight",children:a?.title||"Ładowanie…"}),a?.duration_min&&t.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 rounded-full border bg-white/70 dark:bg-background/60 px-3 py-1.5 shadow-soft",children:[t.jsx(qt,{className:"h-4 w-4"}),t.jsxs("span",{className:"text-sm font-medium",children:[a?.duration_min," min czytania"]})]})]})]})})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_280px] gap-10",children:[t.jsx("main",{children:r?t.jsx(eA,{}):t.jsxs("section",{children:[t.jsx("div",{className:"prose prose-neutral dark:prose-invert max-w-[72ch] mx-auto prose-headings:font-semibold prose-p:text-muted-foreground prose-p:leading-relaxed prose-li:leading-relaxed prose-headings:tracking-tight prose-img:rounded-xl prose-blockquote:rounded-xl md:prose-lg",children:l.length?l.map((A,v)=>{const P=!!u[A.id],_=!P&&v===w,D=!(w===-1||v<=w)&&!P,ee=(c.get(A.id)??[])[0],We="rounded-[20px] border p-6 sm:p-7 md:p-8 shadow-sm transition-colors duration-200",Z=P?"bg-emerald-50 dark:bg-emerald-950/25 border-emerald-300":_?"bg-white dark:bg-background border-neutral-200 shadow-md":D?"bg-white dark:bg-card border-dashed border-muted-foreground/40":"bg-white dark:bg-card border-neutral-200",J=!P&&D?"filter blur-[2px] select-none pointer-events-none":"";return t.jsxs("div",{id:A.id,className:"mb-12 scroll-mt-28",children:[t.jsxs("div",{className:`${We} ${Z}`,children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[D&&t.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-[11px] text-muted-foreground bg-white",children:[t.jsx(Bi,{className:"h-3.5 w-3.5"}),"Zablokowana"]}),P&&t.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-emerald-300/60 bg-emerald-50/60 px-2.5 py-0.5 text-[11px] text-emerald-700 dark:text-emerald-300",children:[t.jsx(ze,{className:"h-3.5 w-3.5"}),"Ukończona"]}),_&&!P&&t.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border bg-white px-2.5 py-0.5 text-[11px]",children:[t.jsx(Qr,{className:"h-3.5 w-3.5"}),"W trakcie"]}),ee&&t.jsxs("button",{type:"button",onClick:()=>!P&&!D&&N(A.id),disabled:P||D,className:["inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-[11px]",P?"text-emerald-700 border-emerald-300/60 bg-emerald-50/60 dark:bg-emerald-950/25":D?"text-muted-foreground cursor-not-allowed bg-white dark:bg-background/40":"bg-white hover:bg-muted"].join(" "),title:P?"Pytanie rozwiązane":D?"Najpierw odblokuj sekcję":"Kliknij, aby odpowiedzieć","aria-label":"Pytanie kontrolne",children:[t.jsx(ct,{className:"h-3.5 w-3.5"}),ee.question.length>72?ee.question.slice(0,69)+"…":ee.question]})]}),t.jsxs("div",{className:J,children:[t.jsx("h2",{className:"text-[22px] md:text-[26px] font-semibold tracking-tight m-0 mb-4",children:A.title||`Sekcja ${v+1}`}),t.jsx(Mn,{remarkPlugins:[cl],components:jm,children:A.content})]}),t.jsx("div",{className:"mt-6 flex justify-end",children:t.jsxs("label",{className:["inline-flex items-center gap-3",D?"cursor-not-allowed opacity-60":"cursor-pointer"].join(" "),title:D?"Najpierw ukończ poprzednie sekcje":P?"Sekcja odhaczona — klik, aby cofnąć":ee?"Kliknij, aby odpowiedzieć na pytanie":"Odhacz sekcję",children:[t.jsx("input",{type:"checkbox",className:"sr-only",checked:P,onChange:()=>!D&&S(v),disabled:D&&!P,"aria-label":`Odhacz sekcję: ${A.title||`Sekcja ${v+1}`}`}),t.jsx("span",{className:["inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm font-medium shadow-soft transition-all",P?"bg-emerald-50/70 dark:bg-emerald-950/30 border-emerald-300/60 text-emerald-700 dark:text-emerald-300":"bg-white hover:bg-muted border-neutral-200"].join(" "),children:ee&&!P?t.jsx("span",{className:"truncate max-w-[56ch]",children:ee.question}):t.jsxs(t.Fragment,{children:[P?t.jsx(ze,{className:"h-4 w-4"}):t.jsx(Qr,{className:"h-4 w-4"}),t.jsxs("span",{className:"whitespace-nowrap",children:[String(v+1).padStart(2,"0")," • ",P?"Odhaczono":ee?"Odhacz (pytanie)":"Odhacz sekcję"]})]})})]})})]}),t.jsx("div",{className:"h-8"})]},A.id)}):o?t.jsx(Mn,{remarkPlugins:[cl],components:jm,children:o}):t.jsx("div",{dangerouslySetInnerHTML:{__html:a?.content||""}})}),!!l.length&&t.jsx("div",{className:"mt-10 flex justify-end",children:t.jsx("button",{onClick:C,className:"inline-flex items-center gap-2 rounded-lg border bg-white px-4 py-2 text-sm font-medium shadow-soft hover:bg-muted transition-colors disabled:opacity-60",disabled:!z,title:z?void 0:"Najpierw odhacz wszystkie sekcje",children:"Zakończ lekcję"})})]})}),t.jsx("aside",{children:t.jsxs("nav",{className:"border rounded-[14px] p-4 bg-white dark:bg-background/60 lg:sticky lg:top-28",children:[t.jsx("h2",{className:"text-sm font-semibold mb-3",children:"Spis treści"}),r?t.jsx("div",{className:"h-4 w-40 rounded bg-muted/60 animate-pulse"}):l.length?t.jsx("ol",{className:"space-y-1.5 text-sm",children:l.map((A,v)=>{const P=!!u[A.id],_=!P&&v===w,D=!(w===-1||v<=w)&&!P;return t.jsxs("li",{className:"flex items-center gap-1.5",children:[D?t.jsx(Bi,{className:"h-3.5 w-3.5 text-muted-foreground"}):P?t.jsx(ze,{className:"h-3.5 w-3.5 text-emerald-600"}):t.jsx(Qr,{className:"h-3.5 w-3.5"}),t.jsxs("a",{href:`#${A.id}`,className:["flex-1 block px-2 py-1 rounded transition-colors",D?"text-muted-foreground pointer-events-none":"hover:bg-muted",P?"text-emerald-700":"",_?"font-semibold underline":""].join(" "),"aria-disabled":D,children:[String(v+1).padStart(2,"0"),". ",A.title||`Sekcja ${v+1}`]})]},A.id)})}):t.jsx("p",{className:"text-sm text-muted-foreground",children:"Brak sekcji."})]})})]}),f&&t.jsx(tA,{quiz:f,onClose:()=>j(null),onPass:k})]})},iA=()=>{const{courseId:e,quizId:s}=tt(),n=H(),[i,r]=L.useState(0),[a,o]=L.useState({}),[l,c]=L.useState(null),[d,m]=L.useState(!1),[u,h]=L.useState([]),[p,x]=L.useState(!0),{data:f,isLoading:j}=Fe({resource:"activities",id:s,meta:{select:"*, topics(title, course_id, courses(title, icon_emoji))"}});L.useEffect(()=>{(async()=>{if(s)try{await se.rpc("start_activity",{p_activity_id:parseInt(s)}),x(!0);const{data:k,error:C}=await se.rpc("get_quiz_questions",{p_activity_id:parseInt(s)});if(C)throw C;const A=typeof k=="string"?JSON.parse(k):k;h(Array.isArray(A)?A:[])}catch(k){console.error("Quiz init error:",k),$.error("Błąd podczas ładowania quizu")}finally{x(!1)}})()},[s]),L.useEffect(()=>{f?.data?.time_limit&&l===null&&c(f.data.time_limit*60)},[f]),L.useEffect(()=>{if(l!==null&&l>0){const S=setTimeout(()=>c(l-1),1e3);return()=>clearTimeout(S)}else l===0&&N()},[l]);const b=f?.data,y=u[i],w=u.length>0?(i+1)/u.length*100:0,z=(S,k)=>{o(C=>({...C,[S]:k}))},N=async()=>{m(!0);try{const S=Object.entries(a).map(([A,v])=>({question_id:parseInt(A),option_id:v})),{data:k,error:C}=await se.rpc("finish_quiz",{p_activity_id:parseInt(s),p_answers:S});if(C)throw C;if(k){const{score:A,passed:v,points_earned:P}=k;v?$.success(`Quiz zaliczony! Wynik: ${A}%`):$.error(`Quiz niezaliczony. Wynik: ${A}%`),el("get_course_structure"),n(`/student/courses/${e}`)}}catch{$.error("Nie udało się przesłać odpowiedzi")}finally{m(!1)}};return j||p?t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-300"})}):t.jsxs("div",{className:"max-w-3xl mx-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-8",children:[t.jsxs("button",{onClick:()=>n(`/student/courses/${e}`),className:"flex items-center gap-2 text-gray-500 hover:text-gray-900 transition-colors",children:[t.jsx(me,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Zakończ quiz"})]}),l!==null&&t.jsxs("div",{className:O("flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium",l<60?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:[t.jsx(qt,{className:"w-4 h-4"}),Math.floor(l/60),":",String(l%60).padStart(2,"0")]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:b?.title}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[t.jsxs("span",{children:["Pytanie ",i+1," z ",u.length]}),t.jsx("span",{children:"•"}),t.jsxs("span",{children:[y?.points," pkt"]})]})]}),t.jsx("div",{className:"h-1 bg-gray-100 rounded-full overflow-hidden mb-8",children:t.jsx(Ce.div,{initial:{width:0},animate:{width:`${w}%`},className:"h-full bg-gray-900"})}),t.jsx(XS,{mode:"wait",children:y&&t.jsx(Ce.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:t.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-8 mb-8",children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-6",children:y.question}),t.jsx("div",{className:"space-y-3",children:y.options.map(S=>t.jsx("label",{className:O("block p-4 rounded-xl border-2 cursor-pointer transition-all",a[y.id]===S.id?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-300"),children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"radio",name:`question-${y.id}`,value:S.id,checked:a[y.id]===S.id,onChange:()=>z(y.id,S.id),className:"sr-only"}),t.jsx("div",{className:O("w-5 h-5 rounded-full border-2 flex items-center justify-center",a[y.id]===S.id?"border-gray-900":"border-gray-300"),children:a[y.id]===S.id&&t.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-gray-900"})}),t.jsx("span",{className:"flex-1",children:S.text})]})},S.id))})]})},y.id)}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("button",{onClick:()=>r(Math.max(0,i-1)),disabled:i===0,className:O("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all",i===0?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"),children:[t.jsx(me,{className:"w-4 h-4"}),"Poprzednie"]}),t.jsx("div",{className:"flex gap-2",children:u.map((S,k)=>t.jsx("button",{onClick:()=>r(k),className:O("w-2 h-2 rounded-full transition-all",k===i?"bg-gray-900 w-8":a[u[k]?.id]?"bg-gray-600":"bg-gray-300")},k))}),i<u.length-1?t.jsxs("button",{onClick:()=>r(i+1),disabled:!a[y?.id],className:O("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all",a[y?.id]?"bg-gray-900 text-white hover:bg-gray-800":"bg-gray-100 text-gray-400 cursor-not-allowed"),children:["Następne",t.jsx(Ze,{className:"w-4 h-4"})]}):t.jsxs("button",{onClick:N,disabled:d||Object.keys(a).length<u.length,className:O("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all",d||Object.keys(a).length<u.length?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-green-500 text-white hover:bg-green-600"),children:[d?"Przesyłanie...":"Zakończ quiz",t.jsx(ze,{className:"w-4 h-4"})]})]})]})},rA={"⚡":$t,"🚀":Jn,"🧠":Vn,"☕":cj,"📚":lj},aA=()=>t.jsxs("div",{className:"rounded-2xl border bg-card p-6 shadow-soft animate-pulse",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-muted/70"}),t.jsxs("div",{children:[t.jsx("div",{className:"h-4 w-40 rounded bg-muted/70"}),t.jsx("div",{className:"mt-2 h-3 w-24 rounded bg-muted/60"})]})]}),t.jsx("div",{className:"h-5 w-16 rounded-full bg-muted/60"})]}),t.jsxs("div",{className:"space-y-3 mb-4",children:[t.jsx("div",{className:"h-3 w-full rounded bg-muted/60"}),t.jsx("div",{className:"h-3 w-2/3 rounded bg-muted/60"})]}),t.jsx("div",{className:"h-10 w-full rounded-lg bg-muted/60"})]}),oA=()=>{const{stats:e,refetch:s}=ur(),{data:n,isLoading:i,refetch:r}=La("get_idle_upgrades"),a=async l=>{try{const{data:c,error:d}=await se.rpc("buy_idle_upgrade",{p_upgrade_id:l});if(d)throw d;c&&($.success(`Ulepszenie zakupione! Poziom ${c.new_level}`),s(),r())}catch{$.error("Niewystarczająca ilość punktów")}},o=n||[];return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs(Ce.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),t.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),t.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:t.jsxs("div",{className:"grid gap-4 md:grid-cols-12 md:items-center",children:[t.jsxs("div",{className:"md:col-span-4 space-y-2",children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Ulepszenia"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Inwestuj punkty, aby zwiększyć tempo zdobywania kolejnych."})]}),t.jsxs("div",{className:"md:col-span-8 grid grid-cols-3 gap-4 md:gap-6",children:[t.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Punkty / h"}),t.jsx(Xs,{className:"h-4 w-4 text-accent"})]}),t.jsx("div",{className:"mt-2 flex items-end gap-2",children:t.jsx("span",{className:"text-4xl md:text-5xl font-semibold text-accent leading-none tabular-nums",children:t.jsx(Be,{value:e.idle_rate})})}),t.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Pasywne tempo zdobywania punktów."})]}),t.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Twoje punkty"}),t.jsx($t,{className:"h-4 w-4 text-primary"})]}),t.jsxs("div",{className:"mt-2 flex items-end gap-2",children:[t.jsx("span",{className:"text-4xl md:text-5xl font-semibold text-primary leading-none tabular-nums",children:t.jsx(Be,{value:e.points})}),t.jsx("span",{className:"mb-[2px] text-sm text-muted-foreground",children:"pkt"})]}),t.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Wydaj je na ulepszenia poniżej."})]}),t.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Do kolejnego poziomu"}),t.jsx(Jn,{className:"h-4 w-4 text-secondary"})]}),t.jsx("div",{className:"mt-3",children:t.jsx(Hn,{value:e.points%100})}),t.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["Pozostało ",100-e.points%100," pkt"]})]})]})]})})]}),t.jsxs(Ce.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"space-y-4",children:[t.jsx("div",{className:"flex items-center justify-between gap-4",children:t.jsxs("div",{className:"min-w-0",children:[t.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-semibold tracking-tight",children:"Dostępne ulepszenia"}),t.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Wybierz i zwiększ swoje tempo zdobywania punktów."})]})}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-5",children:[i&&Array.from({length:6}).map((l,c)=>t.jsx(aA,{},c)),!i&&o.map((l,c)=>{const d=e.points>=l.next_cost,m=rA[l.icon]||$t;return t.jsxs(Cr,{index:c,className:O("group relative rounded-2xl border bg-card p-5 shadow-soft hover:bg-muted/40 transition-colors"),children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-muted flex items-center justify-center shrink-0",children:t.jsx(m,{className:"w-6 h-6 text-muted-foreground"})}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h4",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:l.name}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Poziom ",l.current_level]})]})]}),t.jsx("span",{className:O("inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-semibold border",d?"border-primary/30 text-primary":"border-muted-foreground/25 text-muted-foreground"),children:d?"Dostępne":"Za drogie"})]}),t.jsxs("div",{className:"mt-4 space-y-3",children:[t.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Aktualny bonus"}),t.jsxs("span",{className:"font-medium text-green-600 dark:text-green-400",children:["+",t.jsx(Be,{value:l.total_bonus})," pkt/h"]})]}),t.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Następny poziom"}),t.jsxs("span",{className:"font-medium",children:["+",l.bonus_per_level," pkt/h"]})]})]}),t.jsxs(Ce.button,{whileHover:d?{scale:1.02}:{},whileTap:d?{scale:.98}:{},onClick:()=>a(l.id),disabled:!d,className:O("mt-4 w-full py-2.5 sm:py-3 rounded-lg font-medium focus-ring transition-colors",d?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-muted text-muted-foreground cursor-not-allowed"),title:d?"Kup ulepszenie":"Brakuje punktów",children:["Ulepsz za ",t.jsx(Be,{value:l.next_cost})," pkt"]})]},l.id)})]})]})]})},lA=()=>t.jsx("div",{className:"rounded-2xl border bg-card p-4 shadow-soft animate-pulse",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-8 h-5 rounded bg-muted/60"}),t.jsx("div",{className:"w-10 h-10 rounded-full bg-muted/70"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 w-40 rounded bg-muted/60"}),t.jsx("div",{className:"mt-2 h-3 w-28 rounded bg-muted/50"})]}),t.jsx("div",{className:"h-5 w-16 rounded bg-muted/60"})]})}),cA=()=>{const{data:e}=st(),[s,n]=L.useState("all"),{data:i,isLoading:r,refetch:a,error:o}=La("get_leaderboard",{p_limit:20,p_filter:s});L.useEffect(()=>{let d=!1,m=!1;return(async()=>{if(!(d||m)){m=!0;try{await a()}finally{m=!1}}})(),()=>{d=!0}},[s]);const l=i||[],c=d=>{switch(d){case 1:return t.jsx(Je,{className:"w-5 h-5 text-yellow-500"});case 2:return t.jsx(uj,{className:"w-5 h-5 text-gray-400"});case 3:return t.jsx(Bn,{className:"w-5 h-5 text-orange-500"});default:return t.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:d})}};return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs(Ce.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),t.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),t.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:t.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Ranking"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Top 20 użytkowników według punktów."})]}),t.jsx("div",{className:"bg-muted rounded-lg p-1 inline-flex gap-1",children:[{value:"all",label:"Wszyscy"},{value:"students",label:"Uczniowie"},{value:"teachers",label:"Nauczyciele"}].map(d=>t.jsx("button",{onClick:()=>n(d.value),className:O("px-3 sm:px-4 py-1.5 rounded-md text-sm font-medium transition-colors",s===d.value?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:d.label},d.value))})]})})]}),t.jsxs(Ce.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"space-y-2",children:[r&&Array.from({length:4}).map((d,m)=>t.jsx(lA,{},m)),!r&&(o||l.length===0)&&t.jsxs("div",{className:"rounded-2xl border bg-card p-8 text-center shadow-soft",children:[t.jsx("div",{className:"text-4xl",children:"🥲"}),t.jsx("h4",{className:"mt-3 text-base sm:text-lg font-semibold",children:"Brak wyników"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:o?"Nie udało się pobrać rankingu.":"Brak danych dla wybranego filtra."}),t.jsxs("button",{onClick:()=>a(),className:"mt-4 inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm hover:bg-primary/5 focus-ring",children:[t.jsx(dj,{className:"w-4 h-4"}),"Spróbuj ponownie"]})]}),!r&&l.length>0&&l.map((d,m)=>{const u=d.user_id===e?.id,h=d.rank<=3;return t.jsxs(Cr,{index:m,className:O("flex items-center gap-4 p-4 rounded-2xl border shadow-soft transition-colors",u?"bg-primary text-primary-foreground border-primary/40":h?"bg-muted/50 border-border":"bg-card hover:bg-muted/40 border-border"),children:[t.jsx("div",{className:"w-8 flex justify-center",children:c(d.rank)}),t.jsx("div",{className:O("w-10 h-10 rounded-full flex items-center justify-center font-semibold shrink-0",u?"bg-primary-foreground text-primary":h?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),"aria-label":`Avatar użytkownika ${d.full_name||"Użytkownik"}`,title:d.full_name||"Użytkownik",children:d.full_name?.charAt(0)??"U"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"font-medium truncate",children:[d.full_name||"Użytkownik",u&&t.jsx("span",{className:"ml-2 text-sm opacity-80",children:"(Ty)"})]}),t.jsxs("div",{className:O("text-sm",u?"text-primary-foreground/80":"text-muted-foreground"),children:["Poziom ",d.level," • Seria ",d.streak," dni"]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-semibold tabular-nums",children:t.jsx(Be,{value:d.points})}),t.jsx("div",{className:O("text-xs",u?"text-primary-foreground/80":"text-muted-foreground"),children:"punktów"})]})]},d.user_id||`${d.rank}-${m}`)})]})]})},Ni=[{id:1,icon:Js,title:"Pierwszy Krok",description:"Ukończ pierwszą lekcję",unlocked:!0,rarity:"common",unlockedAt:"2024-01-15",progress:100},{id:2,icon:qi,title:"Perfekcjonista",description:"Zdobądź 100% w 10 quizach",unlocked:!0,rarity:"rare",unlockedAt:"2024-02-20",progress:100},{id:3,icon:$t,title:"Błyskawica",description:"Ukończ 5 lekcji w jeden dzień",unlocked:!1,rarity:"epic",progress:60},{id:4,icon:Je,title:"Mistrz",description:"Osiągnij poziom 50",unlocked:!1,rarity:"legendary",progress:24},{id:5,icon:Ds,title:"Snajper",description:"Odpowiedz poprawnie na 100 pytań z rzędu",unlocked:!1,rarity:"epic",progress:45},{id:6,icon:Jn,title:"Rakieta",description:"Ukończ kurs w mniej niż tydzień",unlocked:!1,rarity:"rare",progress:0}],wm={common:{bg:"bg-muted",ring:"ring-1 ring-border",label:"Pospolite",badge:"border border-muted-foreground/20 text-muted-foreground bg-background/60"},rare:{bg:"bg-blue-500/10",ring:"ring-1 ring-blue-500/30",label:"Rzadkie",badge:"border border-blue-500/30 text-blue-600 dark:text-blue-400"},epic:{bg:"bg-purple-500/10",ring:"ring-1 ring-purple-500/30",label:"Epiczne",badge:"border border-purple-500/30 text-purple-600 dark:text-purple-400"},legendary:{bg:"bg-orange-500/10",ring:"ring-1 ring-orange-500/30",label:"Legendarne",badge:"border border-orange-500/30 text-orange-600 dark:text-orange-400"}},dA=()=>{const e=Ni.filter(i=>i.unlocked).length,s=Ni.length,n=Math.round(e/s*100);return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs(Ce.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),t.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),t.jsxs("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:[t.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Osiągnięcia"}),t.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Odblokowano"," ",t.jsx("span",{className:"font-semibold tabular-nums",children:e})," ","z"," ",t.jsx("span",{className:"font-semibold tabular-nums",children:s})," ","(",n,"%)"]})]}),t.jsxs("div",{className:"w-full md:w-96",children:[t.jsxs("div",{className:"flex items-center justify-between text-xs mb-1.5",children:[t.jsx("span",{className:"text-muted-foreground",children:"Postęp osiągnięć"}),t.jsxs("span",{className:"font-medium tabular-nums",children:[n,"%"]})]}),t.jsx(Hn,{value:n})]})]}),t.jsx("div",{className:"mt-4 grid grid-cols-2 sm:grid-cols-4 gap-2",children:Object.entries(wm).map(([i,r])=>{const a=Ni.filter(l=>l.rarity===i&&l.unlocked).length,o=Ni.filter(l=>l.rarity===i).length;return t.jsxs("div",{className:O("rounded-xl border bg-card/70 backdrop-blur-sm p-3 shadow-soft"),children:[t.jsxs("p",{className:"text-lg font-semibold tabular-nums",children:[a,"/",o]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:r.label})]},i)})})]})]}),t.jsx(Ce.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-5",children:Ni.map((i,r)=>{const a=wm[i.rarity],o=i.icon,l=i.unlocked?t.jsx("span",{className:O("inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-semibold",a.badge),children:"Odblokowane"}):t.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-primary/30 text-primary px-2.5 py-1 text-[11px] font-semibold",children:[i.progress,"%"]});return t.jsxs(Cr,{index:r,className:O("group relative rounded-2xl border bg-card p-5 shadow-soft hover:bg-muted/40 transition-colors",!i.unlocked&&"opacity-95"),children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx("div",{className:O("w-12 h-12 rounded-xl flex items-center justify-center shrink-0",a.bg,a.ring),children:t.jsx(o,{className:"w-6 h-6"})}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h3",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:i.title}),t.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:i.description})]})]}),l]}),t.jsx("div",{className:"mt-4",children:i.unlocked?t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Odblokowano:"," ",t.jsx("span",{className:"font-medium",children:new Date(i.unlockedAt).toLocaleDateString("pl-PL")})]}):t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[t.jsx("span",{className:"text-muted-foreground",children:"Postęp"}),t.jsxs("span",{className:"font-medium tabular-nums",children:[i.progress,"%"]})]}),t.jsx(Hn,{value:i.progress})]})})]},i.id)})})]})},uA=()=>{const{data:e}=st(),{stats:s}=ur(),n=e?.full_name||e?.name||e?.email||"Użytkownik",i=(e?.full_name||e?.name||"U").split(" ").map(o=>o[0]).slice(0,2).join("").toUpperCase()||"U",r=(()=>{const o=e?.created_at;return(o?new Date(o):new Date).toLocaleDateString("pl-PL")})(),a=[{icon:Je,label:"Punkty",value:s.points,iconColor:"text-primary",highlight:"primary",counter:!0},{icon:Ds,label:"Ukończone quizy",value:s.quizzes_completed??0,iconColor:"text-green-600 dark:text-green-400",counter:!1},{icon:qi,label:"Perfekcyjne wyniki",value:s.perfect_scores??0,iconColor:"text-yellow-600 dark:text-yellow-400",counter:!1},{icon:Js,label:"Najdłuższa seria",value:`${s.streak??0} dni`,iconColor:"text-destructive",counter:!1},{icon:qt,label:"Czas nauki",value:`${Math.max(0,Math.floor((s.total_time??0)/60))}h`,iconColor:"text-blue-600 dark:text-blue-400",counter:!1},{icon:Je,label:"Poziom",value:`Poziom ${s.level??1}`,iconColor:"text-secondary",counter:!1}];return t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[t.jsxs(Ce.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),t.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),t.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[t.jsxs("div",{className:"flex items-start gap-4 sm:gap-6",children:[t.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-2xl bg-primary text-primary-foreground flex items-center justify-center text-xl sm:text-2xl font-semibold shadow-soft",children:i}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:n}),t.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-muted-foreground",children:[e?.email&&t.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[t.jsx(fs,{className:"w-4 h-4 shrink-0"}),t.jsx("span",{className:"truncate",children:e.email})]}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(Is,{className:"w-4 h-4"}),t.jsxs("span",{children:["Dołączył ",r]})]})]})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsxs("button",{className:"inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm hover:bg-primary/5 focus-ring",children:[t.jsx(mj,{className:"w-4 h-4"}),"Edytuj profil"]}),t.jsx("button",{className:"inline-flex items-center gap-2 rounded-lg bg-primary px-3 py-2 text-sm text-primary-foreground hover:bg-primary/90 focus-ring",children:"Ustawienia"})]})]})})]}),t.jsxs(Ce.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},children:[t.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-semibold tracking-tight mb-4",children:"Statystyki"}),t.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-5",children:a.map((o,l)=>{const c=o.icon;return t.jsx(Cr,{index:l,className:"group relative rounded-2xl border bg-card p-5 shadow-soft hover:bg-muted/40 transition-colors",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-muted flex items-center justify-center shrink-0",children:t.jsx(c,{className:`w-6 h-6 ${o.iconColor}`})}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:`text-2xl font-semibold leading-none tabular-nums ${o.highlight==="primary"?"text-primary":o.highlight==="secondary"?"text-secondary":o.highlight==="accent"?"text-accent":"text-foreground"}`,children:o.counter?t.jsx(Be,{value:Number(o.value)}):o.value}),t.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:o.label})]})]})},o.label)})})]}),t.jsxs(Ce.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.08},className:"space-y-4",children:[t.jsx("h2",{className:"text-lg sm:text-xl font-semibold tracking-tight",children:"Ustawienia"}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap gap-3",children:[t.jsx(Ce.button,{whileHover:{x:2},whileTap:{scale:.98},className:"w-full sm:w-auto sm:min-w-[220px] inline-flex items-center justify-center rounded-xl bg-primary text-primary-foreground px-4 py-3 shadow-soft hover:bg-primary/90 focus-ring",children:t.jsxs("span",{className:"inline-flex items-center gap-2 font-medium",children:[t.jsx(Bi,{className:"w-4 h-4"}),"Zmień hasło"]})}),t.jsx(Ce.button,{whileHover:{x:2},whileTap:{scale:.98},className:"w-full sm:w-auto sm:min-w-[220px] inline-flex items-center justify-center rounded-xl bg-secondary text-white px-4 py-3 shadow-soft hover:opacity-95 focus-ring",children:t.jsxs("span",{className:"inline-flex items-center gap-2 font-medium",children:[t.jsx(Vl,{className:"w-4 h-4"}),"Ustawienia powiadomień"]})}),t.jsx(Ce.button,{whileHover:{x:2},whileTap:{scale:.98},className:"w-full sm:w-auto sm:min-w-[220px] inline-flex items-center justify-center rounded-xl bg-destructive text-white px-4 py-3 shadow-soft hover:bg-destructive/90 focus-ring",children:t.jsxs("span",{className:"inline-flex items-center gap-2 font-medium",children:[t.jsx(xs,{className:"w-4 h-4"}),"Usuń konto"]})})]})]})]})},mA=()=>t.jsx(Jz,{children:t.jsx(Ho,{})}),hA=[t.jsxs(F,{path:"/student",element:t.jsx(mA,{}),children:[t.jsx(F,{path:"dashboard",element:t.jsx(OT,{})}),t.jsx(F,{path:"courses/:courseId",element:t.jsx($T,{})}),t.jsx(F,{path:"courses/:courseId/lesson/:lessonId",element:t.jsx(nA,{})}),t.jsx(F,{path:"courses/:courseId/quiz/:quizId",element:t.jsx(iA,{})}),t.jsx(F,{path:"gamification",element:t.jsx(oA,{})}),t.jsx(F,{path:"leaderboard",element:t.jsx(cA,{})}),t.jsx(F,{path:"achievements",element:t.jsx(dA,{})}),t.jsx(F,{path:"profile",element:t.jsx(uA,{})})]},"student-layout")],Pt=({children:e})=>t.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center p-4 relative overflow-hidden",children:[t.jsx("div",{className:"h-96 fixed top-0 w-full -rotate-1 scale-125",children:t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-400/0 via-pink-300/15 to-purple-500/10"})}),t.jsx("div",{className:"absolute top-20 -left-32 w-64 h-64 bg-gradient-to-br from-purple-300/20 to-pink-300/20 rounded-full blur-3xl"}),t.jsx("div",{className:"absolute bottom-20 -right-32 w-96 h-96 bg-gradient-to-tl from-purple-400/15 to-pink-400/15 rounded-full blur-3xl"}),t.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-64 bg-gradient-to-b from-pink-200/10 to-transparent"}),t.jsx("div",{className:"w-full max-w-lg space-y-3 relative z-10",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-300/5 to-pink-300/5 rounded-lg blur-md"}),t.jsx("div",{className:"relative bg-background/80 backdrop-blur-sm rounded-lg shadow-xl shadow-purple-200/20 border border-purple-200/20 p-8",children:e})]})})]}),pA=()=>{const{mutate:e,isLoading:s}=Iy(),[n,i]=L.useState(""),[r,a]=L.useState(""),[o,l]=L.useState(null),c=L.useCallback(()=>{if(console.log("🚀 Login attempt:",{email:n}),!n.trim()||!r.trim()){l("Wypełnij wszystkie pola");return}l(null),e({email:n.trim(),password:r},{onSuccess:m=>{console.log("✅ Login success:",m)},onError:m=>{console.error("❌ Login error:",m);let u="Błąd logowania";m?.message&&(m.message.includes("Invalid login credentials")?u="Nieprawidłowe dane logowania":m.message.includes("Email not confirmed")?u="Potwierdź email przed zalogowaniem":u=m.message),l(u)}})},[n,r,e]),d=L.useCallback(m=>{m.preventDefault(),c()},[c]);return{email:n,password:r,setEmail:i,setPassword:a,isLoading:s,error:o,login:c,handleSubmit:d}},fA=()=>{const[e]=ar(),{email:s,password:n,setEmail:i,setPassword:r,isLoading:a,error:o,handleSubmit:l}=pA(),{data:c,isLoading:d}=My(),{data:m,isLoading:u}=st(),h=e.get("verified")==="true",p=e.get("passwordChanged")==="true",x=s.trim().length>0&&n.length>0,f=y=>y.includes("nie zostało potwierdzone")?"warning":"destructive",j=y=>y.includes("nie zostało potwierdzone")?Ea:Vi,b=y=>{if(o){if(y==="email"&&o.toLowerCase().includes("email"))return"Sprawdź poprawność adresu email";if(y==="password"&&o.toLowerCase().includes("hasło"))return"Sprawdź poprawność hasła"}};if(d||u)return t.jsx(Pt,{children:t.jsx(I,{children:t.jsx(M,{className:"flex items-center justify-center py-12",children:t.jsx(an,{className:"h-8 w-8 animate-spin"})})})});if(c&&m){const y=m.role?`/${m.role}`:"/profiles";return t.jsx(In,{to:y,replace:!0})}return t.jsx(Pt,{children:t.jsxs(I,{children:[t.jsxs(V,{className:"space-y-1",children:[t.jsx(q,{className:"text-2xl text-center",children:"Zaloguj się"}),t.jsx(Ls,{className:"text-center",children:"Wprowadź swoje dane aby się zalogować"})]}),t.jsxs(M,{children:[h&&t.jsxs(le,{className:"mb-4 border-green-200 bg-green-50",children:[t.jsx(Ms,{className:"h-4 w-4 text-green-600"}),t.jsxs(ce,{className:"text-green-800",children:[t.jsx("strong",{children:"Email potwierdzony!"})," Możesz się teraz zalogować."]})]}),p&&t.jsxs(le,{className:"mb-4 border-green-200 bg-green-50",children:[t.jsx(Ms,{className:"h-4 w-4 text-green-600"}),t.jsxs(ce,{className:"text-green-800",children:[t.jsx("strong",{children:"Hasło zmienione!"})," Możesz się zalogować używając nowego hasła."]})]}),t.jsxs(Et,{onSubmit:l,children:[t.jsx(G,{label:t.jsxs("span",{className:"flex items-center",children:[t.jsx(fs,{className:"mr-2 h-4 w-4"}),"Email"]}),htmlFor:"email",error:b("email"),required:!0,children:t.jsx(B,{id:"email",type:"email",placeholder:"przykład@email.com",value:s,onChange:y=>i(y.target.value),disabled:a,className:b("email")?"border-red-500":""})}),t.jsx(G,{label:t.jsxs("span",{className:"flex items-center",children:[t.jsx(Bi,{className:"mr-2 h-4 w-4"}),"Hasło"]}),htmlFor:"password",error:b("password"),required:!0,children:t.jsx(B,{id:"password",type:"password",placeholder:"Wprowadź hasło",value:n,onChange:y=>r(y.target.value),disabled:a,className:b("password")?"border-red-500":""})}),o&&t.jsxs(le,{variant:f(o),children:[L.createElement(j(o),{className:"h-4 w-4"}),t.jsxs(ce,{children:[t.jsx("strong",{children:"Błąd logowania:"})," ",o,o.includes("nie zostało potwierdzone")&&t.jsxs("div",{className:"mt-2 text-sm",children:[t.jsxs("p",{children:["💡 ",t.jsx("strong",{children:"Co robić:"})]}),t.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[t.jsx("li",{children:"Sprawdź swoją skrzynkę email (także spam)"}),t.jsx("li",{children:"Kliknij link aktywacyjny w emailu"}),t.jsxs("li",{children:["Jeśli nie otrzymałeś emaila, możesz"," ",t.jsx(zi,{to:"/resend-confirmation",className:"underline",children:"wysłać ponownie"})]})]})]}),o.includes("Nieprawidłowe dane")&&t.jsxs("div",{className:"mt-2 text-sm",children:[t.jsxs("p",{children:["💡 ",t.jsx("strong",{children:"Sprawdź:"})]}),t.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[t.jsx("li",{children:"Czy email jest wpisany poprawnie"}),t.jsx("li",{children:"Czy hasło jest poprawne (uwaga na wielkość liter)"}),t.jsx("li",{children:"Czy masz już założone konto"})]})]})]})]}),t.jsx(It,{className:"!border-0 !pt-0 justify-center",children:t.jsxs(T,{type:"submit",className:"w-full",disabled:a||!x,children:[a&&t.jsx(an,{className:"mr-2 h-4 w-4 animate-spin"}),a?"Logowanie...":"Zaloguj się"]})})]}),t.jsxs("div",{className:"mt-6 space-y-3",children:[t.jsx("div",{className:"text-center text-sm",children:t.jsx(zi,{to:"/register/step1",className:"text-blue-600 hover:text-blue-500 transition-colors",children:"Nie masz konta? Zarejestruj się"})}),t.jsx("div",{className:"text-center text-sm",children:t.jsx(zi,{to:"/forgot-password",className:"text-blue-600 hover:text-blue-500 transition-colors",children:"Zapomniałeś hasła?"})}),t.jsx("div",{className:"border-t pt-4 mt-4",children:t.jsxs("div",{className:"text-center text-xs text-gray-500",children:[t.jsx("p",{children:"Problemy z logowaniem?"}),t.jsx(zi,{to:"/contact",className:"text-blue-600 hover:text-blue-500 transition-colors",children:"Skontaktuj się z pomocą techniczną"})]})})]})]})]})})},xA=()=>{const{mutate:e,isLoading:s,error:n}=Ly(),[i,r]=L.useState(1),[a,o]=L.useState(""),[l,c]=L.useState(""),[d,m]=L.useState(""),[u,h]=L.useState(""),[p,x]=L.useState(""),f=[{value:"beneficiary",label:"Beneficiary",description:"Użytkownik końcowy systemu",icon:ss},{value:"auditor",label:"Auditor",description:"Audytor z uprawnieniami kontrolnymi",icon:Sa}],j=z=>{if(z.preventDefault(),x(""),l!==d){x("Hasła nie są identyczne");return}if(l.length<6){x("Hasło musi mieć co najmniej 6 znaków");return}r(2)},b=()=>{if(!u){x("Wybierz rolę");return}e({email:a,password:l,role:u})},y=z=>{h(z),x("")},w=()=>{r(1),x("")};return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:t.jsx("div",{className:"max-w-md w-full space-y-8",children:i===1?t.jsxs(I,{children:[t.jsxs(V,{className:"space-y-1",children:[t.jsx(q,{className:"text-2xl text-center",children:"Zarejestruj się"}),t.jsx(Ls,{className:"text-center",children:"Krok 1/2: Podaj swoje dane"})]}),t.jsxs(M,{children:[t.jsxs("form",{onSubmit:j,className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(X,{htmlFor:"email",children:"Email"}),t.jsx(B,{id:"email",type:"email",placeholder:"przykład@email.com",value:a,onChange:z=>o(z.target.value),required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(X,{htmlFor:"password",children:"Hasło"}),t.jsx(B,{id:"password",type:"password",placeholder:"Minimum 6 znaków",value:l,onChange:z=>c(z.target.value),required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(X,{htmlFor:"confirmPassword",children:"Potwierdź hasło"}),t.jsx(B,{id:"confirmPassword",type:"password",placeholder:"Powtórz hasło",value:d,onChange:z=>m(z.target.value),required:!0})]}),p&&t.jsx(le,{variant:"destructive",children:t.jsx(ce,{children:p})}),t.jsx(T,{type:"submit",className:"w-full",children:"Dalej"})]}),t.jsx("div",{className:"mt-4 text-center text-sm",children:t.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Masz już konto? Zaloguj się"})})]})]}):t.jsxs(I,{children:[t.jsxs(V,{className:"space-y-1",children:[t.jsx(q,{className:"text-2xl text-center",children:"Wybierz rolę"}),t.jsx(Ls,{className:"text-center",children:"Krok 2/2: Jaka jest Twoja rola w systemie?"})]}),t.jsxs(M,{className:"space-y-4",children:[t.jsx("div",{className:"space-y-3",children:f.map(z=>{const N=z.icon;return t.jsx("div",{onClick:()=>y(z.value),className:`p-4 border-2 rounded-lg cursor-pointer transition-all hover:bg-gray-50 ${u===z.value?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx(N,{className:`h-6 w-6 mt-1 ${u===z.value?"text-blue-600":"text-gray-400"}`}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:`font-medium ${u===z.value?"text-blue-900":"text-gray-900"}`,children:z.label}),t.jsx("p",{className:`text-sm ${u===z.value?"text-blue-700":"text-gray-500"}`,children:z.description})]})]})},z.value)})}),p&&t.jsx(le,{variant:"destructive",children:t.jsx(ce,{children:p})}),n&&t.jsx(le,{variant:"destructive",children:t.jsx(ce,{children:n?.message||"Błąd rejestracji"})}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsxs(T,{variant:"outline",onClick:w,className:"flex-1",disabled:s,children:[t.jsx(me,{className:"mr-2 h-4 w-4"}),"Wstecz"]}),t.jsxs(T,{onClick:b,className:"flex-1",disabled:s||!u,children:[s&&t.jsx(an,{className:"mr-2 h-4 w-4 animate-spin"}),"Zarejestruj się"]})]})]})]})})})},gA=()=>{const{mutate:e,isLoading:s,error:n,isSuccess:i}=Oy(),[r,a]=L.useState(""),o=l=>{l.preventDefault(),e({email:r})};return i?t.jsx(Pt,{children:t.jsxs(I,{children:[t.jsxs(V,{className:"space-y-1",children:[t.jsxs(q,{className:"text-2xl text-center flex items-center justify-center gap-2",children:[t.jsx(Ms,{className:"h-6 w-6 text-green-500"}),"Email wysłany"]}),t.jsx(Ls,{className:"text-center",children:"Sprawdź swoją skrzynkę odbiorczą"})]}),t.jsxs(M,{children:[t.jsx(le,{children:t.jsxs(ce,{children:["Wysłaliśmy link do resetowania hasła na adres ",t.jsx("strong",{children:r}),". Sprawdź swoją skrzynkę odbiorczą i kliknij w link, aby zresetować hasło."]})}),t.jsx("div",{className:"text-center",children:t.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Powrót do logowania"})})]})]})}):t.jsx(Pt,{children:t.jsxs(I,{children:[t.jsxs(V,{className:"space-y-1",children:[t.jsx(q,{className:"text-2xl text-center",children:"Resetuj hasło"}),t.jsx(Ls,{className:"text-center",children:"Wprowadź swój email, aby otrzymać link do resetowania hasła"})]}),t.jsxs(M,{children:[t.jsxs("form",{onSubmit:o,className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(X,{htmlFor:"email",children:"Email"}),t.jsx(B,{id:"email",type:"email",placeholder:"przykład@email.com",value:r,onChange:l=>a(l.target.value),required:!0})]}),n&&t.jsx(le,{variant:"destructive",children:t.jsx(ce,{children:n.message||"Błąd podczas wysyłania emaila"})}),t.jsxs(T,{type:"submit",className:"w-full",disabled:s,children:[s&&t.jsx(an,{className:"mr-2 h-4 w-4 animate-spin"}),"Wyślij link resetujący"]})]}),t.jsx("div",{className:"mt-4 text-center text-sm",children:t.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Powrót do logowania"})})]})]})})},yA=()=>{const e=H(),{mutate:s,isLoading:n,error:i}=Ry(),[r,a]=L.useState(""),[o,l]=L.useState(""),[c,d]=L.useState(""),[m,u]=L.useState(!0),[h,p]=L.useState(!0),[x,f]=L.useState(!1);L.useEffect(()=>{(async()=>{try{const{data:y}=await se.auth.getSession(),z=new URLSearchParams(window.location.hash.substring(1)).get("type");!y.session&&z!=="recovery"?(console.log("No valid recovery session found"),u(!1),setTimeout(()=>{e("/forgot-password")},3e3)):(console.log("Valid session found"),u(!0))}catch(y){console.error("Session check error:",y),u(!1)}finally{p(!1)}})()},[e]);const j=async b=>{if(b.preventDefault(),d(""),r!==o){d("Hasła nie są identyczne");return}if(r.length<6){d("Hasło musi mieć co najmniej 6 znaków");return}if(r.length>72){d("Hasło nie może być dłuższe niż 72 znaki");return}s({password:r},{onSuccess:()=>{f(!0),setTimeout(()=>{e("/login?passwordChanged=true")},3e3)},onError:y=>{console.error("Password update error:",y),d(y?.message||"Błąd aktualizacji hasła")}})};return h?t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:t.jsxs("div",{className:"text-center",children:[t.jsx(an,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-600",children:"Weryfikacja sesji..."})]})}):m?x?t.jsx(Pt,{children:t.jsxs(I,{className:"border-green-200",children:[t.jsx(V,{children:t.jsxs(q,{className:"text-2xl text-center flex items-center justify-center gap-2",children:[t.jsx(Ms,{className:"h-6 w-6 text-green-600"}),"Hasło zmienione!"]})}),t.jsx(M,{children:t.jsxs(le,{className:"border-green-200 bg-green-50",children:[t.jsx(Ms,{className:"h-4 w-4 text-green-600"}),t.jsx(ce,{className:"text-green-800",children:"Twoje hasło zostało pomyślnie zmienione. Za chwilę zostaniesz przekierowany do strony logowania..."})]})})]})}):t.jsx(Pt,{children:t.jsxs(I,{children:[t.jsxs(V,{className:"space-y-1",children:[t.jsxs(q,{className:"text-2xl text-center flex items-center justify-center gap-2",children:[t.jsx(hj,{className:"h-6 w-6"}),"Nowe hasło"]}),t.jsx(Ls,{className:"text-center",children:"Wprowadź nowe hasło dla swojego konta"})]}),t.jsxs(M,{children:[t.jsxs("form",{onSubmit:j,className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(X,{htmlFor:"password",children:"Nowe hasło"}),t.jsx(B,{id:"password",type:"password",placeholder:"Minimum 6 znaków",value:r,onChange:b=>a(b.target.value),disabled:n,required:!0,autoFocus:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(X,{htmlFor:"confirmPassword",children:"Potwierdź nowe hasło"}),t.jsx(B,{id:"confirmPassword",type:"password",placeholder:"Powtórz nowe hasło",value:o,onChange:b=>l(b.target.value),disabled:n,required:!0})]}),t.jsxs(le,{children:[t.jsx(Ea,{className:"h-4 w-4"}),t.jsxs(ce,{children:[t.jsx("strong",{children:"Wymagania hasła:"}),t.jsxs("ul",{className:"list-disc list-inside mt-2 text-sm",children:[t.jsx("li",{children:"Minimum 6 znaków"}),t.jsx("li",{children:"Maksimum 72 znaki"}),t.jsx("li",{children:"Zalecane użycie liter, cyfr i znaków specjalnych"})]})]})]}),(i||c)&&t.jsxs(le,{variant:"destructive",children:[t.jsx(Vi,{className:"h-4 w-4"}),t.jsx(ce,{children:c||i?.message||"Błąd aktualizacji hasła"})]}),t.jsxs(T,{type:"submit",className:"w-full",disabled:n,children:[n&&t.jsx(an,{className:"mr-2 h-4 w-4 animate-spin"}),n?"Aktualizowanie...":"Zaktualizuj hasło"]})]}),t.jsx("div",{className:"mt-6 text-center",children:t.jsxs("p",{className:"text-sm text-gray-600",children:["Pamiętasz hasło?"," ",t.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Wróć do logowania"})]})})]})]})}):t.jsx(Pt,{children:t.jsx(I,{className:"border-red-200",children:t.jsx(M,{className:"pt-6",children:t.jsxs(le,{variant:"destructive",children:[t.jsx(Vi,{className:"h-4 w-4"}),t.jsxs(ce,{children:[t.jsx("strong",{children:"Nieprawidłowa lub wygasła sesja."}),t.jsx("br",{}),"Link do resetowania hasła mógł wygasnąć. Za chwilę zostaniesz przekierowany do strony resetowania hasła..."]})]})})})})},Ag=({schemaPath:e,onSubmit:s,submitLabel:n="Dalej",className:i=""})=>{const{getSchemaFragment:r,setData:a,getData:o}=fe(),[l]=e.split("."),[c,d]=L.useState(""),[m,u]=L.useState({}),h=r(e),p=o(l);if(!h)return t.jsx(le,{variant:"destructive",children:t.jsxs(ce,{children:["Nie znaleziono schematu dla ścieżki: ",e]})});const x=b=>{b.preventDefault(),d(""),u({});const y={};if(h.required)for(const w of h.required)p[w]||(y[w]="To pole jest wymagane");if(Object.keys(y).length>0){u(y);return}if(h.validation){const w=h.validation(p);if(w){d(w);return}}s(p)},f=(b,y)=>{a(l,{...p,[b]:y}),m[b]&&u(w=>{const z={...w};return delete z[b],z})},j=(b,y)=>{const w=p[b]||"",z=h.required?.includes(b),N=m[b];switch(y.type){case"text":case"email":case"password":return t.jsx(G,{label:y.title||b,htmlFor:b,error:N,required:z,children:t.jsx(B,{id:b,type:y.type,value:w,placeholder:y.placeholder,onChange:S=>f(b,S.target.value),className:N?"border-red-500":""})},b);case"select":return t.jsx(G,{label:y.title||b,htmlFor:b,error:N,required:z,children:t.jsxs(Te,{value:w,onValueChange:S=>f(b,S),children:[t.jsx(Ne,{className:N?"border-red-500":"",children:t.jsx(Ae,{placeholder:y.placeholder||"Wybierz opcję"})}),t.jsx(ke,{children:y.options?.map(S=>t.jsx(K,{value:S.value,children:S.label},S.value))})]})},b);default:return null}};return t.jsxs(I,{className:i,children:[t.jsx(V,{children:t.jsx(q,{children:h.title})}),t.jsx(M,{children:t.jsxs(Et,{onSubmit:x,children:[t.jsxs(be,{variant:"1-1-1",children:[h.properties&&Object.entries(h.properties).map(([b,y])=>j(b,y)),c&&t.jsx(le,{variant:"destructive",className:"mt-4",children:t.jsx(ce,{children:c})})]}),t.jsx(It,{className:"mt-6 pt-6",children:t.jsx(T,{type:"submit",className:"w-full sm:w-auto",children:n})})]})})]})},jA=()=>{const e=H(),{register:s}=fe();g.useEffect(()=>{s({id:"registration",title:"Proces rejestracji",schema:{step1:{title:"Dane podstawowe",type:"object",properties:{email:{type:"email",title:"Email",placeholder:"przykład@email.com"},name:{type:"text",title:"Imię i nazwisko",placeholder:"Jan Kowalski"}},required:["email","name"],validation:i=>i.name&&i.name.trim().length<3?"Imię i nazwisko musi mieć co najmniej 3 znaki":i.name&&!i.name.includes(" ")?"Podaj zarówno imię jak i nazwisko":null},step2:{title:"Hasło",type:"object",properties:{password:{type:"password",title:"Hasło",placeholder:"Minimum 6 znaków"},confirmPassword:{type:"password",title:"Potwierdź hasło",placeholder:"Powtórz hasło"}},required:["password","confirmPassword"],validation:i=>i.password&&i.password.length<6?"Hasło musi mieć co najmniej 6 znaków":i.password!==i.confirmPassword?"Hasła nie są identyczne":null},step3:{title:"Podsumowanie",type:"object",properties:{}}}})},[s]);const n=i=>{console.log("RegisterStep1 - Otrzymane dane z formularza:",i),e("/register/step2")};return t.jsxs(Pt,{children:[t.jsxs("div",{className:"flex items-start gap-5 ",children:[t.jsx(rn,{className:"mt-2 bg-white rounded-full p-2 w-12 h-12"}),t.jsx(ie,{title:"Rejestracja",description:"1 z 3 Podaj podstawowe informacje"})]}),t.jsx(Ag,{schemaPath:"registration.step1",onSubmit:n,submitLabel:"Dalej"}),t.jsx("div",{className:"mt-4 text-center",children:t.jsx(zi,{to:"/login",className:"text-blue-600 hover:text-blue-500 text-sm",children:"Masz już konto? Zaloguj się"})})]})},bA=()=>{const e=H(),{setData:s}=fe(),n=r=>{s("registration",r),e("/register/step3")},i=()=>{e("/register/step1")};return t.jsxs(Pt,{children:[t.jsxs("div",{className:"flex items-start gap-5 ",children:[t.jsx(pj,{className:"mt-2 bg-white rounded-full p-2 w-12 h-12"}),t.jsx(ie,{title:"Rejestracja",description:"2 z 3 Ustaw hasło do konta"})]}),t.jsx(Ag,{schemaPath:"registration.step2",onSubmit:n,submitLabel:"Dalej"}),t.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[t.jsxs(T,{variant:"outline",onClick:i,className:"flex items-center",children:[t.jsx(me,{className:"mr-2 h-4 w-4"}),"Wstecz"]}),t.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500 text-sm",children:"Masz już konto? Zaloguj się"})]})]})},wA=()=>{const e=H(),{getData:s,setData:n}=fe(),[i,r]=L.useState(!1),[a,o]=L.useState(!1),[l,c]=L.useState(null),d=s("registration"),m=L.useCallback(async()=>{if(!Zo.register){c("Funkcja rejestracji nie jest dostępna");return}if(!d?.email||!d?.password){c("Brak wymaganych danych. Rozpocznij proces rejestracji od początku.");return}r(!0),c(null);try{console.log("📝 Attempting registration with:",{email:d.email,name:d.name});const h=await Zo.register({email:d.email,password:d.password,name:d.name});if(console.log("📝 Registration result:",h),h.success)o(!0),n("registration",{...d,registrationComplete:!0,registrationDate:new Date().toISOString(),user:h.user}),setTimeout(()=>{e("/register/step4")},1500);else{const p=h.error?.message||"Rejestracja nie powiodła się";console.error("❌ Registration failed:",p),c(p)}}catch(h){console.error("❌ Registration error:",h);const p=h?.message||"Wystąpił nieoczekiwany błąd";c(p)}finally{r(!1)}},[d,n,e]),u=L.useCallback(()=>{e("/register/step2")},[e]);return{isLoading:i,isSuccess:a,error:l,register:m,goBack:u,processData:d}},vA=()=>{const e=H(),{isLoading:s,isSuccess:n,error:i,register:r,goBack:a,processData:o}=wA();return!o||!o.email?t.jsxs(Pt,{children:[t.jsx(ie,{title:"Rejestracja",description:"Błąd - brak danych"}),t.jsxs(le,{variant:"destructive",children:[t.jsx(Vi,{className:"h-4 w-4"}),t.jsx(ce,{children:"Brak danych rejestracji. Rozpocznij proces od początku."})]}),t.jsx(T,{onClick:()=>e("/register/step1"),className:"mt-4",children:"Wróć do kroku 1"})]}):t.jsxs(Pt,{children:[t.jsxs("div",{className:"flex items-start gap-5 ",children:[t.jsx(fj,{className:"mt-2 bg-white rounded-full p-2 w-12 h-12"}),t.jsx(ie,{title:"Rejestracja",description:"3 z 4 Potwierdzenie danych"})]}),n&&t.jsxs(le,{className:"mb-4 border-green-200 bg-green-50",children:[t.jsx(ze,{className:"h-4 w-4 text-green-600"}),t.jsxs(ce,{className:"text-green-800",children:[t.jsx("strong",{children:"Rejestracja udana!"})," Za chwilę zostaniesz przekierowany..."]})]}),i&&!n&&t.jsxs(le,{variant:"destructive",className:"mb-4",children:[t.jsx(Vi,{className:"h-4 w-4"}),t.jsxs(ce,{children:[t.jsx("strong",{children:"Rejestracja nieudana:"})," ",i]})]}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsxs(q,{className:"flex items-center",children:[t.jsx(ze,{className:"mr-2 h-5 w-5 text-blue-600"}),"Podsumowanie"]})}),t.jsxs(M,{className:"space-y-4",children:[t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Co się stanie:"}),t.jsxs("ul",{className:"text-sm text-blue-700 mt-2 space-y-1",children:[t.jsx("li",{children:"• Konto zostanie utworzone"}),t.jsx("li",{children:"• Otrzymasz email z potwierdzeniem"}),t.jsx("li",{children:"• Po aktywacji będziesz mógł się zalogować"})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[t.jsx(fs,{className:"h-5 w-5 text-gray-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:"Email"}),t.jsx("p",{className:"text-sm text-gray-600",children:o.email})]})]}),t.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[t.jsx(ss,{className:"h-5 w-5 text-gray-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:"Imię i nazwisko"}),t.jsx("p",{className:"text-sm text-gray-600",children:o.name})]})]})]}),i&&!n&&t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[t.jsx("p",{className:"text-sm text-red-800 font-medium",children:"Wskazówki w przypadku problemów:"}),t.jsxs("ul",{className:"text-sm text-red-700 mt-2 space-y-1",children:[t.jsx("li",{children:"• Sprawdź czy email ma prawidłowy format"}),t.jsx("li",{children:"• Upewnij się że hasło spełnia wymagania (6-72 znaków)"}),t.jsx("li",{children:"• Jeśli masz już konto, przejdź do logowania"}),t.jsx("li",{children:"• W przypadku dalszych problemów skontaktuj się z pomocą"})]})]})]})]}),t.jsxs("div",{className:"mt-4 flex justify-between",children:[t.jsxs(T,{variant:"outline",onClick:a,disabled:s||n,children:[t.jsx(me,{className:"mr-2 h-4 w-4"}),"Wstecz"]}),t.jsxs(T,{onClick:r,disabled:s||n,children:[s&&t.jsx(an,{className:"mr-2 h-4 w-4 animate-spin"}),s?"Rejestruję...":n?"Udane!":i?"Spróbuj ponownie":"Zarejestruj się"]})]}),t.jsx("div",{className:"mt-4 text-center",children:t.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500 text-sm",children:"Masz już konto? Zaloguj się"})})]})},NA=()=>{const e=H(),{getData:s,unregister:n}=fe(),[i,r]=L.useState(!1),[a,o]=L.useState(!1),l=s("registration"),c=l?.email||"user@example.com",d=l?.name||"Użytkownik";L.useEffect(()=>{const h=setTimeout(()=>{n("registration","data")},3e4);return()=>clearTimeout(h)},[n]);const m=async()=>{r(!0);try{await new Promise(h=>setTimeout(h,2e3)),o(!0),setTimeout(()=>o(!1),3e3)}catch(h){console.error("Błąd wysyłania maila:",h)}finally{r(!1)}},u=()=>{n("registration","data"),e("/login")};return t.jsxs(Pt,{children:[t.jsx(ie,{title:"Rejestracja zakończona!",description:"4 z 4 Sprawdź swoją skrzynkę mailową"}),t.jsxs(I,{className:"border-green-200 bg-green-50",children:[t.jsx(V,{children:t.jsxs(q,{className:"flex items-center text-green-800",children:[t.jsx(Ms,{className:"mr-2 h-6 w-6 text-green-600"}),"Konto zostało utworzone!"]})}),t.jsx(M,{className:"space-y-4",children:t.jsxs("div",{className:"text-green-700",children:[t.jsx("p",{className:"font-medium",children:"Gratulacje! Twoje konto zostało pomyślnie utworzone."}),t.jsxs("p",{className:"text-sm mt-1",children:["Wysłaliśmy email z potwierdzeniem na adres ",t.jsx("strong",{children:c})]})]})})]}),t.jsxs(I,{children:[t.jsx(V,{children:t.jsxs(q,{className:"flex items-center",children:[t.jsx(ss,{className:"mr-2 h-5 w-5"}),"Podsumowanie konta"]})}),t.jsxs(M,{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[t.jsx(fs,{className:"h-5 w-5 text-gray-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:"Adres email"}),t.jsx("p",{className:"text-sm text-gray-600",children:c})]})]}),t.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[t.jsx(ss,{className:"h-5 w-5 text-gray-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:"Imię i nazwisko"}),t.jsx("p",{className:"text-sm text-gray-600",children:d})]})]})]})]}),t.jsxs(I,{className:"border-blue-200",children:[t.jsx(V,{children:t.jsxs(q,{className:"flex items-center text-blue-800",children:[t.jsx(fs,{className:"mr-2 h-5 w-5 text-blue-600"}),"Co dalej?"]})}),t.jsxs(M,{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-3 text-sm",children:[t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-bold",children:"1"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Sprawdź swoją skrzynkę mailową"}),t.jsxs("p",{className:"text-gray-600",children:["Email potwierdzający został wysłany na adres ",t.jsx("strong",{children:c})]})]})]}),t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-bold",children:"2"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Kliknij link w emailu"}),t.jsx("p",{className:"text-gray-600",children:"Aktywuj swoje konto klikając w link potwierdzający"})]})]}),t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-bold",children:"3"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Zaloguj się do systemu"}),t.jsx("p",{className:"text-gray-600",children:"Po aktywacji możesz się zalogować używając swojego emailu i hasła"})]})]})]}),t.jsxs(le,{children:[t.jsx(qt,{className:"h-4 w-4"}),t.jsxs(ce,{children:[t.jsx("strong",{children:"Ważne:"})," Email może dotrzeć w ciągu kilku minut. Sprawdź także folder SPAM/Niechciane."]})]})]})]}),t.jsx(I,{children:t.jsx(M,{className:"pt-6",children:t.jsxs("div",{className:"text-center space-y-3",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Nie otrzymałeś emaila?"}),a&&t.jsxs(le,{className:"border-green-200 bg-green-50",children:[t.jsx(Ms,{className:"h-4 w-4 text-green-600"}),t.jsx(ce,{className:"text-green-800",children:"Email został wysłany ponownie!"})]}),t.jsxs(T,{variant:"outline",onClick:m,disabled:i,className:"w-full sm:w-auto",children:[i&&t.jsx(cr,{className:"mr-2 h-4 w-4 animate-spin"}),i?"Wysyłanie...":"Wyślij email ponownie"]})]})})}),t.jsxs("div",{className:"mt-6 space-y-4",children:[t.jsxs(T,{onClick:u,className:"w-full",size:"lg",children:["Przejdź do logowania",t.jsx(Ze,{className:"ml-2 h-4 w-4"})]}),t.jsx("div",{className:"text-center",children:t.jsx("a",{href:"/help",className:"text-blue-600 hover:text-blue-500 text-sm",children:"Potrzebujesz pomocy? Skontaktuj się z nami"})})]})]})},kA=[t.jsx(F,{path:"/login",element:t.jsx(fA,{})},"auth-login"),t.jsx(F,{path:"/register",element:t.jsx(xA,{})},"auth-register"),t.jsx(F,{path:"/forgot-password",element:t.jsx(gA,{})},"auth-forgot-password"),t.jsx(F,{path:"/update-password",element:t.jsx(yA,{})},"auth-update-password"),t.jsx(F,{path:"/register/step1",element:t.jsx(jA,{})},"auth-register-1"),t.jsx(F,{path:"/register/step2",element:t.jsx(bA,{})},"auth-register-2"),t.jsx(F,{path:"/register/step3",element:t.jsx(vA,{})},"auth-register-3"),t.jsx(F,{path:"/register/step4",element:t.jsx(NA,{})},"auth-register-4")],zA=()=>{const e=H(),[s,n]=g.useState(0),[i,r]=g.useState("");g.useEffect(()=>{const o=()=>n(window.scrollY);return window.addEventListener("scroll",o),()=>window.removeEventListener("scroll",o)},[]);const a=[{name:"Sty",value:65},{name:"Lut",value:72},{name:"Mar",value:78},{name:"Kwi",value:85},{name:"Maj",value:88},{name:"Cze",value:94}];return t.jsxs("div",{className:"min-h-screen bg-white text-foreground",children:[t.jsx("nav",{className:"fixed top-0 w-full z-50 bg-white/80 backdrop-blur-xl border-b border-gray-100",children:t.jsx("div",{className:"container mx-auto px-6 py-4",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-600 to-purple-700 rounded-xl flex items-center justify-center",children:t.jsx(Je,{className:"w-5 h-5 text-white"})}),t.jsx("span",{className:"text-xl font-bold",children:"Smart Up"})]}),t.jsxs("div",{className:"hidden md:flex items-center gap-8",children:[t.jsx("a",{href:"#funkcje",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Funkcje"}),t.jsx("a",{href:"#kursy",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Kursy"}),t.jsx("a",{href:"#firma",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Dla firm"}),t.jsx("a",{href:"#cennik",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Cennik"}),t.jsx(T,{className:"bg-gray-900 hover:bg-gray-800 text-white text-sm px-6",onClick:()=>e("/login"),children:"Rozpocznij"})]})]})})}),t.jsx("section",{className:"pt-32 pb-20 overflow-hidden",children:t.jsx("div",{className:"container mx-auto px-6",children:t.jsxs("div",{className:"grid lg:grid-cols-12 gap-8 items-center",children:[t.jsxs("div",{className:"lg:col-span-5",children:[t.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-50 rounded-full mb-8",children:[t.jsx($t,{className:"w-4 h-4 text-purple-700"}),t.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Gamifikacja w edukacji"})]}),t.jsxs("h1",{className:"text-5xl md:text-6xl font-bold leading-tight mb-6",children:["Nauka, która",t.jsx("span",{className:"block text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"motywuje"})]}),t.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:"Przekształć edukację w angażującą przygodę. System poziomów, punktów i nagród sprawia, że nauka staje się uzależniająca."}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-12",children:[t.jsxs(T,{size:"lg",className:"bg-gray-900 hover:bg-gray-800 text-white px-8",onClick:()=>e("/login"),children:["Zacznij za darmo",t.jsx(Ze,{className:"ml-2 h-4 w-4"})]}),t.jsx(T,{size:"lg",variant:"outline",className:"border-gray-300",children:"Zobacz demo"})]}),t.jsxs("div",{className:"flex items-center gap-8",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold",children:"15k+"}),t.jsx("div",{className:"text-sm text-gray-500",children:"aktywnych uczniów"})]}),t.jsx("div",{className:"w-px h-12 bg-gray-200"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold",children:"92%"}),t.jsx("div",{className:"text-sm text-gray-500",children:"ukończalność"})]}),t.jsx("div",{className:"w-px h-12 bg-gray-200"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold",children:"4.9"}),t.jsx("div",{className:"text-sm text-gray-500",children:"ocena"})]})]})]}),t.jsx("div",{className:"lg:col-span-7",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute -inset-4 bg-gradient-to-r from-pink-600/5 to-purple-700/5 rounded-3xl blur-2xl"}),t.jsxs("div",{className:"relative bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[t.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-100",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-pink-600 to-purple-700 rounded-lg flex items-center justify-center",children:t.jsx(Je,{className:"w-4 h-4 text-white"})}),t.jsx("span",{className:"font-semibold",children:"Dashboard ucznia"})]}),t.jsx(ne,{className:"bg-green-50 text-green-700 border-green-200",children:"Online"})]})}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-pink-100 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(Qo,{className:"w-5 h-5 text-pink-600"}),t.jsx("span",{className:"text-xs text-gray-500",children:"+125"})]}),t.jsx("div",{className:"text-2xl font-bold",children:"1,842"}),t.jsx("div",{className:"text-xs text-gray-500",children:"Punkty XP"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(Ds,{className:"w-5 h-5 text-purple-700"}),t.jsx("span",{className:"text-xs text-gray-500",children:"75%"})]}),t.jsx("div",{className:"text-2xl font-bold",children:"Lvl 12"}),t.jsx("div",{className:"text-xs text-gray-500",children:"Poziom"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-teal-100 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(Bn,{className:"w-5 h-5 text-teal-600"}),t.jsx("span",{className:"text-xs text-gray-500",children:"New!"})]}),t.jsx("div",{className:"text-2xl font-bold",children:"24"}),t.jsx("div",{className:"text-xs text-gray-500",children:"Odznaki"})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("span",{className:"text-sm font-medium",children:"Postęp nauki"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Ostatnie 6 miesięcy"})]}),t.jsx(xj,{width:"100%",height:120,children:t.jsxs(gj,{data:a,children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:"colorProgress",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:"#db2777",stopOpacity:.3}),t.jsx("stop",{offset:"95%",stopColor:"#db2777",stopOpacity:0})]})}),t.jsx(yj,{type:"monotone",dataKey:"value",stroke:"#db2777",strokeWidth:2,fill:"url(#colorProgress)"}),t.jsx(jj,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fontSize:11}}),t.jsx(bj,{hide:!0})]})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"font-medium",children:"Aktywne kursy"}),t.jsx("a",{href:"#",className:"text-purple-700 hover:underline",children:"Zobacz wszystkie"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-600 to-purple-700 rounded-lg flex items-center justify-center",children:t.jsx(aa,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-sm",children:"JavaScript: Gra w kodowanie"}),t.jsx("div",{className:"text-xs text-gray-500",children:"Rozdział 4 z 12"})]})]}),t.jsx($i,{className:"w-4 h-4 text-gray-400"})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-teal-500 to-blue-600 rounded-lg flex items-center justify-center",children:t.jsx(yd,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-sm",children:"Analiza danych: Quest"}),t.jsx("div",{className:"text-xs text-gray-500",children:"Rozdział 7 z 10"})]})]}),t.jsx($i,{className:"w-4 h-4 text-gray-400"})]})]})]})]})]})]})})]})})}),t.jsx("section",{id:"funkcje",className:"py-20 bg-gray-50",children:t.jsxs("div",{className:"container mx-auto px-6",children:[t.jsxs("div",{className:"text-center mb-16",children:[t.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Funkcje, które"," ",t.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"angażują"})]}),t.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"System zaprojektowany, aby uczynić naukę uzależniającą jak najlepsza gra"})]}),t.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-pink-600/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-pink-600 to-purple-700 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(Je,{className:"w-7 h-7 text-white"})}),t.jsx("h3",{className:"text-xl font-bold mb-3",children:"System poziomów"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"99 poziomów do zdobycia. Każdy poziom odblokowuje nowe możliwości i nagrody."}),t.jsxs("div",{className:"flex items-center text-sm text-pink-600 font-medium",children:["Dowiedz się więcej",t.jsx(Ze,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),t.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-700/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-700 to-teal-500 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(Qo,{className:"w-7 h-7 text-white"})}),t.jsx("h3",{className:"text-xl font-bold mb-3",children:"Idle Points"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Zdobywaj punkty nawet gdy nie uczysz się aktywnie. System pasywnego rozwoju."}),t.jsxs("div",{className:"flex items-center text-sm text-purple-700 font-medium",children:["Dowiedz się więcej",t.jsx(Ze,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),t.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-teal-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-teal-500 to-blue-600 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(Ds,{className:"w-7 h-7 text-white"})}),t.jsx("h3",{className:"text-xl font-bold mb-3",children:"Wyzwania"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Codzienne i tygodniowe wyzwania z dodatkowymi nagrodami za ukończenie."}),t.jsxs("div",{className:"flex items-center text-sm text-teal-600 font-medium",children:["Dowiedz się więcej",t.jsx(Ze,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),t.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-orange-500 to-yellow-500 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(He,{className:"w-7 h-7 text-white"})}),t.jsx("h3",{className:"text-xl font-bold mb-3",children:"Rankingi"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Rywalizuj z innymi uczniami. Rankingi globalne, lokalne i grupowe."}),t.jsxs("div",{className:"flex items-center text-sm text-orange-600 font-medium",children:["Dowiedz się więcej",t.jsx(Ze,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),t.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-700/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-700 to-pink-600 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(Bn,{className:"w-7 h-7 text-white"})}),t.jsx("h3",{className:"text-xl font-bold mb-3",children:"Odznaki"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Kolekcjonuj unikalne odznaki za osiągnięcia i kamienie milowe."}),t.jsxs("div",{className:"flex items-center text-sm text-purple-700 font-medium",children:["Dowiedz się więcej",t.jsx(Ze,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),t.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-teal-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-teal-500 to-purple-700 rounded-2xl flex items-center justify-center mb-6",children:t.jsx(yd,{className:"w-7 h-7 text-white"})}),t.jsx("h3",{className:"text-xl font-bold mb-3",children:"Analityka"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Szczegółowe statystyki postępów i personalizowane rekomendacje."}),t.jsxs("div",{className:"flex items-center text-sm text-teal-600 font-medium",children:["Dowiedz się więcej",t.jsx(Ze,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]})]})]})}),t.jsx("section",{className:"py-20 bg-white",children:t.jsxs("div",{className:"container mx-auto px-6",children:[t.jsxs("div",{className:"max-w-3xl mx-auto text-center mb-16",children:[t.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Jak to"," ",t.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"działa"})]}),t.jsx("p",{className:"text-lg text-gray-600",children:"Cztery proste kroki do rozpoczęcia nauki z gamifikacją"})]}),t.jsx("div",{className:"max-w-4xl mx-auto",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 top-0 bottom-0 w-0.5 bg-gray-200"}),t.jsx("div",{className:"space-y-12",children:[{number:"01",title:"Stwórz profil",description:"Wybierz swoją rolę i spersonalizuj doświadczenie nauki",icon:He,color:"from-pink-600 to-purple-700"},{number:"02",title:"Wybierz kursy",description:"Przeglądaj bibliotekę kursów i wybierz te, które Cię interesują",icon:Es,color:"from-purple-700 to-teal-500"},{number:"03",title:"Ucz się i graj",description:"Rozwiązuj quizy, zdobywaj punkty i awansuj na kolejne poziomy",icon:aa,color:"from-teal-500 to-blue-600"},{number:"04",title:"Śledź postępy",description:"Monitoruj swoje osiągnięcia i rywalizuj z innymi",icon:Xs,color:"from-orange-500 to-yellow-500"}].map((o,l)=>t.jsx("div",{className:"relative",children:t.jsxs("div",{className:`flex items-center ${l%2===0?"flex-row":"flex-row-reverse"}`,children:[t.jsxs("div",{className:`w-5/12 ${l%2===0?"text-right pr-8":"text-left pl-8"}`,children:[t.jsxs("div",{className:`inline-flex items-center gap-4 mb-2 ${l%2===0?"flex-row-reverse":""}`,children:[t.jsx("h3",{className:"text-2xl font-bold",children:o.title}),t.jsx("span",{className:"text-4xl font-bold text-gray-200",children:o.number})]}),t.jsx("p",{className:"text-gray-600 text-lg",children:o.description})]}),t.jsx("div",{className:"w-2/12 flex justify-center",children:t.jsx("div",{className:`relative z-10 w-16 h-16 bg-gradient-to-br ${o.color} rounded-2xl flex items-center justify-center shadow-lg`,children:t.jsx(o.icon,{className:"w-8 h-8 text-white"})})}),t.jsx("div",{className:"w-5/12"})]})},l))})]})})]})}),t.jsx("section",{className:"py-20 bg-gradient-to-br from-gray-900 to-gray-800",children:t.jsx("div",{className:"container mx-auto px-6",children:t.jsx("div",{className:"grid md:grid-cols-4 gap-8",children:[{value:"15k+",label:"Aktywnych uczniów",icon:He},{value:"200+",label:"Kursów",icon:Es},{value:"92%",label:"Ukończalność",icon:Ds},{value:"4.9/5",label:"Ocena",icon:qi}].map((o,l)=>t.jsxs("div",{className:"text-center",children:[t.jsx(o.icon,{className:"w-8 h-8 mx-auto mb-4 text-white/60"}),t.jsx("div",{className:"text-4xl font-bold text-white mb-2",children:o.value}),t.jsx("div",{className:"text-sm text-white/60",children:o.label})]},l))})})}),t.jsx("section",{className:"py-20 bg-white",children:t.jsx("div",{className:"container mx-auto px-6",children:t.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[t.jsxs("h2",{className:"text-4xl font-bold mb-6",children:["Gotowy na naukę, która"," ",t.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"wciąga"}),"?"]}),t.jsx("p",{className:"text-lg text-gray-600 mb-8 max-w-2xl mx-auto",children:"Dołącz do tysięcy uczniów, którzy odkryli radość z nauki dzięki gamifikacji. Pierwsze 30 dni gratis."}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8",children:[t.jsx(B,{type:"email",placeholder:"twoj@email.pl",value:i,onChange:o=>r(o.target.value),className:"max-w-xs h-12"}),t.jsxs(T,{size:"lg",className:"bg-gradient-to-r from-pink-600 to-purple-700 hover:opacity-90 text-white px-8 h-12",onClick:()=>e("/login"),children:["Rozpocznij za darmo",t.jsx(Ze,{className:"ml-2 h-4 w-4"})]})]}),t.jsx("p",{className:"text-sm text-gray-500",children:"Bez karty kredytowej • Anuluj w każdej chwili • Pełny dostęp"})]})})}),t.jsx("footer",{className:"bg-gray-900 text-white py-12",children:t.jsx("div",{className:"container mx-auto px-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center",children:t.jsx(Je,{className:"w-4 h-4"})}),t.jsx("span",{className:"text-lg font-bold",children:"Smart Up"})]}),t.jsx("div",{className:"text-sm text-white/60",children:"© 2025 Smart Up. Wszystkie prawa zastrzeżone."})]})})})]})},Go=()=>{const{data:e}=st();return e?.role==="student"?t.jsx(In,{to:"/student/dashboard",replace:!0}):t.jsx(In,{to:"/dashboard/overview",replace:!0})};function SA(){return t.jsx(vy,{children:t.jsxs(Fy,{dataProvider:Ky(se),liveProvider:Wy(se),authProvider:Zo,routerProvider:$y,resources:[lb,k0,T0,Vk,ez,az,cz,mz,Uz,Nz,Ez],options:{syncWithLocation:!0,warnWhenUnsavedChanges:!0,useNewQueryKeys:!0,liveMode:"auto"},children:[t.jsxs(Ny,{children:[t.jsx(F,{path:"/",element:t.jsx(zA,{})}),...kA,t.jsxs(F,{element:t.jsx(fo,{fallback:t.jsx(fd,{to:"/login"}),children:t.jsx(nb,{children:t.jsx(Ho,{})})},"admin-teacher-layout"),children:[t.jsx(F,{path:"/admin",element:t.jsx(Go,{})}),t.jsx(F,{path:"/teacher",element:t.jsx(Go,{})}),t.jsx(F,{path:"/dashboard",element:t.jsx(In,{to:"/dashboard/overview",replace:!0})}),...cb,...z0,...A0,...Uk,...Gk,...Vz,...vz,..._z,...tz,...oz,...dz,...hz]}),t.jsxs(F,{element:t.jsx(fo,{fallback:t.jsx(fd,{to:"/login"}),children:t.jsx(Ho,{})},"student-auth-wrapper"),children:[t.jsx(F,{path:"/student",element:t.jsx(In,{to:"/student/dashboard",replace:!0})}),...hA]}),t.jsx(F,{path:"*",element:t.jsx(qy,{})}),t.jsx(F,{path:"*",element:t.jsx(fo,{fallback:t.jsx(In,{to:"/login",replace:!0}),children:t.jsx(Go,{})},"catch-all-redirect")})]}),t.jsx(By,{}),t.jsx(Vy,{})]})})}const CA=document.getElementById("root"),TA=vj.createRoot(CA);TA.render(t.jsxs(L.StrictMode,{children:[t.jsx(SA,{}),t.jsx(_y,{position:"top-right",richColors:!0,closeButton:!0,duration:4e3,toastOptions:{style:{width:"500px",fontSize:"20px"},className:"sonner-toast"}})]}));
