var di=Object.defineProperty;var mi=(s,a,t)=>a in s?di(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;var Ys=(s,a,t)=>mi(s,typeof a!="symbol"?a+"":a,t);import{j as e,R as ha,I as ja,F as ga,S as Wt,a as ya,P as ui,C as fa,b as wa,V as xi,c as pi,d as ba,e as hi,T as va,f as ji,g as Na,h as za,i as gi,k as ka,l as yi,L as Ca,m as _a,n as fi,o as wi,p as Sa,q as bi,r as vi,s as Ta,t as Pa,u as Ia,v as qa,w as Ni,x as Ma,y as zi,z as xs,A as La,B as Ut,D as as,E as se,G as ki,H as Ci,J as _i,K as Da,M as Si,N as Ti,O as Pi,Q as Ii,U as Ea,W as Ra,X as Aa,Y as mt,Z as qi,_ as Mi,$ as Li,a0 as Di,a1 as Ei,a2 as Ri,a3 as Ai,a4 as Oi,a5 as $i,a6 as Fi,a7 as Wi,a8 as Ui,a9 as Oa,aa as Gi,ab as Bi,ac as Ki,ad as ra,ae as $a,af as Zi,ag as Fa,ah as Wa,ai as Qi}from"./radix-ui-B-S1bak9.js";import{l as Vi,a as h,n as Hi,R as G,d as Ua,e as B,o as L,u as ye,p as Rs,N as gs,L as Is,B as Ji,q as Yi,O as Xi}from"./react-vendor-DEevTyTQ.js";import{c as en,t as A,M as rt,T as sn}from"./utils-0bnMhKyC.js";import{n as Ne,M as Ga,d as tn,e as pe,f as ys,I as ut,i as ue,$ as de,X as Ze,j as an,k as rn,H as nn,w as ln,l as on,m as cn,o as dn,p as mn,D as un,t as xn,E as ia,u as pn,_ as hn,x as jn}from"./refine-core-DyM63hwY.js";import{c as gn,k as Fe,b as yn,I as fn}from"./refine-ui-B9n_E-Zs.js";import{t as wn,c as bn,U as Qe,M as es,G as fs,a as vn,S as xt,b as pt,C as Gt,d as Nn,e as ge,f as Bt,X as Pe,L as Ba,T as be,H as zn,B as xe,g as Et,A as Ms,h as kn,i as Ls,F as ht,j as Cn,k as je,l as Ka,m as $e,n as jt,o as _n,p as gt,q as ns,r as Za,P as Ye,s as Je,u as he,E as As,v as Ae,w as We,x as ls,y as ss,z as ve,D as me,I as Qa,J as Xe,K as yt,N as Ue,O as Le,W as Kt,Q as Sn,R as Os,V as Ve,Y as lt,Z as $s,_ as Fs,$ as ot,a0 as Va,a1 as Tn,a2 as Ha,a3 as Pn,a4 as In,a5 as Ws,a6 as Zt,a7 as ft,a8 as qn,a9 as Mn,aa as Ln,ab as ws,ac as Xs,ad as Dn,ae as En,af as Qt,ag as Rn,ah as Ja,ai as os,aj as An,ak as On,al as $n,am as Fn,an as Ke,ao as na}from"./ui-utils-nc9I8LbU.js";import{R as Wn,A as Un,a as Gn,X as Bn,Y as Kn}from"./tables-COT5ymP3.js";import"./forms-B2VSq9sJ.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var et={},la;function Zn(){if(la)return et;la=1;var s=Vi();return et.createRoot=s.createRoot,et.hydrateRoot=s.hydrateRoot,et}var Qn=Zn();const Vn="https://hqsyimochfcfqahcuprn.supabase.co",Hn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhxc3lpbW9jaGZjZnFhaGN1cHJuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NjU4NTYsImV4cCI6MjA2OTQ0MTg1Nn0.KutvVrkDKuVyvrYQosU3SI6QrrMnWqDCSZ2E3fhCteI",Y=gn(Vn,Hn,{db:{schema:"public"},auth:{persistSession:!0}}),F=(...s)=>wn(bn(s));class It extends Error{constructor(t,r,n,i){super(t);Ys(this,"code");Ys(this,"statusCode");Ys(this,"details");this.name="AuthError",this.code=r,this.statusCode=n||400,this.details=i}}const st={user_already_exists:"Konto z tym adresem email już istnieje.",password_too_short:"Hasło musi mieć co najmniej 6 znaków.",password_too_long:"Hasło nie może być dłuższe niż 72 znaki.",invalid_email:"Nieprawidłowy format adresu email.",over_email_send_rate_limit:"Za szybko! Poczekaj 2 sekundy przed ponowną próbą.",registration_failed:"Rejestracja nie powiodła się.",invalid_credentials:"Nieprawidłowy email lub hasło.",email_not_confirmed:"Potwierdź swój adres email przed zalogowaniem.",user_not_found:"Nie znaleziono użytkownika.",reset_password_rate_limit:"Zbyt wiele prób. Spróbuj ponownie za chwilę.",invalid_recovery_token:"Link do resetowania hasła wygasł lub jest nieprawidłowy.",update_failed:"Aktualizacja nie powiodła się.",session_expired:"Sesja wygasła. Zaloguj się ponownie.",oauth_error:"Błąd podczas logowania przez zewnętrznego dostawcę.",oauth_cancelled:"Logowanie zostało anulowane.",unknown_error:"Wystąpił nieoczekiwany błąd. Spróbuj ponownie.",network_error:"Błąd połączenia. Sprawdź swoje połączenie internetowe."},we=s=>{if(!s)return new It(st.unknown_error,"unknown_error");if(s instanceof It)return s;const a=s.message||s.error_description||"",t=s.code||s.error||"";let r="unknown_error",n=st.unknown_error,i=400;if(t)switch(t){case"user_already_exists":case"user_already_registered":r="user_already_exists",i=409;break;case"weak_password":r="password_too_short",i=422;break;case"invalid_email":r="invalid_email",i=422;break;case"over_email_send_rate_limit":r="over_email_send_rate_limit",i=429;break;case"invalid_credentials":r="invalid_credentials",i=401;break;case"email_not_confirmed":r="email_not_confirmed",i=403;break;case"session_not_found":r="session_expired",i=401;break}return r==="unknown_error"&&(a.includes("User already registered")||a.includes("already exists")?(r="user_already_exists",i=409):a.includes("Password should be at least")?(r="password_too_short",i=422):a.includes("Password cannot be longer than 72")?(r="password_too_long",i=422):a.includes("Invalid email")?(r="invalid_email",i=422):a.includes("over_email_send_rate_limit")?(r="over_email_send_rate_limit",i=429):a.includes("Invalid login credentials")?(r="invalid_credentials",i=401):a.includes("Email not confirmed")?(r="email_not_confirmed",i=403):a.includes("Network request failed")&&(r="network_error",i=503)),n=st[r]||a||st.unknown_error,new It(n,r,i,{originalError:a,originalCode:t})};let is=null,Ts=0;const oa=6e4,Rt={login:async({email:s,password:a})=>{try{const{data:t,error:r}=await Y.auth.signInWithPassword({email:s,password:a});return r?{success:!1,error:we(r)}:(is=null,Ts=0,{success:!0,redirectTo:"/dashboard/overview"})}catch(t){return{success:!1,error:we(t)}}},logout:async()=>{try{const{error:s}=await Y.auth.signOut();return is=null,Ts=0,s?{success:!1,error:we(s)}:{success:!0,redirectTo:"/login"}}catch(s){return{success:!1,error:we(s)}}},check:async()=>{try{const{data:s}=await Y.auth.getSession();return s?.session?{authenticated:!0}:{authenticated:!1,redirectTo:"/login"}}catch{return{authenticated:!1,redirectTo:"/login"}}},getIdentity:async()=>{try{const s=Date.now();if(is&&s-Ts<oa)return is;const{data:{session:a}}=await Y.auth.getSession();if(!a)return null;const{data:t,error:r}=await Y.from("users").select("*").eq("id",a.user.id).single();if(r||!t)return console.error("Error fetching user data:",r),{id:a.user.id,email:a.user.email||"",full_name:a.user.user_metadata?.full_name||"User",vendor_id:1,role:"student"};const n={id:t.id,email:t.email,full_name:t.full_name,vendor_id:t.vendor_id,role:t.role,is_active:t.is_active,created_at:t.created_at};return is=n,Ts=s,n}catch(s){return console.error("Error in getIdentity:",s),null}},register:async({email:s,password:a,name:t})=>{try{if(console.log("🚀 Starting registration:",{email:s,name:t}),!s||!a)return{success:!1,error:we({message:"Email i hasło są wymagane",code:"validation_error"})};if(a.length<6)return{success:!1,error:we({message:"Password should be at least 6 characters",code:"weak_password"})};if(a.length>72)return{success:!1,error:we({message:"Password cannot be longer than 72 characters",code:"password_too_long"})};const{data:r,error:n}=await Y.auth.signUp({email:s.trim(),password:a,options:{data:{full_name:t||s.split("@")[0],role:"student"},emailRedirectTo:`${window.location.origin}/login?verified=true`}});return n?(console.error("❌ Registration error:",n),{success:!1,error:we(n)}):r.user?(console.log("✅ Registration successful:",r.user.id),{success:!0,successNotification:{message:"Rejestracja udana! Sprawdź swoją skrzynkę email.",description:"Wysłaliśmy link aktywacyjny na podany adres email."}}):{success:!1,error:we({message:"Rejestracja nie powiodła się - brak danych użytkownika",code:"registration_failed"})}}catch(r){return console.error("❌ Unexpected registration error:",r),{success:!1,error:we(r)}}},forgotPassword:async({email:s})=>{try{const{error:a}=await Y.auth.resetPasswordForEmail(s,{redirectTo:`${window.location.origin}/update-password`});return a?{success:!1,error:we(a)}:{success:!0,successNotification:{message:"Email wysłany!",description:"Sprawdź swoją skrzynkę odbiorczą"}}}catch(a){return{success:!1,error:we(a)}}},updatePassword:async({password:s})=>{try{const{error:a}=await Y.auth.updateUser({password:s});return a?{success:!1,error:we(a)}:{success:!0,redirectTo:"/login?passwordChanged=true"}}catch(a){return{success:!1,error:we(a)}}},getPermissions:async()=>{try{const s=Date.now();if(is&&s-Ts<oa)return is.role;const{data:{session:a}}=await Y.auth.getSession();if(!a)return null;const{data:t,error:r}=await Y.from("users").select("role").eq("id",a.user.id).single();return r||!t?(console.error("Error fetching user permissions:",r),"student"):t.role}catch{return null}},onError:async s=>(console.error("Auth error:",s),s?.statusCode===401?{redirectTo:"/login",logout:!0,error:s}:{error:s})},wt=({isLoading:s,isError:a,loadingText:t="Loading...",errorMsg:r="Error loading data"})=>s?e.jsx("div",{className:"p-6 text-gray-600 animate-reverse-pulse",children:t}):a?e.jsx("div",{className:"p-6 text-red-500",children:r}):null;function Jn(s,a){let t;try{t=s()}catch{return}return{getItem:n=>{var i;const l=c=>c===null?null:JSON.parse(c,void 0),o=(i=t.getItem(n))!=null?i:null;return o instanceof Promise?o.then(l):l(o)},setItem:(n,i)=>t.setItem(n,JSON.stringify(i,void 0)),removeItem:n=>t.removeItem(n)}}const At=s=>a=>{try{const t=s(a);return t instanceof Promise?t:{then(r){return At(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return At(r)(t)}}}},Yn=(s,a)=>(t,r,n)=>{let i={storage:Jn(()=>localStorage),partialize:j=>j,version:0,merge:(j,v)=>({...v,...j}),...a},l=!1;const o=new Set,c=new Set;let m=i.storage;if(!m)return s((...j)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...j)},r,n);const p=()=>{const j=i.partialize({...r()});return m.setItem(i.name,{state:j,version:i.version})},d=n.setState;n.setState=(j,v)=>{d(j,v),p()};const u=s((...j)=>{t(...j),p()},r,n);n.getInitialState=()=>u;let x;const f=()=>{var j,v;if(!m)return;l=!1,o.forEach(y=>{var C;return y((C=r())!=null?C:u)});const w=((v=i.onRehydrateStorage)==null?void 0:v.call(i,(j=r())!=null?j:u))||void 0;return At(m.getItem.bind(m))(i.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==i.version){if(i.migrate){const C=i.migrate(y.state,y.version);return C instanceof Promise?C.then(S=>[!0,S]):[!0,C]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var C;const[S,W]=y;if(x=i.merge(W,(C=r())!=null?C:u),t(x,!0),S)return p()}).then(()=>{w?.(x,void 0),x=r(),l=!0,c.forEach(y=>y(x))}).catch(y=>{w?.(void 0,y)})};return n.persist={setOptions:j=>{i={...i,...j},j.storage&&(m=j.storage)},clearStorage:()=>{m?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>f(),hasHydrated:()=>l,onHydrate:j=>(o.add(j),()=>{o.delete(j)}),onFinishHydration:j=>(c.add(j),()=>{c.delete(j)})},i.skipHydration||f(),x||u},Xn=Yn;class el{static async call(a,t,r={}){const i={message:this.interpolateTemplate(t.user,r),...t.system&&{system:t.system},...a.model&&{model:a.model}},l=await fetch(a.endpoint,{method:"POST",headers:{"Content-Type":"application/json",...a.apiKey&&{Authorization:`Bearer ${a.apiKey}`}},body:JSON.stringify(i)});if(!l.ok)throw new Error(`LLM API Error: ${l.status} ${l.statusText}`);const o=await l.json();let c=o.response||o.data||o.text||"";return t.responseFormat==="json"?(c=this.cleanJsonResponse(c),JSON.parse(c)):c}static interpolateTemplate(a,t){return a.replace(/\{\{(\w+)\}\}/g,(r,n)=>t[n]!==void 0?String(t[n]):r)}static cleanJsonResponse(a){return a.replace(/```(?:json)?\s*([\s\S]*?)\s*```/,"$1").trim()}}const ne=en()(Xn((s,a)=>({processes:{},formData:{},llmOperations:{},registeredLLMOperations:{},register:t=>s(r=>({processes:{...r.processes,[t.id]:t}})),unregister:(t,r="all")=>s(n=>{switch(r){case"all":{const{[t]:i,...l}=n.processes,{[t]:o,...c}=n.formData,m=Object.keys(n.llmOperations).filter(d=>!d.startsWith(`${t}-`)).reduce((d,u)=>(d[u]=n.llmOperations[u],d),{}),p=Object.keys(n.registeredLLMOperations).filter(d=>!d.startsWith(`${t}-`)).reduce((d,u)=>(d[u]=n.registeredLLMOperations[u],d),{});return{processes:l,formData:c,llmOperations:m,registeredLLMOperations:p}}case"data":{const{[t]:i,...l}=n.formData;return{...n,formData:l}}default:return n}}),get:t=>a().processes[t]||null,getSchemaFragment:t=>{const[r,...n]=t.split("."),i=a().processes[r];if(!i)return null;let l=i.schema;for(const o of n)l=l?.[o];return l},setData:(t,r)=>s(n=>({formData:{...n.formData,[t]:{...n.formData[t],...r}}})),getData:t=>a().formData[t]||{},reset:t=>s(r=>({formData:{...r.formData,[t]:{}}})),registerLLMOperation:(t,r)=>s(n=>({registeredLLMOperations:{...n.registeredLLMOperations,[`${t}-${r.id}`]:r}})),unregisterLLMOperation:(t,r)=>s(n=>{const{[`${t}-${r}`]:i,...l}=n.registeredLLMOperations;return{registeredLLMOperations:l}}),executeLLMOperation:async(t,r,n={})=>{const i=`${t}-${r}`,l=a().registeredLLMOperations[i];if(!l)throw new Error(`LLM Operation not found: ${i}`);try{a().setLLMOperationState(t,r,{loading:!0,error:null});const o=a().getData(t),c={...o,...n},m=l.inputMapping?l.inputMapping(c):c,p=await el.call(l.config,l.prompt,m);if(l.validation&&!l.validation(p))throw new Error("LLM result failed validation");let d=p;return l.outputMapping&&(d=l.outputMapping(p,o),a().setData(t,d)),a().setLLMOperationState(t,r,{loading:!1,error:null,result:p}),p}catch(o){throw a().setLLMOperationState(t,r,{loading:!1,error:o.message||"Unknown error",result:null}),o}},setLLMOperationState:(t,r,n)=>s(i=>({llmOperations:{...i.llmOperations,[`${t}-${r}`]:n}})),getLLMOperationState:(t,r)=>a().llmOperations[`${t}-${r}`]||{loading:!1,error:null},clearLLMOperation:(t,r)=>s(n=>{const{[`${t}-${r}`]:i,...l}=n.llmOperations;return{llmOperations:l}})}),{name:"form-schema-store",version:2,partialize:s=>({processes:s.processes,formData:s.formData})})),Ns=(s,a)=>{const{registerLLMOperation:t,unregisterLLMOperation:r,executeLLMOperation:n,getLLMOperationState:i,clearLLMOperation:l}=ne();return{...i(s,a),registerOperation:u=>{t(s,u)},executeOperation:async u=>await n(s,a,u),clearOperation:()=>{l(s,a)},unregisterOperation:()=>{r(s,a)}}},Ot=h.forwardRef(({className:s,...a},t)=>e.jsx(ha,{ref:t,className:F("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...a}));Ot.displayName=ha.displayName;const sl=h.forwardRef(({className:s,...a},t)=>e.jsx(ja,{ref:t,className:F("aspect-square h-full w-full object-cover",s),...a}));sl.displayName=ja.displayName;const $t=h.forwardRef(({className:s,...a},t)=>e.jsx(ga,{ref:t,className:F("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...a}));$t.displayName=ga.displayName;function tt({className:s,...a}){return e.jsx("div",{className:F("animate-pulse rounded-md bg-primary/10",s),...a})}const tl=({className:s="",showRole:a=!0,showEmail:t=!0,compact:r=!1})=>{const{data:n,isLoading:i,error:l}=Ne(),o=u=>{switch(u){case"admin":return e.jsx(xt,{className:"h-3 w-3"});case"teacher":return e.jsx(vn,{className:"h-3 w-3"});case"student":return e.jsx(fs,{className:"h-3 w-3"});default:return e.jsx(Qe,{className:"h-3 w-3"})}},c=u=>{switch(u){case"admin":return"Administrator";case"teacher":return"Nauczyciel";case"student":return"Uczeń";default:return"Użytkownik"}},m=u=>{switch(u){case"admin":return"text-purple-600 bg-purple-50";case"teacher":return"text-blue-600 bg-blue-50";case"student":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}};if(i)return e.jsxs("div",{className:`flex items-center space-x-3 p-3 ${s}`,children:[e.jsx(tt,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(tt,{className:"h-4 w-28"}),e.jsx(tt,{className:"h-3 w-20"}),a&&e.jsx(tt,{className:"h-3 w-16"})]})]});if(l||!n)return e.jsxs("div",{className:`flex items-center space-x-3 p-3 text-muted-foreground ${s}`,children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(Qe,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-gray-500",children:"Nie zalogowano"}),e.jsx("div",{className:"text-xs opacity-70",children:"Brak danych użytkownika"})]})]});const d=(u=>{if(!u)return"U";const x=u.trim().split(" ");return x.length>=2?`${x[0][0]}${x[x.length-1][0]}`.toUpperCase():u.slice(0,2).toUpperCase()})(n.full_name||n.email);return r?e.jsxs("div",{className:`flex items-center space-x-2 p-2 ${s}`,children:[e.jsx(Ot,{className:"h-8 w-8",children:e.jsx($t,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white text-xs",children:d})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"font-medium text-sm truncate",children:n.full_name})})]}):e.jsxs("div",{className:`flex items-center space-x-3 px-4 pt-4 rounded-lg bg-white/50 backdrop-blur-sm border border-purple-100/20 ${s}`,children:[e.jsx(Ot,{className:"h-12 w-12 ring-2 ring-purple-100 ring-offset-2",children:e.jsx($t,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white font-medium",children:d})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 truncate",title:n.full_name,children:n.full_name}),t&&n.email&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-500",children:[e.jsx(es,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",title:n.email,children:n.email})]}),a&&n.role&&e.jsx("div",{className:"inline-flex items-center gap-1.5",children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full text-xs font-medium ${m(n.role)}`,children:[o(n.role),c(n.role)]})})]})]})},al=pt("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),te=h.forwardRef(({className:s,variant:a,...t},r)=>e.jsx("div",{ref:r,role:"alert",className:F(al({variant:a}),s),...t}));te.displayName="Alert";const rl=h.forwardRef(({className:s,...a},t)=>e.jsx("h5",{ref:t,className:F("mb-1 font-medium leading-none tracking-tight",s),...a}));rl.displayName="AlertTitle";const ae=h.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:F("text-sm [&_p]:leading-relaxed",s),...a}));ae.displayName="AlertDescription";const il=pt("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Q({className:s,variant:a,asChild:t=!1,...r}){const n=t?Wt:"span";return e.jsx(n,{"data-slot":"badge",className:F(il({variant:a}),s),...r})}const nl=h.forwardRef(({...s},a)=>e.jsx("nav",{ref:a,"aria-label":"breadcrumb",...s}));nl.displayName="Breadcrumb";const ll=h.forwardRef(({className:s,...a},t)=>e.jsx("ol",{ref:t,className:F("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",s),...a}));ll.displayName="BreadcrumbList";const ol=h.forwardRef(({className:s,...a},t)=>e.jsx("li",{ref:t,className:F("inline-flex items-center gap-1.5",s),...a}));ol.displayName="BreadcrumbItem";const cl=h.forwardRef(({asChild:s,className:a,...t},r)=>{const n=s?Wt:"a";return e.jsx(n,{ref:r,className:F("transition-colors hover:text-foreground",a),...t})});cl.displayName="BreadcrumbLink";const dl=h.forwardRef(({className:s,...a},t)=>e.jsx("span",{ref:t,role:"link","aria-disabled":"true","aria-current":"page",className:F("font-normal text-foreground",s),...a}));dl.displayName="BreadcrumbPage";const ml=pt("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),g=h.forwardRef(({className:s,variant:a,size:t,asChild:r=!1,...n},i)=>{const l=r?Wt:"button";return e.jsx(l,{className:F(ml({variant:a,size:t,className:s})),ref:i,...n})});g.displayName="Button";const z=h.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:F("rounded-xl border bg-card text-card-foreground shadow flex flex-col overflow-hidden",s),...a}));z.displayName="Card";const I=h.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:F("flex flex-col space-y-1.5 p-6 pb-3 bg-pink-200/25",s),...a}));I.displayName="CardHeader";const T=h.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:F("text-lg font-semibold leading-tight tracking-tight pt-3",s),...a}));T.displayName="CardTitle";const ts=h.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:F("text-sm text-muted-foreground",s),...a}));ts.displayName="CardDescription";const k=h.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:F("p-3 lg:p-6 pt-3 space-y-3 flex-1 bg-background",s),...a}));k.displayName="CardContent";const ul=h.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:F("flex items-center justify-between p-6 pt-0",s),...a}));ul.displayName="CardFooter";const xl=pt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),K=h.forwardRef(({className:s,...a},t)=>e.jsx(ya,{ref:t,className:F(xl(),s),...a}));K.displayName=ya.displayName;h.createContext({});h.createContext({});const D=h.forwardRef(({className:s,type:a,...t},r)=>e.jsx("input",{type:a,className:F("flex h-9 w-full rounded-md border border-input bg-background px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...t}));D.displayName="Input";const pl=h.forwardRef(({className:s,align:a="center",sideOffset:t=4,...r},n)=>e.jsx(ui,{children:e.jsx(fa,{ref:n,align:a,sideOffset:t,className:F("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",s),...r})}));pl.displayName=fa.displayName;const Ya=h.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(wa,{ref:r,className:F("relative overflow-hidden",s),...t,children:[e.jsx(xi,{className:"h-full w-full rounded-[inherit]",children:a}),e.jsx(Xa,{}),e.jsx(pi,{})]}));Ya.displayName=wa.displayName;const Xa=h.forwardRef(({className:s,orientation:a="vertical",...t},r)=>e.jsx(ba,{ref:r,orientation:a,className:F("flex touch-none select-none transition-colors",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...t,children:e.jsx(hi,{className:"relative flex-1 rounded-full bg-border"})}));Xa.displayName=ba.displayName;const le=bi,oe=vi,re=h.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(va,{ref:r,className:F("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...t,children:[a,e.jsx(ji,{asChild:!0,children:e.jsx(Gt,{className:"h-4 w-4 opacity-50"})})]}));re.displayName=va.displayName;const er=h.forwardRef(({className:s,...a},t)=>e.jsx(Na,{ref:t,className:F("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Nn,{className:"h-4 w-4"})}));er.displayName=Na.displayName;const sr=h.forwardRef(({className:s,...a},t)=>e.jsx(za,{ref:t,className:F("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Gt,{className:"h-4 w-4"})}));sr.displayName=za.displayName;const ie=h.forwardRef(({className:s,children:a,position:t="popper",...r},n)=>e.jsx(gi,{children:e.jsxs(ka,{ref:n,className:F("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:t,...r,children:[e.jsx(er,{}),e.jsx(yi,{className:F("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(sr,{})]})}));ie.displayName=ka.displayName;const hl=h.forwardRef(({className:s,...a},t)=>e.jsx(Ca,{ref:t,className:F("px-2 py-1.5 text-sm font-semibold",s),...a}));hl.displayName=Ca.displayName;const E=h.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(_a,{ref:r,className:F("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(fi,{children:e.jsx(ge,{className:"h-4 w-4"})})}),e.jsx(wi,{children:a})]}));E.displayName=_a.displayName;const jl=h.forwardRef(({className:s,...a},t)=>e.jsx(Sa,{ref:t,className:F("-mx-1 my-1 h-px bg-muted",s),...a}));jl.displayName=Sa.displayName;const Ge=h.forwardRef(({className:s,orientation:a="horizontal",decorative:t=!0,...r},n)=>e.jsx(Ta,{ref:n,decorative:t,orientation:a,className:F("shrink-0 bg-border",a==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...r}));Ge.displayName=Ta.displayName;const De=h.forwardRef(({className:s,...a},t)=>e.jsx("textarea",{className:F("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...a}));De.displayName="Textarea";const gl=Ni,tr=h.forwardRef(({className:s,...a},t)=>e.jsx(Pa,{ref:t,className:F("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...a}));tr.displayName=Pa.displayName;const it=h.forwardRef(({className:s,...a},t)=>e.jsx(Ia,{ref:t,className:F("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...a}));it.displayName=Ia.displayName;const ar=h.forwardRef(({className:s,...a},t)=>e.jsx(qa,{ref:t,className:F("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));ar.displayName=qa.displayName;const Te=h.forwardRef(({className:s,...a},t)=>e.jsx(Ma,{ref:t,className:F("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...a,children:e.jsx(zi,{className:F("flex items-center justify-center text-current"),children:e.jsx(ge,{className:"h-4 w-4"})})}));Te.displayName=Ma.displayName;var bt="Switch",[yl,Zd]=Ut(bt),[fl,wl]=yl(bt),rr=h.forwardRef((s,a)=>{const{__scopeSwitch:t,name:r,checked:n,defaultChecked:i,required:l,disabled:o,value:c="on",onCheckedChange:m,form:p,...d}=s,[u,x]=h.useState(null),f=xs(a,C=>x(C)),j=h.useRef(!1),v=u?p||!!u.closest("form"):!0,[w,y]=La({prop:n,defaultProp:i??!1,onChange:m,caller:bt});return e.jsxs(fl,{scope:t,checked:w,disabled:o,children:[e.jsx(as.button,{type:"button",role:"switch","aria-checked":w,"aria-required":l,"data-state":or(w),"data-disabled":o?"":void 0,disabled:o,value:c,...d,ref:f,onClick:se(s.onClick,C=>{y(S=>!S),v&&(j.current=C.isPropagationStopped(),j.current||C.stopPropagation())})}),v&&e.jsx(lr,{control:u,bubbles:!j.current,name:r,value:c,checked:w,required:l,disabled:o,form:p,style:{transform:"translateX(-100%)"}})]})});rr.displayName=bt;var ir="SwitchThumb",nr=h.forwardRef((s,a)=>{const{__scopeSwitch:t,...r}=s,n=wl(ir,t);return e.jsx(as.span,{"data-state":or(n.checked),"data-disabled":n.disabled?"":void 0,...r,ref:a})});nr.displayName=ir;var bl="SwitchBubbleInput",lr=h.forwardRef(({__scopeSwitch:s,control:a,checked:t,bubbles:r=!0,...n},i)=>{const l=h.useRef(null),o=xs(l,i),c=ki(t),m=Ci(a);return h.useEffect(()=>{const p=l.current;if(!p)return;const d=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(d,"checked").set;if(c!==t&&x){const f=new Event("click",{bubbles:r});x.call(p,t),p.dispatchEvent(f)}},[c,t,r]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...n,tabIndex:-1,ref:o,style:{...n.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});lr.displayName=bl;function or(s){return s?"checked":"unchecked"}var cr=rr,vl=nr;const Oe=h.forwardRef(({className:s,...a},t)=>e.jsx(cr,{className:F("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...a,ref:t,children:e.jsx(vl,{className:F("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Oe.displayName=cr.displayName;const qt=Si,Mt=Ti,Lt=Pi,nt=h.forwardRef(({className:s,sideOffset:a=4,...t},r)=>e.jsx(_i,{children:e.jsx(Da,{ref:r,sideOffset:a,className:F("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s),...t})}));nt.displayName=Da.displayName;const Nl=({onClose:s})=>{const{mutate:a}=Ga(),{menuItems:t}=tn(),{data:r}=Ne(),n=()=>{s&&s()},i=r?.role,l=t.filter(o=>o.meta?.roles?o.meta.roles.includes(i):!0);return e.jsxs("div",{className:"flex h-full w-64 flex-col border-r bg-background",children:[e.jsxs("div",{className:"flex h-16 items-center justify-between border-b px-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Bt,{className:"h-6 w-6 mr-2"}),e.jsx("span",{className:"font-semibold",children:"Smart Up"})]}),s&&e.jsx(g,{variant:"ghost",size:"sm",onClick:s,className:"lg:hidden",children:e.jsx(Pe,{className:"h-4 w-4"})})]}),e.jsx(Ya,{className:"flex-1 px-3 py-4",children:e.jsx("nav",{className:"space-y-2",children:l.map(o=>e.jsxs(Hi,{to:o.route??"/",onClick:n,className:({isActive:c})=>F("flex items-center rounded-md px-3 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground",c?"bg-accent text-accent-foreground":"text-muted-foreground"),children:[o.icon&&e.jsx("span",{className:"mr-3 flex items-center",children:(G.isValidElement(o.icon),o.icon)}),o.label]},o.key))})}),e.jsx(Ge,{}),e.jsx(tl,{className:"border-b"}),e.jsx("div",{className:"p-4",children:e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>{a(),s&&s()},className:"w-full justify-start",children:[e.jsx(Ba,{className:"mr-2 h-4 w-4"}),"Logout"]})})]})},zl=({onClose:s})=>{const a=Ua(),t=B(),{data:r}=Ne(),{mutate:n}=Ga(),i=[{id:"dashboard",path:"/student/dashboard",label:"Dashboard",icon:zn},{id:"courses",path:"/student/courses",label:"Kursy",icon:xe},{id:"gamification",path:"/student/gamification",label:"Gamifikacja",icon:Et},{id:"leaderboard",path:"/student/leaderboard",label:"Ranking",icon:be},{id:"achievements",path:"/student/achievements",label:"Osiągnięcia",icon:Ms},{id:"profile",path:"/student/profile",label:"Profil",icon:Qe}],l=c=>a.pathname.startsWith(c),o=c=>{t(c),s?.()};return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-600 to-purple-700 rounded-xl flex items-center justify-center",children:e.jsx(be,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-xl font-bold",children:"Smart Up"})]}),s&&e.jsx(g,{variant:"ghost",size:"icon",onClick:s,className:"lg:hidden",children:e.jsx(Pe,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"p-4 border-b",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center text-white font-bold",children:r?.full_name?.charAt(0)||"U"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:r?.full_name}),e.jsx("p",{className:"text-xs text-gray-500",children:"Uczeń"})]})]})}),e.jsx("nav",{className:"flex-1 p-4 space-y-1",children:i.map(c=>e.jsxs("button",{onClick:()=>o(c.path),className:F("w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all",l(c.path)?"bg-purple-50 text-purple-700 font-medium":"text-gray-600 hover:bg-gray-50"),children:[e.jsx(c.icon,{className:"w-5 h-5"}),e.jsx("span",{children:c.label})]},c.id))}),e.jsxs("div",{className:"p-4 border-t space-y-1",children:[e.jsxs("button",{onClick:()=>o("/student/settings"),className:"w-full flex items-center gap-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition-all",children:[e.jsx(kn,{className:"w-5 h-5"}),e.jsx("span",{children:"Ustawienia"})]}),e.jsxs("button",{onClick:()=>n(),className:"w-full flex items-center gap-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition-all",children:[e.jsx(Ba,{className:"w-5 h-5"}),e.jsx("span",{children:"Wyloguj"})]})]})]})},vt=()=>{const[s,a]=h.useState({points:0,level:1,streak:0,idle_rate:1,next_level_points:200,quizzes_completed:0,perfect_scores:0,total_time:0,rank:0}),[t,r]=h.useState(!0),n=h.useCallback(async()=>{try{r(!0);const{data:i,error:l}=await Y.rpc("get_my_stats");if(l)throw l;i&&a({points:i.points||0,level:i.level||1,streak:i.streak||0,idle_rate:i.idle_rate||1,next_level_points:i.next_level_points||200,quizzes_completed:i.quizzes_completed||0,perfect_scores:i.perfect_scores||0,total_time:i.total_time||0,rank:i.rank||0})}catch(i){console.error("Error fetching stats:",i)}finally{r(!1)}},[]);return h.useEffect(()=>{n()},[n]),{stats:s,setStats:a,isLoading:t,refetch:n}},Us=(s,a,t)=>{const[r,n]=h.useState(null),[i,l]=h.useState(!0),[o,c]=h.useState(null),m=h.useCallback(async()=>{if(t?.enabled!==!1)try{l(!0),c(null);const{data:p,error:d}=await Y.rpc(s,a);if(d)throw d;n(p),t?.onSuccess?.(p)}catch(p){c(p),t?.onError?.(p)}finally{l(!1)}},[s,JSON.stringify(a),t?.enabled]);return h.useEffect(()=>{m()},[m]),{data:r,isLoading:i,error:o,refetch:m}},dr=(s,a)=>{const[t,r]=h.useState([]),[n,i]=h.useState(!0),[l,o]=h.useState(null),c=h.useCallback(async()=>{if(a?.enabled!==!1)try{i(!0),o(null);let m=Y.from(s).select(a?.select||"*");a?.filters?.forEach(u=>{switch(u.operator){case"eq":m=m.eq(u.field,u.value);break;case"in":m=m.in(u.field,u.value);break;case"contains":m=m.ilike(u.field,`%${u.value}%`);break}}),a?.sorts?.forEach(u=>{m=m.order(u.field,{ascending:u.order==="asc"})}),a?.limit&&(m=m.limit(a.limit));const{data:p,error:d}=await m;if(d)throw d;r(p||[])}catch(m){o(m)}finally{i(!1)}},[s,JSON.stringify(a)]);return h.useEffect(()=>{c()},[c]),{data:t,isLoading:n,error:l,refetch:c}},kl=({onMenuClick:s})=>{const{stats:a}=vt();return e.jsx("div",{className:"sticky top-0 z-30 border-b border-purple-200/20 bg-background/80 backdrop-blur-md",children:e.jsxs("div",{className:"flex h-16 items-center justify-between px-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(g,{variant:"ghost",size:"sm",onClick:s,className:"lg:hidden hover:bg-purple-100/20 hover:text-purple-700",children:e.jsx(Bt,{className:"h-6 w-6"})}),e.jsx("span",{className:"font-semibold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent lg:hidden",children:"Smart Up"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-purple-50 px-3 py-1.5 rounded-full",children:[e.jsx(Ls,{className:"w-4 h-4 text-purple-700"}),e.jsx("span",{className:"font-bold text-purple-700 text-sm",children:a.points})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-orange-50 px-3 py-1.5 rounded-full",children:[e.jsx(ht,{className:"w-4 h-4 text-orange-600"}),e.jsx("span",{className:"font-bold text-orange-600 text-sm",children:a.streak})]}),e.jsxs(g,{variant:"ghost",size:"icon",className:"relative",children:[e.jsx(Cn,{className:"w-5 h-5"}),e.jsx("span",{className:"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"})]})]})]})})},P=({children:s})=>e.jsx("div",{className:"p-2 md:p-12 space-y-6 max-w-7xl mx-auto",children:s}),Cl=({children:s})=>{const[a,t]=h.useState(!1),{data:r}=Ne(),n=r?.role==="student",i=()=>{t(!a)};return e.jsx("div",{className:"min-h-screen bg-stone-200 relative overflow-x-hidden",children:e.jsxs("div",{className:"flex relative",children:[a&&e.jsx("div",{className:"fixed inset-0 z-40 bg-purple-900/20 backdrop-blur-sm lg:hidden",onClick:()=>t(!1)}),e.jsx("aside",{className:`
            h-screen w-64 transform transition-transform duration-300 ease-in-out
            fixed left-0 top-0 z-50
            ${a?"translate-x-0":"-translate-x-full"}
            lg:translate-x-0
            bg-background/95 backdrop-blur-md border-r border-purple-200/20
          `,children:n?e.jsx(zl,{onClose:()=>t(!1)}):e.jsx(Nl,{onClose:()=>t(!1)})}),e.jsxs("main",{className:"flex-1 lg:ml-64 min-w-0 relative z-10",children:[n?e.jsx(kl,{onMenuClick:i}):e.jsxs("div",{className:"sticky top-0 z-30 flex h-16 items-center border-b border-purple-200/20 bg-background/80 backdrop-blur-md px-4 lg:hidden",children:[e.jsx(g,{variant:"ghost",size:"sm",onClick:i,className:"mr-2 hover:bg-purple-100/20 hover:text-purple-700",children:e.jsx(Bt,{className:"h-6 w-6"})}),e.jsx("span",{className:"font-semibold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Smart Up"})]}),s]})]})})},_l={"between-center":"flex justify-between items-center gap-2",center:"flex justify-center items-center gap-2",start:"flex justify-start items-center gap-2",end:"flex justify-end items-center gap-2"},_=({children:s,variant:a="between-center",className:t=""})=>{const r=_l[a],n=t?`${r} ${t}`:r;return e.jsx("div",{className:n,children:s})},Sl={"1-2-3":"grid gap-6 md:grid-cols-2 lg:grid-cols-3","1-2-2":"grid gap-6 md:grid-cols-2","1-1-1":"grid gap-6","2-2-4":"grid gap-6 grid-cols-2 lg:grid-cols-4"},J=({children:s,variant:a="1-2-3",className:t=""})=>{const r=Sl[a],n=t?`${r} ${t}`:r;return e.jsx("div",{className:n,children:s})},Tl={card:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},lg:{wrap:"space-y-0",title:"text-3xl font-bold tracking-tight",description:"text-muted-foreground"},md:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},sm:{wrap:"space-y-1",title:"font-medium text-sm text-muted-foreground mb-1",description:"text-sm"}},V=({title:s,description:a,variant:t="lg"})=>{const r=Tl[t],n=()=>{switch(t){case"lg":return e.jsx("h1",{className:r.title,children:s});case"md":return e.jsx("h2",{className:r.title,children:s});case"sm":return e.jsx("h3",{className:r.title,children:s});default:return e.jsx("h1",{className:r.title,children:s})}};return t==="card"?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"text-lg font-semibold leading-tight flex items-center gap-2",children:s}),e.jsx(ts,{className:"text-sm text-muted-foreground mt-2",children:a})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:r.wrap,children:[n(),e.jsx("p",{className:`prose ${r.description}`,children:a})]})})},Pl=()=>{const{data:s,isLoading:a}=Ne(),[t,r]=h.useState(null),[n,i]=h.useState(!0);return h.useEffect(()=>{if(a||!s?.vendor_id){i(!1);return}let l=!0;return(async()=>{try{const[c,m,p,d,u]=await Promise.all([Y.from("users").select("*",{count:"exact",head:!0}).eq("vendor_id",s.vendor_id),Y.from("courses").select("*",{count:"exact"}).eq("vendor_id",s.vendor_id),Y.from("activities").select("*, topics!inner(course_id, courses!inner(vendor_id))",{count:"exact"}).eq("topics.courses.vendor_id",s.vendor_id),Y.from("activity_progress").select("score, completed_at").not("completed_at","is",null),Y.from("user_stats").select("total_points")]);if(!l)return;const x=d.data?.length?d.data.reduce((j,v)=>j+(v.score||0),0)/d.data.length:0,f=u.data?.reduce((j,v)=>j+v.total_points,0)||0;r({totalUsers:c.count||0,activeUsers:c.count||0,totalCourses:m.count||0,publishedCourses:m.data?.filter(j=>j.is_published).length||0,totalActivities:p.count||0,completedActivities:d.data?.length||0,averageScore:Math.round(x),totalPoints:f})}catch(c){console.error("Error fetching dashboard stats:",c)}finally{l&&i(!1)}})(),()=>{l=!1}},[s?.vendor_id,a]),n||a?e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):s?e.jsxs(P,{children:[e.jsx(V,{title:"Dashboard",description:"Przegląd statystyk systemu e-learning"}),e.jsxs(J,{variant:"1-2-2",children:[e.jsxs(z,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Użytkownicy"}),e.jsx(je,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(k,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t?.totalUsers||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t?.activeUsers||0," aktywnych"]})]})]}),e.jsxs(z,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Kursy"}),e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(k,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t?.totalCourses||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t?.publishedCourses||0," opublikowanych"]})]})]}),e.jsxs(z,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Aktywności"}),e.jsx(Ka,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(k,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t?.totalActivities||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t?.completedActivities||0," ukończonych"]})]})]}),e.jsxs(z,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Średni wynik"}),e.jsx($e,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(k,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[t?.averageScore||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"z wszystkich quizów"})]})]})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Aktywność w ostatnich 7 dniach"})}),e.jsx(k,{children:e.jsxs("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:[e.jsx(jt,{className:"h-8 w-8 mr-2"}),"Wykres aktywności (do implementacji)"]})})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Top 5 użytkowników"})}),e.jsx(k,{children:e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(l=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(be,{className:`h-5 w-5 ${l<=3?"text-yellow-500":"text-muted-foreground"}`}),e.jsxs("span",{children:["Użytkownik ",l]})]}),e.jsxs("span",{className:"font-semibold",children:[1e3-l*100," pkt"]})]},l))})})]})]}):e.jsx(P,{children:e.jsx("div",{className:"text-center text-muted-foreground",children:"Nie można załadować danych użytkownika"})})},Il={name:"dashboard",list:"/dashboard/overview",meta:{label:"Dashboard",icon:e.jsx(_n,{className:"h-4 w-4"})}},ql=[e.jsx(L,{path:"/dashboard/overview",element:e.jsx(Pl,{})},"dashboard")],Nt=({current:s,pageSize:a,total:t,setCurrent:r,setPageSize:n,itemName:i="elementów",pageSizeOptions:l=[10,20,50]})=>{const o=Math.ceil(t/a),c=(s-1)*a+1,m=Math.min(s*a,t),p=s>1,d=s<o,u=()=>{const x=[];if(o<=5)for(let j=1;j<=o;j++)x.push(j);else{x.push(1),s>3&&x.push("...");const j=Math.max(2,s-1),v=Math.min(o-1,s+1);for(let w=j;w<=v;w++)x.push(w);s<o-2&&x.push("..."),x.push(o)}return x};return t===0?null:e.jsxs(_,{className:"mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pokazuje ",c,"-",m," z ",t," ",i]}),e.jsxs(_,{className:"gap-2",children:[n&&e.jsxs(le,{value:a.toString(),onValueChange:x=>{n(parseInt(x)),r(1)},children:[e.jsx(re,{className:"w-[100px]",children:e.jsx(oe,{})}),e.jsx(ie,{children:l.map(x=>e.jsxs(E,{value:x.toString(),children:[x," / str."]},x))})]}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>r(s-1),disabled:!p,children:e.jsx(gt,{className:"w-4 h-4"})}),e.jsx("div",{className:"hidden sm:flex gap-1",children:u().map((x,f)=>x==="..."?e.jsx("span",{className:"px-3 py-1 text-sm text-muted-foreground",children:"..."},`ellipsis-${f}`):e.jsx(g,{variant:s===x?"default":"outline",size:"sm",onClick:()=>r(x),className:"min-w-[40px]",children:x},x))}),e.jsxs("div",{className:"flex sm:hidden items-center px-3 text-sm",children:[s," / ",o]}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>r(s+1),disabled:!d,children:e.jsx(ns,{className:"w-4 h-4"})})]})]})};var Ft=["Enter"," "],Ml=["ArrowDown","PageUp","Home"],mr=["ArrowUp","PageDown","End"],Ll=[...Ml,...mr],Dl={ltr:[...Ft,"ArrowRight"],rtl:[...Ft,"ArrowLeft"]},El={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Gs="Menu",[Ds,Rl,Al]=Ii(Gs),[ps,ur]=Ut(Gs,[Al,Ea,Ra]),zt=Ea(),xr=Ra(),[Ol,hs]=ps(Gs),[$l,Bs]=ps(Gs),pr=s=>{const{__scopeMenu:a,open:t=!1,children:r,dir:n,onOpenChange:i,modal:l=!0}=s,o=zt(a),[c,m]=h.useState(null),p=h.useRef(!1),d=Oa(i),u=Gi(n);return h.useEffect(()=>{const x=()=>{p.current=!0,document.addEventListener("pointerdown",f,{capture:!0,once:!0}),document.addEventListener("pointermove",f,{capture:!0,once:!0})},f=()=>p.current=!1;return document.addEventListener("keydown",x,{capture:!0}),()=>{document.removeEventListener("keydown",x,{capture:!0}),document.removeEventListener("pointerdown",f,{capture:!0}),document.removeEventListener("pointermove",f,{capture:!0})}},[]),e.jsx(Bi,{...o,children:e.jsx(Ol,{scope:a,open:t,onOpenChange:d,content:c,onContentChange:m,children:e.jsx($l,{scope:a,onClose:h.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:p,dir:u,modal:l,children:r})})})};pr.displayName=Gs;var Fl="MenuAnchor",Vt=h.forwardRef((s,a)=>{const{__scopeMenu:t,...r}=s,n=zt(t);return e.jsx(Mi,{...n,...r,ref:a})});Vt.displayName=Fl;var Ht="MenuPortal",[Wl,hr]=ps(Ht,{forceMount:void 0}),jr=s=>{const{__scopeMenu:a,forceMount:t,children:r,container:n}=s,i=hs(Ht,a);return e.jsx(Wl,{scope:a,forceMount:t,children:e.jsx(mt,{present:t||i.open,children:e.jsx(qi,{asChild:!0,container:n,children:r})})})};jr.displayName=Ht;var qe="MenuContent",[Ul,Jt]=ps(qe),gr=h.forwardRef((s,a)=>{const t=hr(qe,s.__scopeMenu),{forceMount:r=t.forceMount,...n}=s,i=hs(qe,s.__scopeMenu),l=Bs(qe,s.__scopeMenu);return e.jsx(Ds.Provider,{scope:s.__scopeMenu,children:e.jsx(mt,{present:r||i.open,children:e.jsx(Ds.Slot,{scope:s.__scopeMenu,children:l.modal?e.jsx(Gl,{...n,ref:a}):e.jsx(Bl,{...n,ref:a})})})})}),Gl=h.forwardRef((s,a)=>{const t=hs(qe,s.__scopeMenu),r=h.useRef(null),n=xs(a,r);return h.useEffect(()=>{const i=r.current;if(i)return Wi(i)},[]),e.jsx(Yt,{...s,ref:n,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:se(s.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),Bl=h.forwardRef((s,a)=>{const t=hs(qe,s.__scopeMenu);return e.jsx(Yt,{...s,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),Kl=Ri("MenuContent.ScrollLock"),Yt=h.forwardRef((s,a)=>{const{__scopeMenu:t,loop:r=!1,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:l,disableOutsidePointerEvents:o,onEntryFocus:c,onEscapeKeyDown:m,onPointerDownOutside:p,onFocusOutside:d,onInteractOutside:u,onDismiss:x,disableOutsideScroll:f,...j}=s,v=hs(qe,t),w=Bs(qe,t),y=zt(t),C=xr(t),S=Rl(t),[W,N]=h.useState(null),b=h.useRef(null),q=xs(a,b,v.onContentChange),O=h.useRef(0),M=h.useRef(""),H=h.useRef(0),$=h.useRef(null),R=h.useRef("right"),X=h.useRef(0),He=f?Ei:h.Fragment,_t=f?{as:Kl,allowPinchZoom:!0}:void 0,St=Z=>{const js=M.current+Z,rs=S().filter(ze=>!ze.disabled),_s=document.activeElement,Tt=rs.find(ze=>ze.ref.current===_s)?.textValue,Pt=rs.map(ze=>ze.textValue),ta=ro(Pt,js,Tt),Ss=rs.find(ze=>ze.textValue===ta)?.ref.current;(function ze(aa){M.current=aa,window.clearTimeout(O.current),aa!==""&&(O.current=window.setTimeout(()=>ze(""),1e3))})(js),Ss&&setTimeout(()=>Ss.focus())};h.useEffect(()=>()=>window.clearTimeout(O.current),[]),Di();const Be=h.useCallback(Z=>R.current===$.current?.side&&no(Z,$.current?.area),[]);return e.jsx(Ul,{scope:t,searchRef:M,onItemEnter:h.useCallback(Z=>{Be(Z)&&Z.preventDefault()},[Be]),onItemLeave:h.useCallback(Z=>{Be(Z)||(b.current?.focus(),N(null))},[Be]),onTriggerLeave:h.useCallback(Z=>{Be(Z)&&Z.preventDefault()},[Be]),pointerGraceTimerRef:H,onPointerGraceIntentChange:h.useCallback(Z=>{$.current=Z},[]),children:e.jsx(He,{..._t,children:e.jsx(Ai,{asChild:!0,trapped:n,onMountAutoFocus:se(i,Z=>{Z.preventDefault(),b.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:l,children:e.jsx(Oi,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:m,onPointerDownOutside:p,onFocusOutside:d,onInteractOutside:u,onDismiss:x,children:e.jsx($i,{asChild:!0,...C,dir:w.dir,orientation:"vertical",loop:r,currentTabStopId:W,onCurrentTabStopIdChange:N,onEntryFocus:se(c,Z=>{w.isUsingKeyboardRef.current||Z.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(Fi,{role:"menu","aria-orientation":"vertical","data-state":Mr(v.open),"data-radix-menu-content":"",dir:w.dir,...y,...j,ref:q,style:{outline:"none",...j.style},onKeyDown:se(j.onKeyDown,Z=>{const rs=Z.target.closest("[data-radix-menu-content]")===Z.currentTarget,_s=Z.ctrlKey||Z.altKey||Z.metaKey,Tt=Z.key.length===1;rs&&(Z.key==="Tab"&&Z.preventDefault(),!_s&&Tt&&St(Z.key));const Pt=b.current;if(Z.target!==Pt||!Ll.includes(Z.key))return;Z.preventDefault();const Ss=S().filter(ze=>!ze.disabled).map(ze=>ze.ref.current);mr.includes(Z.key)&&Ss.reverse(),to(Ss)}),onBlur:se(s.onBlur,Z=>{Z.currentTarget.contains(Z.target)||(window.clearTimeout(O.current),M.current="")}),onPointerMove:se(s.onPointerMove,Es(Z=>{const js=Z.target,rs=X.current!==Z.clientX;if(Z.currentTarget.contains(js)&&rs){const _s=Z.clientX>X.current?"right":"left";R.current=_s,X.current=Z.clientX}}))})})})})})})});gr.displayName=qe;var Zl="MenuGroup",Xt=h.forwardRef((s,a)=>{const{__scopeMenu:t,...r}=s;return e.jsx(as.div,{role:"group",...r,ref:a})});Xt.displayName=Zl;var Ql="MenuLabel",yr=h.forwardRef((s,a)=>{const{__scopeMenu:t,...r}=s;return e.jsx(as.div,{...r,ref:a})});yr.displayName=Ql;var ct="MenuItem",ca="menu.itemSelect",kt=h.forwardRef((s,a)=>{const{disabled:t=!1,onSelect:r,...n}=s,i=h.useRef(null),l=Bs(ct,s.__scopeMenu),o=Jt(ct,s.__scopeMenu),c=xs(a,i),m=h.useRef(!1),p=()=>{const d=i.current;if(!t&&d){const u=new CustomEvent(ca,{bubbles:!0,cancelable:!0});d.addEventListener(ca,x=>r?.(x),{once:!0}),Ui(d,u),u.defaultPrevented?m.current=!1:l.onClose()}};return e.jsx(fr,{...n,ref:c,disabled:t,onClick:se(s.onClick,p),onPointerDown:d=>{s.onPointerDown?.(d),m.current=!0},onPointerUp:se(s.onPointerUp,d=>{m.current||d.currentTarget?.click()}),onKeyDown:se(s.onKeyDown,d=>{const u=o.searchRef.current!=="";t||u&&d.key===" "||Ft.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});kt.displayName=ct;var fr=h.forwardRef((s,a)=>{const{__scopeMenu:t,disabled:r=!1,textValue:n,...i}=s,l=Jt(ct,t),o=xr(t),c=h.useRef(null),m=xs(a,c),[p,d]=h.useState(!1),[u,x]=h.useState("");return h.useEffect(()=>{const f=c.current;f&&x((f.textContent??"").trim())},[i.children]),e.jsx(Ds.ItemSlot,{scope:t,disabled:r,textValue:n??u,children:e.jsx(Li,{asChild:!0,...o,focusable:!r,children:e.jsx(as.div,{role:"menuitem","data-highlighted":p?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:m,onPointerMove:se(s.onPointerMove,Es(f=>{r?l.onItemLeave(f):(l.onItemEnter(f),f.defaultPrevented||f.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:se(s.onPointerLeave,Es(f=>l.onItemLeave(f))),onFocus:se(s.onFocus,()=>d(!0)),onBlur:se(s.onBlur,()=>d(!1))})})})}),Vl="MenuCheckboxItem",wr=h.forwardRef((s,a)=>{const{checked:t=!1,onCheckedChange:r,...n}=s;return e.jsx(kr,{scope:s.__scopeMenu,checked:t,children:e.jsx(kt,{role:"menuitemcheckbox","aria-checked":dt(t)?"mixed":t,...n,ref:a,"data-state":sa(t),onSelect:se(n.onSelect,()=>r?.(dt(t)?!0:!t),{checkForDefaultPrevented:!1})})})});wr.displayName=Vl;var br="MenuRadioGroup",[Hl,Jl]=ps(br,{value:void 0,onValueChange:()=>{}}),vr=h.forwardRef((s,a)=>{const{value:t,onValueChange:r,...n}=s,i=Oa(r);return e.jsx(Hl,{scope:s.__scopeMenu,value:t,onValueChange:i,children:e.jsx(Xt,{...n,ref:a})})});vr.displayName=br;var Nr="MenuRadioItem",zr=h.forwardRef((s,a)=>{const{value:t,...r}=s,n=Jl(Nr,s.__scopeMenu),i=t===n.value;return e.jsx(kr,{scope:s.__scopeMenu,checked:i,children:e.jsx(kt,{role:"menuitemradio","aria-checked":i,...r,ref:a,"data-state":sa(i),onSelect:se(r.onSelect,()=>n.onValueChange?.(t),{checkForDefaultPrevented:!1})})})});zr.displayName=Nr;var ea="MenuItemIndicator",[kr,Yl]=ps(ea,{checked:!1}),Cr=h.forwardRef((s,a)=>{const{__scopeMenu:t,forceMount:r,...n}=s,i=Yl(ea,t);return e.jsx(mt,{present:r||dt(i.checked)||i.checked===!0,children:e.jsx(as.span,{...n,ref:a,"data-state":sa(i.checked)})})});Cr.displayName=ea;var Xl="MenuSeparator",_r=h.forwardRef((s,a)=>{const{__scopeMenu:t,...r}=s;return e.jsx(as.div,{role:"separator","aria-orientation":"horizontal",...r,ref:a})});_r.displayName=Xl;var eo="MenuArrow",Sr=h.forwardRef((s,a)=>{const{__scopeMenu:t,...r}=s,n=zt(t);return e.jsx(Ki,{...n,...r,ref:a})});Sr.displayName=eo;var so="MenuSub",[Qd,Tr]=ps(so),qs="MenuSubTrigger",Pr=h.forwardRef((s,a)=>{const t=hs(qs,s.__scopeMenu),r=Bs(qs,s.__scopeMenu),n=Tr(qs,s.__scopeMenu),i=Jt(qs,s.__scopeMenu),l=h.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:c}=i,m={__scopeMenu:s.__scopeMenu},p=h.useCallback(()=>{l.current&&window.clearTimeout(l.current),l.current=null},[]);return h.useEffect(()=>p,[p]),h.useEffect(()=>{const d=o.current;return()=>{window.clearTimeout(d),c(null)}},[o,c]),e.jsx(Vt,{asChild:!0,...m,children:e.jsx(fr,{id:n.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":n.contentId,"data-state":Mr(t.open),...s,ref:Aa(a,n.onTriggerChange),onClick:d=>{s.onClick?.(d),!(s.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:se(s.onPointerMove,Es(d=>{i.onItemEnter(d),!d.defaultPrevented&&!s.disabled&&!t.open&&!l.current&&(i.onPointerGraceIntentChange(null),l.current=window.setTimeout(()=>{t.onOpenChange(!0),p()},100))})),onPointerLeave:se(s.onPointerLeave,Es(d=>{p();const u=t.content?.getBoundingClientRect();if(u){const x=t.content?.dataset.side,f=x==="right",j=f?-5:5,v=u[f?"left":"right"],w=u[f?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+j,y:d.clientY},{x:v,y:u.top},{x:w,y:u.top},{x:w,y:u.bottom},{x:v,y:u.bottom}],side:x}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:se(s.onKeyDown,d=>{const u=i.searchRef.current!=="";s.disabled||u&&d.key===" "||Dl[r.dir].includes(d.key)&&(t.onOpenChange(!0),t.content?.focus(),d.preventDefault())})})})});Pr.displayName=qs;var Ir="MenuSubContent",qr=h.forwardRef((s,a)=>{const t=hr(qe,s.__scopeMenu),{forceMount:r=t.forceMount,...n}=s,i=hs(qe,s.__scopeMenu),l=Bs(qe,s.__scopeMenu),o=Tr(Ir,s.__scopeMenu),c=h.useRef(null),m=xs(a,c);return e.jsx(Ds.Provider,{scope:s.__scopeMenu,children:e.jsx(mt,{present:r||i.open,children:e.jsx(Ds.Slot,{scope:s.__scopeMenu,children:e.jsx(Yt,{id:o.contentId,"aria-labelledby":o.triggerId,...n,ref:m,align:"start",side:l.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:p=>{l.isUsingKeyboardRef.current&&c.current?.focus(),p.preventDefault()},onCloseAutoFocus:p=>p.preventDefault(),onFocusOutside:se(s.onFocusOutside,p=>{p.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:se(s.onEscapeKeyDown,p=>{l.onClose(),p.preventDefault()}),onKeyDown:se(s.onKeyDown,p=>{const d=p.currentTarget.contains(p.target),u=El[l.dir].includes(p.key);d&&u&&(i.onOpenChange(!1),o.trigger?.focus(),p.preventDefault())})})})})})});qr.displayName=Ir;function Mr(s){return s?"open":"closed"}function dt(s){return s==="indeterminate"}function sa(s){return dt(s)?"indeterminate":s?"checked":"unchecked"}function to(s){const a=document.activeElement;for(const t of s)if(t===a||(t.focus(),document.activeElement!==a))return}function ao(s,a){return s.map((t,r)=>s[(a+r)%s.length])}function ro(s,a,t){const n=a.length>1&&Array.from(a).every(m=>m===a[0])?a[0]:a,i=t?s.indexOf(t):-1;let l=ao(s,Math.max(i,0));n.length===1&&(l=l.filter(m=>m!==t));const c=l.find(m=>m.toLowerCase().startsWith(n.toLowerCase()));return c!==t?c:void 0}function io(s,a){const{x:t,y:r}=s;let n=!1;for(let i=0,l=a.length-1;i<a.length;l=i++){const o=a[i],c=a[l],m=o.x,p=o.y,d=c.x,u=c.y;p>r!=u>r&&t<(d-m)*(r-p)/(u-p)+m&&(n=!n)}return n}function no(s,a){if(!a)return!1;const t={x:s.clientX,y:s.clientY};return io(t,a)}function Es(s){return a=>a.pointerType==="mouse"?s(a):void 0}var lo=pr,oo=Vt,co=jr,mo=gr,uo=Xt,xo=yr,po=kt,ho=wr,jo=vr,go=zr,yo=Cr,fo=_r,wo=Sr,bo=Pr,vo=qr,Ct="DropdownMenu",[No,Vd]=Ut(Ct,[ur]),fe=ur(),[zo,Lr]=No(Ct),Dr=s=>{const{__scopeDropdownMenu:a,children:t,dir:r,open:n,defaultOpen:i,onOpenChange:l,modal:o=!0}=s,c=fe(a),m=h.useRef(null),[p,d]=La({prop:n,defaultProp:i??!1,onChange:l,caller:Ct});return e.jsx(zo,{scope:a,triggerId:ra(),triggerRef:m,contentId:ra(),open:p,onOpenChange:d,onOpenToggle:h.useCallback(()=>d(u=>!u),[d]),modal:o,children:e.jsx(lo,{...c,open:p,onOpenChange:d,dir:r,modal:o,children:t})})};Dr.displayName=Ct;var Er="DropdownMenuTrigger",Rr=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,disabled:r=!1,...n}=s,i=Lr(Er,t),l=fe(t);return e.jsx(oo,{asChild:!0,...l,children:e.jsx(as.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...n,ref:Aa(a,i.triggerRef),onPointerDown:se(s.onPointerDown,o=>{!r&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:se(s.onKeyDown,o=>{r||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});Rr.displayName=Er;var ko="DropdownMenuPortal",Ar=s=>{const{__scopeDropdownMenu:a,...t}=s,r=fe(a);return e.jsx(co,{...r,...t})};Ar.displayName=ko;var Or="DropdownMenuContent",$r=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,...r}=s,n=Lr(Or,t),i=fe(t),l=h.useRef(!1);return e.jsx(mo,{id:n.contentId,"aria-labelledby":n.triggerId,...i,...r,ref:a,onCloseAutoFocus:se(s.onCloseAutoFocus,o=>{l.current||n.triggerRef.current?.focus(),l.current=!1,o.preventDefault()}),onInteractOutside:se(s.onInteractOutside,o=>{const c=o.detail.originalEvent,m=c.button===0&&c.ctrlKey===!0,p=c.button===2||m;(!n.modal||p)&&(l.current=!0)}),style:{...s.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});$r.displayName=Or;var Co="DropdownMenuGroup",_o=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,...r}=s,n=fe(t);return e.jsx(uo,{...n,...r,ref:a})});_o.displayName=Co;var So="DropdownMenuLabel",Fr=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,...r}=s,n=fe(t);return e.jsx(xo,{...n,...r,ref:a})});Fr.displayName=So;var To="DropdownMenuItem",Wr=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,...r}=s,n=fe(t);return e.jsx(po,{...n,...r,ref:a})});Wr.displayName=To;var Po="DropdownMenuCheckboxItem",Ur=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,...r}=s,n=fe(t);return e.jsx(ho,{...n,...r,ref:a})});Ur.displayName=Po;var Io="DropdownMenuRadioGroup",qo=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,...r}=s,n=fe(t);return e.jsx(jo,{...n,...r,ref:a})});qo.displayName=Io;var Mo="DropdownMenuRadioItem",Gr=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,...r}=s,n=fe(t);return e.jsx(go,{...n,...r,ref:a})});Gr.displayName=Mo;var Lo="DropdownMenuItemIndicator",Br=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,...r}=s,n=fe(t);return e.jsx(yo,{...n,...r,ref:a})});Br.displayName=Lo;var Do="DropdownMenuSeparator",Kr=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,...r}=s,n=fe(t);return e.jsx(fo,{...n,...r,ref:a})});Kr.displayName=Do;var Eo="DropdownMenuArrow",Ro=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,...r}=s,n=fe(t);return e.jsx(wo,{...n,...r,ref:a})});Ro.displayName=Eo;var Ao="DropdownMenuSubTrigger",Zr=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,...r}=s,n=fe(t);return e.jsx(bo,{...n,...r,ref:a})});Zr.displayName=Ao;var Oo="DropdownMenuSubContent",Qr=h.forwardRef((s,a)=>{const{__scopeDropdownMenu:t,...r}=s,n=fe(t);return e.jsx(vo,{...n,...r,ref:a,style:{...s.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Qr.displayName=Oo;var $o=Dr,Fo=Rr,Wo=Ar,Vr=$r,Hr=Fr,Jr=Wr,Yr=Ur,Xr=Gr,ei=Br,si=Kr,ti=Zr,ai=Qr;const bs=$o,vs=Fo,Uo=h.forwardRef(({className:s,inset:a,children:t,...r},n)=>e.jsxs(ti,{ref:n,className:F("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",s),...r,children:[t,e.jsx(ns,{className:"ml-auto"})]}));Uo.displayName=ti.displayName;const Go=h.forwardRef(({className:s,...a},t)=>e.jsx(ai,{ref:t,className:F("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",s),...a}));Go.displayName=ai.displayName;const cs=h.forwardRef(({className:s,sideOffset:a=4,...t},r)=>e.jsx(Wo,{children:e.jsx(Vr,{ref:r,sideOffset:a,className:F("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",s),...t})}));cs.displayName=Vr.displayName;const ce=h.forwardRef(({className:s,inset:a,...t},r)=>e.jsx(Jr,{ref:r,className:F("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",a&&"pl-8",s),...t}));ce.displayName=Jr.displayName;const Bo=h.forwardRef(({className:s,children:a,checked:t,...r},n)=>e.jsxs(Yr,{ref:n,className:F("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:t,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ei,{children:e.jsx(ge,{className:"h-4 w-4"})})}),a]}));Bo.displayName=Yr.displayName;const Ko=h.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Xr,{ref:r,className:F("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ei,{children:e.jsx(Za,{className:"h-2 w-2 fill-current"})})}),a]}));Ko.displayName=Xr.displayName;const ri=h.forwardRef(({className:s,inset:a,...t},r)=>e.jsx(Hr,{ref:r,className:F("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s),...t}));ri.displayName=Hr.displayName;const ds=h.forwardRef(({className:s,...a},t)=>e.jsx(si,{ref:t,className:F("-mx-1 my-1 h-px bg-muted",s),...a}));ds.displayName=si.displayName;const Zo=()=>{const{create:s,edit:a,show:t}=pe(),{mutate:r}=ys(),{tableQuery:{data:n,isLoading:i,isError:l},current:o,setCurrent:c,pageSize:m,setFilters:p}=ut({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, topics(count), course_access(count)"}}),d=wt({isLoading:i,isError:l});if(d)return d;const u=(x,f)=>{confirm(`Czy na pewno chcesz usunąć kurs "${f}"?`)&&r({resource:"courses",id:x})};return e.jsxs(P,{children:[e.jsxs(_,{children:[e.jsx(V,{title:"Kursy",description:"Zarządzaj kursami w systemie"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(qt,{children:e.jsxs(Mt,{children:[e.jsx(Lt,{asChild:!0,children:e.jsxs(g,{variant:"outline",onClick:()=>window.location.href="/course-structure/step1",children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),e.jsx(Je,{className:"w-3 h-3"})]})}),e.jsx(nt,{children:e.jsx("p",{children:"Stwórz kurs z pomocą AI"})})]})}),e.jsxs(g,{onClick:()=>s("courses"),children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Dodaj kurs"]})]})]}),e.jsx(_,{children:e.jsx(D,{placeholder:"Szukaj kursów...",className:"max-w-sm",onChange:x=>{p([{field:"title",operator:"contains",value:x.target.value}])}})}),e.jsx(J,{children:n?.data?.map(x=>e.jsxs(z,{className:"relative cursor-pointer transition-shadow hover:shadow-lg",onClick:f=>{f.target.closest('[role="menu"]')||t("courses",x.id)},children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsxs(T,{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"flex-shrink-0",children:x.icon_emoji?e.jsx("span",{className:"text-2xl",children:x.icon_emoji}):e.jsx(xe,{className:"w-5 h-5"})}),e.jsx(qt,{delayDuration:200,children:e.jsxs(Mt,{children:[e.jsx(Lt,{asChild:!0,children:e.jsx("span",{className:"truncate",children:x.title})}),x.title.length>30&&e.jsx(nt,{children:e.jsx("p",{className:"max-w-xs",children:x.title})})]})})]}),e.jsxs(bs,{children:[e.jsx(vs,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"sm",onClick:f=>f.stopPropagation(),children:e.jsx(As,{className:"h-4 w-4"})})}),e.jsxs(cs,{align:"end",children:[e.jsxs(ce,{onClick:()=>t("courses",x.id),children:[e.jsx(Ae,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),e.jsxs(ce,{onClick:()=>a("courses",x.id),children:[e.jsx(We,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),e.jsx(ds,{}),e.jsxs(ce,{onClick:()=>{sessionStorage.setItem("wizardContext",JSON.stringify({courseId:x.id,courseTitle:x.title})),window.location.href="/educational-material/step1"},className:"text-purple-600 focus:text-purple-600",children:[e.jsx(Je,{className:"mr-2 h-4 w-4"}),"Generuj materiał z AI"]}),e.jsxs(ce,{onClick:()=>{sessionStorage.setItem("wizardContext",JSON.stringify({courseId:x.id,courseTitle:x.title})),window.location.href="/quiz-wizard/step1"},className:"text-blue-600 focus:text-blue-600",children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),"Generuj quiz z AI"]}),e.jsx(ds,{}),e.jsxs(ce,{onClick:()=>u(x.id,x.title),className:"text-red-600 focus:text-red-600",children:[e.jsx(ss,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})}),e.jsxs(k,{children:[x.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:x.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx(Q,{variant:x.is_published?"default":"secondary",children:x.is_published?"Opublikowany":"Szkic"})}),e.jsxs("div",{className:"flex gap-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ve,{className:"w-3 h-3"}),x._count?.topics||0]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3"}),x._count?.course_access||0]})]})]})]})]},x.id))}),n?.data?.length===0&&e.jsx(z,{className:"border-dashed border-2 bg-gradient-to-r from-indigo-50/50 to-purple-50/50 dark:from-indigo-950/20 dark:to-purple-950/20",children:e.jsxs(k,{className:"text-center py-12",children:[e.jsx(Ye,{className:"w-12 h-12 mx-auto mb-4 text-indigo-600"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Brak kursów"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Rozpocznij od stworzenia pierwszego kursu"}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsxs(g,{variant:"outline",onClick:()=>s("courses"),children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Dodaj ręcznie"]}),e.jsxs(g,{onClick:()=>window.location.href="/course-structure/step1",className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Wygeneruj z AI"]})]})]})}),e.jsx(Nt,{current:o,pageSize:m,total:n?.total||0,setCurrent:c,itemName:"kursów"}),n?.data&&n.data.length>0&&e.jsx("div",{className:"fixed bottom-6 right-6",children:e.jsx(qt,{children:e.jsxs(Mt,{children:[e.jsx(Lt,{asChild:!0,children:e.jsxs(g,{size:"lg",className:"rounded-full shadow-lg bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700",onClick:()=>window.location.href="/course-structure/step1",children:[e.jsx(Ye,{className:"w-5 h-5 mr-2"}),e.jsx(Je,{className:"w-4 h-4"})]})}),e.jsx(nt,{side:"left",children:e.jsx("p",{children:"Stwórz nowy kurs z pomocą AI"})})]})})})]})},Ee=({children:s,onSubmit:a,className:t="",...r})=>{const n="space-y-6",i=t?`${n} ${t}`:n;return e.jsx("form",{onSubmit:a,className:i,...r,children:s})},U=({children:s,label:a,htmlFor:t,error:r,required:n=!1,className:i="",hint:l})=>{const o="space-y-2",c=i?`${o} ${i}`:o,m=()=>a?typeof a=="string"?e.jsxs(K,{htmlFor:t,children:[a,n&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):e.jsxs(K,{htmlFor:t,className:"flex items-center",children:[a,n&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):null,p=h.isValidElement(s)?h.cloneElement(s,{className:`${s.props.className||""} ${r?"border-red-500 ring-1 ring-red-500":""}`.trim()}):s;return e.jsxs("div",{className:c,children:[m(),p,l&&!r&&e.jsx("p",{className:"text-sm text-muted-foreground",children:l}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r})]})},Re=({children:s,className:a=""})=>{const t="flex justify-end items-center gap-4 pt-6 border-t",r=a?`${t} ${a}`:t;return e.jsx("div",{className:r,children:s})},Qo=["📚","🎓","💡","🚀","⭐","🏆","🎯","📖","✏️","🧮"],Vo=()=>{const{list:s}=pe(),{data:a}=Ne(),[t,r]=h.useState(!1),{refineCore:{onFinish:n},register:i,handleSubmit:l,setValue:o,watch:c,formState:{errors:m,isSubmitting:p}}=Fe({defaultValues:{title:"",description:"",vendor_id:a?.vendor_id||0,is_published:!1,icon_emoji:"📚"}}),d=c("icon_emoji");return e.jsxs(P,{children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>s("courses"),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(_,{children:e.jsx(V,{title:"Dodaj kurs",description:"Utwórz nowy kurs w systemie"})}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Informacje o kursie"})}),e.jsx(k,{children:e.jsxs(Ee,{onSubmit:l(n),children:[e.jsxs(J,{variant:"1-2-2",children:[e.jsx(U,{label:"Tytuł kursu",htmlFor:"title",error:m.title?.message?.toString(),required:!0,children:e.jsx(D,{id:"title",placeholder:"np. Podstawy programowania",...i("title",{required:"Tytuł kursu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),e.jsx(U,{label:"Ikona kursu",htmlFor:"icon_emoji",children:e.jsxs("div",{className:"relative",children:[e.jsxs(g,{type:"button",variant:"outline",className:"w-full justify-start",onClick:()=>r(!t),children:[e.jsx("span",{className:"text-2xl mr-2",children:d||"📚"}),"Wybierz ikonę"]}),t&&e.jsx("div",{className:"absolute top-full mt-2 p-2 bg-white border rounded-lg shadow-lg z-10",children:e.jsx("div",{className:"grid grid-cols-5 gap-2",children:Qo.map(u=>e.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded text-2xl",onClick:()=>{o("icon_emoji",u),r(!1)},children:u},u))})})]})})]}),e.jsx(U,{label:"Opis kursu",htmlFor:"description",error:m.description?.message?.toString(),children:e.jsx(De,{id:"description",placeholder:"Opisz czego uczniowie nauczą się na tym kursie...",rows:4,...i("description")})}),e.jsx(U,{label:"Status publikacji",children:e.jsxs(_,{variant:"start",children:[e.jsx(Oe,{checked:c("is_published")||!1,onCheckedChange:u=>o("is_published",u)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj kurs od razu (możesz to zmienić później)"})]})}),e.jsxs(Re,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>s("courses"),children:"Anuluj"}),e.jsx(g,{type:"submit",disabled:p,children:p?"Tworzenie...":"Utwórz kurs"})]})]})})]})]})},Ho=["📚","🎓","💡","🚀","⭐","🏆","🎯","📖","✏️","🧮"],Jo=()=>{const{list:s}=pe(),{id:a}=ye(),[t,r]=h.useState(!1),{data:n,isLoading:i}=ue({resource:"courses",id:a,liveMode:"off"}),{refineCore:{onFinish:l},register:o,handleSubmit:c,setValue:m,watch:p,formState:{errors:d,isSubmitting:u}}=Fe({refineCoreProps:{resource:"courses",id:a,liveMode:"off"}}),x=p("icon_emoji");return i?e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs(P,{children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>s("courses"),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(_,{children:e.jsx(V,{title:"Edytuj kurs",description:`Edycja kursu: ${n?.data?.title}`})}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Informacje o kursie"})}),e.jsx(k,{children:e.jsxs(Ee,{onSubmit:c(l),children:[e.jsxs(J,{variant:"1-2-2",children:[e.jsx(U,{label:"Tytuł kursu",htmlFor:"title",error:d.title?.message,required:!0,children:e.jsx(D,{id:"title",placeholder:"np. Podstawy programowania",...o("title",{required:"Tytuł kursu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),e.jsx(U,{label:"Ikona kursu",htmlFor:"icon_emoji",children:e.jsxs("div",{className:"relative",children:[e.jsxs(g,{type:"button",variant:"outline",className:"w-full justify-start",onClick:()=>r(!t),children:[e.jsx("span",{className:"text-2xl mr-2",children:x||"📚"}),"Wybierz ikonę"]}),t&&e.jsx("div",{className:"absolute top-full mt-2 p-2 bg-white border rounded-lg shadow-lg z-10",children:e.jsx("div",{className:"grid grid-cols-5 gap-2",children:Ho.map(f=>e.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded text-2xl",onClick:()=>{m("icon_emoji",f),r(!1)},children:f},f))})})]})})]}),e.jsx(U,{label:"Opis kursu",htmlFor:"description",error:d.description?.message,children:e.jsx(De,{id:"description",placeholder:"Opisz czego uczniowie nauczą się na tym kursie...",rows:4,...o("description")})}),e.jsx(U,{label:"Status publikacji",children:e.jsxs(_,{variant:"start",children:[e.jsx(Oe,{checked:p("is_published")||!1,onCheckedChange:f=>m("is_published",f)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Kurs jest opublikowany i widoczny dla uczniów"})]})}),e.jsxs(Re,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>s("courses"),children:"Anuluj"}),e.jsx(g,{type:"submit",disabled:u,children:u?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},Yo=({topic:s,isExpanded:a,onToggle:t,onDelete:r,onEdit:n,onNavigateToWizard:i,courseId:l,courseTitle:o,children:c,activitiesCount:m})=>{const p=B(),d=x=>{const f=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",f),p(x)},u=(x,f)=>{i&&i(x,{courseId:l,courseTitle:o,topicId:s.id,topicTitle:s.title,...f})};return e.jsxs("div",{className:`border-2 rounded-lg overflow-hidden group ${a?"shadow-lg border-primary":"border-border hover:border-primary/50"}`,children:[e.jsx("div",{className:`p-4 ${a?"bg-primary text-primary-foreground":"bg-background hover:bg-muted"}`,children:e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("button",{onClick:t,className:`p-1 rounded ${a?"text-primary-foreground hover:bg-primary-foreground/20":"hover:bg-muted"}`,"aria-label":a?"Zwiń temat":"Rozwiń temat",children:a?e.jsx(Gt,{className:"w-5 h-5"}):e.jsx(ns,{className:"w-5 h-5"})}),e.jsx("div",{className:"cursor-move",children:e.jsx(Qa,{className:`w-4 h-4 ${a?"text-primary-foreground/70":"text-muted-foreground"}`})}),e.jsxs("div",{className:"flex-1 cursor-pointer group",onClick:t,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h4",{className:`font-semibold text-base ${a?"text-primary-foreground":"group-hover:text-primary"}`,children:["Temat ",s.position,": ",s.title]}),e.jsx(Q,{variant:s.is_published?a?"secondary":"default":"outline",className:a?"bg-primary-foreground/20 text-primary-foreground border-primary-foreground/30":"",children:s.is_published?"Opublikowany":"Szkic"})]}),e.jsx("div",{className:"flex items-center gap-4 mt-1",children:e.jsxs("span",{className:`text-sm flex items-center gap-1 ${a?"text-primary-foreground/80":"text-muted-foreground"}`,children:[e.jsx(ve,{className:"w-3 h-3"}),m," ",m===1?"aktywność":"aktywności"]})})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(bs,{children:[e.jsx(vs,{asChild:!0,children:e.jsx(g,{size:"sm",variant:a?"secondary":"ghost",title:"Dodaj aktywność",className:`h-8 w-8 p-0 ${a?"bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground":""}`,children:e.jsx(he,{className:"h-4 w-4"})})}),e.jsxs(cs,{align:"end",children:[e.jsx(ri,{children:"Dodaj treść"}),e.jsxs(ce,{onClick:()=>d(`/activities/create?topic_id=${s.id}`),children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"Dodaj ręcznie"]}),e.jsx(ds,{}),e.jsxs(ce,{onClick:()=>u("/educational-material/step1"),className:"text-purple-600 focus:text-purple-600",children:[e.jsx(Je,{className:"mr-2 h-4 w-4"}),"Generuj materiał z AI"]}),e.jsxs(ce,{onClick:()=>u("/quiz-wizard/step1"),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),"Generuj quiz z AI"]})]})]}),e.jsxs(bs,{children:[e.jsx(vs,{asChild:!0,children:e.jsx(g,{variant:a?"secondary":"ghost",size:"sm",className:`h-8 w-8 p-0 ${a?"bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground":""}`,children:e.jsx(As,{className:"h-4 w-4"})})}),e.jsxs(cs,{align:"end",children:[e.jsxs(ce,{onClick:()=>n("topics",s.id),children:[e.jsx(We,{className:"mr-2 h-4 w-4"}),"Edytuj temat"]}),e.jsx(ds,{}),e.jsxs(ce,{onClick:()=>r(s.id,s.title),className:"text-red-600 focus:text-red-600",children:[e.jsx(ss,{className:"mr-2 h-4 w-4"}),"Usuń temat"]})]})]})]})]})}),a&&e.jsx("div",{className:"p-4 bg-muted/20 border-t-2 border-primary",children:e.jsx("div",{className:"space-y-2",children:c})})]})},Xo=({activity:s,topicPosition:a,onDelete:t,onEdit:r})=>{const n=B(),i=()=>s.type==="quiz"?e.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:e.jsx(Le,{className:"w-5 h-5 text-white"})}):e.jsx("div",{className:"p-2 bg-green-600 rounded-lg",children:e.jsx(ve,{className:"w-5 h-5 text-white"})}),l=()=>s.type==="quiz"?"Quiz":"Materiał";return e.jsxs("div",{className:"group flex items-center gap-4 p-4 bg-white border-2 rounded-lg hover:border-primary/50 transition-all duration-200",children:[e.jsx("div",{className:"cursor-move opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Qa,{className:"w-4 h-4 text-muted-foreground"})}),i(),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("h5",{className:"font-semibold text-sm text-foreground",children:[a,".",s.position," ",s.title]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:s.type==="quiz"?"default":"secondary",className:"text-xs font-medium",children:l()}),s.type==="quiz"&&s._count?.questions!==void 0&&e.jsxs(Q,{variant:"outline",className:"text-xs font-medium border-2",children:[e.jsx(Xe,{className:"w-3 h-3 mr-1"}),s._count.questions," ",s._count.questions===1?"pytanie":"pytań"]}),e.jsx(Q,{variant:s.is_published?"default":"outline",className:`text-xs font-medium ${s.is_published?"bg-green-600 hover:bg-green-700":"border-2"}`,children:s.is_published?e.jsxs(e.Fragment,{children:[e.jsx(yt,{className:"w-3 h-3 mr-1"}),"Opublikowany"]}):"Szkic"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[s.duration_min&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ue,{className:"w-3 h-3"}),e.jsxs("span",{children:[s.duration_min," min"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3"}),e.jsx("span",{children:"0 ukończeń"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[s.type==="quiz"&&e.jsx(g,{size:"sm",variant:"ghost",onClick:()=>n(`/questions/manage/${s.id}`),title:"Zarządzaj pytaniami",className:"h-8 w-8 p-0",children:e.jsx(Xe,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"ghost",onClick:()=>n(`/activities/show/${s.id}`),title:"Podgląd",className:"h-8 w-8 p-0",children:e.jsx(Ae,{className:"h-4 w-4"})}),e.jsxs(bs,{children:[e.jsx(vs,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(As,{className:"h-4 w-4"})})}),e.jsxs(cs,{align:"end",children:[e.jsxs(ce,{onClick:()=>n(`/activities/show/${s.id}`),children:[e.jsx(Ae,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),e.jsxs(ce,{onClick:()=>r("activities",s.id),children:[e.jsx(We,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),s.type==="quiz"&&e.jsxs(e.Fragment,{children:[e.jsx(ds,{}),e.jsxs(ce,{onClick:()=>n(`/questions/manage/${s.id}`),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(Xe,{className:"mr-2 h-4 w-4"}),"Zarządzaj pytaniami"]}),e.jsxs(ce,{onClick:()=>n(`/questions/create?activity_id=${s.id}`),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"Dodaj pytanie"]})]}),e.jsx(ds,{}),e.jsxs(ce,{onClick:()=>t(s.id,s.title),className:"text-red-600 focus:text-red-600",children:[e.jsx(ss,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})]})},ec=()=>{const{list:s,edit:a}=pe(),{id:t}=ye(),r=B(),[n,i]=Rs(),l=n.get("expanded"),{mutate:o}=ys(),{mutate:c}=ys(),{data:m,isLoading:p}=ue({resource:"courses",id:t}),{data:d,isLoading:u,refetch:x}=de({resource:"topics",filters:[{field:"course_id",operator:"eq",value:t}],sorters:[{field:"position",order:"asc"}],meta:{select:"*, activities(count)"}}),{data:f,refetch:j}=de({resource:"activities",filters:[{field:"topic_id",operator:"in",value:d?.data?.map(q=>q.id)||[]}],sorters:[{field:"position",order:"asc"}],meta:{select:"*, questions(count)"},queryOptions:{enabled:!!d?.data?.length}}),{data:v}=de({resource:"course_access",filters:[{field:"course_id",operator:"eq",value:t}]});if(p)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const w=m?.data,y=q=>{l===q.toString()?(n.delete("expanded"),i(n)):i({expanded:q.toString()})},C=(q,O)=>{confirm(`Czy na pewno chcesz usunąć temat "${O}" wraz ze wszystkimi aktywnościami?`)&&o({resource:"topics",id:q},{onSuccess:()=>{A.success("Temat został usunięty"),x(),j(),l===q.toString()&&(n.delete("expanded"),i(n))}})},S=(q,O)=>{confirm(`Czy na pewno chcesz usunąć aktywność "${O}"?`)&&c({resource:"activities",id:q},{onSuccess:()=>{A.success("Aktywność została usunięta"),j(),x()}})},W=q=>f?.data?.filter(O=>O.topic_id===q)||[],N=q=>{const O=`${window.location.pathname}${window.location.search}`,M=encodeURIComponent(O);r(`${q}${q.includes("?")?"&":"?"}returnUrl=${M}`)},b=(q,O)=>{O&&sessionStorage.setItem("wizardContext",JSON.stringify(O));const M=`${window.location.pathname}${window.location.search}`;sessionStorage.setItem("returnUrl",M),r(q)};return e.jsxs(P,{children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>s("courses"),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsxs(_,{children:[e.jsx(V,{title:e.jsxs("div",{className:"flex items-center gap-3",children:[w?.icon_emoji&&e.jsx("span",{className:"text-4xl",children:w.icon_emoji}),w?.title]}),description:w?.description}),e.jsxs(g,{onClick:()=>a("courses",w?.id??0),children:[e.jsx(We,{className:"w-4 h-4 mr-2"}),"Edytuj kurs"]})]}),e.jsxs(J,{variant:"2-2-4",children:[e.jsxs(z,{children:[e.jsx(I,{className:"pb-2",children:e.jsx(T,{className:"text-sm font-medium",children:"Status"})}),e.jsx(k,{children:e.jsx(Q,{variant:w?.is_published?"default":"secondary",children:w?.is_published?"Opublikowany":"Szkic"})})]}),e.jsxs(z,{children:[e.jsx(I,{className:"pb-2",children:e.jsx(T,{className:"text-sm font-medium",children:"Tematy"})}),e.jsx(k,{children:e.jsx("div",{className:"text-2xl font-bold",children:d?.total||0})})]}),e.jsxs(z,{children:[e.jsx(I,{className:"pb-2",children:e.jsx(T,{className:"text-sm font-medium",children:"Aktywności"})}),e.jsx(k,{children:e.jsx("div",{className:"text-2xl font-bold",children:f?.total||0})})]}),e.jsxs(z,{children:[e.jsx(I,{className:"pb-2",children:e.jsx(T,{className:"text-sm font-medium",children:"Uczestników"})}),e.jsx(k,{children:e.jsx("div",{className:"text-2xl font-bold",children:v?.total||0})})]})]}),e.jsxs(z,{className:"border-dashed border-2 bg-gradient-to-r from-purple-50 to-blue-50",children:[e.jsx(I,{children:e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5 text-purple-600"}),"Szybkie akcje AI"]})}),e.jsx(k,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx(g,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white",onClick:()=>b("/course-structure/step1"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ye,{className:"w-5 h-5 text-indigo-600 mt-0.5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Rozbuduj strukturę kursu"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Dodaj nowe tematy z AI"})]})]})}),e.jsx(g,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white",onClick:()=>b("/educational-material/step1",{courseId:w?.id,courseTitle:w?.title}),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Kt,{className:"w-5 h-5 text-purple-600 mt-0.5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Generuj materiał"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Stwórz treści z AI"})]})]})}),e.jsx(g,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white",onClick:()=>b("/quiz-wizard/step1",{courseId:w?.id,courseTitle:w?.title}),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ls,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Stwórz quiz"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Quiz sprawdzający z AI"})]})]})})]})})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsx(T,{children:"Struktura kursu"}),e.jsxs(g,{size:"sm",onClick:()=>N(`/topics/create?course_id=${t}`),children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Dodaj temat"]})]})}),e.jsx(k,{children:u?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):d?.data?.length?e.jsx("div",{className:"space-y-4",children:d.data.map(q=>{const O=W(q.id),M=l===q.id.toString();return e.jsx(Yo,{topic:q,isExpanded:M,onToggle:()=>y(q.id),onDelete:C,onEdit:(H,$)=>N(`/${H}/edit/${$}`),activitiesCount:O.length,onNavigateToWizard:b,courseId:Number(w?.id),courseTitle:w?.title,children:O.length>0?O.map(H=>e.jsx(Xo,{activity:H,topicPosition:q.position,onDelete:S,onEdit:($,R)=>N(`/${$}/edit/${R}`)},H.id)):e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx("p",{children:"Brak aktywności w tym temacie"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center mt-4",children:[e.jsxs(g,{size:"sm",variant:"outline",onClick:()=>N(`/activities/create?topic_id=${q.id}`),children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Dodaj ręcznie"]}),e.jsxs(g,{size:"sm",onClick:()=>b("/educational-material/step1",{courseId:w?.id,courseTitle:w?.title,topicId:q.id,topicTitle:q.title}),children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Generuj materiał z AI"]}),e.jsxs(g,{size:"sm",variant:"secondary",onClick:()=>b("/quiz-wizard/step1",{courseId:w?.id,courseTitle:w?.title,topicId:q.id,topicTitle:q.title}),children:[e.jsx(ls,{className:"w-4 h-4 mr-2"}),"Generuj quiz z AI"]})]})]})},q.id)})}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ve,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Brak tematów w tym kursie"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center mt-4",children:[e.jsxs(g,{onClick:()=>N(`/topics/create?course_id=${t}`),children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Dodaj pierwszy temat"]}),e.jsxs(g,{variant:"secondary",onClick:()=>b("/course-structure/step1",{courseId:w?.id,courseTitle:w?.title,mode:"extend"}),children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),"Wygeneruj strukturę z AI"]})]})]})})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Grupy z dostępem"})}),e.jsx(k,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(je,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Lista grup (do implementacji)"})]})})]})]})},sc={name:"courses",list:"/courses",create:"/courses/create",edit:"/courses/edit/:id",show:"/courses/show/:id",meta:{label:"Kursy",icon:e.jsx(xe,{className:"h-4 w-4"})}},tc=[e.jsx(L,{path:"/courses",element:e.jsx(Zo,{})},"courses-list"),e.jsx(L,{path:"/courses/create",element:e.jsx(Vo,{})},"courses-create"),e.jsx(L,{path:"/courses/edit/:id",element:e.jsx(Jo,{})},"courses-edit"),e.jsx(L,{path:"/courses/show/:id",element:e.jsx(ec,{})},"courses-show")],ac=()=>{const{show:s}=pe(),a=B(),[t]=Rs(),r=t.get("course_id"),{data:n}=ue({resource:"courses",id:r,queryOptions:{enabled:!!r}}),{data:i,isLoading:l}=de({resource:"topics",filters:[{field:"course_id",operator:"eq",value:r}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!r}}),{refineCore:{onFinish:o},register:c,handleSubmit:m,setValue:p,watch:d,formState:{errors:u,isSubmitting:x}}=Fe({defaultValues:{course_id:r?parseInt(r):void 0,is_published:!1,position:1},refineCoreProps:{successNotification:()=>({message:"Temat został utworzony",type:"success"}),redirect:!1,onMutationSuccess:()=>{r?s("courses",r):a("/courses")}}});h.useEffect(()=>{if(!l&&i&&i.data.length>0){const j=i.data[0].position+1;p("position",j)}},[i,l,p]);const f=()=>{r?s("courses",r):a("/courses")};return e.jsxs(P,{children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:f,children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do kursu"]}),e.jsx(_,{children:e.jsx(V,{title:"Dodaj temat",description:n?.data?`Do kursu: ${n.data.title}`:"Utwórz nowy temat"})}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Informacje o temacie"})}),e.jsx(k,{children:e.jsxs(Ee,{onSubmit:m(o),children:[e.jsx("input",{type:"hidden",...c("course_id")}),e.jsx(U,{label:"Tytuł tematu",htmlFor:"title",error:u.title?.message,required:!0,children:e.jsx(D,{id:"title",placeholder:"np. Wprowadzenie do zmiennych",...c("title",{required:"Tytuł tematu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),e.jsx(U,{label:"Pozycja",htmlFor:"position",error:u.position?.message,required:!0,children:e.jsx(D,{id:"position",type:"number",min:"1",disabled:!0,className:"bg-muted",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),e.jsx(U,{label:"Status publikacji",children:e.jsxs(_,{variant:"start",children:[e.jsx(Oe,{checked:d("is_published")||!1,onCheckedChange:j=>p("is_published",j)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj temat od razu"})]})}),e.jsxs(Re,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:f,children:"Anuluj"}),e.jsx(g,{type:"submit",disabled:x||!r,children:x?"Tworzenie...":"Utwórz temat"})]})]})})]})]})},ms=({variant:s="outline",size:a="sm",children:t="Powrót do kursu"})=>{const r=B(),n=Ua(),i=()=>{const o=new URLSearchParams(n.search).get("returnUrl");r(o?decodeURIComponent(o):-1)};return e.jsxs(g,{variant:s,size:a,onClick:i,children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),t]})},rc=()=>{const{show:s}=pe(),{id:a}=ye(),t=B(),{data:r,isLoading:n}=ue({resource:"topics",id:a,liveMode:"off"}),i=r?.data,l=i?.course_id,{refineCore:{onFinish:o},register:c,handleSubmit:m,setValue:p,watch:d,formState:{errors:u,isSubmitting:x}}=Fe({refineCoreProps:{resource:"topics",id:a,liveMode:"off",successNotification:()=>({message:"Temat został zaktualizowany",type:"success"}),redirect:!1,onMutationSuccess:()=>{const j=sessionStorage.getItem("returnUrl");j?(sessionStorage.removeItem("returnUrl"),t(j)):l&&t(`/courses/show/${l}?expanded=${a}`)}}}),f=()=>{const j=sessionStorage.getItem("returnUrl");j?(sessionStorage.removeItem("returnUrl"),t(j)):l?t(`/courses/show/${l}?expanded=${a}`):s("courses","")};return n?e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs(P,{children:[e.jsx(ms,{}),e.jsx(_,{children:e.jsx(V,{title:"Edytuj temat",description:`Edycja: ${i?.title}`})}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Informacje o temacie"})}),e.jsx(k,{children:e.jsxs(Ee,{onSubmit:m(o),children:[e.jsx(U,{label:"Tytuł tematu",htmlFor:"title",error:u.title?.message,required:!0,children:e.jsx(D,{id:"title",placeholder:"np. Wprowadzenie do zmiennych",...c("title",{required:"Tytuł tematu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),e.jsx(U,{label:"Pozycja",htmlFor:"position",error:u.position?.message,required:!0,children:e.jsx(D,{id:"position",type:"number",min:"1",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),e.jsx(U,{label:"Status publikacji",children:e.jsxs(_,{variant:"start",children:[e.jsx(Oe,{checked:d("is_published")||!1,onCheckedChange:j=>p("is_published",j)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Temat jest opublikowany"})]})}),e.jsxs(Re,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:f,children:"Anuluj"}),e.jsx(g,{type:"submit",disabled:x,children:x?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},ic={name:"topics",create:"/topics/create",edit:"/topics/edit/:id",meta:{label:"Tematy",icon:e.jsx(ve,{className:"h-4 w-4"})}},nc=[e.jsx(L,{path:"/topics/create",element:e.jsx(ac,{})},"topics-create"),e.jsx(L,{path:"/topics/edit/:id",element:e.jsx(rc,{})},"topics-edit")],lc=()=>{const{show:s}=pe(),a=B(),[t]=Rs(),r=t.get("topic_id"),{data:n}=ue({resource:"topics",id:r,meta:{select:"*, courses(*)"},queryOptions:{enabled:!!r}}),{data:i,isLoading:l}=de({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:r}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!r}}),{refineCore:{onFinish:o},register:c,handleSubmit:m,setValue:p,watch:d,formState:{errors:u,isSubmitting:x}}=Fe({defaultValues:{topic_id:r?parseInt(r):void 0,type:"material",is_published:!1,position:1,passing_score:70},refineCoreProps:{successNotification:!1,redirect:!1,onMutationSuccess:v=>{const w=n?.data?.course_id,y=v.data.type;if(A.success("Aktywność została utworzona"),y==="quiz")A.info("Dodaj pytania do quizu"),a(`/questions/manage/${v.data.id}`);else{const C=sessionStorage.getItem("returnUrl");C?(sessionStorage.removeItem("returnUrl"),a(C)):a(w?`/courses/show/${w}?expanded=${r}`:"/courses")}}}}),f=d("type");h.useEffect(()=>{if(!l&&i&&i.data.length>0){const v=i.data[0].position+1;p("position",v)}},[i,l,p]);const j=()=>{const v=sessionStorage.getItem("returnUrl");v?(sessionStorage.removeItem("returnUrl"),a(v)):n?.data?.course_id?a(`/courses/show/${n.data.course_id}?expanded=${r}`):a("/courses")};return n?.data?.course_id,r?e.jsxs(P,{children:[e.jsx(ms,{}),e.jsx(_,{children:e.jsx(V,{title:"Dodaj aktywność",description:n?.data?e.jsxs("div",{children:[e.jsx("div",{className:"text-lg",children:n.data.courses?.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Temat ",n.data.position,": ",n.data.title]})]}):"Utwórz nowy materiał lub quiz"})}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Informacje o aktywności"})}),e.jsx(k,{children:e.jsxs(Ee,{onSubmit:m(o),children:[e.jsx("input",{type:"hidden",...c("topic_id")}),e.jsxs(J,{variant:"1-2-2",children:[e.jsx(U,{label:"Typ aktywności",error:u.type?.message,required:!0,children:e.jsxs(le,{value:f,onValueChange:v=>p("type",v),children:[e.jsx(re,{children:e.jsx(oe,{placeholder:"Wybierz typ"})}),e.jsxs(ie,{children:[e.jsx(E,{value:"material",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"}),"Materiał"]})}),e.jsx(E,{value:"quiz",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4"}),"Quiz"]})})]})]})}),e.jsx(U,{label:"Tytuł",htmlFor:"title",error:u.title?.message,required:!0,children:e.jsx(D,{id:"title",placeholder:f==="quiz"?"np. Test wiedzy z rozdziału":"np. Wprowadzenie do tematu",...c("title",{required:"Tytuł jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),e.jsx(U,{label:"Pozycja w temacie",htmlFor:"position",error:u.position?.message,required:!0,children:e.jsx(D,{id:"position",type:"number",min:"1",disabled:!0,className:"bg-muted",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),e.jsx(U,{label:"Czas trwania (min)",htmlFor:"duration_min",hint:"Szacowany czas potrzebny na ukończenie",children:e.jsx(D,{id:"duration_min",type:"number",min:"1",placeholder:"np. 15",...c("duration_min",{min:{value:1,message:"Czas musi być większy od 0"},valueAsNumber:!0})})})]}),f==="material"&&e.jsx(U,{label:"Treść materiału",htmlFor:"content",error:u.content?.message,required:!0,hint:"Możesz używać formatowania Markdown",children:e.jsx(De,{id:"content",placeholder:"Wprowadź treść materiału edukacyjnego...",rows:10,...c("content",{required:f==="material"?"Treść jest wymagana dla materiału":!1})})}),f==="quiz"&&e.jsxs(e.Fragment,{children:[e.jsxs(J,{variant:"1-1-1",children:[e.jsx(U,{label:"Próg zaliczenia (%)",htmlFor:"passing_score",error:u.passing_score?.message,hint:"Minimalny wynik do zaliczenia",children:e.jsx(D,{id:"passing_score",type:"number",min:"0",max:"100",...c("passing_score",{min:{value:0,message:"Wartość minimalna to 0"},max:{value:100,message:"Wartość maksymalna to 100"},valueAsNumber:!0})})}),e.jsx(U,{label:"Limit czasu (min)",htmlFor:"time_limit",hint:"Pozostaw puste dla braku limitu",children:e.jsx(D,{id:"time_limit",type:"number",min:"1",placeholder:"Brak limitu",...c("time_limit",{min:{value:1,message:"Limit musi być większy od 0"},valueAsNumber:!0})})}),e.jsx(U,{label:"Maksymalna liczba prób",htmlFor:"max_attempts",hint:"Pozostaw puste dla nieograniczonej liczby",children:e.jsx(D,{id:"max_attempts",type:"number",min:"1",placeholder:"Bez limitu",...c("max_attempts",{min:{value:1,message:"Minimum 1 próba"},valueAsNumber:!0})})})]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{className:"text-blue-700 dark:text-blue-300",children:"💡 Wskazówka:"})," ",e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"Po utworzeniu quizu zostaniesz przekierowany do ekranu dodawania pytań."})]})})]}),e.jsx(U,{label:"Status publikacji",children:e.jsxs(_,{variant:"start",children:[e.jsx(Oe,{checked:d("is_published")||!1,onCheckedChange:v=>p("is_published",v)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj aktywność od razu (uczniowie będą mogli ją zobaczyć)"})]})}),e.jsxs(Re,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:j,disabled:x,children:"Anuluj"}),e.jsx(g,{type:"submit",disabled:x||!r,children:x?"Tworzenie...":f==="quiz"?"Utwórz i dodaj pytania":"Utwórz aktywność"})]})]})})]})]}):e.jsx(P,{children:e.jsx(z,{children:e.jsxs(k,{className:"text-center py-12",children:[e.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-4",children:"Nie wybrano tematu"}),e.jsx(g,{onClick:()=>a("/courses"),children:"Przejdź do kursów"})]})})})},oc=()=>{const{list:s}=pe(),{id:a}=ye(),t=B(),{data:r,isLoading:n}=ue({resource:"activities",id:a,liveMode:"off",meta:{select:"*, topics(*, courses(*))"}}),{data:i}=ue({resource:"questions",id:a,meta:{select:"count",filter:`activity_id.eq.${a}`},queryOptions:{enabled:!!a&&r?.data?.type==="quiz"}}),{refineCore:{onFinish:l,formLoading:o},register:c,handleSubmit:m,setValue:p,watch:d,reset:u,formState:{errors:x,isSubmitting:f}}=Fe({refineCoreProps:{resource:"activities",id:a,liveMode:"off",redirect:!1,successNotification:!1,onMutationSuccess:()=>{const O=r?.data?.topics?.course_id,M=r?.data?.topic_id;A.success("Aktywność została zaktualizowana");const H=sessionStorage.getItem("returnUrl");H?(sessionStorage.removeItem("returnUrl"),t(H)):O?t(`/courses/show/${O}?expanded=${M}`):s("activities")},onMutationError:O=>{console.error("Błąd podczas aktualizacji:",O),O?.code==="PGRST204"?A.error("Błąd konfiguracji - skontaktuj się z administratorem"):O?.code==="23505"?A.error("Aktywność o tej pozycji już istnieje w tym temacie"):O?.code==="23503"?A.error("Nieprawidłowe powiązanie z tematem"):O?.message?A.error(`Błąd: ${O.message}`):A.error("Wystąpił nieoczekiwany błąd. Spróbuj ponownie.")}}});h.useEffect(()=>{if(r?.data){const{topics:O,_count:M,questions:H,...$}=r.data;u($)}},[r,u]);const j=d("type")||r?.data?.type||"material";if(n||o)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const v=r?.data,w=v?.topics,y=w?.courses,C=y?.id,S=v?.topic_id,W=()=>{const O=sessionStorage.getItem("returnUrl");O?(sessionStorage.removeItem("returnUrl"),t(O)):C?t(`/courses/show/${C}?expanded=${S}`):s("activities")},N=()=>j==="quiz"?e.jsx(Le,{className:"w-6 h-6 text-blue-500"}):e.jsx(ve,{className:"w-6 h-6 text-green-500"}),b=()=>{const O=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",O),t(`/questions/manage/${v?.id}`)},q=i?.data?.[0]?.count||0;return e.jsxs(P,{children:[e.jsx(ms,{}),e.jsxs(_,{children:[e.jsx(V,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[N(),"Edytuj aktywność"]}),description:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-medium",children:v?.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[y?.title," → Temat ",w?.position,": ",w?.title]})]})}),j==="quiz"&&e.jsxs(g,{onClick:b,variant:"outline",children:[e.jsx(Xe,{className:"w-4 h-4 mr-2"}),"Zarządzaj pytaniami (",q,")"]})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Informacje o aktywności"})}),e.jsx(k,{children:e.jsxs(Ee,{onSubmit:m(l),children:[e.jsxs(J,{variant:"1-2-2",children:[e.jsxs(U,{label:"Typ aktywności",error:x.type?.message,required:!0,children:[e.jsxs(le,{value:j,disabled:!0,children:[e.jsx(re,{className:"bg-muted",children:e.jsx(oe,{placeholder:"Wybierz typ"})}),e.jsxs(ie,{children:[e.jsx(E,{value:"material",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"}),"Materiał"]})}),e.jsx(E,{value:"quiz",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4"}),"Quiz"]})})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Typ aktywności nie może być zmieniony"})]}),e.jsx(U,{label:"Tytuł",htmlFor:"title",error:x.title?.message,required:!0,children:e.jsx(D,{id:"title",placeholder:j==="quiz"?"np. Test wiedzy":"np. Wprowadzenie",...c("title",{required:"Tytuł jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),e.jsx(U,{label:"Pozycja w temacie",htmlFor:"position",error:x.position?.message,required:!0,children:e.jsx(D,{id:"position",type:"number",min:"1",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),e.jsx(U,{label:"Czas trwania (min)",htmlFor:"duration_min",hint:"Szacowany czas potrzebny na ukończenie",children:e.jsx(D,{id:"duration_min",type:"number",min:"1",placeholder:"np. 15",...c("duration_min",{min:{value:1,message:"Czas musi być większy od 0"},valueAsNumber:!0})})})]}),j==="material"&&e.jsx(U,{label:"Treść materiału",htmlFor:"content",error:x.content?.message,required:!0,hint:"Możesz używać formatowania Markdown",children:e.jsx(De,{id:"content",placeholder:"Wprowadź treść materiału...",rows:10,...c("content",{required:j==="material"?"Treść jest wymagana dla materiału":!1})})}),j==="quiz"&&e.jsxs(e.Fragment,{children:[e.jsxs(J,{variant:"1-1-1",children:[e.jsx(U,{label:"Próg zaliczenia (%)",htmlFor:"passing_score",error:x.passing_score?.message,hint:"Minimalny wynik do zaliczenia",children:e.jsx(D,{id:"passing_score",type:"number",min:"0",max:"100",...c("passing_score",{min:{value:0,message:"Wartość minimalna to 0"},max:{value:100,message:"Wartość maksymalna to 100"},valueAsNumber:!0})})}),e.jsx(U,{label:"Limit czasu (min)",htmlFor:"time_limit",hint:"Pozostaw puste dla braku limitu",children:e.jsx(D,{id:"time_limit",type:"number",min:"1",placeholder:"Brak limitu",...c("time_limit",{min:{value:1,message:"Limit musi być większy od 0"},valueAsNumber:!0})})}),e.jsx(U,{label:"Maksymalna liczba prób",htmlFor:"max_attempts",hint:"Pozostaw puste dla nieograniczonej liczby",children:e.jsx(D,{id:"max_attempts",type:"number",min:"1",placeholder:"Bez limitu",...c("max_attempts",{min:{value:1,message:"Minimum 1 próba"},valueAsNumber:!0})})})]}),q>0&&e.jsx(z,{className:"mt-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800",children:e.jsx(k,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Ten quiz zawiera ",q," ",q===1?"pytanie":"pytań"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Możesz zarządzać pytaniami klikając przycisk powyżej"})]}),e.jsx(Q,{variant:"outline",className:"text-lg px-3 py-1",children:q})]})})})]}),e.jsx(U,{label:"Status publikacji",children:e.jsxs(_,{variant:"start",children:[e.jsx(Oe,{checked:d("is_published")||!1,onCheckedChange:O=>p("is_published",O)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Aktywność jest opublikowana (uczniowie mogą ją zobaczyć)"})]})}),e.jsxs(Re,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:W,disabled:f,children:"Anuluj"}),e.jsx(g,{type:"submit",disabled:f,children:f?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},cc=()=>{const{edit:s}=pe(),{id:a}=ye(),t=B(),{data:r,isLoading:n}=ue({resource:"activities",id:a,meta:{select:"*, topics(*, courses(*)), questions:questions(count)"}}),{data:i,isLoading:l}=de({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(a)}],sorters:[{field:"position",order:"asc"}],queryOptions:{enabled:r?.data?.type==="quiz"&&!!a}});if(n)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const o=r?.data,c=o?.topics,m=c?.courses,p=o?.questions?.[0]?.count||o?._count?.questions||0,d=()=>{const f=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",f),s("activities",o?.id??"")},u=f=>{const j=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",j),t(f)},x=()=>o?.type==="quiz"?e.jsx(Le,{className:"w-6 h-6 text-blue-500"}):e.jsx(ve,{className:"w-6 h-6 text-green-500"});return e.jsxs(P,{children:[e.jsx(ms,{}),e.jsxs(_,{children:[e.jsx(V,{title:e.jsxs("div",{className:"flex items-center gap-3",children:[x(),o?.title]}),description:e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[m?.title," → Temat ",c?.position,": ",c?.title]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(Q,{variant:o?.type==="quiz"?"default":"outline",children:o?.type==="quiz"?"Quiz":"Materiał"}),e.jsx(Q,{variant:o?.is_published?"default":"secondary",children:o?.is_published?"Opublikowany":"Szkic"})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[o?.type==="quiz"&&e.jsxs(g,{variant:"outline",onClick:()=>u(`/questions/manage/${o.id}`),children:[e.jsx(Xe,{className:"w-4 h-4 mr-2"}),"Pytania (",p,")"]}),e.jsxs(g,{onClick:d,children:[e.jsx(We,{className:"w-4 h-4 mr-2"}),"Edytuj"]})]})]}),e.jsxs(J,{variant:"2-2-4",children:[e.jsxs(z,{children:[e.jsx(I,{className:"pb-2",children:e.jsxs(T,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Czas trwania"]})}),e.jsx(k,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[o?.duration_min||"-"," min"]})})]}),o?.type==="quiz"&&e.jsxs(e.Fragment,{children:[e.jsxs(z,{children:[e.jsx(I,{className:"pb-2",children:e.jsxs(T,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4"}),"Próg zaliczenia"]})}),e.jsx(k,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[o?.passing_score||70,"%"]})})]}),e.jsxs(z,{children:[e.jsx(I,{className:"pb-2",children:e.jsxs(T,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Sn,{className:"w-4 h-4"}),"Limit czasu"]})}),e.jsx(k,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[o?.time_limit||"Brak",o?.time_limit&&" min"]})})]}),e.jsxs(z,{children:[e.jsx(I,{className:"pb-2",children:e.jsxs(T,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Os,{className:"w-4 h-4"}),"Liczba prób"]})}),e.jsx(k,{children:e.jsx("div",{className:"text-2xl font-bold",children:o?.max_attempts||"Bez limitu"})})]})]})]}),o?.type==="material"&&o?.content&&e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Treść materiału"})}),e.jsx(k,{children:e.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:e.jsx(rt,{children:o.content})})})]}),o?.type==="quiz"&&e.jsxs(e.Fragment,{children:[e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Informacje o quizie"})}),e.jsx(k,{children:e.jsx("div",{className:"space-y-4",children:p===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Le,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),e.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-4",children:"Ten quiz nie ma jeszcze pytań"}),e.jsxs(g,{onClick:()=>u(`/questions/manage/${o.id}`),children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Dodaj pytania"]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Liczba pytań"}),e.jsx("p",{className:"text-2xl font-bold",children:p})]}),e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Wymagany wynik"}),e.jsxs("p",{className:"text-2xl font-bold",children:[o.passing_score||70,"%"]})]}),e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Limit czasu"}),e.jsx("p",{className:"text-2xl font-bold",children:o.time_limit?`${o.time_limit} min`:"Brak"})]})]}),e.jsxs(g,{className:"w-full",onClick:()=>u(`/questions/manage/${o.id}`),children:[e.jsx(Xe,{className:"w-4 h-4 mr-2"}),"Zarządzaj pytaniami"]})]})})})]}),p>0&&e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(T,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Pytania w quizie"}),e.jsxs(Q,{variant:"outline",children:[i?.data?.length||0," pytań"]})]})}),e.jsx(k,{children:l?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):e.jsx("div",{className:"space-y-3",children:i?.data?.map((f,j)=>e.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-sm font-medium",children:j+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.type==="single_choice"&&e.jsxs(Q,{variant:"outline",className:"text-xs",children:[e.jsx(Ve,{className:"w-3 h-3 mr-1"}),"Jednokrotny wybór"]}),f.type==="multiple_choice"&&e.jsxs(Q,{variant:"outline",className:"text-xs",children:[e.jsx(Xe,{className:"w-3 h-3 mr-1"}),"Wielokrotny wybór"]}),f.type==="true_false"&&e.jsxs(Q,{variant:"outline",className:"text-xs",children:[e.jsx(lt,{className:"w-3 h-3 mr-1"}),"Prawda/Fałsz"]}),e.jsxs(Q,{variant:"secondary",className:"text-xs",children:[f.points," pkt"]})]}),e.jsx("p",{className:"font-medium",children:f.content}),f.explanation&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[e.jsx("span",{className:"font-medium",children:"Wyjaśnienie:"})," ",f.explanation]})]})]})},f.id))})})]})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Szczegóły"})}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Pozycja w temacie:"}),e.jsx("span",{className:"font-medium",children:o?.position})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx(Q,{variant:o?.is_published?"default":"secondary",children:o?.is_published?"Opublikowany":"Szkic"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Utworzono:"}),e.jsx("span",{children:new Date(o?.created_at).toLocaleDateString("pl-PL")})]}),o?.updated_at&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ostatnia aktualizacja:"}),e.jsx("span",{children:new Date(o.updated_at).toLocaleDateString("pl-PL")})]})]})})]})]})},dc={name:"activities",create:"/activities/create",edit:"/activities/edit/:id",show:"/activities/show/:id",meta:{label:"Aktywności",parent:"topics"}},mc=[e.jsx(L,{path:"/activities/create",element:e.jsx(lc,{})},"activities-create"),e.jsx(L,{path:"/activities/edit/:id",element:e.jsx(oc,{})},"activities-edit"),e.jsx(L,{path:"/activities/show/:id",element:e.jsx(cc,{})},"activities-show")],uc=()=>{const{activityId:s}=ye();B();const[a,t]=h.useState(null),[r,n]=h.useState(!1),{data:i,isLoading:l}=ue({resource:"activities",id:s,meta:{select:"*, topics(*, courses(*))"}}),{data:o,isLoading:c,refetch:m}=de({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(s)}],sorters:[{field:"position",order:"asc"}],pagination:{mode:"off"}}),{mutate:p}=Ze(),{mutate:d}=an(),{mutate:u}=ys();if(l||c)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const x=i?.data,f=o?.data||[];return e.jsxs(P,{children:[e.jsx(ms,{}),e.jsxs(_,{children:[e.jsx(V,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-6 h-6 text-blue-500"}),"Pytania quizu"]}),description:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-medium",children:x?.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[x?.topics?.courses?.title," → Temat"," ",x?.topics?.position,": ",x?.topics?.title]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Q,{variant:"outline",className:"text-base px-3 py-1",children:[f.length," ",f.length===1?"pytanie":"pytań"]}),e.jsxs(g,{onClick:()=>n(!0),disabled:r,children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Dodaj pytanie"]})]})]}),e.jsx(z,{className:"bg-muted/50",children:e.jsx(k,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Próg zaliczenia:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[x?.passing_score||70,"%"]})]}),x?.time_limit&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Limit czasu:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[x.time_limit," min"]})]}),x?.max_attempts&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Max. prób:"}),e.jsx("span",{className:"ml-2 font-medium",children:x.max_attempts})]})]})})}),r&&e.jsx(da,{activityId:parseInt(s),position:f.length+1,onSave:j=>{p({resource:"questions",values:j},{onSuccess:()=>{A.success("Pytanie zostało dodane"),n(!1),m()}})},onCancel:()=>n(!1)}),e.jsx("div",{className:"space-y-4",children:f.map(j=>e.jsx("div",{children:a===j.id?e.jsx(da,{question:j,activityId:parseInt(s),position:j.position,onSave:v=>{d({resource:"questions",id:j.id,values:v},{onSuccess:()=>{A.success("Pytanie zostało zaktualizowane"),t(null),m()}})},onCancel:()=>t(null)}):e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsxs(T,{className:"text-base",children:[e.jsxs("span",{className:"text-muted-foreground mr-2",children:["#",j.position]}),j.question]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Q,{variant:"outline",children:[j.points," pkt"]}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>t(j.id),children:e.jsx(We,{className:"w-3 h-3"})}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{confirm("Czy na pewno chcesz usunąć to pytanie?")&&u({resource:"questions",id:j.id},{onSuccess:()=>{A.success("Pytanie zostało usunięte"),m()}})},children:e.jsx(ss,{className:"w-3 h-3 text-red-600"})})]})]})}),e.jsxs(k,{children:[e.jsx("div",{className:"space-y-2",children:j.options.map((v,w)=>e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded ${v.is_correct?"bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800":""}`,children:[v.is_correct?e.jsx(ge,{className:"w-4 h-4 text-green-600"}):e.jsx(Pe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:v.is_correct?"font-medium":"",children:v.text})]},v.id||w))}),j.explanation&&e.jsxs("div",{className:"mt-4 p-3 bg-muted rounded",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Wyjaśnienie:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:j.explanation})]})]})]})},j.id))}),f.length===0&&!r&&e.jsx(z,{children:e.jsxs(k,{className:"text-center py-12",children:[e.jsx(Le,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),e.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-4",children:"Quiz nie ma jeszcze żadnych pytań"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Dodaj pierwsze pytanie, aby uczniowie mogli rozwiązać quiz"}),e.jsxs(g,{onClick:()=>n(!0),children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Dodaj pierwsze pytanie"]})]})}),f.length>0&&e.jsxs("div",{className:"flex justify-between items-center pt-6 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Łącznie punktów: ",f.reduce((j,v)=>j+v.points,0)]}),e.jsx(ms,{variant:"outline",children:"Zakończ edycję"})]})]})},da=({question:s,activityId:a,position:t,onSave:r,onCancel:n})=>{const[i,l]=h.useState({question:s?.question||"",explanation:s?.explanation||"",points:s?.points||1,position:t,options:s?.options||[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]}),o=()=>{if(!i.question.trim()){A.error("Pytanie jest wymagane");return}const p=i.options.filter(u=>u.text.trim());if(p.length<2){A.error("Dodaj przynajmniej 2 odpowiedzi");return}if(p.filter(u=>u.is_correct).length===0){A.error("Zaznacz przynajmniej jedną poprawną odpowiedź");return}r({activity_id:a,question:i.question,explanation:i.explanation||null,points:i.points,position:i.position,options:p.map((u,x)=>({...u,position:x+1}))})},c=()=>{i.options.length<6&&l({...i,options:[...i.options,{text:"",is_correct:!1}]})},m=p=>{if(i.options.length>2){const d=i.options.filter((u,x)=>x!==p);l({...i,options:d})}};return e.jsxs(z,{className:"border-primary",children:[e.jsx(I,{children:e.jsx(T,{children:s?"Edytuj pytanie":"Nowe pytanie"})}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Treść pytania"}),e.jsx(De,{placeholder:"Wprowadź treść pytania...",value:i.question,onChange:p=>l({...i,question:p.target.value}),className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Liczba punktów"}),e.jsx(D,{type:"number",min:"1",value:i.points,onChange:p=>l({...i,points:parseInt(p.target.value)||1}),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Pozycja"}),e.jsx(D,{type:"number",min:"1",value:i.position,onChange:p=>l({...i,position:parseInt(p.target.value)||1}),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Odpowiedzi"}),i.options.length<6&&e.jsxs(g,{type:"button",size:"sm",variant:"outline",onClick:c,children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"Dodaj opcję"]})]}),e.jsx("div",{className:"space-y-2",children:i.options.map((p,d)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Te,{checked:p.is_correct,onCheckedChange:u=>{const x=[...i.options];x[d].is_correct=u,l({...i,options:x})}}),e.jsx(D,{placeholder:`Odpowiedź ${d+1}`,value:p.text,onChange:u=>{const x=[...i.options];x[d].text=u.target.value,l({...i,options:x})},className:"flex-1"}),i.options.length>2&&e.jsx(g,{type:"button",variant:"ghost",size:"sm",onClick:()=>m(d),children:e.jsx(Pe,{className:"w-4 h-4"})})]},d))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Zaznacz checkbox przy poprawnych odpowiedziach. Możesz zaznaczyć więcej niż jedną."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Wyjaśnienie (opcjonalne)"}),e.jsx(De,{placeholder:"Wyjaśnienie poprawnej odpowiedzi...",value:i.explanation,onChange:p=>l({...i,explanation:p.target.value}),className:"mt-1",rows:3})]}),e.jsxs(_,{children:[e.jsxs(g,{variant:"outline",onClick:n,children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),e.jsxs(g,{onClick:o,children:[e.jsx($s,{className:"w-4 h-4 mr-2"}),"Zapisz pytanie"]})]})]})]})},xc=()=>{const[s]=Rs(),a=B(),t=s.get("activity_id"),{data:r,isLoading:n}=de({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(t)}],sorters:[{field:"position",order:"desc"}],pagination:{mode:"off"}}),[i,l]=h.useState({question:"",explanation:"",points:1,position:1,options:[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]});h.useEffect(()=>{if(r?.data){const j=r.data.reduce((v,w)=>Math.max(v,w.position||0),0);l(v=>({...v,position:j+1}))}},[r]);const{data:o,isLoading:c}=ue({resource:"activities",id:t,meta:{select:"*, topics(*, courses(*))"}}),{mutate:m,isLoading:p}=Ze();if(!t)return e.jsx(P,{children:e.jsx(z,{children:e.jsx(k,{className:"text-center py-12",children:e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Brak ID aktywności"})})})});if(c||n)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const d=o?.data;if(!d||d.type!=="quiz")return e.jsx(P,{children:e.jsx(z,{children:e.jsx(k,{className:"text-center py-12",children:e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Nieprawidłowa aktywność lub aktywność nie jest quizem"})})})});const u=()=>{if(!i.question.trim()){A.error("Pytanie jest wymagane");return}const j=i.options.filter(w=>w.text.trim());if(j.length<2){A.error("Dodaj przynajmniej 2 odpowiedzi");return}if(j.filter(w=>w.is_correct).length===0){A.error("Zaznacz przynajmniej jedną poprawną odpowiedź");return}m({resource:"questions",values:{activity_id:parseInt(t),question:i.question,explanation:i.explanation||null,points:i.points,position:i.position,options:j.map((w,y)=>({id:y+1,text:w.text,is_correct:w.is_correct}))}},{onSuccess:()=>{A.success("Pytanie zostało dodane"),a(`/questions/manage/${t}`)},onError:w=>{console.error("Błąd podczas dodawania pytania:",w);const y=w?.code||w?.statusCode,C=w?.message||w?.error?.message;y==="23505"||y===23505?C?.includes("position")?A.error("Pytanie o tej pozycji już istnieje. Zmień pozycję na inną wartość."):A.error("Wystąpił konflikt z istniejącymi danymi. Sprawdź pozycję pytania."):y==="23503"||y===23503?A.error("Nieprawidłowe powiązanie z aktywnością."):y==="22P02"||y===22002?A.error("Nieprawidłowy format danych."):C?A.error(`Błąd: ${C}`):A.error("Wystąpił nieoczekiwany błąd. Spróbuj ponownie.")}})},x=()=>{i.options.length<6&&l({...i,options:[...i.options,{text:"",is_correct:!1}]})},f=j=>{if(i.options.length>2){const v=i.options.filter((w,y)=>y!==j);l({...i,options:v})}};return e.jsxs(P,{children:[e.jsx(ms,{}),e.jsx(_,{children:e.jsx(V,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-6 h-6 text-blue-500"}),"Dodaj pytanie do quizu"]}),description:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-medium",children:d?.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[d?.topics?.courses?.title," → Temat"," ",d?.topics?.position,": ",d?.topics?.title]})]})})}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Nowe pytanie"})}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Treść pytania"}),e.jsx(De,{placeholder:"Wprowadź treść pytania...",value:i.question,onChange:j=>l({...i,question:j.target.value}),className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Liczba punktów"}),e.jsx(D,{type:"number",min:"1",value:i.points,onChange:j=>l({...i,points:parseInt(j.target.value)||1}),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Pozycja"}),e.jsx(D,{type:"number",min:"1",value:i.position,onChange:j=>l({...i,position:parseInt(j.target.value)||1}),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Odpowiedzi"}),i.options.length<6&&e.jsxs(g,{type:"button",size:"sm",variant:"outline",onClick:x,children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"Dodaj opcję"]})]}),e.jsx("div",{className:"space-y-2",children:i.options.map((j,v)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Te,{checked:j.is_correct,onCheckedChange:w=>{const y=[...i.options];y[v].is_correct=w,l({...i,options:y})}}),e.jsx(D,{placeholder:`Odpowiedź ${v+1}`,value:j.text,onChange:w=>{const y=[...i.options];y[v].text=w.target.value,l({...i,options:y})},className:"flex-1"}),i.options.length>2&&e.jsx(g,{type:"button",variant:"ghost",size:"sm",onClick:()=>f(v),children:e.jsx(Pe,{className:"w-4 h-4"})})]},v))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Zaznacz checkbox przy poprawnych odpowiedziach. Możesz zaznaczyć więcej niż jedną."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Wyjaśnienie (opcjonalne)"}),e.jsx(De,{placeholder:"Wyjaśnienie poprawnej odpowiedzi...",value:i.explanation,onChange:j=>l({...i,explanation:j.target.value}),className:"mt-1",rows:3})]}),e.jsxs(_,{children:[e.jsxs(g,{variant:"outline",onClick:()=>a(`/questions/manage/${t}`),children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),e.jsxs(g,{onClick:u,disabled:p,children:[e.jsx($s,{className:"w-4 h-4 mr-2"}),p?"Zapisywanie...":"Zapisz pytanie"]})]})]})]})]})},pc=[e.jsx(L,{path:"/questions/manage/:activityId",element:e.jsx(uc,{})},"questions-manage"),e.jsx(L,{path:"/questions/create",element:e.jsx(xc,{})},"questions-create")],hc=()=>{const{create:s,edit:a,show:t}=pe(),{mutate:r}=ys(),{tableQuery:{data:n,isLoading:i,isError:l},current:o,setCurrent:c,pageSize:m,setFilters:p}=ut({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, group_members:group_members(count), course_access:course_access(count)"}}),d=wt({isLoading:i,isError:l});if(d)return d;const u=(x,f)=>{confirm(`Czy na pewno chcesz usunąć grupę "${f}"?`)&&r({resource:"groups",id:x})};return e.jsxs(P,{children:[e.jsxs(_,{children:[e.jsx(V,{title:"Grupy",description:"Zarządzaj grupami uczniów"}),e.jsxs(g,{onClick:()=>s("groups"),children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Dodaj grupę"]})]}),e.jsx(_,{children:e.jsx(D,{placeholder:"Szukaj grup...",className:"max-w-sm",onChange:x=>{p([{field:"name",operator:"contains",value:x.target.value}])}})}),e.jsx(J,{children:n?.data?.map(x=>e.jsxs(z,{className:"cursor-pointer transition-shadow hover:shadow-lg",onClick:f=>{f.target.closest('[role="menu"]')||t("groups",x.id)},children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5"}),x.name]}),e.jsxs(bs,{children:[e.jsx(vs,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"sm",onClick:f=>f.stopPropagation(),children:e.jsx(As,{className:"h-4 w-4"})})}),e.jsxs(cs,{align:"end",children:[e.jsxs(ce,{onClick:()=>t("groups",x.id),children:[e.jsx(Ae,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),e.jsxs(ce,{onClick:()=>a("groups",x.id),children:[e.jsx(We,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),e.jsxs(ce,{onClick:()=>u(x.id,x.name),className:"text-red-600",children:[e.jsx(ss,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Fs,{className:"w-4 h-4"}),e.jsxs("span",{children:["Rok akademicki: ",x.academic_year]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-background rounded-md",children:e.jsx(je,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Uczniowie"}),e.jsx("p",{className:"text-lg font-semibold",children:x.group_members?.[0]?.count||x._count?.group_members||0})]})]})}),e.jsx("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-background rounded-md",children:e.jsx(xe,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Kursy"}),e.jsx("p",{className:"text-lg font-semibold",children:x.course_access?.[0]?.count||x._count?.course_access||0})]})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(Q,{variant:x.is_active?"default":"secondary",children:x.is_active?"Aktywna":"Nieaktywna"})})]})})]},x.id))}),e.jsx(Nt,{current:o,pageSize:m,total:n?.total||0,setCurrent:c,itemName:"grup"})]})},jc=()=>{const{list:s}=pe(),{data:a}=Ne(),{refineCore:{onFinish:t},register:r,handleSubmit:n,setValue:i,watch:l,formState:{errors:o,isSubmitting:c}}=Fe({defaultValues:{name:"",vendor_id:a?.vendor_id||0,is_active:!0,academic_year:new Date().getFullYear().toString()+"/"+(new Date().getFullYear()+1).toString()}});return e.jsxs(P,{children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>s("groups"),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(_,{children:e.jsx(V,{title:"Dodaj grupę",description:"Utwórz nową grupę uczniów"})}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Informacje o grupie"})}),e.jsx(k,{children:e.jsxs(Ee,{onSubmit:n(t),children:[e.jsx(U,{label:"Nazwa grupy",htmlFor:"name",error:o.name?.message?.toString(),required:!0,children:e.jsx(D,{id:"name",placeholder:"np. Klasa 1A",...r("name",{required:"Nazwa grupy jest wymagana",minLength:{value:2,message:"Nazwa musi mieć minimum 2 znaki"}})})}),e.jsx(U,{label:"Rok akademicki",htmlFor:"academic_year",error:o.academic_year?.message?.toString(),required:!0,children:e.jsx(D,{id:"academic_year",placeholder:"np. 2024/2025",...r("academic_year",{required:"Rok akademicki jest wymagany",pattern:{value:/^\d{4}\/\d{4}$/,message:"Format: RRRR/RRRR (np. 2024/2025)"}})})}),e.jsx(U,{label:"Status grupy",children:e.jsxs(_,{variant:"start",children:[e.jsx(Oe,{checked:l("is_active"),onCheckedChange:m=>i("is_active",m)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Grupa aktywna"})]})}),e.jsxs(Re,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>s("groups"),children:"Anuluj"}),e.jsx(g,{type:"submit",disabled:c,children:c?"Tworzenie...":"Utwórz grupę"})]})]})})]})]})},gc=()=>{const{list:s}=pe(),{id:a}=ye(),{data:t,isLoading:r}=ue({resource:"groups",id:a,liveMode:"off"}),{refineCore:{onFinish:n},register:i,handleSubmit:l,setValue:o,watch:c,reset:m,formState:{errors:p,isSubmitting:d}}=Fe({refineCoreProps:{resource:"groups",id:a,redirect:"list",liveMode:"off"}});return h.useEffect(()=>{t?.data&&m({name:t.data.name,academic_year:t.data.academic_year,is_active:t.data.is_active,vendor_id:t.data.vendor_id})},[t,m]),r?e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs(P,{children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>s("groups"),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(_,{children:e.jsx(V,{title:"Edytuj grupę",description:`Edycja: ${t?.data?.name}`})}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Informacje o grupie"})}),e.jsx(k,{children:e.jsxs(Ee,{onSubmit:l(n),children:[e.jsx(U,{label:"Nazwa grupy",htmlFor:"name",error:p.name?.message,required:!0,children:e.jsx(D,{id:"name",placeholder:"np. Klasa 1A",...i("name",{required:"Nazwa grupy jest wymagana",minLength:{value:2,message:"Nazwa musi mieć minimum 2 znaki"}})})}),e.jsx(U,{label:"Rok akademicki",htmlFor:"academic_year",error:p.academic_year?.message,required:!0,children:e.jsx(D,{id:"academic_year",placeholder:"np. 2024/2025",...i("academic_year",{required:"Rok akademicki jest wymagany",pattern:{value:/^\d{4}\/\d{4}$/,message:"Format: RRRR/RRRR (np. 2024/2025)"}})})}),e.jsx(U,{label:"Status grupy",children:e.jsxs(_,{variant:"start",children:[e.jsx(Oe,{checked:c("is_active"),onCheckedChange:u=>o("is_active",u)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Grupa aktywna"})]})}),e.jsxs(Re,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>s("groups"),children:"Anuluj"}),e.jsx(g,{type:"submit",disabled:d,children:d?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},yc=()=>{const{list:s,edit:a}=pe(),{id:t}=ye(),r=B(),n=rn(),{data:i,isLoading:l}=ue({resource:"groups",id:t,liveMode:"off"}),{data:o}=de({resource:"group_members",filters:[{field:"group_id",operator:"eq",value:t}],meta:{select:"*, users(*)"},queryOptions:{enabled:!!t},liveMode:"off"}),{data:c}=de({resource:"course_access",filters:[{field:"group_id",operator:"eq",value:t}],meta:{select:"*, courses(*)"},queryOptions:{enabled:!!t},liveMode:"off"}),m=async(u,x)=>{if(confirm(`Czy na pewno chcesz odpiąć kurs "${x}" od tej grupy?`))try{const{error:f}=await Y.from("course_access").delete().eq("course_id",u).eq("group_id",parseInt(t));if(f)throw f;A.success("Kurs został odpięty od grupy"),n({resource:"course_access",invalidates:["list"]})}catch(f){console.error("Error removing course:",f),A.error("Błąd podczas odpinania kursu")}},p=async(u,x)=>{if(confirm(`Czy na pewno chcesz usunąć "${x}" z tej grupy?`))try{const{error:f}=await Y.from("group_members").delete().eq("user_id",u).eq("group_id",parseInt(t));if(f)throw f;A.success("Uczeń został usunięty z grupy"),n({resource:"group_members",invalidates:["list"]})}catch(f){console.error("Error removing member:",f),A.error("Błąd podczas usuwania ucznia z grupy")}};if(l)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const d=i?.data;return e.jsxs(P,{children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>s("groups"),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsxs(_,{children:[e.jsx(V,{title:d?.name,description:`Rok akademicki: ${d?.academic_year}`}),e.jsxs(g,{onClick:()=>a("groups",d?.id??""),children:[e.jsx(We,{className:"w-4 h-4 mr-2"}),"Edytuj grupę"]})]}),e.jsxs(J,{variant:"2-2-4",children:[e.jsxs(z,{children:[e.jsx(I,{className:"pb-2",children:e.jsx(T,{className:"text-sm font-medium",children:"Status"})}),e.jsx(k,{children:e.jsx(Q,{variant:d?.is_active?"default":"secondary",children:d?.is_active?"Aktywna":"Nieaktywna"})})]}),e.jsxs(z,{children:[e.jsx(I,{className:"pb-2",children:e.jsx(T,{className:"text-sm font-medium",children:"Uczniowie"})}),e.jsx(k,{children:e.jsx("div",{className:"text-2xl font-bold",children:o?.total||0})})]}),e.jsxs(z,{children:[e.jsx(I,{className:"pb-2",children:e.jsx(T,{className:"text-sm font-medium",children:"Kursy"})}),e.jsx(k,{children:e.jsx("div",{className:"text-2xl font-bold",children:c?.total||0})})]}),e.jsxs(z,{children:[e.jsx(I,{className:"pb-2",children:e.jsx(T,{className:"text-sm font-medium",children:"Utworzono"})}),e.jsx(k,{children:e.jsx("div",{className:"text-sm",children:new Date(d?.created_at).toLocaleDateString("pl-PL")})})]})]}),e.jsxs(J,{variant:"1-2-2",children:[e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsx(T,{children:"Uczniowie grupy"}),e.jsxs(g,{size:"sm",onClick:()=>r(`/groups/${t}/assign-students`),children:[e.jsx(ot,{className:"w-4 h-4 mr-2"}),"Dodaj ucznia"]})]})}),e.jsx(k,{children:o?.data?.length?e.jsx("div",{className:"space-y-2",children:o.data.map(u=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-muted flex items-center justify-center",children:e.jsx(je,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:u.users?.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u.users?.email})]})]}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>p(u.user_id,u.users?.full_name),children:e.jsx(ss,{className:"h-4 w-4 text-red-600"})})]},u.user_id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(je,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Brak uczniów w grupie"})]})})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsx(T,{children:"Przypisane kursy"}),e.jsxs(g,{size:"sm",onClick:()=>r(`/groups/${t}/assign-courses`),children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Przypisz kurs"]})]})}),e.jsx(k,{children:c?.data?.length?e.jsx("div",{className:"space-y-2",children:c.data.map(u=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[u.courses?.icon_emoji?e.jsx("span",{className:"text-2xl",children:u.courses.icon_emoji}):e.jsx(xe,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:u.courses?.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Przypisano:"," ",new Date(u.assigned_at).toLocaleDateString("pl-PL")]})]})]}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>m(u.course_id,u.courses?.title),children:e.jsx(ss,{className:"h-4 w-4 text-red-600"})})]},u.course_id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(xe,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Brak przypisanych kursów"})]})})]})]})]})},fc=()=>{const{id:s}=ye(),a=B(),[t,r]=h.useState([]),[n,i]=h.useState(""),{data:l,isLoading:o}=ue({resource:"groups",id:s}),{data:c,isLoading:m}=de({resource:"courses",pagination:{mode:"off"}}),{data:p,isLoading:d}=de({resource:"course_access",filters:[{field:"group_id",operator:"eq",value:parseInt(s)}],pagination:{mode:"off"},meta:{select:"course_id, group_id"}}),{mutate:u,isLoading:x}=Ze(),f=async()=>{if(t.length===0){A.error("Wybierz przynajmniej jeden kurs");return}try{const N=t.map(b=>u({resource:"course_access",values:{course_id:b,group_id:parseInt(s)}},{onSuccess:()=>{console.log(`Course ${b} assigned successfully`)},onError:q=>{console.error("Error assigning course:",b,q)}}));await Promise.all(N),A.success(`Przypisano ${t.length} kursów do grupy`),a(`/groups/show/${s}`)}catch(N){A.error("Błąd podczas przypisywania kursów"),console.error("Error details:",N)}};if(o||m||d)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const j=l?.data,v=p?.data?.map(N=>N.course_id)||[],w=c?.data?.filter(N=>!v.includes(N.id))||[],y=w.filter(N=>N.title.toLowerCase().includes(n.toLowerCase())),C=N=>{r(b=>b.includes(N)?b.filter(q=>q!==N):[...b,N])},S=()=>{r(y.map(N=>N.id))},W=()=>{r([])};return e.jsxs(P,{children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>a(`/groups/show/${s}`),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do grupy"]}),e.jsx(_,{children:e.jsx(V,{title:"Przypisz kursy",description:`Przypisywanie kursów do grupy: ${j?.name}`})}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsx(T,{children:"Dostępne kursy"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:S,disabled:y.length===0,children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Zaznacz wszystkie"]}),e.jsxs(g,{variant:"outline",size:"sm",onClick:W,disabled:t.length===0,children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Odznacz wszystkie"]})]})]})}),e.jsxs(k,{children:[e.jsx(D,{placeholder:"Szukaj kursów...",value:n,onChange:N=>i(N.target.value),className:"mb-4"}),y.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:w.length===0?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Wszystkie kursy są już przypisane do tej grupy"})]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Nie znaleziono kursów"})]})}):e.jsx("div",{className:"space-y-2",children:y.map(N=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-muted/50 cursor-pointer",onClick:()=>C(N.id),children:[e.jsx(Te,{checked:t.includes(N.id),onCheckedChange:()=>C(N.id),onClick:b=>b.stopPropagation()}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[N.icon_emoji&&e.jsx("span",{className:"text-xl",children:N.icon_emoji}),e.jsx("span",{className:"font-medium",children:N.title})]}),N.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:N.description})]})]},N.id))}),t.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:["Wybrano ",t.length," kursów do przypisania"]}),e.jsxs(_,{children:[e.jsx(g,{variant:"outline",onClick:()=>a(`/groups/show/${s}`),children:"Anuluj"}),e.jsx(g,{onClick:f,disabled:x,children:x?"Przypisywanie...":"Przypisz kursy"})]})]})]})]})]})},wc=()=>{const{id:s}=ye(),a=B(),[t,r]=h.useState([]),[n,i]=h.useState(""),{data:l,isLoading:o}=ue({resource:"groups",id:s}),{data:c,isLoading:m}=de({resource:"users",filters:[{field:"role",operator:"eq",value:"student"}],pagination:{mode:"off"}}),{data:p,isLoading:d}=de({resource:"group_members",filters:[{field:"group_id",operator:"eq",value:parseInt(s)}],pagination:{mode:"off"},meta:{select:"user_id, group_id"}}),{mutate:u,isLoading:x}=Ze(),f=async()=>{if(t.length===0){A.error("Wybierz przynajmniej jednego ucznia");return}try{const N=t.map(b=>u({resource:"group_members",values:{user_id:b,group_id:parseInt(s)}},{onSuccess:()=>{console.log(`Student ${b} assigned successfully`)},onError:q=>{console.error("Error assigning student:",b,q)}}));await Promise.all(N),A.success(`Dodano ${t.length} uczniów do grupy`),a(`/groups/show/${s}`)}catch(N){A.error("Błąd podczas dodawania uczniów"),console.error("Error details:",N)}};if(o||m||d)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const j=l?.data,v=p?.data?.map(N=>N.user_id)||[],w=c?.data?.filter(N=>!v.includes(N.id))||[],y=w.filter(N=>N.full_name.toLowerCase().includes(n.toLowerCase())||N.email.toLowerCase().includes(n.toLowerCase())),C=N=>{r(b=>b.includes(N)?b.filter(q=>q!==N):[...b,N])},S=()=>{r(y.map(N=>N.id))},W=()=>{r([])};return e.jsxs(P,{children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>a(`/groups/show/${s}`),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do grupy"]}),e.jsx(_,{children:e.jsx(V,{title:"Dodaj uczniów",description:`Dodawanie uczniów do grupy: ${j?.name}`})}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsx(T,{children:"Dostępni uczniowie"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:S,disabled:y.length===0,children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Zaznacz wszystkich"]}),e.jsxs(g,{variant:"outline",size:"sm",onClick:W,disabled:t.length===0,children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Odznacz wszystkich"]})]})]})}),e.jsxs(k,{children:[e.jsx(D,{placeholder:"Szukaj uczniów...",value:n,onChange:N=>i(N.target.value),className:"mb-4"}),y.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:w.length===0?e.jsxs(e.Fragment,{children:[e.jsx(ot,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Wszyscy uczniowie są już w tej grupie"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ot,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Nie znaleziono uczniów"})]})}):e.jsx("div",{className:"space-y-2",children:y.map(N=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-muted/50 cursor-pointer",onClick:()=>C(N.id),children:[e.jsx(Te,{checked:t.includes(N.id),onCheckedChange:()=>C(N.id),onClick:b=>b.stopPropagation()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:N.full_name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(es,{className:"w-3 h-3"}),N.email]})]}),e.jsx(Q,{variant:"secondary",className:"text-xs",children:"Uczeń"})]},N.id))}),t.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:["Wybrano ",t.length," uczniów do dodania"]}),e.jsxs(_,{children:[e.jsx(g,{variant:"outline",onClick:()=>a(`/groups/show/${s}`),children:"Anuluj"}),e.jsx(g,{onClick:f,disabled:x,children:x?"Dodawanie...":"Dodaj uczniów"})]})]})]})]})]})},bc={name:"groups",list:"/groups",create:"/groups/create",edit:"/groups/edit/:id",show:"/groups/show/:id",meta:{label:"Grupy",icon:e.jsx(je,{className:"h-4 w-4"})}},vc=[e.jsx(L,{path:"/groups",element:e.jsx(hc,{})},"groups-list"),e.jsx(L,{path:"/groups/create",element:e.jsx(jc,{})},"groups-create"),e.jsx(L,{path:"/groups/edit/:id",element:e.jsx(gc,{})},"groups-edit"),e.jsx(L,{path:"/groups/show/:id",element:e.jsx(yc,{})},"groups-show"),e.jsx(L,{path:"/groups/:id/assign-courses",element:e.jsx(fc,{})},"groups-assign-courses"),e.jsx(L,{path:"/groups/:id/assign-students",element:e.jsx(wc,{})},"groups-assign-students")],Nc=()=>{const{create:s,edit:a,show:t}=pe(),{mutate:r}=ys(),[n,i]=h.useState("all"),{tableQuery:{data:l,isLoading:o,isError:c},current:m,setCurrent:p,pageSize:d,setFilters:u}=ut({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, user_stats(total_points, current_level)"}}),x=wt({isLoading:o,isError:c});if(x)return x;const f=(y,C)=>{confirm(`Czy na pewno chcesz usunąć użytkownika "${C}"?`)&&r({resource:"users",id:y})},j=y=>{const C=[];y&&C.push({operator:"or",value:[{field:"full_name",operator:"contains",value:y},{field:"email",operator:"contains",value:y}]}),n!=="all"&&C.push({field:"role",operator:"eq",value:n}),u(C)},v=y=>{switch(y){case"admin":return e.jsx(xt,{className:"w-3 h-3"});case"teacher":return e.jsx(fs,{className:"w-3 h-3"});default:return e.jsx(Tn,{className:"w-3 h-3"})}},w=y=>{switch(y){case"admin":return"destructive";case"teacher":return"default";default:return"secondary"}};return e.jsxs(P,{children:[e.jsxs(_,{children:[e.jsx(V,{title:"Użytkownicy",description:"Zarządzaj użytkownikami systemu"}),e.jsxs(g,{onClick:()=>s("users"),children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Dodaj użytkownika"]})]}),e.jsxs(_,{className:"gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(Va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(D,{placeholder:"Szukaj po nazwie lub email...",className:"pl-10",onChange:y=>j(y.target.value)})]}),e.jsxs(le,{value:n,onValueChange:y=>{i(y),j("")},children:[e.jsx(re,{className:"w-[180px]",children:e.jsx(oe,{placeholder:"Filtruj po roli"})}),e.jsxs(ie,{children:[e.jsx(E,{value:"all",children:"Wszystkie role"}),e.jsx(E,{value:"student",children:"Studenci"}),e.jsx(E,{value:"teacher",children:"Nauczyciele"}),e.jsx(E,{value:"admin",children:"Administratorzy"})]})]})]}),e.jsx("div",{className:"space-y-4",children:l?.data?.map(y=>e.jsx(z,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center",children:e.jsx(je,{className:"h-6 w-6 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:y.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:y.email})]}),e.jsxs(Q,{variant:w(y.role),children:[v(y.role),e.jsx("span",{className:"ml-1 capitalize",children:y.role})]}),e.jsx(Q,{variant:y.is_active?"outline":"secondary",children:y.is_active?"Aktywny":"Nieaktywny"})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[y.user_stats&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Punkty"}),e.jsx("p",{className:"font-semibold",children:y.user_stats.total_points})]}),e.jsxs(bs,{children:[e.jsx(vs,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"sm",children:e.jsx(As,{className:"h-4 w-4"})})}),e.jsxs(cs,{align:"end",children:[e.jsxs(ce,{onClick:()=>t("users",y.id),children:[e.jsx(Ae,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),e.jsxs(ce,{onClick:()=>a("users",y.id),children:[e.jsx(We,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),e.jsxs(ce,{onClick:()=>f(y.id,y.full_name),className:"text-red-600",children:[e.jsx(ss,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})]})})},y.id))}),e.jsx(Nt,{current:m,pageSize:d,total:l?.total||0,setCurrent:p,itemName:"użytkowników"})]})},zc=()=>{const{list:s}=pe(),{data:a}=Ne(),{refineCore:{onFinish:t},register:r,handleSubmit:n,setValue:i,watch:l,formState:{errors:o,isSubmitting:c}}=Fe({defaultValues:{full_name:"",email:"",vendor_id:a?.vendor_id||0,role:"student",is_active:!0}});return e.jsxs(P,{children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>s("users"),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(_,{children:e.jsx(V,{title:"Dodaj użytkownika",description:"Utwórz nowe konto użytkownika"})}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Dane użytkownika"})}),e.jsx(k,{children:e.jsxs(Ee,{onSubmit:n(t),children:[e.jsxs(J,{variant:"1-2-2",children:[e.jsx(U,{label:"Imię i nazwisko",htmlFor:"full_name",error:o.full_name?.message?.toString(),required:!0,children:e.jsx(D,{id:"full_name",placeholder:"np. Jan Kowalski",...r("full_name",{required:"Imię i nazwisko są wymagane",minLength:{value:3,message:"Minimum 3 znaki"}})})}),e.jsx(U,{label:"Email",htmlFor:"email",error:o.email?.message?.toString(),required:!0,children:e.jsx(D,{id:"email",type:"email",placeholder:"np. jan.kowalski@example.com",...r("email",{required:"Email jest wymagany",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Nieprawidłowy format email"}})})}),e.jsx(U,{label:"Rola",error:o.role?.message?.toString(),required:!0,children:e.jsxs(le,{value:l("role"),onValueChange:m=>i("role",m),children:[e.jsx(re,{children:e.jsx(oe,{placeholder:"Wybierz rolę"})}),e.jsxs(ie,{children:[e.jsx(E,{value:"student",children:"Student"}),e.jsx(E,{value:"teacher",children:"Nauczyciel"}),e.jsx(E,{value:"admin",children:"Administrator"})]})]})})]}),e.jsx(U,{label:"Status konta",children:e.jsxs(_,{variant:"start",children:[e.jsx(Oe,{checked:l("is_active"),onCheckedChange:m=>i("is_active",m)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Konto aktywne (użytkownik może się zalogować)"})]})}),e.jsxs(Re,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>s("users"),children:"Anuluj"}),e.jsx(g,{type:"submit",disabled:c,children:c?"Tworzenie...":"Utwórz użytkownika"})]})]})})]})]})},kc=()=>{const{list:s}=pe(),{id:a}=ye(),{data:t,isLoading:r}=ue({resource:"users",id:a,liveMode:"off"}),{refineCore:{onFinish:n},register:i,handleSubmit:l,setValue:o,watch:c,reset:m,formState:{errors:p,isSubmitting:d}}=Fe({refineCoreProps:{resource:"users",id:a,redirect:"list",liveMode:"off"}});return h.useEffect(()=>{t?.data&&m({full_name:t.data.full_name,email:t.data.email,role:t.data.role,is_active:t.data.is_active,vendor_id:t.data.vendor_id})},[t,m]),r?e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs(P,{children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>s("users"),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(_,{children:e.jsx(V,{title:"Edytuj użytkownika",description:`Edycja: ${t?.data?.full_name}`})}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Dane użytkownika"})}),e.jsx(k,{children:e.jsxs(Ee,{onSubmit:l(n),children:[e.jsxs(J,{variant:"1-2-2",children:[e.jsx(U,{label:"Imię i nazwisko",htmlFor:"full_name",error:p.full_name?.message,required:!0,children:e.jsx(D,{id:"full_name",placeholder:"np. Jan Kowalski",...i("full_name",{required:"Imię i nazwisko są wymagane",minLength:{value:3,message:"Minimum 3 znaki"}})})}),e.jsx(U,{label:"Email",htmlFor:"email",error:p.email?.message,required:!0,children:e.jsx(D,{id:"email",type:"email",placeholder:"np. jan.kowalski@example.com",...i("email",{required:"Email jest wymagany",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Nieprawidłowy format email"}}),disabled:!0})}),e.jsx(U,{label:"Rola",error:p.role?.message,required:!0,children:e.jsxs(le,{value:c("role")||"student",onValueChange:u=>o("role",u),children:[e.jsx(re,{children:e.jsx(oe,{placeholder:"Wybierz rolę"})}),e.jsxs(ie,{children:[e.jsx(E,{value:"student",children:"Student"}),e.jsx(E,{value:"teacher",children:"Nauczyciel"}),e.jsx(E,{value:"admin",children:"Administrator"})]})]})})]}),e.jsx(U,{label:"Status konta",children:e.jsxs(_,{variant:"start",children:[e.jsx(Oe,{checked:c("is_active")??!0,onCheckedChange:u=>o("is_active",u)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Konto aktywne (użytkownik może się zalogować)"})]})}),e.jsxs(Re,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>s("users"),children:"Anuluj"}),e.jsx(g,{type:"submit",disabled:d,children:d?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},Cc=()=>{const{list:s,edit:a}=pe(),{id:t}=ye(),{data:r,isLoading:n}=ue({resource:"users",id:t,meta:{select:"*, user_stats(*)"}}),{data:i}=de({resource:"activity_progress",filters:[{field:"user_id",operator:"eq",value:t}]});if(n)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const l=r?.data,o=l?.user_stats?.[0]||{},c=m=>{switch(m){case"admin":return e.jsx(xt,{className:"w-4 h-4"});case"teacher":return e.jsx(xe,{className:"w-4 h-4"});default:return e.jsx(Qe,{className:"w-4 h-4"})}};return e.jsxs(P,{children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>s("users"),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsxs(_,{children:[e.jsx(V,{title:l?.full_name,description:l?.email}),e.jsxs(g,{onClick:()=>a("users",l?.id??""),children:[e.jsx(We,{className:"w-4 h-4 mr-2"}),"Edytuj użytkownika"]})]}),e.jsxs(J,{children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Informacje podstawowe"})}),e.jsx(k,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Imię i nazwisko"}),e.jsx("p",{className:"text-lg",children:l?.full_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsxs("p",{className:"text-lg flex items-center gap-2",children:[e.jsx(es,{className:"w-4 h-4"}),l?.email]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Rola"}),e.jsxs(Q,{variant:"default",className:"mt-1",children:[c(l?.role),e.jsx("span",{className:"ml-1 capitalize",children:l?.role})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx(Q,{variant:l?.is_active?"outline":"secondary",className:"mt-1",children:l?.is_active?"Aktywny":"Nieaktywny"})]})]})})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Statystyki gamifikacji"})}),e.jsx(k,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(be,{className:"w-8 h-8 mx-auto mb-2 text-yellow-500"}),e.jsx("p",{className:"text-2xl font-bold",children:o.total_points||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Punkty"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx($e,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),e.jsx("p",{className:"text-2xl font-bold",children:o.current_level||1}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Poziom"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Ka,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),e.jsx("p",{className:"text-2xl font-bold",children:o.daily_streak||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Dni z rzędu"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Ue,{className:"w-8 h-8 mx-auto mb-2 text-purple-500"}),e.jsx("p",{className:"text-2xl font-bold",children:Math.round((o.total_time_spent||0)/60)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Godzin nauki"})]})]})})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Postępy w nauce"})}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Ukończone quizy"}),e.jsx("span",{className:"font-bold",children:o.quizzes_completed||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Wyniki perfekcyjne"}),e.jsx("span",{className:"font-bold",children:o.perfect_scores||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Ukończone aktywności"}),e.jsx("span",{className:"font-bold",children:i?.data?.filter(m=>m.completed_at).length||0})]})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{className:"text-lg",children:"Daty"})}),e.jsxs(k,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Utworzono"}),e.jsx("p",{className:"text-sm font-medium",children:new Date(l?.created_at).toLocaleDateString("pl-PL")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ostatnia aktywność"}),e.jsx("p",{className:"text-sm font-medium",children:o.last_active?new Date(o.last_active).toLocaleDateString("pl-PL"):"Brak aktywności"})]})]})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{className:"text-lg",children:"Idle Game"})}),e.jsxs(k,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Punkty/h"}),e.jsx("span",{className:"font-bold",children:o.idle_points_rate||1})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ostatnie odebranie"}),e.jsx("p",{className:"text-sm font-medium",children:o.last_idle_claim?new Date(o.last_idle_claim).toLocaleString("pl-PL"):"Nigdy"})]})]})]})]})]})]})},_c={name:"users",list:"/users",create:"/users/create",edit:"/users/edit/:id",show:"/users/show/:id",meta:{label:"Użytkownicy",icon:e.jsx(je,{className:"h-4 w-4"})}},Sc=[e.jsx(L,{path:"/users",element:e.jsx(Nc,{})},"users-list"),e.jsx(L,{path:"/users/create",element:e.jsx(zc,{})},"users-create"),e.jsx(L,{path:"/users/edit/:id",element:e.jsx(kc,{})},"users-edit"),e.jsx(L,{path:"/users/show/:id",element:e.jsx(Cc,{})},"users-show")],Tc=()=>{const{tableQuery:{data:s,isLoading:a,isError:t},current:r,setCurrent:n,pageSize:i,setFilters:l}=ut({sorters:{initial:[{field:"created_at",order:"desc"}]}}),o=wt({isLoading:a,isError:t});return o||e.jsxs(P,{children:[e.jsx(V,{title:"Organizacje",description:"Lista wszystkich organizacji w systemie"}),e.jsx(_,{children:e.jsx(D,{placeholder:"Szukaj organizacji...",className:"max-w-sm",onChange:c=>{l([{operator:"or",value:[{field:"name",operator:"contains",value:c.target.value},{field:"subdomain",operator:"contains",value:c.target.value}]}])}})}),e.jsx(J,{children:s?.data?.map(c=>e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(Ha,{className:"w-5 h-5"}),c.name]}),e.jsx(Q,{variant:c.is_active?"default":"secondary",children:c.is_active?"Aktywna":"Nieaktywna"})]})}),e.jsxs(k,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Pn,{className:"w-3 h-3"}),e.jsxs("span",{children:[c.subdomain,".example.com"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Fs,{className:"w-3 h-3"}),e.jsxs("span",{children:["Utworzono: ",new Date(c.created_at).toLocaleDateString("pl-PL")]})]})]})]},c.id))}),e.jsx(Nt,{current:r,pageSize:i,total:s?.total||0,setCurrent:n,itemName:"organizacji"})]})},Pc={name:"vendors",list:"/vendors",meta:{label:"Organizacje",icon:e.jsx(Ha,{className:"h-4 w-4"})}},Ic=[e.jsx(L,{path:"/vendors",element:e.jsx(Tc,{})},"vendors-list")],qc=()=>{const[s,a]=h.useState("users"),[t,r]=h.useState("month"),[n,i]=h.useState(!1),l=async()=>{i(!0);try{alert("Funkcja generowania raportów będzie dostępna wkrótce")}catch(c){console.error("Error generating report:",c)}finally{i(!1)}},o=[{id:"users",name:"Raport użytkowników",description:"Statystyki użytkowników, postępy, aktywność",icon:je},{id:"courses",name:"Raport kursów",description:"Popularność kursów, wskaźniki ukończenia",icon:xe},{id:"gamification",name:"Raport gamifikacji",description:"Punkty, poziomy, rankingi",icon:Ms},{id:"activity",name:"Raport aktywności",description:"Logi, czas nauki, częstotliwość",icon:jt}];return e.jsxs(P,{children:[e.jsx(V,{title:"Raporty",description:"Generuj raporty i analizy systemu"}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Generator raportów"})}),e.jsxs(k,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Typ raportu"}),e.jsxs(le,{value:s,onValueChange:a,children:[e.jsx(re,{children:e.jsx(oe,{})}),e.jsx(ie,{children:o.map(c=>e.jsx(E,{value:c.id,children:c.name},c.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Zakres czasowy"}),e.jsxs(le,{value:t,onValueChange:r,children:[e.jsx(re,{children:e.jsx(oe,{})}),e.jsxs(ie,{children:[e.jsx(E,{value:"week",children:"Ostatni tydzień"}),e.jsx(E,{value:"month",children:"Ostatni miesiąc"}),e.jsx(E,{value:"quarter",children:"Ostatni kwartał"}),e.jsx(E,{value:"year",children:"Ostatni rok"}),e.jsx(E,{value:"all",children:"Wszystkie dane"})]})]})]})]}),e.jsx("div",{className:"p-4 border rounded-lg bg-muted/50",children:o.find(c=>c.id===s)&&e.jsxs("div",{className:"flex items-start gap-3",children:[(()=>{const c=o.find(m=>m.id===s).icon;return e.jsx(c,{className:"w-5 h-5 mt-0.5 text-muted-foreground"})})(),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:o.find(c=>c.id===s).name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o.find(c=>c.id===s).description})]})]})}),e.jsxs(g,{onClick:l,disabled:n,className:"w-full",children:[e.jsx(In,{className:"w-4 h-4 mr-2"}),n?"Generowanie...":"Generuj raport"]})]})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Ostatnie raporty"})}),e.jsx(k,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ve,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Brak wygenerowanych raportów"}),e.jsx("p",{className:"text-sm mt-1",children:"Wygenerowane raporty będą wyświetlane tutaj"})]})})]})]})},Mc={name:"reports",list:"/reports",meta:{label:"Raporty",icon:e.jsx(ve,{className:"h-4 w-4"})}},Lc=[e.jsx(L,{path:"/reports",element:e.jsx(qc,{})},"reports")],ma={id:"educational-material-wizard",title:"Kreator materiałów edukacyjnych",schema:{step1:{title:"Podstawowe informacje",type:"object",properties:{subject:{type:"text",title:"Temat materiału",placeholder:"np. Wprowadzenie do programowania w Python"},targetLevel:{type:"select",title:"Poziom zaawansowania",options:[{value:"beginner",label:"Początkujący"},{value:"intermediate",label:"Średniozaawansowany"},{value:"advanced",label:"Zaawansowany"}]},ageGroup:{type:"select",title:"Grupa wiekowa",options:[{value:"7-10",label:"7-10 lat (szkoła podstawowa)"},{value:"11-14",label:"11-14 lat (klasy 4-8)"},{value:"15-18",label:"15-18 lat (szkoła średnia)"},{value:"18+",label:"18+ (dorośli)"}]}},required:["subject","targetLevel","ageGroup"]},step2:{title:"Analiza tematu",type:"object",properties:{keyTopics:{type:"tags",title:"Kluczowe zagadnienia",readOnly:!0},learningObjectives:{type:"textarea",title:"Cele nauczania",readOnly:!0},prerequisites:{type:"tags",title:"Wymagania wstępne",readOnly:!0},estimatedDuration:{type:"number",title:"Szacowany czas (min)",readOnly:!0}}},step3:{title:"Dostosowanie celów",type:"object",properties:{learningObjectives:{type:"textarea",title:"Cele nauczania (edytowalne)",placeholder:"Dostosuj cele nauczania...",rows:6},materialType:{type:"select",title:"Typ materiału",options:[{value:"lesson",label:"Lekcja z teorią"},{value:"exercise",label:"Ćwiczenia praktyczne"},{value:"mixed",label:"Teoria + ćwiczenia"}]}},required:["learningObjectives","materialType"]},step4:{title:"Podgląd materiału",type:"object",properties:{title:{type:"text",title:"Tytuł materiału",readOnly:!0},content:{type:"textarea",title:"Treść materiału",readOnly:!0},exercises:{type:"textarea",title:"Ćwiczenia",readOnly:!0},summary:{type:"textarea",title:"Podsumowanie",readOnly:!0}}},step5:{title:"Finalizacja",type:"object",properties:{courseId:{type:"select",title:"Wybierz kurs",placeholder:"Wybierz kurs..."},topicId:{type:"select",title:"Wybierz temat",placeholder:"Najpierw wybierz kurs..."},activityTitle:{type:"text",title:"Tytuł aktywności",placeholder:"np. Wprowadzenie do zmiennych"},activityType:{type:"select",title:"Typ aktywności",options:[{value:"material",label:"Materiał edukacyjny"},{value:"quiz",label:"Quiz sprawdzający"}]},content:{type:"textarea",title:"Treść materiału",placeholder:"Edytuj wygenerowaną treść...",rows:15},duration:{type:"number",title:"Czas trwania (min)",placeholder:"15"}},required:["courseId","topicId","activityTitle","activityType","content"]}}},Dc={id:"analyze-topic",name:"Analiza tematu edukacyjnego",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od edukacji i tworzenia materiałów dydaktycznych.",user:`
Przeanalizuj temat edukacyjny:
Temat: {{subject}}
Poziom: {{targetLevel}}
Grupa wiekowa: {{ageGroup}}

Wygeneruj JSON:
{
  "keyTopics": ["temat1", "temat2", "temat3"],
  "learningObjectives": "<szczegółowe cele nauczania - czego uczeń się nauczy>",
  "prerequisites": ["wymaganie1", "wymaganie2"],
  "estimatedDuration": <liczba minut>
}

Wymagania:
- KeyTopics: 3-7 kluczowych zagadnień do omówienia
- LearningObjectives: konkretne, mierzalne cele (100-200 słów)
- Prerequisites: 2-5 wymagań wstępnych (może być puste dla początkujących)
- EstimatedDuration: realistyczny czas w minutach (15-90)
    `,responseFormat:"json"},inputMapping:s=>({subject:s.subject,targetLevel:s.targetLevel,ageGroup:s.ageGroup}),outputMapping:(s,a)=>({...a,keyTopics:s.keyTopics,learningObjectives:s.learningObjectives,prerequisites:s.prerequisites,estimatedDuration:s.estimatedDuration}),validation:s=>!!(s.keyTopics&&s.learningObjectives&&s.estimatedDuration)},Ec={id:"generate-material",name:"Generowanie materiału edukacyjnego",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś doświadczonym nauczycielem tworzącym angażujące materiały edukacyjne.",user:`
Stwórz materiał edukacyjny:

Temat: {{subject}}
Poziom: {{targetLevel}}
Grupa wiekowa: {{ageGroup}}
Cele nauczania: {{learningObjectives}}
Typ materiału: {{materialType}}
Kluczowe zagadnienia: {{keyTopics}}

Wygeneruj JSON:
{
  "title": "<atrakcyjny tytuł materiału>",
  "content": "<treść materiału w formacie Markdown - teoria, przykłady, wyjaśnienia>",
  "exercises": "<ćwiczenia praktyczne w formacie Markdown>",
  "summary": "<podsumowanie najważniejszych punktów>"
}

Wymagania:
- Title: kreatywny i zachęcający do nauki
- Content: dostosowany do wieku, z przykładami, min. 500 słów
- Exercises: 3-5 ćwiczeń praktycznych z instrukcjami
- Summary: bullet points z najważniejszymi informacjami
- Używaj formatowania Markdown (nagłówki, listy, kod)
- Język dostosowany do grupy wiekowej
    `,responseFormat:"json"},inputMapping:s=>({subject:s.subject,targetLevel:s.targetLevel,ageGroup:s.ageGroup,learningObjectives:s.learningObjectives,materialType:s.materialType,keyTopics:Array.isArray(s.keyTopics)?s.keyTopics.join(", "):s.keyTopics}),outputMapping:(s,a)=>({...a,title:s.title,content:s.content,exercises:s.exercises,summary:s.summary}),validation:s=>!!(s.title&&s.content&&s.exercises&&s.summary)},ke={subject:{minLength:5,errorMessage:"Temat jest wymagany (5-200 znaków)"},activityTitle:{minLength:3,maxLength:100,errorMessage:"Tytuł jest wymagany (3-100 znaków)"},content:{minLength:100,errorMessage:"Treść materiału jest wymagana (min. 100 znaków)"},duration:{min:5,max:180,errorMessage:"Czas trwania musi być między 5 a 180 minut"}},zs={steps:{1:{title:"O czym chcesz stworzyć materiał?",description:"Podaj temat, poziom zaawansowania i grupę docelową - AI pomoże stworzyć angażujący materiał edukacyjny",button:"Analizuj temat",loading:"Analizuję temat..."},2:{title:"Analiza tematu",description:"AI przeanalizowała temat i zaproponowała strukturę materiału",success:"✓ Analiza zakończona pomyślnie"},3:{title:"Dostosuj cele i typ materiału",description:"Możesz zmodyfikować cele nauczania i wybrać typ materiału do wygenerowania",button:"Generuj materiał",loading:"Generuję materiał...",loadingInfo:"⚡ AI tworzy spersonalizowany materiał edukacyjny..."},4:{title:"Podgląd wygenerowanego materiału",description:"AI przygotowała kompletny materiał edukacyjny",info:"💡 W następnym kroku wybierzesz kurs i temat, do którego dodasz materiał."},5:{title:"Zapisz materiał w kursie",description:"Wybierz kurs i temat, następnie dostosuj materiał przed zapisaniem",saveInfo:"💾 Materiał zostanie zapisany jako nowa aktywność w wybranym temacie",button:"Zapisz materiał",loading:"Zapisuję...",success:"✓ Materiał został zapisany pomyślnie! Przekierowuję do kursu..."}},dashboard:{title:"Kreator materiałów edukacyjnych",description:"Twórz angażujące materiały z pomocą AI",wizardTitle:"Kreator materiałów AI",wizardDescription:"Stwórz materiał edukacyjny w 5 prostych krokach",features:["Automatyczna analiza tematu","Dostosowanie do wieku uczniów","Generowanie celów nauczania","Tworzenie ćwiczeń praktycznych","Formatowanie Markdown","Integracja z kursami"]},errors:{subjectRequired:"Podaj temat materiału",analysisError:"Błąd analizy tematu:",generationError:"Błąd generowania materiału:",saveError:"Wystąpił błąd podczas zapisu",unexpectedError:"Wystąpił nieoczekiwany błąd",noCourses:"Nie znaleziono żadnych kursów",noTopics:"Wybierz najpierw kurs"}},Ce={dashboard:"/educational-material",step1:"/educational-material/step1",step2:"/educational-material/step2",step3:"/educational-material/step3",step4:"/educational-material/step4",step5:"/educational-material/step5",courses:"/courses"},Rc=()=>{const s=B(),{getData:a}=ne(),t=a("educational-material-wizard"),{dashboard:r}=zs,n=t&&t.title;return e.jsxs(P,{children:[e.jsx(V,{title:r.title,description:r.description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg border border-purple-200",children:[e.jsxs(_,{variant:"start",className:"mb-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(Je,{className:"w-8 h-8 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r.wizardTitle}),e.jsx("p",{className:"text-gray-600",children:r.wizardDescription})]})]}),e.jsxs(J,{variant:"1-2-2",className:"gap-4",children:[e.jsx("div",{className:"space-y-2",children:r.features.slice(0,3).map((i,l)=>e.jsxs(_,{variant:"start",className:"text-sm text-gray-700",children:[e.jsx(ge,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{children:i})]},l))}),e.jsx("div",{className:"space-y-2",children:r.features.slice(3).map((i,l)=>e.jsxs(_,{variant:"start",className:"text-sm text-gray-700",children:[e.jsx(ge,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{children:i})]},l))})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(g,{onClick:()=>s(Ce.step1),className:"w-full md:w-auto",size:"lg",children:[e.jsx(Ws,{className:"w-4 h-4 mr-2"}),"Stwórz nowy materiał"]})})]}),n&&e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsxs(_,{variant:"between-center",className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ostatni materiał"}),e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Zapisany"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tytuł materiału"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.title})]}),t.subject&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Temat"}),e.jsx("p",{className:"text-gray-900",children:t.subject})]}),t.targetLevel&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Poziom"}),e.jsx("p",{className:"text-gray-900",children:t.targetLevel==="beginner"?"Początkujący":t.targetLevel==="intermediate"?"Średniozaawansowany":"Zaawansowany"})]})]}),e.jsxs(_,{variant:"start",className:"mt-6 gap-3",children:[e.jsxs(g,{variant:"outline",onClick:()=>s(Ce.step4),children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Podgląd"]}),e.jsxs(g,{variant:"outline",onClick:()=>s(Ce.step5),children:[e.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),e.jsxs(g,{variant:"outline",onClick:()=>s(Ce.step1),children:[e.jsx(Os,{className:"w-4 h-4 mr-2"}),"Nowy materiał"]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Zarządzanie kursami"}),e.jsxs(J,{variant:"1-2-3",className:"gap-4",children:[e.jsxs("button",{onClick:()=>s("/courses"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[e.jsxs(_,{variant:"start",className:"mb-2",children:[e.jsx(xe,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Kursy"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Zobacz wszystkie kursy"})]}),e.jsxs("button",{onClick:()=>s("/topics"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[e.jsxs(_,{variant:"start",className:"mb-2",children:[e.jsx(ve,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Tematy"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Zarządzaj tematami kursów"})]}),e.jsxs("button",{onClick:()=>s("/activities"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[e.jsxs(_,{variant:"start",className:"mb-2",children:[e.jsx(fs,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Aktywności"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Materiały i quizy"})]})]})]})]})]})},Ks=({step:s})=>{const a=B();return e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>a("/educational-material"),children:e.jsx(Pe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"p-8 space-y-12 text-zinc-800",children:[e.jsx("h1",{className:"text-6xl font-black",children:"SMART UP"}),e.jsxs("h2",{className:"text-4xl",children:["Stwórzmy razem ",e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"angażujący materiał"})]}),e.jsxs("p",{children:["Krok ",s," z 5"]})]}),e.jsx(Ge,{className:"my-8"})]})},Zs=({title:s,description:a})=>e.jsxs("header",{className:"mb-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:s}),e.jsx("p",{className:"text-gray-600",children:a})]}),Ac=()=>{const s=B(),{register:a,setData:t}=ne(),[r,n]=h.useState(""),[i,l]=h.useState(""),[o,c]=h.useState(""),[m,p]=h.useState(""),[d,u]=h.useState(""),[x,f]=h.useState({}),[j,v]=h.useState(null),w=Ns("educational-material-wizard","analyze-topic"),{steps:y,errors:C}=zs,{data:S,isLoading:W}=de({resource:"courses",filters:[{field:"is_published",operator:"eq",value:!0}],meta:{select:"*, topics(*)"},sorters:[{field:"created_at",order:"desc"}]}),N=S?.data?.find(M=>M.id.toString()===r),b=N?.topics||[];h.useEffect(()=>{a(ma),w.registerOperation(Dc);const M=sessionStorage.getItem("wizardContext");if(M){const H=JSON.parse(M);v(H),H.courseId&&n(H.courseId.toString()),H.topicId&&l(H.topicId.toString()),H.topicTitle&&c(H.topicTitle)}return()=>{w.unregisterOperation()}},[]),h.useEffect(()=>{if(i&&b.length>0){const M=b.find(H=>H.id.toString()===i);M&&!o&&c(M.title)}},[i,b]);const q=()=>{const M={};return r||(M.courseId="Wybierz kurs"),i||(M.topicId="Wybierz temat z kursu"),(!o.trim()||o.length<ke.subject.minLength)&&(M.subject=ke.subject.errorMessage),m||(M.targetLevel="Wybierz poziom zaawansowania"),d||(M.ageGroup="Wybierz grupę wiekową"),f(M),Object.keys(M).length===0},O=async()=>{if(q())try{const M={courseId:parseInt(r),topicId:parseInt(i),subject:o.trim(),targetLevel:m,ageGroup:d,courseTitle:N?.title,topicTitle:b.find(H=>H.id.toString()===i)?.title};t("educational-material-wizard",M),await w.executeOperation(M),s(Ce.step2)}catch(M){console.error(C.analysisError,M)}};return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[e.jsx(Ks,{step:1}),e.jsxs("div",{className:"p-6",children:[e.jsx(Zs,{title:y[1].title,description:y[1].description}),j&&e.jsxs(te,{className:"mb-4",children:[e.jsx(ft,{className:"h-4 w-4"}),e.jsxs(ae,{children:["Tworzysz materiał dla: ",e.jsx("strong",{children:j.courseTitle}),j.topicTitle&&e.jsxs(e.Fragment,{children:[" → ",e.jsx("strong",{children:j.topicTitle})]})]})]}),w.error&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("span",{className:"text-red-800 text-sm",children:[C.analysisError," ",w.error]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{className:"border-2 border-purple-200 bg-purple-50/50",children:e.jsxs(k,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xe,{className:"w-5 h-5 text-purple-600"}),e.jsx("h3",{className:"font-semibold",children:"Wybierz miejsce w kursie"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"courseId",children:["Kurs ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(le,{value:r,onValueChange:M=>{n(M),l("")},disabled:w.loading||W||!!j?.courseId,children:[e.jsx(re,{className:x.courseId?"border-red-300":"",children:e.jsx(oe,{placeholder:"Wybierz kurs..."})}),e.jsx(ie,{children:S?.data?.map(M=>e.jsx(E,{value:M.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[M.icon_emoji&&e.jsx("span",{children:M.icon_emoji}),M.title]})},M.id))})]}),x.courseId&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:x.courseId})]}),e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"topicId",children:["Temat ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(le,{value:i,onValueChange:l,disabled:!r||w.loading||!!j?.topicId,children:[e.jsx(re,{className:x.topicId?"border-red-300":"",children:e.jsx(oe,{placeholder:r?"Wybierz temat...":"Najpierw wybierz kurs..."})}),e.jsx(ie,{children:b.sort((M,H)=>M.position-H.position).map(M=>e.jsxs(E,{value:M.id.toString(),children:[M.position,". ",M.title]},M.id))})]}),x.topicId&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:x.topicId})]})]})]})}),e.jsx(Ge,{}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"subject",children:"Temat materiału"}),e.jsx(D,{id:"subject",type:"text",value:o,onChange:M=>c(M.target.value),placeholder:ma.schema.step1.properties.subject.placeholder,disabled:w.loading,className:x.subject?"border-red-300":""}),x.subject&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:x.subject}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Możesz dostosować temat materiału lub pozostawić sugerowany"})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"targetLevel",children:"Poziom zaawansowania"}),e.jsxs(le,{value:m,onValueChange:p,disabled:w.loading,children:[e.jsx(re,{className:x.targetLevel?"border-red-300":"",children:e.jsx(oe,{placeholder:"Wybierz poziom..."})}),e.jsxs(ie,{children:[e.jsx(E,{value:"beginner",children:"Początkujący"}),e.jsx(E,{value:"intermediate",children:"Średniozaawansowany"}),e.jsx(E,{value:"advanced",children:"Zaawansowany"})]})]}),x.targetLevel&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:x.targetLevel})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"ageGroup",children:"Grupa wiekowa"}),e.jsxs(le,{value:d,onValueChange:u,disabled:w.loading,children:[e.jsx(re,{className:x.ageGroup?"border-red-300":"",children:e.jsx(oe,{placeholder:"Wybierz grupę wiekową..."})}),e.jsxs(ie,{children:[e.jsx(E,{value:"7-10",children:"7-10 lat (szkoła podstawowa)"}),e.jsx(E,{value:"11-14",children:"11-14 lat (klasy 4-8)"}),e.jsx(E,{value:"15-18",children:"15-18 lat (szkoła średnia)"}),e.jsx(E,{value:"18+",children:"18+ (dorośli)"})]})]}),x.ageGroup&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:x.ageGroup})]}),e.jsx("button",{onClick:O,disabled:w.loading,className:"w-full h-12 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 text-white font-medium rounded-lg flex items-center justify-center gap-2",children:w.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),y[1].loading]}):y[1].button})]})]})]})})},Oc=()=>{const s=B(),{getData:a}=ne(),t=a("educational-material-wizard"),{steps:r}=zs;return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[e.jsx(Ks,{step:2}),e.jsxs("div",{className:"space-y-6 p-8",children:[e.jsx(Zs,{title:r[2].title,description:r[2].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("span",{className:"text-green-800 text-sm",children:r[2].success})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Temat"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800",children:t.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kluczowe zagadnienia"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.keyTopics?.map((n,i)=>e.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm",children:n},i))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cele nauczania"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 whitespace-pre-wrap",children:t.learningObjectives})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wymagania wstępne"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.prerequisites?.length>0?t.prerequisites.map((n,i)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:n},i)):e.jsx("span",{className:"text-gray-500 text-sm",children:"Brak wymagań wstępnych"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Szacowany czas"}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[t.estimatedDuration," minut"]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(g,{variant:"outline",onClick:()=>s(Ce.step1),children:"Wstecz"}),e.jsx(g,{onClick:()=>s(Ce.step3),children:"Kontynuuj"})]})]})]})]})})},$c=()=>{const s=B(),{getData:a,setData:t}=ne(),r=a("educational-material-wizard"),[n,i]=h.useState(r.learningObjectives||""),[l,o]=h.useState("mixed"),c=Ns("educational-material-wizard","generate-material"),{steps:m,errors:p}=zs;h.useEffect(()=>(c.registerOperation(Ec),()=>{c.unregisterOperation()}),[]);const d=async()=>{if(!(!n.trim()||!l))try{const u={...r,learningObjectives:n.trim(),materialType:l};t("educational-material-wizard",u),await c.executeOperation(u),s(Ce.step4)}catch(u){console.error(p.generationError,u)}};return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[e.jsx(Ks,{step:3}),e.jsxs("div",{className:"space-y-6 p-8",children:[e.jsx(Zs,{title:m[3].title,description:m[3].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(K,{htmlFor:"learningObjectives",children:"Cele nauczania"}),e.jsx(De,{id:"learningObjectives",value:n,onChange:u=>i(u.target.value),placeholder:"Dostosuj cele nauczania...",rows:6,className:"mt-1"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Możesz edytować automatycznie wygenerowane cele"})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"materialType",children:"Typ materiału"}),e.jsxs(le,{value:l,onValueChange:o,children:[e.jsx(re,{className:"mt-1",children:e.jsx(oe,{placeholder:"Wybierz typ materiału..."})}),e.jsxs(ie,{children:[e.jsx(E,{value:"lesson",children:"Lekcja z teorią"}),e.jsx(E,{value:"exercise",children:"Ćwiczenia praktyczne"}),e.jsx(E,{value:"mixed",children:"Teoria + ćwiczenia"})]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(g,{variant:"outline",onClick:()=>s(Ce.step2),children:"Wstecz"}),e.jsx(g,{onClick:d,disabled:c.loading||!n.trim(),children:c.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),m[3].loading]}):m[3].button})]})]}),c.loading&&e.jsx("div",{className:"mt-6 p-4 bg-purple-50 border border-purple-200 rounded-lg",children:e.jsx("span",{className:"text-purple-800 text-sm",children:m[3].loadingInfo})})]})]})})},Fc=()=>{const s=B(),{getData:a}=ne(),t=a("educational-material-wizard"),{steps:r}=zs;return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[e.jsx(Ks,{step:4}),e.jsxs("div",{className:"space-y-6 p-8",children:[e.jsx(Zs,{title:e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"w-8 h-8 text-zinc-500"}),e.jsx("span",{children:r[4].title})]}),description:r[4].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tytuł materiału"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:t.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Treść materiału"}),e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg max-h-96 overflow-y-auto",children:e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx(rt,{children:t.content})})})]}),t.exercises&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ćwiczenia"}),e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg max-h-64 overflow-y-auto",children:e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx(rt,{children:t.exercises})})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Podsumowanie"}),e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx(rt,{children:t.summary})})})]})]}),e.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:e.jsx("p",{className:"text-purple-800 text-sm",children:r[4].info})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(g,{variant:"outline",onClick:()=>s(Ce.step3),children:"Wstecz"}),e.jsx(g,{onClick:()=>s(Ce.step5),children:"Zapisz w kursie"})]})]})]})})},Wc=()=>{const s=B(),{getData:a,setData:t}=ne(),{mutate:r}=Ze(),n=a("educational-material-wizard"),[i,l]=h.useState(n.title||""),[o,c]=h.useState(n.content+(n.exercises?`

## Ćwiczenia

${n.exercises}`:"")+(n.summary?`

## Podsumowanie

${n.summary}`:"")),[m,p]=h.useState(n.estimatedDuration||30),[d,u]=h.useState({}),[x,f]=h.useState(!1),[j,v]=h.useState(!1),{steps:w,errors:y}=zs,{data:C}=de({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:n.topicId}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!n.topicId}}),S=C?.data?.[0]?.position?C.data[0].position+1:1,W=()=>{const b={};return(!i.trim()||i.length<ke.activityTitle.minLength)&&(b.activityTitle=ke.activityTitle.errorMessage),(!o.trim()||o.length<ke.content.minLength)&&(b.content=ke.content.errorMessage),(!m||m<ke.duration.min||m>ke.duration.max)&&(b.duration=ke.duration.errorMessage),u(b),Object.keys(b).length===0},N=async()=>{if(W()){f(!0);try{r({resource:"activities",values:{topic_id:n.topicId,type:"material",title:i.trim(),content:o.trim(),position:S,duration_min:m,is_published:!1}},{onSuccess:b=>{t("educational-material-wizard",{...n,activityTitle:i.trim(),content:o.trim(),activityId:b.data.id,saved:!0}),f(!1),v(!0);const q=sessionStorage.getItem("returnUrl");setTimeout(()=>{sessionStorage.removeItem("wizardContext"),q?(sessionStorage.removeItem("returnUrl"),s(q)):s(`${Ce.courses}/show/${n.courseId}?expanded=${n.topicId}`)},2e3)},onError:b=>{f(!1),console.error(y.saveError,b),alert(y.saveError)}})}catch(b){f(!1),console.error(y.unexpectedError,b),alert(y.unexpectedError)}}};return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative",children:[e.jsx(Ks,{step:5}),e.jsxs("div",{className:"p-8",children:[e.jsx(Zs,{title:e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"w-8 h-8 text-purple-500"}),e.jsx("span",{children:w[5].title})]}),description:w[5].description}),j&&e.jsx(te,{className:"mb-6 bg-green-50 border-green-200",children:e.jsx(ae,{className:"text-green-800",children:w[5].success})}),e.jsxs("form",{className:"space-y-6",onSubmit:b=>{b.preventDefault(),N()},children:[e.jsx(z,{className:"bg-muted/50",children:e.jsx(k,{className:"pt-6",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Kurs:"})," ",n.courseTitle]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Temat:"})," ",n.topicTitle]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Pozycja:"})," ",S]})]})})}),e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"activityTitle",children:["Tytuł aktywności ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{id:"activityTitle",type:"text",value:i,onChange:b=>l(b.target.value),placeholder:"np. Wprowadzenie do zmiennych",maxLength:ke.activityTitle.maxLength,className:d.activityTitle?"border-red-300":""}),d.activityTitle&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:d.activityTitle})]}),e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"duration",children:["Czas trwania (min) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{id:"duration",type:"number",value:m,onChange:b=>p(parseInt(b.target.value)||0),min:ke.duration.min,max:ke.duration.max,className:d.duration?"border-red-300":""}),d.duration&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:d.duration})]}),e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"content",children:["Treść materiału ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(De,{id:"content",value:o,onChange:b=>c(b.target.value),placeholder:"Treść materiału w formacie Markdown...",rows:15,className:`font-mono text-sm ${d.content?"border-red-300":""}`}),d.content&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:d.content}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[o.length," znaków (minimum ",ke.content.minLength,")"]})]}),e.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:e.jsx("p",{className:"text-purple-800 text-sm",children:w[5].saveInfo})}),e.jsx(Ge,{}),e.jsxs("footer",{className:"flex justify-between gap-4",children:[e.jsxs(g,{type:"button",variant:"outline",onClick:()=>s(Ce.step4),disabled:x,className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Wstecz"]}),e.jsx(g,{type:"submit",disabled:x||j,className:"flex items-center gap-2 min-w-[160px]",children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),w[5].loading]}):e.jsxs(e.Fragment,{children:[e.jsx($s,{className:"w-4 h-4"}),w[5].button]})})]})]})]})]})})},Uc=[e.jsx(L,{path:"/educational-material",element:e.jsx(Rc,{})},"material-dashboard"),e.jsx(L,{path:"/educational-material/step1",element:e.jsx(Ac,{})},"material-step1"),e.jsx(L,{path:"/educational-material/step2",element:e.jsx(Oc,{})},"material-step2"),e.jsx(L,{path:"/educational-material/step3",element:e.jsx($c,{})},"material-step3"),e.jsx(L,{path:"/educational-material/step4",element:e.jsx(Fc,{})},"material-step4"),e.jsx(L,{path:"/educational-material/step5",element:e.jsx(Wc,{})},"material-step5")],Gc={name:"educational-materials",list:"/educational-material",create:"/educational-material/step1",meta:{canDelete:!1,label:"Kreator materiałów",icon:e.jsx(Kt,{className:"h-4 w-4"})}},ua={id:"quiz-wizard",title:"Kreator quizów",schema:{step1:{title:"Podstawowe informacje o quizie",type:"object",properties:{topic:{type:"text",title:"Temat quizu",placeholder:"np. Podstawy programowania w Python"},difficulty:{type:"select",title:"Poziom trudności",options:[{value:"easy",label:"Łatwy"},{value:"medium",label:"Średni"},{value:"hard",label:"Trudny"}]},questionsCount:{type:"number",title:"Liczba pytań",placeholder:"10",min:5,max:30},questionTypes:{type:"multiselect",title:"Typy pytań",options:[{value:"single",label:"Jednokrotny wybór"},{value:"multiple",label:"Wielokrotny wybór"},{value:"truefalse",label:"Prawda/Fałsz"}]}},required:["topic","difficulty","questionsCount"]},step2:{title:"Analiza tematu",type:"object",properties:{keyTopics:{type:"tags",title:"Kluczowe zagadnienia",readOnly:!0},learningObjectives:{type:"textarea",title:"Cele sprawdzające",readOnly:!0},suggestedTime:{type:"number",title:"Sugerowany czas (min)",readOnly:!0},passingScore:{type:"number",title:"Próg zaliczenia (%)",readOnly:!0}}},step3:{title:"Parametry quizu",type:"object",properties:{quizTitle:{type:"text",title:"Tytuł quizu",placeholder:"np. Test wiedzy - Zmienne i typy danych"},passingScore:{type:"number",title:"Próg zaliczenia (%)",placeholder:"70",min:50,max:100},timeLimit:{type:"number",title:"Limit czasu (min)",placeholder:"Pozostaw puste dla braku limitu",min:5,max:180},maxAttempts:{type:"number",title:"Maksymalna liczba podejść",placeholder:"Pozostaw puste dla nieograniczonej liczby",min:1,max:10},shuffleQuestions:{type:"checkbox",title:"Losowa kolejność pytań"},showExplanations:{type:"checkbox",title:"Pokazuj wyjaśnienia po odpowiedzi"}},required:["quizTitle","passingScore"]},step4:{title:"Podgląd wygenerowanych pytań",type:"object",properties:{questions:{type:"array",title:"Lista pytań",readOnly:!0}}},step5:{title:"Finalizacja i zapis",type:"object",properties:{courseId:{type:"select",title:"Wybierz kurs",placeholder:"Wybierz kurs..."},topicId:{type:"select",title:"Wybierz temat",placeholder:"Najpierw wybierz kurs..."},finalTitle:{type:"text",title:"Ostateczny tytuł",placeholder:"Tytuł quizu"},questions:{type:"array",title:"Pytania do edycji"}},required:["courseId","topicId","finalTitle"]}}},Bc={id:"analyze-quiz-topic",name:"Analiza tematu quizu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia testów i quizów edukacyjnych.",user:`
Przeanalizuj temat dla quizu:
Temat: {{topic}}
Poziom trudności: {{difficulty}}
Liczba pytań: {{questionsCount}}

Wygeneruj JSON:
{
  "keyTopics": ["zagadnienie1", "zagadnienie2", "zagadnienie3"],
  "learningObjectives": "<cele sprawdzające - co quiz ma zweryfikować>",
  "suggestedTime": <liczba minut>,
  "passingScore": <próg zaliczenia w %>
}

Wymagania:
- KeyTopics: 5-10 kluczowych zagadnień do sprawdzenia
- LearningObjectives: konkretne umiejętności do weryfikacji (50-150 słów)
- SuggestedTime: 1-3 minuty na pytanie
- PassingScore: 60-80% w zależności od trudności
    `,responseFormat:"json"},inputMapping:s=>({topic:s.topic,difficulty:s.difficulty,questionsCount:s.questionsCount}),outputMapping:(s,a)=>({...a,keyTopics:s.keyTopics,learningObjectives:s.learningObjectives,suggestedTime:s.suggestedTime,passingScore:s.passingScore}),validation:s=>!!(s.keyTopics&&s.learningObjectives&&s.suggestedTime&&s.passingScore)},Kc={id:"generate-quiz-questions",name:"Generowanie pytań quizowych",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia pytań testowych. Tworzysz rzetelne, dobrze sformułowane pytania sprawdzające wiedzę.",user:`
Stwórz pytania quizowe:

Temat: {{topic}}
Poziom trudności: {{difficulty}}
Liczba pytań: {{questionsCount}}
Typy pytań: {{questionTypes}}
Kluczowe zagadnienia: {{keyTopics}}
Cele: {{learningObjectives}}

Wygeneruj JSON z tablicą pytań:
{
  "quizTitle": "<tytuł quizu>",
  "questions": [
    {
      "question": "<treść pytania>",
      "type": "single|multiple|truefalse",
      "options": [
        {"text": "<treść opcji>", "is_correct": true/false},
        {"text": "<treść opcji>", "is_correct": true/false}
      ],
      "explanation": "<wyjaśnienie poprawnej odpowiedzi>",
      "points": <liczba punktów 1-5>
    }
  ]
}

Wymagania:
- Pytania jasne i jednoznaczne
- 4 opcje dla single/multiple, 2 dla true/false
- Dokładnie jedna poprawna dla single, 1-3 dla multiple
- Wyjaśnienia edukacyjne (30-100 słów)
- Punkty: łatwe=1-2, średnie=2-3, trudne=3-5
- Różnorodność typów pytań
- Pokrycie wszystkich kluczowych zagadnień
    `,responseFormat:"json"},inputMapping:s=>({topic:s.topic,difficulty:s.difficulty,questionsCount:s.questionsCount,questionTypes:Array.isArray(s.questionTypes)?s.questionTypes.join(", "):s.questionTypes||"single, multiple, truefalse",keyTopics:Array.isArray(s.keyTopics)?s.keyTopics.join(", "):s.keyTopics,learningObjectives:s.learningObjectives}),outputMapping:(s,a)=>({...a,quizTitle:s.quizTitle,questions:s.questions}),validation:s=>!!(s.quizTitle&&s.questions&&Array.isArray(s.questions)&&s.questions.length>0)},ee={topic:{minLength:5,errorMessage:"Temat jest wymagany (5-200 znaków)"},quizTitle:{minLength:5,maxLength:100,errorMessage:"Tytuł jest wymagany (5-100 znaków)"},questionsCount:{min:5,max:30,errorMessage:"Liczba pytań musi być między 5 a 30"},passingScore:{min:50,max:100,errorMessage:"Próg zaliczenia musi być między 50% a 100%"},timeLimit:{min:5,max:180,errorMessage:"Limit czasu musi być między 5 a 180 minut"},maxAttempts:{min:1,max:10,errorMessage:"Liczba podejść musi być między 1 a 10"}},ks={steps:{1:{title:"Jaki quiz chcesz stworzyć?",description:"Podaj temat, poziom trudności i liczbę pytań - AI wygeneruje profesjonalny quiz",button:"Analizuj temat",loading:"Analizuję temat..."},2:{title:"Analiza tematu quizu",description:"AI przeanalizowała temat i zaproponowała parametry quizu",success:"✓ Analiza zakończona pomyślnie"},3:{title:"Skonfiguruj parametry quizu",description:"Dostosuj ustawienia quizu według swoich potrzeb",button:"Generuj pytania",loading:"Generuję pytania...",loadingInfo:"⚡ AI tworzy zestaw pytań dostosowanych do tematu..."},4:{title:"Podgląd wygenerowanych pytań",description:"AI przygotowała kompletny zestaw pytań",info:"💡 W następnym kroku będziesz mógł edytować pytania i wybrać kurs."},5:{title:"Zapisz quiz w kursie",description:"Wybierz kurs i temat, sprawdź pytania przed zapisaniem",saveInfo:"💾 Quiz zostanie zapisany jako nowa aktywność z wygenerowanymi pytaniami",button:"Zapisz quiz",loading:"Zapisuję...",success:"✓ Quiz został zapisany pomyślnie! Przekierowuję do zarządzania pytaniami..."}},dashboard:{title:"Kreator quizów",description:"Twórz profesjonalne testy sprawdzające z pomocą AI",wizardTitle:"Kreator quizów AI",wizardDescription:"Stwórz quiz w 5 prostych krokach",features:["Automatyczna analiza tematu","Generowanie różnych typów pytań","Dostosowanie poziomu trudności","Inteligentne wyjaśnienia odpowiedzi","Konfiguracja parametrów quizu","Edycja i dostosowanie pytań"]},errors:{topicRequired:"Podaj temat quizu",analysisError:"Błąd analizy tematu:",generationError:"Błąd generowania pytań:",saveError:"Wystąpił błąd podczas zapisu",unexpectedError:"Wystąpił nieoczekiwany błąd",noCourses:"Nie znaleziono żadnych kursów",noTopics:"Wybierz najpierw kurs",noQuestions:"Brak pytań do zapisania"}},_e={dashboard:"/quiz-wizard",step1:"/quiz-wizard/step1",step2:"/quiz-wizard/step2",step3:"/quiz-wizard/step3",step4:"/quiz-wizard/step4",step5:"/quiz-wizard/step5",questions:"/questions/manage"},Zc=()=>{const s=B(),{getData:a}=ne(),t=a("quiz-wizard"),{dashboard:r}=ks,n=t&&t.quizTitle;return e.jsxs(P,{children:[e.jsx(V,{title:r.title,description:r.description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 p-6 rounded-lg border border-blue-200",children:[e.jsxs(_,{variant:"start",className:"mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(ls,{className:"w-8 h-8 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r.wizardTitle}),e.jsx("p",{className:"text-gray-600",children:r.wizardDescription})]})]}),e.jsxs(J,{variant:"1-2-2",className:"gap-4",children:[e.jsx("div",{className:"space-y-2",children:r.features.slice(0,3).map((i,l)=>e.jsxs(_,{variant:"start",className:"text-sm text-gray-700",children:[e.jsx(ge,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{children:i})]},l))}),e.jsx("div",{className:"space-y-2",children:r.features.slice(3).map((i,l)=>e.jsxs(_,{variant:"start",className:"text-sm text-gray-700",children:[e.jsx(ge,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{children:i})]},l))})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(g,{onClick:()=>s(_e.step1),className:"w-full md:w-auto",size:"lg",children:[e.jsx(Ws,{className:"w-4 h-4 mr-2"}),"Stwórz nowy quiz"]})})]}),n&&e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsxs(_,{variant:"between-center",className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ostatni quiz"}),e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Zapisany"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tytuł quizu"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.quizTitle})]}),t.topic&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Temat"}),e.jsx("p",{className:"text-gray-900",children:t.topic})]}),t.questions&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Liczba pytań"}),e.jsxs("p",{className:"text-gray-900",children:[t.questions.length," pytań"]})]})]}),e.jsxs(_,{variant:"start",className:"mt-6 gap-3",children:[e.jsxs(g,{variant:"outline",onClick:()=>s(_e.step4),children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Podgląd"]}),e.jsxs(g,{variant:"outline",onClick:()=>s(_e.step5),children:[e.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),e.jsxs(g,{variant:"outline",onClick:()=>s(_e.step1),children:[e.jsx(Os,{className:"w-4 h-4 mr-2"}),"Nowy quiz"]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Zarządzanie quizami"}),e.jsxs(J,{variant:"1-2-3",className:"gap-4",children:[e.jsxs("button",{onClick:()=>s("/activities"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[e.jsxs(_,{variant:"start",className:"mb-2",children:[e.jsx(Le,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Aktywności"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Wszystkie quizy i materiały"})]}),e.jsxs("button",{onClick:()=>s("/questions"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[e.jsxs(_,{variant:"start",className:"mb-2",children:[e.jsx(Xe,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Pytania"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Zarządzaj pytaniami"})]}),e.jsxs("button",{onClick:()=>s("/reports"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[e.jsxs(_,{variant:"start",className:"mb-2",children:[e.jsx(be,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Wyniki"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Statystyki quizów"})]})]})]})]})]})},Qs=({step:s})=>{const a=B();return e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>a("/quiz-wizard"),children:e.jsx(Pe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"p-8 space-y-12 text-zinc-800",children:[e.jsx("h1",{className:"text-6xl font-black",children:"QUIZWISE."}),e.jsxs("h2",{className:"text-4xl",children:["Twórzmy razem ",e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"sprawdzian wiedzy"})]}),e.jsxs("p",{children:["Krok ",s," z 5"]})]}),e.jsx(Ge,{className:"my-8"})]})},Vs=({title:s,description:a})=>e.jsxs("header",{className:"mb-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:s}),e.jsx("p",{className:"text-gray-600",children:a})]}),Qc=()=>{const s=B(),{register:a,setData:t}=ne(),[r,n]=h.useState(""),[i,l]=h.useState(""),[o,c]=h.useState(""),[m,p]=h.useState(""),[d,u]=h.useState(10),[x,f]=h.useState(["single","multiple"]),[j,v]=h.useState({}),[w,y]=h.useState(null),C=Ns("quiz-wizard","analyze-quiz-topic"),{steps:S,errors:W}=ks,{data:N,isLoading:b}=de({resource:"courses",filters:[{field:"is_published",operator:"eq",value:!0}],meta:{select:"*, topics(*)"},sorters:[{field:"created_at",order:"desc"}]}),q=N?.data?.find(R=>R.id.toString()===r),O=q?.topics||[];h.useEffect(()=>{a(ua),C.registerOperation(Bc);const R=sessionStorage.getItem("wizardContext");if(R){const X=JSON.parse(R);y(X),X.courseId&&n(X.courseId.toString()),X.topicId&&l(X.topicId.toString()),X.topicTitle&&c(X.topicTitle)}return()=>{C.unregisterOperation()}},[]),h.useEffect(()=>{if(i&&O.length>0){const R=O.find(X=>X.id.toString()===i);R&&!o&&c(R.title)}},[i,O]);const M=()=>{const R={};return r||(R.courseId="Wybierz kurs"),i||(R.topicId="Wybierz temat z kursu"),(!o.trim()||o.length<ee.topic.minLength)&&(R.topic=ee.topic.errorMessage),m||(R.difficulty="Wybierz poziom trudności"),(!d||d<ee.questionsCount.min||d>ee.questionsCount.max)&&(R.questionsCount=ee.questionsCount.errorMessage),x.length===0&&(R.questionTypes="Wybierz przynajmniej jeden typ pytań"),v(R),Object.keys(R).length===0},H=async()=>{if(M())try{const R={courseId:parseInt(r),topicId:parseInt(i),topic:o.trim(),difficulty:m,questionsCount:d,questionTypes:x,courseTitle:q?.title,topicTitle:O.find(X=>X.id.toString()===i)?.title};t("quiz-wizard",R),await C.executeOperation(R),s(_e.step2)}catch(R){console.error(W.analysisError,R)}},$=R=>{f(X=>X.includes(R)?X.filter(He=>He!==R):[...X,R])};return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[e.jsx(Qs,{step:1}),e.jsxs("div",{className:"p-6",children:[e.jsx(Vs,{title:S[1].title,description:S[1].description}),w&&e.jsxs(te,{className:"mb-4",children:[e.jsx(ft,{className:"h-4 w-4"}),e.jsxs(ae,{children:["Tworzysz quiz dla: ",e.jsx("strong",{children:w.courseTitle}),w.topicTitle&&e.jsxs(e.Fragment,{children:[" → ",e.jsx("strong",{children:w.topicTitle})]})]})]}),C.error&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("span",{className:"text-red-800 text-sm",children:[W.analysisError," ",C.error]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{className:"border-2 border-blue-200 bg-blue-50/50",children:e.jsxs(k,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xe,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold",children:"Wybierz miejsce w kursie"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"courseId",children:["Kurs ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(le,{value:r,onValueChange:R=>{n(R),l("")},disabled:C.loading||b||!!w?.courseId,children:[e.jsx(re,{className:j.courseId?"border-red-300":"",children:e.jsx(oe,{placeholder:"Wybierz kurs..."})}),e.jsx(ie,{children:N?.data?.map(R=>e.jsx(E,{value:R.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[R.icon_emoji&&e.jsx("span",{children:R.icon_emoji}),R.title]})},R.id))})]}),j.courseId&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.courseId})]}),e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"topicId",children:["Temat ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(le,{value:i,onValueChange:l,disabled:!r||C.loading||!!w?.topicId,children:[e.jsx(re,{className:j.topicId?"border-red-300":"",children:e.jsx(oe,{placeholder:r?"Wybierz temat...":"Najpierw wybierz kurs..."})}),e.jsx(ie,{children:O.sort((R,X)=>R.position-X.position).map(R=>e.jsxs(E,{value:R.id.toString(),children:[R.position,". ",R.title]},R.id))})]}),j.topicId&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.topicId})]})]})]})}),e.jsx(Ge,{}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"topic",children:"Temat quizu"}),e.jsx(D,{id:"topic",type:"text",value:o,onChange:R=>c(R.target.value),placeholder:ua.schema.step1.properties.topic.placeholder,disabled:C.loading,className:j.topic?"border-red-300":""}),j.topic&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.topic}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Możesz dostosować temat quizu lub pozostawić sugerowany"})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"difficulty",children:"Poziom trudności"}),e.jsxs(le,{value:m,onValueChange:p,disabled:C.loading,children:[e.jsx(re,{className:j.difficulty?"border-red-300":"",children:e.jsx(oe,{placeholder:"Wybierz poziom..."})}),e.jsxs(ie,{children:[e.jsx(E,{value:"easy",children:"Łatwy"}),e.jsx(E,{value:"medium",children:"Średni"}),e.jsx(E,{value:"hard",children:"Trudny"})]})]}),j.difficulty&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.difficulty})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"questionsCount",children:"Liczba pytań"}),e.jsx(D,{id:"questionsCount",type:"number",value:d,onChange:R=>u(parseInt(R.target.value)||0),min:ee.questionsCount.min,max:ee.questionsCount.max,disabled:C.loading,className:j.questionsCount?"border-red-300":""}),j.questionsCount&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.questionsCount})]}),e.jsxs("div",{children:[e.jsx(K,{children:"Typy pytań"}),e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{id:"single",checked:x.includes("single"),onCheckedChange:()=>$("single"),disabled:C.loading}),e.jsx("label",{htmlFor:"single",className:"text-sm cursor-pointer",children:"Jednokrotny wybór"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{id:"multiple",checked:x.includes("multiple"),onCheckedChange:()=>$("multiple"),disabled:C.loading}),e.jsx("label",{htmlFor:"multiple",className:"text-sm cursor-pointer",children:"Wielokrotny wybór"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{id:"truefalse",checked:x.includes("truefalse"),onCheckedChange:()=>$("truefalse"),disabled:C.loading}),e.jsx("label",{htmlFor:"truefalse",className:"text-sm cursor-pointer",children:"Prawda/Fałsz"})]})]}),j.questionTypes&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:j.questionTypes})]}),e.jsx("button",{onClick:H,disabled:C.loading,className:"w-full h-12 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium rounded-lg flex items-center justify-center gap-2",children:C.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),S[1].loading]}):S[1].button})]})]})]})})},Vc=()=>{const s=B(),{getData:a}=ne(),t=a("quiz-wizard"),{steps:r}=ks,n=l=>{switch(l){case"easy":return"Łatwy";case"medium":return"Średni";case"hard":return"Trudny";default:return l}},i=l=>{switch(l){case"single":return"Jednokrotny wybór";case"multiple":return"Wielokrotny wybór";case"truefalse":return"Prawda/Fałsz";default:return l}};return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[e.jsx(Qs,{step:2}),e.jsxs("div",{className:"space-y-6 p-8",children:[e.jsx(Vs,{title:r[2].title,description:r[2].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("span",{className:"text-green-800 text-sm",children:r[2].success})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Temat"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800",children:t.topic})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Poziom trudności"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:n(t.difficulty)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Liczba pytań"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:t.questionsCount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Typy pytań"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:t.questionTypes?.map(l=>e.jsxs("span",{className:"text-sm text-gray-800",children:[i(l),t.questionTypes.indexOf(l)<t.questionTypes.length-1&&", "]},l))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kluczowe zagadnienia"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.keyTopics?.map((l,o)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:l},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cele sprawdzające"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 whitespace-pre-wrap",children:t.learningObjectives})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sugerowany czas"}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[t.suggestedTime," minut"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sugerowany próg zaliczenia"}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[t.passingScore,"%"]})]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(g,{variant:"outline",onClick:()=>s(_e.step1),children:"Wstecz"}),e.jsx(g,{onClick:()=>s(_e.step3),children:"Kontynuuj"})]})]})]})]})})},Hc=()=>{const s=B(),{getData:a,setData:t}=ne(),r=a("quiz-wizard"),[n,i]=h.useState(r.quizTitle||""),[l,o]=h.useState(r.passingScore||70),[c,m]=h.useState(r.timeLimit||""),[p,d]=h.useState(r.maxAttempts||""),[u,x]=h.useState(!1),[f,j]=h.useState(!0),[v,w]=h.useState({}),y=Ns("quiz-wizard","generate-quiz-questions"),{steps:C,errors:S}=ks;h.useEffect(()=>(y.registerOperation(Kc),()=>{y.unregisterOperation()}),[]);const W=()=>{const b={};return(!n.trim()||n.length<ee.quizTitle.minLength)&&(b.quizTitle=ee.quizTitle.errorMessage),(!l||l<ee.passingScore.min||l>ee.passingScore.max)&&(b.passingScore=ee.passingScore.errorMessage),c&&(parseInt(c)<ee.timeLimit.min||parseInt(c)>ee.timeLimit.max)&&(b.timeLimit=ee.timeLimit.errorMessage),p&&(parseInt(p)<ee.maxAttempts.min||parseInt(p)>ee.maxAttempts.max)&&(b.maxAttempts=ee.maxAttempts.errorMessage),w(b),Object.keys(b).length===0},N=async()=>{if(W())try{const b={...r,quizTitle:n.trim(),passingScore:l,timeLimit:c?parseInt(c):null,maxAttempts:p?parseInt(p):null,shuffleQuestions:u,showExplanations:f};t("quiz-wizard",b),await y.executeOperation(b),s(_e.step4)}catch(b){console.error(S.generationError,b)}};return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[e.jsx(Qs,{step:3}),e.jsxs("div",{className:"space-y-6 p-8",children:[e.jsx(Vs,{title:C[3].title,description:C[3].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"quizTitle",children:["Tytuł quizu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{id:"quizTitle",value:n,onChange:b=>i(b.target.value),placeholder:"np. Test wiedzy - Zmienne i typy danych",className:`mt-1 ${v.quizTitle?"border-red-300":""}`}),v.quizTitle&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:v.quizTitle})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"passingScore",children:["Próg zaliczenia (%) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{id:"passingScore",type:"number",value:l,onChange:b=>o(parseInt(b.target.value)||0),min:ee.passingScore.min,max:ee.passingScore.max,className:`mt-1 ${v.passingScore?"border-red-300":""}`}),v.passingScore&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:v.passingScore})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"timeLimit",children:"Limit czasu (min)"}),e.jsx(D,{id:"timeLimit",type:"number",value:c,onChange:b=>m(b.target.value),placeholder:"Pozostaw puste dla braku limitu",min:ee.timeLimit.min,max:ee.timeLimit.max,className:`mt-1 ${v.timeLimit?"border-red-300":""}`}),v.timeLimit&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:v.timeLimit})]})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"maxAttempts",children:"Maksymalna liczba podejść"}),e.jsx(D,{id:"maxAttempts",type:"number",value:p,onChange:b=>d(b.target.value),placeholder:"Pozostaw puste dla nieograniczonej liczby",min:ee.maxAttempts.min,max:ee.maxAttempts.max,className:`mt-1 ${v.maxAttempts?"border-red-300":""}`}),v.maxAttempts&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:v.maxAttempts})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{id:"shuffleQuestions",checked:u,onCheckedChange:b=>x(b)}),e.jsx("label",{htmlFor:"shuffleQuestions",className:"text-sm cursor-pointer",children:"Losowa kolejność pytań"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{id:"showExplanations",checked:f,onCheckedChange:b=>j(b)}),e.jsx("label",{htmlFor:"showExplanations",className:"text-sm cursor-pointer",children:"Pokazuj wyjaśnienia po odpowiedzi"})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(g,{variant:"outline",onClick:()=>s(_e.step2),children:"Wstecz"}),e.jsx(g,{onClick:N,disabled:y.loading,children:y.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),C[3].loading]}):C[3].button})]})]}),y.loading&&e.jsx("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("span",{className:"text-blue-800 text-sm",children:C[3].loadingInfo})})]})]})})},Jc=()=>{const s=B(),{getData:a}=ne(),t=a("quiz-wizard"),{steps:r}=ks,n=l=>{switch(l){case"single":return"Jednokrotny wybór";case"multiple":return"Wielokrotny wybór";case"truefalse":return"Prawda/Fałsz";default:return l}},i=l=>{switch(l){case"single":return"default";case"multiple":return"secondary";case"truefalse":return"outline";default:return"default"}};return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[e.jsx(Qs,{step:4}),e.jsxs("div",{className:"space-y-6 p-8",children:[e.jsx(Vs,{title:e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"w-8 h-8 text-zinc-500"}),e.jsx("span",{children:r[4].title})]}),description:r[4].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:t.quizTitle}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Liczba pytań:"}),e.jsx("span",{className:"ml-2 font-medium",children:t.questions?.length||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Próg zaliczenia:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[t.passingScore,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Limit czasu:"}),e.jsx("span",{className:"ml-2 font-medium",children:t.timeLimit?`${t.timeLimit} min`:"Brak"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Max. podejść:"}),e.jsx("span",{className:"ml-2 font-medium",children:t.maxAttempts||"Bez limitu"})]})]})]}),e.jsx("div",{className:"space-y-4",children:t.questions?.map((l,o)=>e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("h5",{className:"font-medium",children:["Pytanie ",o+1]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Q,{variant:i(l.type),children:n(l.type)}),e.jsxs(Q,{variant:"outline",children:[l.points," pkt"]})]})]}),e.jsx("p",{className:"text-gray-700",children:l.question})]}),e.jsx("div",{className:"space-y-2 mb-3",children:l.options?.map((c,m)=>e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded ${c.is_correct?"bg-green-50 border border-green-200":"bg-gray-50"}`,children:[c.is_correct?e.jsx(ge,{className:"w-4 h-4 text-green-600 flex-shrink-0"}):e.jsx(Pe,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:c.is_correct?"font-medium":"",children:c.text})]},m))}),l.explanation&&e.jsx("div",{className:"bg-blue-50 p-3 rounded",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Wyjaśnienie:"})," ",l.explanation]})})]},o))})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsx("p",{className:"text-blue-800 text-sm",children:r[4].info})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(g,{variant:"outline",onClick:()=>s(_e.step3),children:"Wstecz"}),e.jsx(g,{onClick:()=>s(_e.step5),children:"Zapisz w kursie"})]})]})]})})},Yc=()=>{const s=B(),{getData:a,setData:t}=ne(),{mutate:r}=Ze(),{mutate:n}=Ze(),i=a("quiz-wizard"),[l,o]=h.useState(""),[c,m]=h.useState(""),[p,d]=h.useState(i.quizTitle||""),[u,x]=h.useState({}),[f,j]=h.useState(!1),[v,w]=h.useState(!1),{steps:y,errors:C}=ks,{data:S}=de({resource:"courses",meta:{select:"id, title, is_published"},filters:[{field:"is_published",operator:"eq",value:!0}]}),{data:W}=de({resource:"topics",filters:[{field:"course_id",operator:"eq",value:l}],sorters:[{field:"position",order:"asc"}],queryOptions:{enabled:!!l}}),{data:N}=de({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:c}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!c}}),b=N?.data?.[0]?.position?N.data[0].position+1:1,q=()=>{const $={};return l||($.courseId="Wybierz kurs"),c||($.topicId="Wybierz temat"),(!p.trim()||p.length<ee.quizTitle.minLength)&&($.finalTitle=ee.quizTitle.errorMessage),(!i.questions||i.questions.length===0)&&($.questions=C.noQuestions),x($),Object.keys($).length===0},O=async()=>{if(q()){j(!0),w(!1);try{r({resource:"activities",values:{topic_id:parseInt(c),type:"quiz",title:p.trim(),position:b,duration_min:i.suggestedTime||i.timeLimit||30,is_published:!1,passing_score:i.passingScore,time_limit:i.timeLimit||null,max_attempts:i.maxAttempts||null}},{onSuccess:async $=>{const R=$.data.id;try{for(let X=0;X<i.questions.length;X++){const He=i.questions[X];await new Promise((_t,St)=>{n({resource:"questions",values:{activity_id:R,question:He.question,explanation:He.explanation,points:He.points,position:X+1,options:He.options.map((Be,Z)=>({id:Z+1,text:Be.text,is_correct:Be.is_correct}))}},{onSuccess:_t,onError:St})})}t("quiz-wizard",{...i,finalTitle:p.trim(),courseId:l,topicId:c,activityId:R,saved:!0}),j(!1),w(!0),setTimeout(()=>{s(`${_e.questions}/${R}`)},2e3)}catch(X){j(!1),w(!1),console.error("Błąd podczas zapisywania pytań:",X),A.error("Wystąpił błąd podczas zapisywania pytań. Spróbuj ponownie.")}},onError:$=>{j(!1),w(!1),console.error(C.saveError,$),A.error(C.saveError)}})}catch($){j(!1),w(!1),console.error(C.unexpectedError,$),A.error(C.unexpectedError)}}},M=$=>$.id!==void 0&&$.title!==void 0,H=$=>$.id!==void 0&&$.title!==void 0&&$.position!==void 0;return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative",children:[e.jsx(Qs,{step:5}),e.jsxs("div",{className:"p-8",children:[e.jsx(Vs,{title:e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"w-8 h-8 text-blue-500"}),e.jsx("span",{children:y[5].title})]}),description:y[5].description}),v&&e.jsx(te,{className:"mb-6 bg-green-50 border-green-200",children:e.jsx(ae,{className:"text-green-800",children:y[5].success})}),e.jsxs("form",{className:"space-y-6",onSubmit:$=>{$.preventDefault(),O()},children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"courseId",children:["Kurs ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(le,{value:l,onValueChange:$=>{o($),m("")},children:[e.jsx(re,{className:u.courseId?"border-red-300":"",children:e.jsx(oe,{placeholder:"Wybierz kurs..."})}),e.jsx(ie,{children:S?.data?.map($=>M($)?e.jsx(E,{value:$.id.toString(),children:$.title},$.id):null)})]}),u.courseId&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.courseId})]}),e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"topicId",children:["Temat ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(le,{value:c,onValueChange:m,disabled:!l,children:[e.jsx(re,{className:u.topicId?"border-red-300":"",children:e.jsx(oe,{placeholder:l?"Wybierz temat...":"Najpierw wybierz kurs..."})}),e.jsx(ie,{children:W?.data?.map($=>H($)?e.jsxs(E,{value:$.id.toString(),children:[$.position,". ",$.title]},$.id):null)})]}),u.topicId&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.topicId})]})]}),e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"finalTitle",children:["Tytuł quizu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{id:"finalTitle",type:"text",value:p,onChange:$=>d($.target.value),placeholder:"Tytuł quizu",maxLength:ee.quizTitle.maxLength,className:u.finalTitle?"border-red-300":""}),u.finalTitle&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.finalTitle})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Podsumowanie quizu"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Liczba pytań:"}),e.jsx("span",{className:"ml-2 font-medium",children:i.questions?.length||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Próg zaliczenia:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[i.passingScore,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Limit czasu:"}),e.jsx("span",{className:"ml-2 font-medium",children:i.timeLimit?`${i.timeLimit} min`:"Brak"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Łączna liczba punktów:"}),e.jsx("span",{className:"ml-2 font-medium",children:i.questions?.reduce(($,R)=>$+R.points,0)||0})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-3",children:["Pytania (",i.questions?.length||0,")"]}),e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2 border rounded-lg p-3",children:i.questions?.map(($,R)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("span",{className:"text-sm truncate flex-1",children:[R+1,". ",$.question]}),e.jsxs("span",{className:"text-sm font-medium ml-2",children:[$.points," pkt"]})]},R))})]}),e.jsxs(te,{className:"bg-yellow-50 border-yellow-200",children:[e.jsx(lt,{className:"h-4 w-4 text-yellow-800"}),e.jsx(ae,{className:"text-yellow-800",children:"Po zapisaniu będziesz mógł edytować pytania w panelu zarządzania quizem"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsx("p",{className:"text-blue-800 text-sm",children:y[5].saveInfo})}),e.jsx(Ge,{}),e.jsxs("footer",{className:"flex justify-between gap-4",children:[e.jsxs(g,{type:"button",variant:"outline",onClick:()=>s(_e.step4),disabled:f,className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Wstecz"]}),e.jsx(g,{type:"submit",disabled:f||v,className:"flex items-center gap-2 min-w-[160px]",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),y[5].loading]}):e.jsxs(e.Fragment,{children:[e.jsx($s,{className:"w-4 h-4"}),y[5].button]})})]})]})]})]})})},Xc=[e.jsx(L,{path:"/quiz-wizard",element:e.jsx(Zc,{})},"quiz-dashboard"),e.jsx(L,{path:"/quiz-wizard/step1",element:e.jsx(Qc,{})},"quiz-step1"),e.jsx(L,{path:"/quiz-wizard/step2",element:e.jsx(Vc,{})},"quiz-step2"),e.jsx(L,{path:"/quiz-wizard/step3",element:e.jsx(Hc,{})},"quiz-step3"),e.jsx(L,{path:"/quiz-wizard/step4",element:e.jsx(Jc,{})},"quiz-step4"),e.jsx(L,{path:"/quiz-wizard/step5",element:e.jsx(Yc,{})},"quiz-step5")],ed={name:"quiz-wizard",list:"/quiz-wizard",create:"/quiz-wizard/step1",meta:{canDelete:!1,label:"Kreator quizów",icon:e.jsx(Kt,{className:"h-4 w-4"})}},sd={id:"course-structure-wizard",title:"Kreator struktury kursu",schema:{step1:{title:"Podstawowe informacje o kursie",type:"object",properties:{courseType:{type:"select",title:"Typ kursu",options:[{value:"matura",label:"Kurs maturalny"},{value:"academic",label:"Kurs akademicki"},{value:"professional",label:"Kurs zawodowy"},{value:"hobby",label:"Kurs hobbystyczny"},{value:"certification",label:"Kurs certyfikacyjny"}]},subject:{type:"text",title:"Przedmiot/Dziedzina",placeholder:"np. Matematyka, Programowanie Python, Język angielski"},level:{type:"select",title:"Poziom kursu",options:[{value:"basic",label:"Podstawowy"},{value:"extended",label:"Rozszerzony"},{value:"beginner",label:"Początkujący"},{value:"intermediate",label:"Średniozaawansowany"},{value:"advanced",label:"Zaawansowany"}]},duration:{type:"select",title:"Planowany czas trwania",options:[{value:"1month",label:"1 miesiąc"},{value:"3months",label:"3 miesiące"},{value:"6months",label:"6 miesięcy"},{value:"1year",label:"1 rok"},{value:"2years",label:"2 lata"}]}},required:["courseType","subject","level","duration"]},step2:{title:"Analiza wymagań",type:"object",properties:{courseTitle:{type:"text",title:"Proponowany tytuł kursu",readOnly:!0},description:{type:"textarea",title:"Opis kursu",readOnly:!0},objectives:{type:"tags",title:"Cele kursu",readOnly:!0},targetAudience:{type:"text",title:"Grupa docelowa",readOnly:!0},prerequisites:{type:"tags",title:"Wymagania wstępne",readOnly:!0},estimatedHours:{type:"number",title:"Szacowana liczba godzin",readOnly:!0},topicsCount:{type:"number",title:"Liczba głównych tematów",readOnly:!0}}},step3:{title:"Dostosowanie struktury",type:"object",properties:{courseTitle:{type:"text",title:"Tytuł kursu",placeholder:"np. Matematyka - Przygotowanie do matury"},description:{type:"textarea",title:"Opis kursu",rows:4},topicsPerWeek:{type:"number",title:"Liczba tematów na tydzień",min:1,max:7},includeExercises:{type:"checkbox",title:"Dodaj ćwiczenia do każdego tematu"},includeQuizzes:{type:"checkbox",title:"Dodaj quizy sprawdzające"},quizFrequency:{type:"select",title:"Częstotliwość quizów",options:[{value:"after_each",label:"Po każdym temacie"},{value:"weekly",label:"Co tydzień"},{value:"biweekly",label:"Co dwa tygodnie"},{value:"monthly",label:"Co miesiąc"},{value:"chapter_end",label:"Na koniec działu"}]}},required:["courseTitle","description","topicsPerWeek"]},step4:{title:"Podgląd struktury",type:"object",properties:{structure:{type:"array",title:"Struktura kursu",readOnly:!0}}},step5:{title:"Tworzenie kursu",type:"object",properties:{courseName:{type:"text",title:"Ostateczna nazwa kursu"},iconEmoji:{type:"text",title:"Emoji ikona",placeholder:"np. 📚 📐 🎓"},isPublished:{type:"checkbox",title:"Opublikuj od razu"}},required:["courseName"]}}},td={id:"analyze-course-requirements",name:"Analiza wymagań kursu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od projektowania kursów edukacyjnych i programów nauczania.",user:`
Przeanalizuj wymagania dla kursu:
Typ: {{courseType}}
Przedmiot: {{subject}}
Poziom: {{level}}
Czas trwania: {{duration}}

Wygeneruj JSON:
{
  "courseTitle": "<tytuł kursu odpowiedni do typu i poziomu>",
  "description": "<szczegółowy opis kursu 100-200 słów>",
  "objectives": ["cel1", "cel2", "cel3", "cel4", "cel5"],
  "targetAudience": "<opis grupy docelowej>",
  "prerequisites": ["wymaganie1", "wymaganie2"],
  "estimatedHours": <liczba godzin>,
  "topicsCount": <liczba głównych tematów>
}

Wymagania:
- Dla kursów maturalnych: zgodność z podstawą programową
- CourseTitle: profesjonalny i opisowy
- Description: zawiera zakres materiału i metodykę
- Objectives: 5-8 konkretnych, mierzalnych celów
- Prerequisites: realistyczne wymagania (może być pusta tablica)
- EstimatedHours: realistyczna liczba godzin
- TopicsCount: odpowiednia liczba tematów do czasu trwania
    `,responseFormat:"json"},inputMapping:s=>({courseType:s.courseType,subject:s.subject,level:s.level,duration:s.duration}),outputMapping:(s,a)=>({...a,courseTitle:s.courseTitle,description:s.description,objectives:s.objectives,targetAudience:s.targetAudience,prerequisites:s.prerequisites,estimatedHours:s.estimatedHours,topicsCount:s.topicsCount}),validation:s=>!!(s.courseTitle&&s.description&&s.objectives&&s.topicsCount)},ad={id:"generate-course-structure",name:"Generowanie struktury kursu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia szczegółowych programów nauczania. Tworzysz logiczną, progresywną strukturę kursu.",user:`
Stwórz szczegółową strukturę kursu:

Tytuł: {{courseTitle}}
Opis: {{description}}
Przedmiot: {{subject}}
Poziom: {{level}}
Typ: {{courseType}}
Cele: {{objectives}}
Liczba tematów: {{topicsCount}}
Tematy na tydzień: {{topicsPerWeek}}
Ćwiczenia: {{includeExercises}}
Quizy: {{includeQuizzes}}
Częstotliwość quizów: {{quizFrequency}}

Wygeneruj JSON ze strukturą:
{
  "structure": [
    {
      "weekNumber": 1,
      "topics": [
        {
          "title": "<tytuł tematu>",
          "description": "<opis tematu>",
          "objectives": ["cel1", "cel2"],
          "activities": [
            {
              "type": "material",
              "title": "<tytuł materiału>",
              "duration": <czas w minutach>
            },
            {
              "type": "quiz",
              "title": "<tytuł quizu>",
              "questionsCount": <liczba pytań>
            }
          ],
          "keywords": ["słowo1", "słowo2"]
        }
      ]
    }
  ],
  "summary": {
    "totalWeeks": <liczba>,
    "totalTopics": <liczba>,
    "totalActivities": <liczba>,
    "totalQuizzes": <liczba>
  }
}

Wymagania:
- Logiczna progresja trudności
- Dla kursów maturalnych: zgodność z wymaganiami egzaminacyjnymi
- Każdy temat ma jasno określone cele
- Realistyczne czasy trwania (30-90 min na materiał)
- Quizy dostosowane do poziomu (5-15 pytań)
- Równomierne rozłożenie materiału
    `,responseFormat:"json"},inputMapping:s=>({courseTitle:s.courseTitle,description:s.description,subject:s.subject,level:s.level,courseType:s.courseType,objectives:Array.isArray(s.objectives)?s.objectives.join(", "):s.objectives,topicsCount:s.topicsCount,topicsPerWeek:s.topicsPerWeek,includeExercises:s.includeExercises?"tak":"nie",includeQuizzes:s.includeQuizzes?"tak":"nie",quizFrequency:s.quizFrequency||"chapter_end"}),outputMapping:(s,a)=>({...a,structure:s.structure,summary:s.summary}),validation:s=>!!(s.structure&&Array.isArray(s.structure)&&s.structure.length>0)},Ie={subject:{minLength:3,errorMessage:"Przedmiot jest wymagany (3-100 znaków)"},courseTitle:{minLength:5,errorMessage:"Tytuł jest wymagany (5-200 znaków)"},description:{minLength:50,errorMessage:"Opis jest wymagany (50-1000 znaków)"},topicsPerWeek:{min:1,max:7,errorMessage:"Liczba tematów na tydzień musi być między 1 a 7"}},Cs={steps:{1:{title:"Jaki kurs chcesz stworzyć?",description:"Określ typ, przedmiot i poziom - AI stworzy kompletną strukturę kursu",button:"Analizuj wymagania",loading:"Analizuję wymagania..."},2:{title:"Analiza wymagań kursu",description:"AI przeanalizowała wymagania i zaproponowała parametry kursu",success:"✓ Analiza zakończona pomyślnie"},3:{title:"Dostosuj strukturę kursu",description:"Określ tempo nauki i dodatkowe elementy kursu",button:"Generuj strukturę",loading:"Generuję strukturę...",loadingInfo:"⚡ AI tworzy szczegółowy plan kursu z podziałem na tygodnie..."},4:{title:"Podgląd struktury kursu",description:"AI przygotowała kompletną strukturę z harmonogramem",info:"💡 Po zapisaniu będziesz mógł dodawać materiały do utworzonych tematów."},5:{title:"Tworzenie kursu",description:"Ostatnie poprawki przed utworzeniem kursu",saveInfo:"💾 Zostanie utworzony kurs z pełną strukturą tematów. Materiały i quizy możesz dodać później.",button:"Utwórz kurs",loading:"Tworzę kurs...",success:"✓ Kurs został utworzony pomyślnie! Przekierowuję..."}},dashboard:{title:"Generator struktury kursu",description:"Twórz kompletne kursy z pomocą AI",wizardTitle:"Generator kursów AI",wizardDescription:"Stwórz pełną strukturę kursu w 5 krokach",features:["Automatyczna analiza wymagań","Generowanie harmonogramu","Podział na tygodnie i tematy","Sugestie materiałów i quizów","Zgodność z podstawą programową","Progresja poziomu trudności"]},errors:{subjectRequired:"Podaj przedmiot kursu",analysisError:"Błąd analizy wymagań:",generationError:"Błąd generowania struktury:",saveError:"Wystąpił błąd podczas tworzenia kursu",unexpectedError:"Wystąpił nieoczekiwany błąd"}},Se={dashboard:"/course-structure",step1:"/course-structure/step1",step2:"/course-structure/step2",step3:"/course-structure/step3",step4:"/course-structure/step4",step5:"/course-structure/step5",courses:"/courses"},xa={matura:{defaultTopics:["Wprowadzenie i powtórka","Podstawowe zagadnienia","Zagadnienia rozszerzone","Zadania typu maturalnego","Próbne egzaminy","Powtórka przedegzaminacyjna"],defaultQuizFrequency:"weekly",includeExercises:!0,includeQuizzes:!0},academic:{defaultQuizFrequency:"biweekly",includeExercises:!0,includeQuizzes:!0},professional:{defaultQuizFrequency:"chapter_end",includeExercises:!0,includeQuizzes:!0},hobby:{defaultQuizFrequency:"monthly",includeExercises:!0,includeQuizzes:!1},certification:{defaultQuizFrequency:"after_each",includeExercises:!0,includeQuizzes:!0}},rd=()=>{const s=B(),{getData:a}=ne(),t=a("course-structure-wizard"),{dashboard:r}=Cs,n=t&&t.courseTitle;return e.jsxs(P,{children:[e.jsx(V,{title:r.title,description:r.description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-blue-50 p-6 rounded-lg border border-indigo-200",children:[e.jsxs(_,{variant:"start",className:"mb-4",children:[e.jsx("div",{className:"p-3 bg-indigo-100 rounded-lg",children:e.jsx(Ye,{className:"w-8 h-8 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r.wizardTitle}),e.jsx("p",{className:"text-gray-600",children:r.wizardDescription})]})]}),e.jsxs(J,{variant:"1-2-2",className:"gap-4",children:[e.jsx("div",{className:"space-y-2",children:r.features.slice(0,3).map((i,l)=>e.jsxs(_,{variant:"start",className:"text-sm text-gray-700",children:[e.jsx(ge,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{children:i})]},l))}),e.jsx("div",{className:"space-y-2",children:r.features.slice(3).map((i,l)=>e.jsxs(_,{variant:"start",className:"text-sm text-gray-700",children:[e.jsx(ge,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{children:i})]},l))})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(g,{onClick:()=>s(Se.step1),className:"w-full md:w-auto",size:"lg",children:[e.jsx(Ws,{className:"w-4 h-4 mr-2"}),"Stwórz strukturę kursu"]})})]}),n&&e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsxs(_,{variant:"between-center",className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ostatnia struktura"}),e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Wygenerowana"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tytuł kursu"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.courseTitle})]}),t.subject&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Przedmiot"}),e.jsx("p",{className:"text-gray-900",children:t.subject})]}),t.summary&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Liczba tygodni"}),e.jsx("p",{className:"text-gray-900 font-medium",children:t.summary.totalWeeks})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Liczba tematów"}),e.jsx("p",{className:"text-gray-900 font-medium",children:t.summary.totalTopics})]})]})]}),e.jsxs(_,{variant:"start",className:"mt-6 gap-3",children:[e.jsxs(g,{variant:"outline",onClick:()=>s(Se.step4),children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Podgląd"]}),e.jsxs(g,{variant:"outline",onClick:()=>s(Se.step3),children:[e.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),e.jsxs(g,{variant:"outline",onClick:()=>s(Se.step1),children:[e.jsx(Os,{className:"w-4 h-4 mr-2"}),"Nowa struktura"]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Zarządzanie kursami"}),e.jsxs(J,{variant:"1-2-3",className:"gap-4",children:[e.jsxs("button",{onClick:()=>s("/courses"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[e.jsxs(_,{variant:"start",className:"mb-2",children:[e.jsx(xe,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Kursy"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Zobacz wszystkie kursy"})]}),e.jsxs("button",{onClick:()=>s("/educational-material"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[e.jsxs(_,{variant:"start",className:"mb-2",children:[e.jsx(fs,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Materiały"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Kreator materiałów"})]}),e.jsxs("button",{onClick:()=>s("/quiz-wizard"),className:"p-4 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow text-left",children:[e.jsxs(_,{variant:"start",className:"mb-2",children:[e.jsx(Fs,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Quizy"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Kreator quizów"})]})]})]})]})]})},Hs=({step:s})=>{const a=B();return e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>a("/course-structure"),children:e.jsx(Pe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"p-8 space-y-12 text-zinc-800",children:[e.jsx("h1",{className:"text-6xl font-black",children:"COURSEFORGE"}),e.jsxs("h2",{className:"text-4xl",children:["Zaprojektujmy ",e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"strukturę kursu"})]}),e.jsxs("p",{children:["Krok ",s," z 5"]})]}),e.jsx(Ge,{className:"my-8"})]})},Js=({title:s,description:a})=>e.jsxs("header",{className:"mb-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:s}),e.jsx("p",{className:"text-gray-600",children:a})]}),id=()=>{const s=B(),{register:a,setData:t}=ne(),[r,n]=h.useState(""),[i,l]=h.useState(""),[o,c]=h.useState(""),[m,p]=h.useState(""),[d,u]=h.useState({}),x=Ns("course-structure-wizard","analyze-course-requirements"),{steps:f,errors:j}=Cs;h.useEffect(()=>(a(sd),x.registerOperation(td),()=>{x.unregisterOperation()}),[]);const v=()=>{const y={};return r||(y.courseType="Wybierz typ kursu"),(!i.trim()||i.length<Ie.subject.minLength)&&(y.subject=Ie.subject.errorMessage),o||(y.level="Wybierz poziom kursu"),m||(y.duration="Wybierz czas trwania"),u(y),Object.keys(y).length===0},w=async()=>{if(v())try{const y={courseType:r,subject:i.trim(),level:o,duration:m};t("course-structure-wizard",y),await x.executeOperation(y),s(Se.step2)}catch(y){console.error(j.analysisError,y)}};return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[e.jsx(Hs,{step:1}),e.jsxs("div",{className:"p-6",children:[e.jsx(Js,{title:f[1].title,description:f[1].description}),x.error&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("span",{className:"text-red-800 text-sm",children:[j.analysisError," ",x.error]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(K,{htmlFor:"courseType",children:"Typ kursu"}),e.jsxs(le,{value:r,onValueChange:n,disabled:x.loading,children:[e.jsx(re,{className:d.courseType?"border-red-300":"",children:e.jsx(oe,{placeholder:"Wybierz typ kursu..."})}),e.jsxs(ie,{children:[e.jsx(E,{value:"matura",children:"Kurs maturalny"}),e.jsx(E,{value:"academic",children:"Kurs akademicki"}),e.jsx(E,{value:"professional",children:"Kurs zawodowy"}),e.jsx(E,{value:"hobby",children:"Kurs hobbystyczny"}),e.jsx(E,{value:"certification",children:"Kurs certyfikacyjny"})]})]}),d.courseType&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:d.courseType})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"subject",children:"Przedmiot/Dziedzina"}),e.jsx(D,{id:"subject",type:"text",value:i,onChange:y=>l(y.target.value),placeholder:"np. Matematyka, Programowanie Python, Język angielski",disabled:x.loading,className:d.subject?"border-red-300":""}),d.subject&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:d.subject})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"level",children:"Poziom kursu"}),e.jsxs(le,{value:o,onValueChange:c,disabled:x.loading,children:[e.jsx(re,{className:d.level?"border-red-300":"",children:e.jsx(oe,{placeholder:"Wybierz poziom..."})}),e.jsx(ie,{children:r==="matura"?e.jsxs(e.Fragment,{children:[e.jsx(E,{value:"basic",children:"Podstawowy"}),e.jsx(E,{value:"extended",children:"Rozszerzony"})]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{value:"beginner",children:"Początkujący"}),e.jsx(E,{value:"intermediate",children:"Średniozaawansowany"}),e.jsx(E,{value:"advanced",children:"Zaawansowany"})]})})]}),d.level&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:d.level})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"duration",children:"Planowany czas trwania"}),e.jsxs(le,{value:m,onValueChange:p,disabled:x.loading,children:[e.jsx(re,{className:d.duration?"border-red-300":"",children:e.jsx(oe,{placeholder:"Wybierz czas trwania..."})}),e.jsxs(ie,{children:[e.jsx(E,{value:"1month",children:"1 miesiąc"}),e.jsx(E,{value:"3months",children:"3 miesiące"}),e.jsx(E,{value:"6months",children:"6 miesięcy"}),e.jsx(E,{value:"1year",children:"1 rok"}),e.jsx(E,{value:"2years",children:"2 lata"})]})]}),d.duration&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:d.duration})]}),e.jsx("button",{onClick:w,disabled:x.loading,className:"w-full h-12 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white font-medium rounded-lg flex items-center justify-center gap-2",children:x.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),f[1].loading]}):f[1].button})]})]})]})})},nd=()=>{const s=B(),{getData:a}=ne(),t=a("course-structure-wizard"),{steps:r}=Cs;return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[e.jsx(Hs,{step:2}),e.jsxs("div",{className:"space-y-6 p-8",children:[e.jsx(Js,{title:r[2].title,description:r[2].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("span",{className:"text-green-800 text-sm",children:r[2].success})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Proponowany tytuł"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:t.courseTitle})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opis kursu"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 whitespace-pre-wrap",children:t.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cele kursu"}),e.jsx("div",{className:"space-y-2",children:t.objectives?.map((n,i)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"text-indigo-600 font-medium",children:[i+1,"."]}),e.jsx("span",{className:"text-gray-800",children:n})]},i))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Grupa docelowa"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800",children:t.targetAudience})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wymagania wstępne"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:t.prerequisites?.length>0?e.jsx("ul",{className:"list-disc list-inside space-y-1",children:t.prerequisites.map((n,i)=>e.jsx("li",{className:"text-gray-800 text-sm",children:n},i))}):e.jsx("span",{className:"text-gray-500 text-sm",children:"Brak wymagań wstępnych"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Szacowana liczba godzin"}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[t.estimatedHours," godzin"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Liczba głównych tematów"}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-gray-800 font-medium",children:[t.topicsCount," tematów"]})]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(g,{variant:"outline",onClick:()=>s(Se.step1),children:"Wstecz"}),e.jsx(g,{onClick:()=>s(Se.step3),children:"Kontynuuj"})]})]})]})]})})},ld=()=>{const s=B(),{getData:a,setData:t}=ne(),r=a("course-structure-wizard"),[n,i]=h.useState(r.courseTitle||""),[l,o]=h.useState(r.description||""),[c,m]=h.useState(2),[p,d]=h.useState(!0),[u,x]=h.useState(!0),[f,j]=h.useState("weekly"),[v,w]=h.useState({}),y=Ns("course-structure-wizard","generate-course-structure"),{steps:C,errors:S}=Cs;h.useEffect(()=>{if(y.registerOperation(ad),r.courseType&&r.courseType in xa){const b=r.courseType,q=xa[b];d(q.includeExercises),x(q.includeQuizzes),j(q.defaultQuizFrequency)}return()=>{y.unregisterOperation()}},[]);const W=()=>{const b={};return(!n.trim()||n.length<Ie.courseTitle.minLength)&&(b.courseTitle=Ie.courseTitle.errorMessage),(!l.trim()||l.length<Ie.description.minLength)&&(b.description=Ie.description.errorMessage),(!c||c<Ie.topicsPerWeek.min||c>Ie.topicsPerWeek.max)&&(b.topicsPerWeek=Ie.topicsPerWeek.errorMessage),w(b),Object.keys(b).length===0},N=async()=>{if(W())try{const b={...r,courseTitle:n.trim(),description:l.trim(),topicsPerWeek:c,includeExercises:p,includeQuizzes:u,quizFrequency:f};t("course-structure-wizard",b),await y.executeOperation(b),s(Se.step4)}catch(b){console.error(S.generationError,b)}};return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[e.jsx(Hs,{step:3}),e.jsxs("div",{className:"space-y-6 p-8",children:[e.jsx(Js,{title:C[3].title,description:C[3].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"courseTitle",children:["Tytuł kursu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{id:"courseTitle",value:n,onChange:b=>i(b.target.value),placeholder:"np. Matematyka - Przygotowanie do matury",className:`mt-1 ${v.courseTitle?"border-red-300":""}`}),v.courseTitle&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:v.courseTitle})]}),e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"description",children:["Opis kursu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(De,{id:"description",value:l,onChange:b=>o(b.target.value),placeholder:"Szczegółowy opis kursu...",rows:4,className:`mt-1 ${v.description?"border-red-300":""}`}),v.description&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:v.description}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[l.length," / ",Ie.description.minLength," ","znaków minimum"]})]}),e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"topicsPerWeek",children:["Liczba tematów na tydzień"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{id:"topicsPerWeek",type:"number",value:c,onChange:b=>m(parseInt(b.target.value)||0),min:Ie.topicsPerWeek.min,max:Ie.topicsPerWeek.max,className:`mt-1 ${v.topicsPerWeek?"border-red-300":""}`}),v.topicsPerWeek&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:v.topicsPerWeek}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Określa tempo realizacji kursu"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{id:"includeExercises",checked:p,onCheckedChange:b=>d(b)}),e.jsx("label",{htmlFor:"includeExercises",className:"text-sm cursor-pointer",children:"Dodaj ćwiczenia do każdego tematu"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{id:"includeQuizzes",checked:u,onCheckedChange:b=>x(b)}),e.jsx("label",{htmlFor:"includeQuizzes",className:"text-sm cursor-pointer",children:"Dodaj quizy sprawdzające"})]}),u&&e.jsxs("div",{className:"ml-6",children:[e.jsx(K,{htmlFor:"quizFrequency",children:"Częstotliwość quizów"}),e.jsxs(le,{value:f,onValueChange:j,children:[e.jsx(re,{className:"mt-1",children:e.jsx(oe,{})}),e.jsxs(ie,{children:[e.jsx(E,{value:"after_each",children:"Po każdym temacie"}),e.jsx(E,{value:"weekly",children:"Co tydzień"}),e.jsx(E,{value:"biweekly",children:"Co dwa tygodnie"}),e.jsx(E,{value:"monthly",children:"Co miesiąc"}),e.jsx(E,{value:"chapter_end",children:"Na koniec działu"})]})]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(g,{variant:"outline",onClick:()=>s(Se.step2),children:"Wstecz"}),e.jsx(g,{onClick:N,disabled:y.loading,children:y.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),C[3].loading]}):C[3].button})]})]}),y.loading&&e.jsx("div",{className:"mt-6 p-4 bg-indigo-50 border border-indigo-200 rounded-lg",children:e.jsx("span",{className:"text-indigo-800 text-sm",children:C[3].loadingInfo})})]})]})})},od=()=>{const s=B(),{getData:a}=ne(),t=a("course-structure-wizard"),{steps:r}=Cs,n=i=>{switch(i){case"material":return e.jsx(ve,{className:"w-4 h-4"});case"quiz":return e.jsx(Le,{className:"w-4 h-4"});default:return e.jsx(xe,{className:"w-4 h-4"})}};return e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative pb-6",children:[e.jsx(Hs,{step:4}),e.jsxs("div",{className:"space-y-6 p-8",children:[e.jsx(Js,{title:e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"w-8 h-8 text-zinc-500"}),e.jsx("span",{children:r[4].title})]}),description:r[4].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-3",children:t.courseTitle}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t.description}),t.summary&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:t.summary.totalWeeks}),e.jsx("div",{className:"text-gray-600",children:"tygodni"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.summary.totalTopics}),e.jsx("div",{className:"text-gray-600",children:"tematów"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.summary.totalActivities}),e.jsx("div",{className:"text-gray-600",children:"aktywności"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.summary.totalQuizzes}),e.jsx("div",{className:"text-gray-600",children:"quizów"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Struktura kursu"}),t.structure?.map((i,l)=>e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-indigo-50 px-4 py-3 flex items-center gap-2",children:[e.jsx(Fs,{className:"w-5 h-5 text-indigo-600"}),e.jsxs("h5",{className:"font-medium",children:["Tydzień ",i.weekNumber]}),e.jsxs(Q,{variant:"secondary",className:"ml-auto",children:[i.topics.length," ",i.topics.length===1?"temat":"tematów"]})]}),e.jsx("div",{className:"p-4 space-y-3",children:i.topics.map((o,c)=>e.jsxs("div",{className:"border-l-4 border-indigo-200 pl-4",children:[e.jsx("h6",{className:"font-medium text-gray-900",children:o.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o.description}),o.objectives&&o.objectives.length>0&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Cele:"}),e.jsx("ul",{className:"text-xs text-gray-600 list-disc list-inside",children:o.objectives.map((m,p)=>e.jsx("li",{children:m},p))})]}),o.activities&&o.activities.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:o.activities.map((m,p)=>e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-100 rounded text-xs",children:[n(m.type),e.jsx("span",{children:m.title}),m.duration&&e.jsxs("span",{className:"text-gray-500",children:["(",m.duration," min)"]})]},p))}),o.keywords&&o.keywords.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:o.keywords.map((m,p)=>e.jsx(Q,{variant:"outline",className:"text-xs",children:m},p))})]},c))})]},l))]})]}),e.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:e.jsx("p",{className:"text-indigo-800 text-sm",children:r[4].info})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(g,{variant:"outline",onClick:()=>s(Se.step3),children:"Wstecz"}),e.jsx(g,{onClick:()=>s(Se.step5),children:"Utwórz kurs"})]})]})]})})},cd=()=>{const s=B(),{getData:a,setData:t}=ne(),{mutate:r}=Ze(),{mutate:n}=Ze(),{data:i}=Ne(),l=a("course-structure-wizard"),[o,c]=h.useState(l.courseTitle||""),[m,p]=h.useState("📚"),[d,u]=h.useState(!1),[x,f]=h.useState(!1),[j,v]=h.useState(!1),{steps:w,errors:y}=Cs,C=async()=>{if(!o.trim()){A.error("Nazwa kursu jest wymagana");return}if(!i?.vendor_id){A.error("Brak informacji o vendor_id. Skontaktuj się z administratorem.");return}f(!0),v(!1);try{r({resource:"courses",values:{vendor_id:i.vendor_id,title:o.trim(),description:l.description,icon_emoji:m,is_published:d}},{onSuccess:async W=>{const N=W.data.id;let b=1;try{for(const q of l.structure)for(const O of q.topics)await new Promise((M,H)=>{n({resource:"topics",values:{course_id:N,title:O.title,position:b++,is_published:!1}},{onSuccess:M,onError:H})});t("course-structure-wizard",{...l,courseName:o.trim(),courseId:N,saved:!0}),f(!1),v(!0),setTimeout(()=>{s(`${Se.courses}/show/${N}`)},2e3)}catch(q){f(!1),console.error("Błąd podczas tworzenia tematów:",q),A.error("Wystąpił błąd podczas tworzenia struktury kursu")}},onError:W=>{f(!1),console.error(y.saveError,W),W?.code==="42501"?A.error("Brak uprawnień do tworzenia kursów. Sprawdź swoje uprawnienia."):W?.code==="23505"?A.error("Kurs o takiej nazwie już istnieje."):A.error(y.saveError)}})}catch(W){f(!1),console.error(y.unexpectedError,W),A.error(y.unexpectedError)}},S=()=>{switch(l.courseType){case"matura":return"🎓";case"academic":return"🏛️";case"professional":return"💼";case"hobby":return"🎨";case"certification":return"📜";default:return"📚"}};return G.useEffect(()=>{p(S())},[l.courseType]),e.jsx(P,{children:e.jsxs("div",{className:"border rounded-lg bg-white shadow relative",children:[e.jsx(Hs,{step:5}),e.jsxs("div",{className:"p-8",children:[e.jsx(Js,{title:e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"w-8 h-8 text-indigo-500"}),e.jsx("span",{children:w[5].title})]}),description:w[5].description}),j&&e.jsx(te,{className:"mb-6 bg-green-50 border-green-200",children:e.jsx(ae,{className:"text-green-800",children:w[5].success})}),e.jsxs("form",{className:"space-y-6",onSubmit:W=>{W.preventDefault(),C()},children:[e.jsxs("div",{children:[e.jsxs(K,{htmlFor:"courseName",children:["Nazwa kursu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{id:"courseName",type:"text",value:o,onChange:W=>c(W.target.value),placeholder:"np. Matematyka - Kurs maturalny poziom rozszerzony",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(K,{htmlFor:"iconEmoji",children:"Emoji ikona"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(D,{id:"iconEmoji",type:"text",value:m,onChange:W=>p(W.target.value),placeholder:"np. 📚 📐 🎓",className:"flex-1",maxLength:5}),e.jsx("div",{className:"flex gap-1",children:["📚","🎓","📐","🏛️","💼","🎨","📜","🚀"].map(W=>e.jsx(g,{type:"button",variant:"outline",size:"sm",onClick:()=>p(W),className:"w-10 h-10",children:W},W))})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Wybierz emoji z listy lub wpisz własne"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{id:"isPublished",checked:d,onCheckedChange:W=>u(W)}),e.jsx("label",{htmlFor:"isPublished",className:"text-sm cursor-pointer",children:"Opublikuj kurs od razu (uczniowie będą mogli go zobaczyć)"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Co zostanie utworzone:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600",children:"✓"}),e.jsxs("span",{children:['Kurs "',o||l.courseTitle,'" z pełnym opisem']})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600",children:"✓"}),e.jsxs("span",{children:[l.summary?.totalTopics||0," tematów rozłożonych na ",l.summary?.totalWeeks||0," tygodni"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600",children:"✓"}),e.jsx("span",{children:"Struktura gotowa do wypełnienia materiałami i quizami"})]})]})]}),e.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:e.jsx("p",{className:"text-indigo-800 text-sm",children:w[5].saveInfo})}),e.jsx(Ge,{}),e.jsxs("footer",{className:"flex justify-between gap-4",children:[e.jsxs(g,{type:"button",variant:"outline",onClick:()=>s(Se.step4),disabled:x,className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Wstecz"]}),e.jsx(g,{type:"submit",disabled:x||j,className:"flex items-center gap-2 min-w-[160px]",children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),w[5].loading]}):e.jsxs(e.Fragment,{children:[e.jsx($s,{className:"w-4 h-4"}),w[5].button]})})]})]})]})]})})},dd=[e.jsx(L,{path:"/course-structure",element:e.jsx(rd,{})},"course-dashboard"),e.jsx(L,{path:"/course-structure/step1",element:e.jsx(id,{})},"course-step1"),e.jsx(L,{path:"/course-structure/step2",element:e.jsx(nd,{})},"course-step2"),e.jsx(L,{path:"/course-structure/step3",element:e.jsx(ld,{})},"course-step3"),e.jsx(L,{path:"/course-structure/step4",element:e.jsx(od,{})},"course-step4"),e.jsx(L,{path:"/course-structure/step5",element:e.jsx(cd,{})},"course-step5")],md={name:"course-structure",list:"/course-structure",create:"/course-structure/step1",meta:{canDelete:!1,label:"Generator kursów",icon:e.jsx(Ye,{className:"h-4 w-4"})}},us=h.forwardRef(({className:s,value:a,...t},r)=>e.jsx($a,{ref:r,className:F("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",s),...t,children:e.jsx(Zi,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));us.displayName=$a.displayName;const at=({icon:s,label:a,value:t,color:r="blue",trend:n,subtitle:i})=>{const l={blue:"from-blue-500 to-blue-600",purple:"from-purple-500 to-purple-600",pink:"from-pink-500 to-pink-600",green:"from-green-500 to-green-600",yellow:"from-yellow-500 to-yellow-600",orange:"from-orange-500 to-orange-600"};return e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-200 to-gray-300 rounded-2xl blur-xl opacity-0 group-hover:opacity-20 transition-opacity"}),e.jsx(z,{className:"relative hover:shadow-lg transition-all duration-300",children:e.jsxs(k,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${l[r]} shadow-lg`,children:e.jsx(s,{className:"w-6 h-6 text-white"})}),n&&e.jsxs("div",{className:`flex items-center gap-1 text-sm ${n>0?"text-green-600":"text-red-600"}`,children:[n>0?e.jsx(qn,{className:"w-4 h-4"}):e.jsx(Mn,{className:"w-4 h-4"}),e.jsxs("span",{children:[Math.abs(n),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:t}),e.jsx("p",{className:"text-sm font-medium text-gray-600 mt-1",children:a}),i&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i})]})]})})]})},ii=({course:s,onClick:a})=>e.jsxs(z,{className:"cursor-pointer hover:shadow-lg transition-all duration-300 overflow-hidden group",onClick:a,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-600/5 to-pink-600/5 opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs(k,{className:"p-6 relative",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-4xl",children:s.emoji}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg line-clamp-1",children:s.title}),s.lastActivity&&e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1 mt-1",children:[e.jsx(Ue,{className:"w-3 h-3"}),s.lastActivity]})]})]}),s.progress>0&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-green-600",children:[e.jsx(jt,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.progress,"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Postęp"}),e.jsxs("span",{className:"font-medium",children:[s.progress,"%"]})]}),e.jsx(us,{value:s.progress,className:"h-2"})]})]})]}),ni=({activity:s,onStart:a})=>{const t=()=>s.type==="quiz"?ls:xe,r=()=>s.type==="quiz"?"Quiz":"Materiał",n=()=>s.type==="quiz"?"bg-purple-500":"bg-blue-500",i=t();return e.jsx(z,{className:`transition-all duration-200 hover:shadow-md ${s.completed?"bg-gray-50/50":""}`,children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${n()} bg-opacity-10`,children:e.jsx(i,{className:`w-6 h-6 ${n().replace("bg-","text-")}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium truncate",children:s.title}),s.completed&&e.jsx(yt,{className:"w-5 h-5 text-green-500 flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[e.jsx(Q,{variant:"secondary",className:"text-xs",children:r()}),s.duration&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ue,{className:"w-3 h-3"}),e.jsxs("span",{children:[s.duration," min"]})]}),s.points&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3"}),e.jsxs("span",{children:[s.points," pkt"]})]}),s.score!==null&&s.score!==void 0&&e.jsxs(Q,{variant:s.score>=80?"default":"secondary",className:"text-xs",children:[s.score,"%"]})]}),s.courseTitle&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:s.courseEmoji||"📚"}),e.jsx("span",{children:s.courseTitle})]})]}),e.jsx(g,{size:"sm",variant:s.completed?"ghost":"default",onClick:l=>{l.stopPropagation(),a()},className:"flex-shrink-0",children:s.completed?e.jsxs(e.Fragment,{children:["Powtórz",e.jsx(ns,{className:"w-4 h-4 ml-1"})]}):e.jsxs(e.Fragment,{children:["Rozpocznij",e.jsx(ns,{className:"w-4 h-4 ml-1"})]})})]})})})},ud=()=>{const s=B(),{data:a}=Ne(),{stats:t,isLoading:r,refetch:n}=vt(),{data:i,isLoading:l}=Us("get_my_courses"),{data:o}=dr("activity_progress",{select:`
      *,
      activities!inner(
        id,
        title,
        type,
        topics!inner(
          id,
          title,
          courses!inner(
            id,
            title,
            icon_emoji
          )
        )
      )
    `,filters:a?.id?[{field:"user_id",operator:"eq",value:a.id}]:[],sorts:[{field:"started_at",order:"desc"}],limit:5,enabled:!!a?.id}),c=async()=>{try{const{data:u,error:x}=await Y.rpc("claim_daily_rewards");if(x)throw x;u&&(A.success(`Odebrano ${u.total_earned} punktów!`,{description:u.daily_points>0?`Seria ${u.streak} dni!`:"Punkty idle zebrane"}),n())}catch(u){console.error("Error claiming rewards:",u),A.error("Nie można odebrać nagród")}},m=t.level>0?(t.points-(t.level-1)*(t.level-1)*100)/(t.level*t.level*100-(t.level-1)*(t.level-1)*100)*100:0;if(r||l)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const p=i||[],d=o||[];return e.jsx(P,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(_,{children:[e.jsx(V,{title:`Witaj, ${a?.full_name||"Uczniu"}! 👋`,description:"Kontynuuj swoją przygodę z nauką"}),e.jsxs(g,{onClick:c,variant:"outline",className:"gap-2",children:[e.jsx(Ln,{className:"w-4 h-4"}),"Odbierz nagrody"]})]}),e.jsxs(J,{variant:"2-2-4",children:[e.jsx(at,{icon:be,label:"Poziom",value:t.level,color:"yellow",subtitle:`${t.points}/${t.next_level_points} pkt`}),e.jsx(at,{icon:ht,label:"Seria dni",value:t.streak,color:"orange",trend:t.streak>7?15:0}),e.jsx(at,{icon:$e,label:"Ukończone quizy",value:t.quizzes_completed,color:"green"}),e.jsx(at,{icon:Ue,label:"Czas nauki",value:`${Math.floor(t.total_time/60)}h`,color:"purple"})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsx(T,{children:"Postęp poziomu"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Poziom ",t.level," → ",t.level+1]})]})}),e.jsxs(k,{className:"space-y-2",children:[e.jsx(us,{value:m,className:"h-3"}),e.jsxs(_,{children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.points," punktów"]}),e.jsxs("span",{className:"text-sm font-medium",children:[t.next_level_points-t.points," punktów do następnego poziomu"]})]})]})]}),p.length>0&&e.jsxs("div",{children:[e.jsxs(_,{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Twoje kursy"}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>s("/student/courses"),children:"Zobacz wszystkie"})]}),e.jsx(J,{children:p.slice(0,3).map(u=>e.jsx(ii,{course:{id:u.course_id,title:u.title,emoji:u.icon_emoji||"📚",progress:u.progress_percent||0,lastActivity:u.last_activity?new Date(u.last_activity).toLocaleDateString("pl-PL"):null},onClick:()=>s(`/student/courses/${u.course_id}`)},u.course_id))})]}),d.length>0&&e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Ostatnie aktywności"})}),e.jsx(k,{className:"space-y-3",children:d.map(u=>e.jsx(ni,{activity:{id:u.activity_id,title:u.activities?.title||"Bez tytułu",type:u.activities?.type||"material",completed:!!u.completed_at,score:u.score,courseTitle:u.activities?.topics?.courses?.title,courseEmoji:u.activities?.topics?.courses?.icon_emoji},onStart:()=>{const x=u.activities?.topics?.courses?.id,f=u.activity_id;x&&f&&(u.activities?.type==="quiz"?s(`/student/courses/${x}/quiz/${f}`):s(`/student/courses/${x}/lesson/${f}`))}},u.activity_id))})]})]})})},xd=()=>{const s=B(),[a,t]=G.useState(""),{data:r,isLoading:n}=Us("get_my_courses"),i=G.useMemo(()=>!r||!a?r||[]:r.filter(l=>l.title.toLowerCase().includes(a.toLowerCase())),[r,a]);return n?e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsx(P,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{title:"Moje kursy",description:"Wybierz kurs i kontynuuj naukę"}),e.jsxs("div",{className:"relative",children:[e.jsx(Va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(D,{placeholder:"Szukaj kursów...",className:"pl-10",value:a,onChange:l=>t(l.target.value)})]}),e.jsx(J,{children:i.map(l=>e.jsx(ii,{course:{id:l.course_id,title:l.title,emoji:l.icon_emoji||"📚",progress:l.progress_percent||0,lastActivity:l.last_activity?new Date(l.last_activity).toLocaleDateString("pl-PL"):null},onClick:()=>s(`/student/courses/${l.course_id}`)},l.course_id))}),(!i||i.length===0)&&e.jsx(z,{children:e.jsxs(k,{className:"text-center py-12",children:[e.jsx(xe,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:a?"Nie znaleziono kursów":"Nie masz jeszcze żadnych kursów"})]})})]})})},pd=()=>{const{courseId:s}=ye(),a=B(),{data:t,isLoading:r}=Us("get_course_structure",{p_course_id:parseInt(s)},{enabled:!!s}),{data:n}=dr("courses",{filters:[{field:"id",operator:"eq",value:parseInt(s)}],enabled:!!s}),i=G.useMemo(()=>{if(!t)return[];const c=t.reduce((m,p)=>{const d=`${p.topic_id}-${p.topic_title}`;return m[d]||(m[d]={id:p.topic_id,title:p.topic_title,position:p.topic_position,activities:[]}),p.activity_id&&m[d].activities.push({id:p.activity_id,title:p.activity_title,type:p.activity_type,position:p.activity_position,completed:p.is_completed,score:p.score}),m},{});return Object.values(c).sort((m,p)=>m.position-p.position)},[t]),l=G.useMemo(()=>{const c=i.flatMap(d=>d.activities),m=c.filter(d=>d.completed).length,p=c.length;return{totalActivities:p,completedActivities:m,progress:p>0?Math.round(m/p*100):0,topics:i.length}},[i]);if(r)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const o=n?.[0];return e.jsx(P,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(g,{variant:"ghost",size:"sm",onClick:()=>a("/student/courses"),className:"gap-2",children:[e.jsx(gt,{className:"w-4 h-4"}),"Powrót do kursów"]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-pink-600 rounded-2xl p-8 text-white",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-5xl",children:o?.icon_emoji||"📚"}),e.jsx("h1",{className:"text-3xl font-bold",children:o?.title})]}),e.jsx("p",{className:"text-white/80 max-w-2xl",children:o?.description})]}),e.jsxs(Q,{className:"bg-white/20 text-white border-white/30",children:[l.progress,"% ukończone"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 mt-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/60",children:"Postęp"}),e.jsxs("p",{className:"text-2xl font-bold",children:[l.completedActivities,"/",l.totalActivities]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/60",children:"Tematy"}),e.jsx("p",{className:"text-2xl font-bold",children:l.topics})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/60",children:"Czas trwania"}),e.jsxs("p",{className:"text-2xl font-bold",children:["~",Math.ceil(l.totalActivities*15/60),"h"]})]})]}),e.jsx(us,{value:l.progress,className:"mt-6 h-3 bg-white/20"})]}),e.jsx("div",{className:"space-y-6",children:i.map(c=>{const m=c.activities.filter(d=>d.completed).length,p=m===c.activities.length;return e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsxs("div",{children:[e.jsxs(T,{className:"text-xl",children:["Temat ",c.position,": ",c.title]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[m,"/",c.activities.length," aktywności ukończonych"]})]}),p&&e.jsxs(Q,{variant:"secondary",className:"gap-1",children:[e.jsx(yt,{className:"w-3 h-3"}),"Ukończony"]})]})}),e.jsx(k,{className:"space-y-3",children:c.activities.map(d=>e.jsx(ni,{activity:{id:d.id,title:d.title,type:d.type,completed:d.completed,score:d.score,points:d.type==="quiz"?20:10},onStart:()=>{d.type==="quiz"?a(`/student/courses/${s}/quiz/${d.id}`):a(`/student/courses/${s}/lesson/${d.id}`)}},d.id))})]},c.id)})})]})})},hd=()=>{const{courseId:s,lessonId:a}=ye(),t=B(),[r,n]=G.useState(!1),{data:i,isLoading:l}=ue({resource:"activities",id:a,meta:{select:"*, topics(title, course_id, courses(title, icon_emoji))"}}),o=async()=>{n(!0);try{const{data:m,error:p}=await Y.rpc("complete_material",{p_activity_id:parseInt(a)});if(p)throw p;m&&(A.success("Lekcja ukończona!",{description:"Zdobyłeś punkty za ukończenie materiału"}),t(`/student/courses/${s}`))}catch(m){console.error("Complete error:",m),A.error("Nie udało się ukończyć lekcji",{description:m.message})}finally{n(!1)}};if(l)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const c=i?.data;return e.jsx(P,{children:e.jsxs("div",{className:"space-y-6 max-w-4xl mx-auto",children:[e.jsxs(g,{variant:"ghost",size:"sm",onClick:()=>t(`/student/courses/${s}`),className:"gap-2",children:[e.jsx(gt,{className:"w-4 h-4"}),"Powrót do kursu"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:c?.topics?.courses?.icon_emoji||"📚"}),e.jsx("span",{children:c?.topics?.courses?.title}),e.jsx("span",{children:"/"}),e.jsx("span",{children:c?.topics?.title})]}),e.jsx("h1",{className:"text-3xl font-bold",children:c?.title}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{variant:"secondary",children:"Materiał"}),c?.duration_min&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(Ue,{className:"w-3 h-3"}),e.jsxs("span",{children:[c?.duration_min," min"]})]})]})]}),e.jsx(z,{children:e.jsx(k,{className:"prose prose-lg max-w-none p-8",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:c?.content||""}})})}),e.jsx(z,{children:e.jsx(k,{className:"p-6",children:e.jsxs(_,{children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Ukończyłeś tę lekcję?"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Kliknij przycisk, aby zaznaczyć jako ukończone i otrzymać punkty"})]}),e.jsxs(g,{onClick:o,disabled:r,className:"gap-2",children:[e.jsx(yt,{className:"w-4 h-4"}),r?"Zapisywanie...":"Oznacz jako ukończone"]})]})})})]})})},li=h.forwardRef(({className:s,...a},t)=>e.jsx(Fa,{className:F("grid gap-2",s),...a,ref:t}));li.displayName=Fa.displayName;const oi=h.forwardRef(({className:s,...a},t)=>e.jsx(Wa,{ref:t,className:F("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:e.jsx(Qi,{className:"flex items-center justify-center",children:e.jsx(Za,{className:"h-3.5 w-3.5 fill-primary"})})}));oi.displayName=Wa.displayName;const jd=()=>{const{courseId:s,quizId:a}=ye(),t=B(),[r,n]=G.useState(0),[i,l]=G.useState({}),[o,c]=G.useState(null),[m,p]=G.useState(!1),[d,u]=G.useState([]),[x,f]=G.useState(!0),{data:j,isLoading:v}=ue({resource:"activities",id:a,meta:{select:"*, topics(title, course_id, courses(title, icon_emoji))"}});G.useEffect(()=>{(async()=>{if(a)try{const{error:b}=await Y.rpc("start_activity",{p_activity_id:parseInt(a)});b&&(console.error("Error starting quiz:",b),A.error("Nie udało się rozpocząć quizu",{icon:e.jsx(Xs,{size:24})})),f(!0);const{data:q,error:O}=await Y.rpc("get_quiz_questions",{p_activity_id:parseInt(a)});if(O)console.error("Error fetching questions:",O),A.error("Nie udało się pobrać pytań",{icon:e.jsx(Xs,{size:24})});else{const M=typeof q=="string"?JSON.parse(q):q;console.log("Questions data:",M),M&&M.length>0&&console.log("First question options:",M[0].options),u(Array.isArray(M)?M:[])}}catch(b){console.error("Quiz init error:",b),A.error("Błąd podczas ładowania quizu",{icon:e.jsx(Xs,{size:24})})}finally{f(!1)}})()},[a]),G.useEffect(()=>{j?.data?.time_limit&&o===null&&c(j.data.time_limit*60)},[j]),G.useEffect(()=>{if(o!==null&&o>0){const N=setTimeout(()=>c(o-1),1e3);return()=>clearTimeout(N)}else o===0&&C()},[o]);const w=j?.data,y=(N,b)=>{l(q=>({...q,[N]:b}))},C=async()=>{p(!0);try{const N=Object.entries(i).map(([O,M])=>({question_id:parseInt(O),option_id:M}));console.log("Submitting answers:",N);const{data:b,error:q}=await Y.rpc("finish_quiz",{p_activity_id:parseInt(a),p_answers:N});if(q)throw q;if(b){const{score:O,passed:M,points_earned:H}=b;M?A.success(`Quiz zaliczony! Wynik: ${O}%`,{description:`Zdobyłeś ${H} punktów!`,icon:e.jsx(Ve,{size:24})}):A.warning(`Quiz niezaliczony. Wynik: ${O}%`,{description:`Wymagane minimum ${w?.passing_score||70}% do zaliczenia. Spróbuj ponownie!`,icon:e.jsx(ws,{size:24})}),t(`/student/courses/${s}?refresh=true`)}}catch(N){console.error("Submit error:",N),A.error("Nie udało się przesłać odpowiedzi",{description:N.message,icon:e.jsx(Xs,{size:24})})}finally{p(!1)}};if(v||x)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const S=d[r],W=d.length>0?(r+1)/d.length*100:0;return e.jsx(P,{children:e.jsxs("div",{className:"space-y-6 max-w-4xl mx-auto",children:[e.jsxs(_,{children:[e.jsxs(g,{variant:"ghost",size:"sm",onClick:()=>t(`/student/courses/${s}`),className:"gap-2",children:[e.jsx(gt,{className:"w-4 h-4"}),"Powrót do kursu"]}),o!==null&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-medium",children:[Math.floor(o/60),":",String(o%60).padStart(2,"0")]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold",children:w?.title}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{variant:"default",children:"Quiz"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Pytanie ",r+1," z ",d.length]})]})]}),e.jsx(us,{value:W,className:"h-2"}),S&&d.length>0?e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsx(T,{className:"text-xl",children:S.question}),e.jsxs(Q,{variant:"secondary",children:[S.points," pkt"]})]})}),e.jsxs(k,{className:"space-y-4",children:[e.jsx(li,{value:String(i[S.id]||""),onValueChange:N=>y(S.id,parseInt(N)),children:S.options&&Array.isArray(S.options)&&S.options.map(N=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oi,{value:String(N.id),id:`radio-${S.id}-${N.id}`}),e.jsx(K,{htmlFor:`radio-${S.id}-${N.id}`,className:"flex-1 cursor-pointer py-2",children:N.text})]},`option-${S.id}-${N.id}`))}),!i[S.id]&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-amber-600",children:[e.jsx(lt,{className:"w-4 h-4"}),e.jsx("span",{children:"Wybierz odpowiedź"})]})]})]}):d.length===0&&!x?e.jsx(z,{children:e.jsxs(k,{className:"text-center py-12",children:[e.jsx(lt,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"Nie znaleziono pytań dla tego quizu"})]})}):null,e.jsxs(_,{children:[e.jsx(g,{variant:"outline",onClick:()=>n(Math.max(0,r-1)),disabled:r===0,children:"Poprzednie"}),e.jsx("div",{className:"flex gap-2",children:d.map((N,b)=>e.jsx("button",{onClick:()=>n(b),className:`w-10 h-10 rounded-lg border-2 transition-all ${b===r?"border-primary bg-primary text-white":i[N.id]?"border-green-500 bg-green-50":"border-gray-300"}`,children:b+1},`nav-${N.id}-${b}`))}),r<d.length-1?e.jsx(g,{onClick:()=>n(r+1),disabled:!i[S?.id],children:"Następne"}):e.jsx(g,{onClick:C,disabled:m||Object.keys(i).length<d.length,variant:"default",children:m?"Przesyłanie...":"Zakończ quiz"})]})]})})},gd={"⚡":Qt,"🚀":Ws,"🧠":ls,"☕":En,"📚":Dn},yd=()=>{const{stats:s,refetch:a}=vt(),{data:t,isLoading:r,refetch:n}=Us("get_idle_upgrades"),i=async o=>{try{const{data:c,error:m}=await Y.rpc("buy_idle_upgrade",{p_upgrade_id:o});if(m)throw m;c&&(A.success("Ulepszenie zakupione!",{description:`Nowy poziom: ${c.new_level}`}),a(),n())}catch(c){A.error("Nie udało się kupić ulepszenia",{description:c.message||"Niewystarczająca ilość punktów"})}},l=t||[];return r?e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsx(P,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{title:"Gamifikacja",description:"Ulepsz swoje możliwości zdobywania punktów"}),e.jsxs(z,{className:"bg-gradient-to-br from-purple-600 to-pink-600 text-white",children:[e.jsx(I,{children:e.jsx(T,{className:"text-2xl",children:"Idle Game"})}),e.jsx(k,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-80",children:"Punkty na godzinę"}),e.jsx("p",{className:"text-4xl font-bold",children:s.idle_rate})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-80",children:"Twoje punkty"}),e.jsx("p",{className:"text-4xl font-bold",children:s.points})]})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Ulepszenia"}),e.jsx(J,{children:l.map(o=>{const c=s.points>=o.next_cost,m=gd[o.icon]||Ls;return e.jsxs(z,{className:"relative overflow-hidden",children:[e.jsx(I,{children:e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500",children:e.jsx(m,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(T,{className:"text-lg",children:o.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["+",o.bonus_per_level," pkt/h za poziom"]})]})]}),e.jsxs(Q,{variant:"secondary",children:["Lvl ",o.current_level]})]})}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Aktualny bonus"}),e.jsxs("span",{className:"font-bold text-green-600",children:["+",o.total_bonus," pkt/h"]})]}),e.jsxs(g,{className:"w-full",onClick:()=>i(o.id),disabled:!c,variant:c?"default":"secondary",children:[e.jsx(Ls,{className:"w-4 h-4 mr-2"}),"Ulepsz (",o.next_cost," pkt)"]})]})})]},o.id)})})]})]})})},fd=()=>{const{data:s}=Ne(),[a,t]=G.useState("all"),{data:r,isLoading:n,refetch:i}=Us("get_leaderboard",{p_limit:20,p_filter:a});G.useEffect(()=>{i()},[a]);const l=m=>{switch(m){case 1:return e.jsx(be,{className:"w-5 h-5 text-yellow-500"});case 2:return e.jsx(Rn,{className:"w-5 h-5 text-gray-400"});case 3:return e.jsx(Ms,{className:"w-5 h-5 text-orange-600"});default:return e.jsxs("span",{className:"text-sm font-bold text-gray-500",children:["#",m]})}},o=m=>{switch(m){case 1:return"bg-yellow-50 border-yellow-200";case 2:return"bg-gray-50 border-gray-200";case 3:return"bg-orange-50 border-orange-200";default:return""}};if(n)return e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const c=r||[];return e.jsx(P,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{title:"Ranking",description:"Zobacz jak wypadasz na tle innych uczniów"}),e.jsxs(gl,{value:a,onValueChange:m=>t(m),children:[e.jsxs(tr,{className:"grid w-full grid-cols-3",children:[e.jsx(it,{value:"all",children:"Wszyscy"}),e.jsx(it,{value:"students",children:"Uczniowie"}),e.jsx(it,{value:"teachers",children:"Nauczyciele"})]}),e.jsx(ar,{value:a,className:"mt-6",children:e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Top 20"})}),e.jsx(k,{className:"space-y-2",children:c.map(m=>{const p=m.user_id===s?.id;return e.jsxs("div",{className:`flex items-center gap-4 p-4 rounded-xl transition-all ${p?"bg-purple-50 border-2 border-purple-200":`border ${o(m.rank)} hover:bg-gray-50`}`,children:[e.jsx("div",{className:"w-10 flex justify-center",children:l(m.rank)}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center text-white font-bold",children:m.full_name.charAt(0)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-semibold",children:[m.full_name,p&&e.jsx(Q,{className:"ml-2",variant:"secondary",children:"Ty"})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Poziom ",m.level," • Seria ",m.streak," dni"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-lg",children:m.points}),e.jsx("p",{className:"text-xs text-gray-500",children:"punktów"})]})]},m.user_id)})})]})})]})]})})},Ps=[{id:1,icon:ht,title:"Pierwszy Krok",description:"Ukończ pierwszą lekcję",unlocked:!0,rarity:"common",unlockedAt:"2024-01-15",progress:100},{id:2,icon:Ja,title:"Perfekcjonista",description:"Zdobądź 100% w 10 quizach",unlocked:!0,rarity:"rare",unlockedAt:"2024-02-20",progress:100},{id:3,icon:Qt,title:"Błyskawica",description:"Ukończ 5 lekcji w jeden dzień",unlocked:!1,rarity:"epic",progress:60},{id:4,icon:be,title:"Mistrz",description:"Osiągnij poziom 50",unlocked:!1,rarity:"legendary",progress:24},{id:5,icon:$e,title:"Snajper",description:"Odpowiedz poprawnie na 100 pytań z rzędu",unlocked:!1,rarity:"epic",progress:45},{id:6,icon:Ws,title:"Rakieta",description:"Ukończ kurs w mniej niż tydzień",unlocked:!1,rarity:"rare",progress:0}],pa={common:{gradient:"from-gray-400 to-gray-500",bgColor:"bg-gray-50",borderColor:"border-gray-200",label:"Pospolite"},rare:{gradient:"from-blue-400 to-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",label:"Rzadkie"},epic:{gradient:"from-purple-400 to-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-200",label:"Epiczne"},legendary:{gradient:"from-yellow-400 to-orange-500",bgColor:"bg-orange-50",borderColor:"border-orange-200",label:"Legendarne"}},wd=()=>{const s=Ps.filter(t=>t.unlocked).length,a=Ps.length;return e.jsx(P,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{title:"Osiągnięcia",description:`Odblokowano ${s} z ${a} osiągnięć`}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Postęp osiągnięć"})}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(us,{value:s/a*100,className:"h-3"}),e.jsx("div",{className:"grid grid-cols-4 gap-4 text-center",children:Object.entries(pa).map(([t,r])=>{const n=Ps.filter(l=>l.rarity===t&&l.unlocked).length,i=Ps.filter(l=>l.rarity===t).length;return e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:[n,"/",i]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.label})]},t)})})]})})]}),e.jsx(J,{variant:"1-2-3",children:Ps.map(t=>{const r=pa[t.rarity],n=t.icon;return e.jsxs(z,{className:`relative overflow-hidden ${t.unlocked?"":"opacity-75"} border-2 ${r.borderColor}`,children:[e.jsx("div",{className:`absolute inset-0 ${r.bgColor} opacity-20`}),e.jsx(k,{className:"relative p-6",children:e.jsxs("div",{className:"flex flex-col items-center text-center space-y-4",children:[e.jsx("div",{className:`w-20 h-20 rounded-full bg-gradient-to-br ${t.unlocked?r.gradient:"from-gray-300 to-gray-400"} flex items-center justify-center shadow-lg`,children:e.jsx(n,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.description})]}),t.unlocked?e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Odblokowano ",new Date(t.unlockedAt).toLocaleDateString("pl-PL")]}):e.jsxs("div",{className:"w-full space-y-2",children:[e.jsx(us,{value:t.progress,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.progress,"% ukończone"]})]}),e.jsx(Q,{variant:t.unlocked?"default":"secondary",children:r.label})]})})]},t.id)})})]})})},bd=()=>{const{data:s}=Ne(),{stats:a}=vt();return e.jsx(P,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{title:"Mój profil",description:"Zarządzaj swoim kontem i zobacz swoje statystyki"}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Informacje osobiste"})}),e.jsx(k,{children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center text-white text-3xl font-bold",children:s?.full_name?.charAt(0)||"U"}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:s?.full_name}),e.jsx(Q,{variant:"secondary",className:"mt-1",children:"Uczeń"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(es,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{children:s?.email})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Fs,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{children:["Dołączył: ",new Date(s?.created_at||Date.now()).toLocaleDateString("pl-PL")]})]})]})]}),e.jsx(g,{variant:"outline",children:"Edytuj profil"})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Moje osiągnięcia"}),e.jsxs(J,{variant:"2-2-4",children:[e.jsx(z,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-yellow-500 to-yellow-600",children:e.jsx(be,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:a.points}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Punktów zdobytych"})]})]})})}),e.jsx(z,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-purple-500 to-purple-600",children:e.jsx($e,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:a.quizzes_completed}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ukończonych quizów"})]})]})})}),e.jsx(z,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-green-500 to-green-600",children:e.jsx($e,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:a.perfect_scores}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Perfekcyjnych wyników"})]})]})})}),e.jsx(z,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-orange-500 to-orange-600",children:e.jsx(ht,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:[a.streak," dni"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Najdłuższa seria"})]})]})})}),e.jsx(z,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-blue-500 to-blue-600",children:e.jsx(Ue,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:[Math.floor(a.total_time/60),"h"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Czasu nauki"})]})]})})}),e.jsx(z,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-pink-500 to-pink-600",children:e.jsx(Qe,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:["Poziom ",a.level]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aktualny poziom"})]})]})})})]})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(T,{children:"Ustawienia konta"})}),e.jsxs(k,{className:"space-y-4",children:[e.jsx(g,{variant:"outline",className:"w-full justify-start",children:"Zmień hasło"}),e.jsx(g,{variant:"outline",className:"w-full justify-start",children:"Ustawienia powiadomień"}),e.jsx(g,{variant:"outline",className:"w-full justify-start text-red-600 hover:text-red-700",children:"Usuń konto"})]})]})]})})},vd=[e.jsx(L,{path:"/student/dashboard",element:e.jsx(ud,{})},"student-dashboard"),e.jsx(L,{path:"/student/courses",element:e.jsx(xd,{})},"student-courses"),e.jsx(L,{path:"/student/courses/:courseId",element:e.jsx(pd,{})},"student-course-detail"),e.jsx(L,{path:"/student/courses/:courseId/lesson/:lessonId",element:e.jsx(hd,{})},"student-lesson"),e.jsx(L,{path:"/student/courses/:courseId/quiz/:quizId",element:e.jsx(jd,{})},"student-quiz"),e.jsx(L,{path:"/student/gamification",element:e.jsx(yd,{})},"student-gamification"),e.jsx(L,{path:"/student/leaderboard",element:e.jsx(fd,{})},"student-leaderboard"),e.jsx(L,{path:"/student/achievements",element:e.jsx(wd,{})},"student-achievements"),e.jsx(L,{path:"/student/profile",element:e.jsx(bd,{})},"student-profile")],Me=({children:s})=>e.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"h-96 fixed top-0 w-full -rotate-1 scale-125",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-400/0 via-pink-300/15 to-purple-500/10"})}),e.jsx("div",{className:"absolute top-20 -left-32 w-64 h-64 bg-gradient-to-br from-purple-300/20 to-pink-300/20 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-20 -right-32 w-96 h-96 bg-gradient-to-tl from-purple-400/15 to-pink-400/15 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-64 bg-gradient-to-b from-pink-200/10 to-transparent"}),e.jsx("div",{className:"w-full max-w-lg space-y-3 relative z-10",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-300/5 to-pink-300/5 rounded-lg blur-md"}),e.jsx("div",{className:"relative bg-background/80 backdrop-blur-sm rounded-lg shadow-xl shadow-purple-200/20 border border-purple-200/20 p-8",children:s})]})})]}),Nd=()=>{const{mutate:s,isLoading:a}=nn(),[t,r]=G.useState(""),[n,i]=G.useState(""),[l,o]=G.useState(null),c=G.useCallback(()=>{if(console.log("🚀 Login attempt:",{email:t}),!t.trim()||!n.trim()){o("Wypełnij wszystkie pola");return}o(null),s({email:t.trim(),password:n},{onSuccess:p=>{console.log("✅ Login success:",p)},onError:p=>{console.error("❌ Login error:",p);let d="Błąd logowania";p?.message&&(p.message.includes("Invalid login credentials")?d="Nieprawidłowe dane logowania":p.message.includes("Email not confirmed")?d="Potwierdź email przed zalogowaniem":d=p.message),o(d)}})},[t,n,s]),m=G.useCallback(p=>{p.preventDefault(),c()},[c]);return{email:t,password:n,setEmail:r,setPassword:i,isLoading:a,error:l,login:c,handleSubmit:m}},zd=()=>{const[s]=Rs(),{email:a,password:t,setEmail:r,setPassword:n,isLoading:i,error:l,handleSubmit:o}=Nd(),{data:c,isLoading:m}=ln(),{data:p,isLoading:d}=Ne(),u=s.get("verified")==="true",x=s.get("passwordChanged")==="true",f=a.trim().length>0&&t.length>0,j=y=>y.includes("nie zostało potwierdzone")?"warning":"destructive",v=y=>y.includes("nie zostało potwierdzone")?ft:ws,w=y=>{if(l){if(y==="email"&&l.toLowerCase().includes("email"))return"Sprawdź poprawność adresu email";if(y==="password"&&l.toLowerCase().includes("hasło"))return"Sprawdź poprawność hasła"}};if(m||d)return e.jsx(Me,{children:e.jsx(z,{children:e.jsx(k,{className:"flex items-center justify-center py-12",children:e.jsx(os,{className:"h-8 w-8 animate-spin"})})})});if(c&&p){const y=p.role?`/${p.role}`:"/profiles";return e.jsx(gs,{to:y,replace:!0})}return e.jsx(Me,{children:e.jsxs(z,{children:[e.jsxs(I,{className:"space-y-1",children:[e.jsx(T,{className:"text-2xl text-center",children:"Zaloguj się"}),e.jsx(ts,{className:"text-center",children:"Wprowadź swoje dane aby się zalogować"})]}),e.jsxs(k,{children:[u&&e.jsxs(te,{className:"mb-4 border-green-200 bg-green-50",children:[e.jsx(Ve,{className:"h-4 w-4 text-green-600"}),e.jsxs(ae,{className:"text-green-800",children:[e.jsx("strong",{children:"Email potwierdzony!"})," Możesz się teraz zalogować."]})]}),x&&e.jsxs(te,{className:"mb-4 border-green-200 bg-green-50",children:[e.jsx(Ve,{className:"h-4 w-4 text-green-600"}),e.jsxs(ae,{className:"text-green-800",children:[e.jsx("strong",{children:"Hasło zmienione!"})," Możesz się zalogować używając nowego hasła."]})]}),e.jsxs(Ee,{onSubmit:o,children:[e.jsx(U,{label:e.jsxs("span",{className:"flex items-center",children:[e.jsx(es,{className:"mr-2 h-4 w-4"}),"Email"]}),htmlFor:"email",error:w("email"),required:!0,children:e.jsx(D,{id:"email",type:"email",placeholder:"przykład@email.com",value:a,onChange:y=>r(y.target.value),disabled:i,className:w("email")?"border-red-500":""})}),e.jsx(U,{label:e.jsxs("span",{className:"flex items-center",children:[e.jsx(An,{className:"mr-2 h-4 w-4"}),"Hasło"]}),htmlFor:"password",error:w("password"),required:!0,children:e.jsx(D,{id:"password",type:"password",placeholder:"Wprowadź hasło",value:t,onChange:y=>n(y.target.value),disabled:i,className:w("password")?"border-red-500":""})}),l&&e.jsxs(te,{variant:j(l),children:[G.createElement(v(l),{className:"h-4 w-4"}),e.jsxs(ae,{children:[e.jsx("strong",{children:"Błąd logowania:"})," ",l,l.includes("nie zostało potwierdzone")&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsxs("p",{children:["💡 ",e.jsx("strong",{children:"Co robić:"})]}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[e.jsx("li",{children:"Sprawdź swoją skrzynkę email (także spam)"}),e.jsx("li",{children:"Kliknij link aktywacyjny w emailu"}),e.jsxs("li",{children:["Jeśli nie otrzymałeś emaila, możesz"," ",e.jsx(Is,{to:"/resend-confirmation",className:"underline",children:"wysłać ponownie"})]})]})]}),l.includes("Nieprawidłowe dane")&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsxs("p",{children:["💡 ",e.jsx("strong",{children:"Sprawdź:"})]}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[e.jsx("li",{children:"Czy email jest wpisany poprawnie"}),e.jsx("li",{children:"Czy hasło jest poprawne (uwaga na wielkość liter)"}),e.jsx("li",{children:"Czy masz już założone konto"})]})]})]})]}),e.jsx(Re,{className:"!border-0 !pt-0 justify-center",children:e.jsxs(g,{type:"submit",className:"w-full",disabled:i||!f,children:[i&&e.jsx(os,{className:"mr-2 h-4 w-4 animate-spin"}),i?"Logowanie...":"Zaloguj się"]})})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("div",{className:"text-center text-sm",children:e.jsx(Is,{to:"/register/step1",className:"text-blue-600 hover:text-blue-500 transition-colors",children:"Nie masz konta? Zarejestruj się"})}),e.jsx("div",{className:"text-center text-sm",children:e.jsx(Is,{to:"/forgot-password",className:"text-blue-600 hover:text-blue-500 transition-colors",children:"Zapomniałeś hasła?"})}),e.jsx("div",{className:"border-t pt-4 mt-4",children:e.jsxs("div",{className:"text-center text-xs text-gray-500",children:[e.jsx("p",{children:"Problemy z logowaniem?"}),e.jsx(Is,{to:"/contact",className:"text-blue-600 hover:text-blue-500 transition-colors",children:"Skontaktuj się z pomocą techniczną"})]})})]})]})]})})},kd=()=>{const{mutate:s,isLoading:a,error:t}=on(),[r,n]=G.useState(1),[i,l]=G.useState(""),[o,c]=G.useState(""),[m,p]=G.useState(""),[d,u]=G.useState(""),[x,f]=G.useState(""),j=[{value:"beneficiary",label:"Beneficiary",description:"Użytkownik końcowy systemu",icon:Qe},{value:"auditor",label:"Auditor",description:"Audytor z uprawnieniami kontrolnymi",icon:xt}],v=S=>{if(S.preventDefault(),f(""),o!==m){f("Hasła nie są identyczne");return}if(o.length<6){f("Hasło musi mieć co najmniej 6 znaków");return}n(2)},w=()=>{if(!d){f("Wybierz rolę");return}s({email:i,password:o,role:d})},y=S=>{u(S),f("")},C=()=>{n(1),f("")};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"max-w-md w-full space-y-8",children:r===1?e.jsxs(z,{children:[e.jsxs(I,{className:"space-y-1",children:[e.jsx(T,{className:"text-2xl text-center",children:"Zarejestruj się"}),e.jsx(ts,{className:"text-center",children:"Krok 1/2: Podaj swoje dane"})]}),e.jsxs(k,{children:[e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{htmlFor:"email",children:"Email"}),e.jsx(D,{id:"email",type:"email",placeholder:"przykład@email.com",value:i,onChange:S=>l(S.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{htmlFor:"password",children:"Hasło"}),e.jsx(D,{id:"password",type:"password",placeholder:"Minimum 6 znaków",value:o,onChange:S=>c(S.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{htmlFor:"confirmPassword",children:"Potwierdź hasło"}),e.jsx(D,{id:"confirmPassword",type:"password",placeholder:"Powtórz hasło",value:m,onChange:S=>p(S.target.value),required:!0})]}),x&&e.jsx(te,{variant:"destructive",children:e.jsx(ae,{children:x})}),e.jsx(g,{type:"submit",className:"w-full",children:"Dalej"})]}),e.jsx("div",{className:"mt-4 text-center text-sm",children:e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Masz już konto? Zaloguj się"})})]})]}):e.jsxs(z,{children:[e.jsxs(I,{className:"space-y-1",children:[e.jsx(T,{className:"text-2xl text-center",children:"Wybierz rolę"}),e.jsx(ts,{className:"text-center",children:"Krok 2/2: Jaka jest Twoja rola w systemie?"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsx("div",{className:"space-y-3",children:j.map(S=>{const W=S.icon;return e.jsx("div",{onClick:()=>y(S.value),className:`p-4 border-2 rounded-lg cursor-pointer transition-all hover:bg-gray-50 ${d===S.value?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(W,{className:`h-6 w-6 mt-1 ${d===S.value?"text-blue-600":"text-gray-400"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-medium ${d===S.value?"text-blue-900":"text-gray-900"}`,children:S.label}),e.jsx("p",{className:`text-sm ${d===S.value?"text-blue-700":"text-gray-500"}`,children:S.description})]})]})},S.value)})}),x&&e.jsx(te,{variant:"destructive",children:e.jsx(ae,{children:x})}),t&&e.jsx(te,{variant:"destructive",children:e.jsx(ae,{children:t?.message||"Błąd rejestracji"})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(g,{variant:"outline",onClick:C,className:"flex-1",disabled:a,children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Wstecz"]}),e.jsxs(g,{onClick:w,className:"flex-1",disabled:a||!d,children:[a&&e.jsx(os,{className:"mr-2 h-4 w-4 animate-spin"}),"Zarejestruj się"]})]})]})]})})})},Cd=()=>{const{mutate:s,isLoading:a,error:t,isSuccess:r}=cn(),[n,i]=G.useState(""),l=o=>{o.preventDefault(),s({email:n})};return r?e.jsx(Me,{children:e.jsxs(z,{children:[e.jsxs(I,{className:"space-y-1",children:[e.jsxs(T,{className:"text-2xl text-center flex items-center justify-center gap-2",children:[e.jsx(Ve,{className:"h-6 w-6 text-green-500"}),"Email wysłany"]}),e.jsx(ts,{className:"text-center",children:"Sprawdź swoją skrzynkę odbiorczą"})]}),e.jsxs(k,{children:[e.jsx(te,{children:e.jsxs(ae,{children:["Wysłaliśmy link do resetowania hasła na adres ",e.jsx("strong",{children:n}),". Sprawdź swoją skrzynkę odbiorczą i kliknij w link, aby zresetować hasło."]})}),e.jsx("div",{className:"text-center",children:e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Powrót do logowania"})})]})]})}):e.jsx(Me,{children:e.jsxs(z,{children:[e.jsxs(I,{className:"space-y-1",children:[e.jsx(T,{className:"text-2xl text-center",children:"Resetuj hasło"}),e.jsx(ts,{className:"text-center",children:"Wprowadź swój email, aby otrzymać link do resetowania hasła"})]}),e.jsxs(k,{children:[e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{htmlFor:"email",children:"Email"}),e.jsx(D,{id:"email",type:"email",placeholder:"przykład@email.com",value:n,onChange:o=>i(o.target.value),required:!0})]}),t&&e.jsx(te,{variant:"destructive",children:e.jsx(ae,{children:t.message||"Błąd podczas wysyłania emaila"})}),e.jsxs(g,{type:"submit",className:"w-full",disabled:a,children:[a&&e.jsx(os,{className:"mr-2 h-4 w-4 animate-spin"}),"Wyślij link resetujący"]})]}),e.jsx("div",{className:"mt-4 text-center text-sm",children:e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Powrót do logowania"})})]})]})})},_d=()=>{const s=B(),{mutate:a,isLoading:t,error:r}=dn(),[n,i]=G.useState(""),[l,o]=G.useState(""),[c,m]=G.useState(""),[p,d]=G.useState(!0),[u,x]=G.useState(!0),[f,j]=G.useState(!1);G.useEffect(()=>{(async()=>{try{const{data:y}=await Y.auth.getSession(),S=new URLSearchParams(window.location.hash.substring(1)).get("type");!y.session&&S!=="recovery"?(console.log("No valid recovery session found"),d(!1),setTimeout(()=>{s("/forgot-password")},3e3)):(console.log("Valid session found"),d(!0))}catch(y){console.error("Session check error:",y),d(!1)}finally{x(!1)}})()},[s]);const v=async w=>{if(w.preventDefault(),m(""),n!==l){m("Hasła nie są identyczne");return}if(n.length<6){m("Hasło musi mieć co najmniej 6 znaków");return}if(n.length>72){m("Hasło nie może być dłuższe niż 72 znaki");return}a({password:n},{onSuccess:()=>{j(!0),setTimeout(()=>{s("/login?passwordChanged=true")},3e3)},onError:y=>{console.error("Password update error:",y),m(y?.message||"Błąd aktualizacji hasła")}})};return u?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(os,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("p",{className:"text-gray-600",children:"Weryfikacja sesji..."})]})}):p?f?e.jsx(Me,{children:e.jsxs(z,{className:"border-green-200",children:[e.jsx(I,{children:e.jsxs(T,{className:"text-2xl text-center flex items-center justify-center gap-2",children:[e.jsx(Ve,{className:"h-6 w-6 text-green-600"}),"Hasło zmienione!"]})}),e.jsx(k,{children:e.jsxs(te,{className:"border-green-200 bg-green-50",children:[e.jsx(Ve,{className:"h-4 w-4 text-green-600"}),e.jsx(ae,{className:"text-green-800",children:"Twoje hasło zostało pomyślnie zmienione. Za chwilę zostaniesz przekierowany do strony logowania..."})]})})]})}):e.jsx(Me,{children:e.jsxs(z,{children:[e.jsxs(I,{className:"space-y-1",children:[e.jsxs(T,{className:"text-2xl text-center flex items-center justify-center gap-2",children:[e.jsx(On,{className:"h-6 w-6"}),"Nowe hasło"]}),e.jsx(ts,{className:"text-center",children:"Wprowadź nowe hasło dla swojego konta"})]}),e.jsxs(k,{children:[e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{htmlFor:"password",children:"Nowe hasło"}),e.jsx(D,{id:"password",type:"password",placeholder:"Minimum 6 znaków",value:n,onChange:w=>i(w.target.value),disabled:t,required:!0,autoFocus:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{htmlFor:"confirmPassword",children:"Potwierdź nowe hasło"}),e.jsx(D,{id:"confirmPassword",type:"password",placeholder:"Powtórz nowe hasło",value:l,onChange:w=>o(w.target.value),disabled:t,required:!0})]}),e.jsxs(te,{children:[e.jsx(ft,{className:"h-4 w-4"}),e.jsxs(ae,{children:[e.jsx("strong",{children:"Wymagania hasła:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 text-sm",children:[e.jsx("li",{children:"Minimum 6 znaków"}),e.jsx("li",{children:"Maksimum 72 znaki"}),e.jsx("li",{children:"Zalecane użycie liter, cyfr i znaków specjalnych"})]})]})]}),(r||c)&&e.jsxs(te,{variant:"destructive",children:[e.jsx(ws,{className:"h-4 w-4"}),e.jsx(ae,{children:c||r?.message||"Błąd aktualizacji hasła"})]}),e.jsxs(g,{type:"submit",className:"w-full",disabled:t,children:[t&&e.jsx(os,{className:"mr-2 h-4 w-4 animate-spin"}),t?"Aktualizowanie...":"Zaktualizuj hasło"]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Pamiętasz hasło?"," ",e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Wróć do logowania"})]})})]})]})}):e.jsx(Me,{children:e.jsx(z,{className:"border-red-200",children:e.jsx(k,{className:"pt-6",children:e.jsxs(te,{variant:"destructive",children:[e.jsx(ws,{className:"h-4 w-4"}),e.jsxs(ae,{children:[e.jsx("strong",{children:"Nieprawidłowa lub wygasła sesja."}),e.jsx("br",{}),"Link do resetowania hasła mógł wygasnąć. Za chwilę zostaniesz przekierowany do strony resetowania hasła..."]})]})})})})},ci=({schemaPath:s,onSubmit:a,submitLabel:t="Dalej",className:r=""})=>{const{getSchemaFragment:n,setData:i,getData:l}=ne(),[o]=s.split("."),[c,m]=G.useState(""),[p,d]=G.useState({}),u=n(s),x=l(o);if(!u)return e.jsx(te,{variant:"destructive",children:e.jsxs(ae,{children:["Nie znaleziono schematu dla ścieżki: ",s]})});const f=w=>{w.preventDefault(),m(""),d({});const y={};if(u.required)for(const C of u.required)x[C]||(y[C]="To pole jest wymagane");if(Object.keys(y).length>0){d(y);return}if(u.validation){const C=u.validation(x);if(C){m(C);return}}a(x)},j=(w,y)=>{i(o,{...x,[w]:y}),p[w]&&d(C=>{const S={...C};return delete S[w],S})},v=(w,y)=>{const C=x[w]||"",S=u.required?.includes(w),W=p[w];switch(y.type){case"text":case"email":case"password":return e.jsx(U,{label:y.title||w,htmlFor:w,error:W,required:S,children:e.jsx(D,{id:w,type:y.type,value:C,placeholder:y.placeholder,onChange:N=>j(w,N.target.value),className:W?"border-red-500":""})},w);case"select":return e.jsx(U,{label:y.title||w,htmlFor:w,error:W,required:S,children:e.jsxs(le,{value:C,onValueChange:N=>j(w,N),children:[e.jsx(re,{className:W?"border-red-500":"",children:e.jsx(oe,{placeholder:y.placeholder||"Wybierz opcję"})}),e.jsx(ie,{children:y.options?.map(N=>e.jsx(E,{value:N.value,children:N.label},N.value))})]})},w);default:return null}};return e.jsxs(z,{className:r,children:[e.jsx(I,{children:e.jsx(T,{children:u.title})}),e.jsx(k,{children:e.jsxs(Ee,{onSubmit:f,children:[e.jsxs(J,{variant:"1-1-1",children:[u.properties&&Object.entries(u.properties).map(([w,y])=>v(w,y)),c&&e.jsx(te,{variant:"destructive",className:"mt-4",children:e.jsx(ae,{children:c})})]}),e.jsx(Re,{className:"mt-6 pt-6",children:e.jsx(g,{type:"submit",className:"w-full sm:w-auto",children:t})})]})})]})},Sd=()=>{const s=B(),{register:a}=ne();h.useEffect(()=>{a({id:"registration",title:"Proces rejestracji",schema:{step1:{title:"Dane podstawowe",type:"object",properties:{email:{type:"email",title:"Email",placeholder:"przykład@email.com"},name:{type:"text",title:"Imię i nazwisko",placeholder:"Jan Kowalski"}},required:["email","name"],validation:r=>r.name&&r.name.trim().length<3?"Imię i nazwisko musi mieć co najmniej 3 znaki":r.name&&!r.name.includes(" ")?"Podaj zarówno imię jak i nazwisko":null},step2:{title:"Hasło",type:"object",properties:{password:{type:"password",title:"Hasło",placeholder:"Minimum 6 znaków"},confirmPassword:{type:"password",title:"Potwierdź hasło",placeholder:"Powtórz hasło"}},required:["password","confirmPassword"],validation:r=>r.password&&r.password.length<6?"Hasło musi mieć co najmniej 6 znaków":r.password!==r.confirmPassword?"Hasła nie są identyczne":null},step3:{title:"Podsumowanie",type:"object",properties:{}}}})},[a]);const t=r=>{console.log("RegisterStep1 - Otrzymane dane z formularza:",r),s("/register/step2")};return e.jsxs(Me,{children:[e.jsxs("div",{className:"flex items-start gap-5 ",children:[e.jsx(ot,{className:"mt-2 bg-white rounded-full p-2 w-12 h-12"}),e.jsx(V,{title:"Rejestracja",description:"1 z 3 Podaj podstawowe informacje"})]}),e.jsx(ci,{schemaPath:"registration.step1",onSubmit:t,submitLabel:"Dalej"}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(Is,{to:"/login",className:"text-blue-600 hover:text-blue-500 text-sm",children:"Masz już konto? Zaloguj się"})})]})},Td=()=>{const s=B(),{setData:a}=ne(),t=n=>{a("registration",n),s("/register/step3")},r=()=>{s("/register/step1")};return e.jsxs(Me,{children:[e.jsxs("div",{className:"flex items-start gap-5 ",children:[e.jsx($n,{className:"mt-2 bg-white rounded-full p-2 w-12 h-12"}),e.jsx(V,{title:"Rejestracja",description:"2 z 3 Ustaw hasło do konta"})]}),e.jsx(ci,{schemaPath:"registration.step2",onSubmit:t,submitLabel:"Dalej"}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsxs(g,{variant:"outline",onClick:r,className:"flex items-center",children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Wstecz"]}),e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500 text-sm",children:"Masz już konto? Zaloguj się"})]})]})},Pd=()=>{const s=B(),{getData:a,setData:t}=ne(),[r,n]=G.useState(!1),[i,l]=G.useState(!1),[o,c]=G.useState(null),m=a("registration"),p=G.useCallback(async()=>{if(!Rt.register){c("Funkcja rejestracji nie jest dostępna");return}if(!m?.email||!m?.password){c("Brak wymaganych danych. Rozpocznij proces rejestracji od początku.");return}n(!0),c(null);try{console.log("📝 Attempting registration with:",{email:m.email,name:m.name});const u=await Rt.register({email:m.email,password:m.password,name:m.name});if(console.log("📝 Registration result:",u),u.success)l(!0),t("registration",{...m,registrationComplete:!0,registrationDate:new Date().toISOString(),user:u.user}),setTimeout(()=>{s("/register/step4")},1500);else{const x=u.error?.message||"Rejestracja nie powiodła się";console.error("❌ Registration failed:",x),c(x)}}catch(u){console.error("❌ Registration error:",u);const x=u?.message||"Wystąpił nieoczekiwany błąd";c(x)}finally{n(!1)}},[m,t,s]),d=G.useCallback(()=>{s("/register/step2")},[s]);return{isLoading:r,isSuccess:i,error:o,register:p,goBack:d,processData:m}},Id=()=>{const s=B(),{isLoading:a,isSuccess:t,error:r,register:n,goBack:i,processData:l}=Pd();return!l||!l.email?e.jsxs(Me,{children:[e.jsx(V,{title:"Rejestracja",description:"Błąd - brak danych"}),e.jsxs(te,{variant:"destructive",children:[e.jsx(ws,{className:"h-4 w-4"}),e.jsx(ae,{children:"Brak danych rejestracji. Rozpocznij proces od początku."})]}),e.jsx(g,{onClick:()=>s("/register/step1"),className:"mt-4",children:"Wróć do kroku 1"})]}):e.jsxs(Me,{children:[e.jsxs("div",{className:"flex items-start gap-5 ",children:[e.jsx(Fn,{className:"mt-2 bg-white rounded-full p-2 w-12 h-12"}),e.jsx(V,{title:"Rejestracja",description:"3 z 4 Potwierdzenie danych"})]}),t&&e.jsxs(te,{className:"mb-4 border-green-200 bg-green-50",children:[e.jsx(ge,{className:"h-4 w-4 text-green-600"}),e.jsxs(ae,{className:"text-green-800",children:[e.jsx("strong",{children:"Rejestracja udana!"})," Za chwilę zostaniesz przekierowany..."]})]}),r&&!t&&e.jsxs(te,{variant:"destructive",className:"mb-4",children:[e.jsx(ws,{className:"h-4 w-4"}),e.jsxs(ae,{children:[e.jsx("strong",{children:"Rejestracja nieudana:"})," ",r]})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(T,{className:"flex items-center",children:[e.jsx(ge,{className:"mr-2 h-5 w-5 text-blue-600"}),"Podsumowanie"]})}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Co się stanie:"}),e.jsxs("ul",{className:"text-sm text-blue-700 mt-2 space-y-1",children:[e.jsx("li",{children:"• Konto zostanie utworzone"}),e.jsx("li",{children:"• Otrzymasz email z potwierdzeniem"}),e.jsx("li",{children:"• Po aktywacji będziesz mógł się zalogować"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(es,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Email"}),e.jsx("p",{className:"text-sm text-gray-600",children:l.email})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Qe,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Imię i nazwisko"}),e.jsx("p",{className:"text-sm text-gray-600",children:l.name})]})]})]}),r&&!t&&e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-sm text-red-800 font-medium",children:"Wskazówki w przypadku problemów:"}),e.jsxs("ul",{className:"text-sm text-red-700 mt-2 space-y-1",children:[e.jsx("li",{children:"• Sprawdź czy email ma prawidłowy format"}),e.jsx("li",{children:"• Upewnij się że hasło spełnia wymagania (6-72 znaków)"}),e.jsx("li",{children:"• Jeśli masz już konto, przejdź do logowania"}),e.jsx("li",{children:"• W przypadku dalszych problemów skontaktuj się z pomocą"})]})]})]})]}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsxs(g,{variant:"outline",onClick:i,disabled:a||t,children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Wstecz"]}),e.jsxs(g,{onClick:n,disabled:a||t,children:[a&&e.jsx(os,{className:"mr-2 h-4 w-4 animate-spin"}),a?"Rejestruję...":t?"Udane!":r?"Spróbuj ponownie":"Zarejestruj się"]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500 text-sm",children:"Masz już konto? Zaloguj się"})})]})},qd=()=>{const s=B(),{getData:a,unregister:t}=ne(),[r,n]=G.useState(!1),[i,l]=G.useState(!1),o=a("registration"),c=o?.email||"user@example.com",m=o?.name||"Użytkownik";G.useEffect(()=>{const u=setTimeout(()=>{t("registration","data")},3e4);return()=>clearTimeout(u)},[t]);const p=async()=>{n(!0);try{await new Promise(u=>setTimeout(u,2e3)),l(!0),setTimeout(()=>l(!1),3e3)}catch(u){console.error("Błąd wysyłania maila:",u)}finally{n(!1)}},d=()=>{t("registration","data"),s("/login")};return e.jsxs(Me,{children:[e.jsx(V,{title:"Rejestracja zakończona!",description:"4 z 4 Sprawdź swoją skrzynkę mailową"}),e.jsxs(z,{className:"border-green-200 bg-green-50",children:[e.jsx(I,{children:e.jsxs(T,{className:"flex items-center text-green-800",children:[e.jsx(Ve,{className:"mr-2 h-6 w-6 text-green-600"}),"Konto zostało utworzone!"]})}),e.jsx(k,{className:"space-y-4",children:e.jsxs("div",{className:"text-green-700",children:[e.jsx("p",{className:"font-medium",children:"Gratulacje! Twoje konto zostało pomyślnie utworzone."}),e.jsxs("p",{className:"text-sm mt-1",children:["Wysłaliśmy email z potwierdzeniem na adres ",e.jsx("strong",{children:c})]})]})})]}),e.jsxs(z,{children:[e.jsx(I,{children:e.jsxs(T,{className:"flex items-center",children:[e.jsx(Qe,{className:"mr-2 h-5 w-5"}),"Podsumowanie konta"]})}),e.jsxs(k,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(es,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Adres email"}),e.jsx("p",{className:"text-sm text-gray-600",children:c})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Qe,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Imię i nazwisko"}),e.jsx("p",{className:"text-sm text-gray-600",children:m})]})]})]})]}),e.jsxs(z,{className:"border-blue-200",children:[e.jsx(I,{children:e.jsxs(T,{className:"flex items-center text-blue-800",children:[e.jsx(es,{className:"mr-2 h-5 w-5 text-blue-600"}),"Co dalej?"]})}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Sprawdź swoją skrzynkę mailową"}),e.jsxs("p",{className:"text-gray-600",children:["Email potwierdzający został wysłany na adres ",e.jsx("strong",{children:c})]})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Kliknij link w emailu"}),e.jsx("p",{className:"text-gray-600",children:"Aktywuj swoje konto klikając w link potwierdzający"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Zaloguj się do systemu"}),e.jsx("p",{className:"text-gray-600",children:"Po aktywacji możesz się zalogować używając swojego emailu i hasła"})]})]})]}),e.jsxs(te,{children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsxs(ae,{children:[e.jsx("strong",{children:"Ważne:"})," Email może dotrzeć w ciągu kilku minut. Sprawdź także folder SPAM/Niechciane."]})]})]})]}),e.jsx(z,{children:e.jsx(k,{className:"pt-6",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Nie otrzymałeś emaila?"}),i&&e.jsxs(te,{className:"border-green-200 bg-green-50",children:[e.jsx(Ve,{className:"h-4 w-4 text-green-600"}),e.jsx(ae,{className:"text-green-800",children:"Email został wysłany ponownie!"})]}),e.jsxs(g,{variant:"outline",onClick:p,disabled:r,className:"w-full sm:w-auto",children:[r&&e.jsx(Os,{className:"mr-2 h-4 w-4 animate-spin"}),r?"Wysyłanie...":"Wyślij email ponownie"]})]})})}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs(g,{onClick:d,className:"w-full",size:"lg",children:["Przejdź do logowania",e.jsx(Ke,{className:"ml-2 h-4 w-4"})]}),e.jsx("div",{className:"text-center",children:e.jsx("a",{href:"/help",className:"text-blue-600 hover:text-blue-500 text-sm",children:"Potrzebujesz pomocy? Skontaktuj się z nami"})})]})]})},Md=[e.jsx(L,{path:"/login",element:e.jsx(zd,{})},"auth-login"),e.jsx(L,{path:"/register",element:e.jsx(kd,{})},"auth-register"),e.jsx(L,{path:"/forgot-password",element:e.jsx(Cd,{})},"auth-forgot-password"),e.jsx(L,{path:"/update-password",element:e.jsx(_d,{})},"auth-update-password"),e.jsx(L,{path:"/register/step1",element:e.jsx(Sd,{})},"auth-register-1"),e.jsx(L,{path:"/register/step2",element:e.jsx(Td,{})},"auth-register-2"),e.jsx(L,{path:"/register/step3",element:e.jsx(Id,{})},"auth-register-3"),e.jsx(L,{path:"/register/step4",element:e.jsx(qd,{})},"auth-register-4")],Ld=()=>{const s=B(),[a,t]=h.useState(0),[r,n]=h.useState("");h.useEffect(()=>{const l=()=>t(window.scrollY);return window.addEventListener("scroll",l),()=>window.removeEventListener("scroll",l)},[]);const i=[{name:"Sty",value:65},{name:"Lut",value:72},{name:"Mar",value:78},{name:"Kwi",value:85},{name:"Maj",value:88},{name:"Cze",value:94}];return e.jsxs("div",{className:"min-h-screen bg-white text-foreground",children:[e.jsx("nav",{className:"fixed top-0 w-full z-50 bg-white/80 backdrop-blur-xl border-b border-gray-100",children:e.jsx("div",{className:"container mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-600 to-purple-700 rounded-xl flex items-center justify-center",children:e.jsx(be,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-xl font-bold",children:"Smart Up"})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-8",children:[e.jsx("a",{href:"#funkcje",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Funkcje"}),e.jsx("a",{href:"#kursy",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Kursy"}),e.jsx("a",{href:"#firma",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Dla firm"}),e.jsx("a",{href:"#cennik",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Cennik"}),e.jsx(g,{className:"bg-gray-900 hover:bg-gray-800 text-white text-sm px-6",onClick:()=>s("/login"),children:"Rozpocznij"})]})]})})}),e.jsx("section",{className:"pt-32 pb-20 overflow-hidden",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"grid lg:grid-cols-12 gap-8 items-center",children:[e.jsxs("div",{className:"lg:col-span-5",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-50 rounded-full mb-8",children:[e.jsx(Qt,{className:"w-4 h-4 text-purple-700"}),e.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Gamifikacja w edukacji"})]}),e.jsxs("h1",{className:"text-5xl md:text-6xl font-bold leading-tight mb-6",children:["Nauka, która",e.jsx("span",{className:"block text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"motywuje"})]}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:"Przekształć edukację w angażującą przygodę. System poziomów, punktów i nagród sprawia, że nauka staje się uzależniająca."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-12",children:[e.jsxs(g,{size:"lg",className:"bg-gray-900 hover:bg-gray-800 text-white px-8",onClick:()=>s("/login"),children:["Zacznij za darmo",e.jsx(Ke,{className:"ml-2 h-4 w-4"})]}),e.jsx(g,{size:"lg",variant:"outline",className:"border-gray-300",children:"Zobacz demo"})]}),e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"15k+"}),e.jsx("div",{className:"text-sm text-gray-500",children:"aktywnych uczniów"})]}),e.jsx("div",{className:"w-px h-12 bg-gray-200"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"92%"}),e.jsx("div",{className:"text-sm text-gray-500",children:"ukończalność"})]}),e.jsx("div",{className:"w-px h-12 bg-gray-200"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"4.9"}),e.jsx("div",{className:"text-sm text-gray-500",children:"ocena"})]})]})]}),e.jsx("div",{className:"lg:col-span-7",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-4 bg-gradient-to-r from-pink-600/5 to-purple-700/5 rounded-3xl blur-2xl"}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-pink-600 to-purple-700 rounded-lg flex items-center justify-center",children:e.jsx(be,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:"font-semibold",children:"Dashboard ucznia"})]}),e.jsx(Q,{className:"bg-green-50 text-green-700 border-green-200",children:"Online"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-pink-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Ls,{className:"w-5 h-5 text-pink-600"}),e.jsx("span",{className:"text-xs text-gray-500",children:"+125"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"1,842"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Punkty XP"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx($e,{className:"w-5 h-5 text-purple-700"}),e.jsx("span",{className:"text-xs text-gray-500",children:"75%"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"Lvl 12"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Poziom"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-teal-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Ms,{className:"w-5 h-5 text-teal-600"}),e.jsx("span",{className:"text-xs text-gray-500",children:"New!"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"24"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Odznaki"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Postęp nauki"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Ostatnie 6 miesięcy"})]}),e.jsx(Wn,{width:"100%",height:120,children:e.jsxs(Un,{data:i,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorProgress",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#db2777",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#db2777",stopOpacity:0})]})}),e.jsx(Gn,{type:"monotone",dataKey:"value",stroke:"#db2777",strokeWidth:2,fill:"url(#colorProgress)"}),e.jsx(Bn,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fontSize:11}}),e.jsx(Kn,{hide:!0})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Aktywne kursy"}),e.jsx("a",{href:"#",className:"text-purple-700 hover:underline",children:"Zobacz wszystkie"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-600 to-purple-700 rounded-lg flex items-center justify-center",children:e.jsx(Et,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:"JavaScript: Gra w kodowanie"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Rozdział 4 z 12"})]})]}),e.jsx(ns,{className:"w-4 h-4 text-gray-400"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-teal-500 to-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(na,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:"Analiza danych: Quest"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Rozdział 7 z 10"})]})]}),e.jsx(ns,{className:"w-4 h-4 text-gray-400"})]})]})]})]})]})]})})]})})}),e.jsx("section",{id:"funkcje",className:"py-20 bg-gray-50",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Funkcje, które"," ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"angażują"})]}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"System zaprojektowany, aby uczynić naukę uzależniającą jak najlepsza gra"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-pink-600/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-pink-600 to-purple-700 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(be,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"System poziomów"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"99 poziomów do zdobycia. Każdy poziom odblokowuje nowe możliwości i nagrody."}),e.jsxs("div",{className:"flex items-center text-sm text-pink-600 font-medium",children:["Dowiedz się więcej",e.jsx(Ke,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-700/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-700 to-teal-500 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(Ls,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Idle Points"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Zdobywaj punkty nawet gdy nie uczysz się aktywnie. System pasywnego rozwoju."}),e.jsxs("div",{className:"flex items-center text-sm text-purple-700 font-medium",children:["Dowiedz się więcej",e.jsx(Ke,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-teal-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-teal-500 to-blue-600 rounded-2xl flex items-center justify-center mb-6",children:e.jsx($e,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Wyzwania"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Codzienne i tygodniowe wyzwania z dodatkowymi nagrodami za ukończenie."}),e.jsxs("div",{className:"flex items-center text-sm text-teal-600 font-medium",children:["Dowiedz się więcej",e.jsx(Ke,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-orange-500 to-yellow-500 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(je,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Rankingi"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Rywalizuj z innymi uczniami. Rankingi globalne, lokalne i grupowe."}),e.jsxs("div",{className:"flex items-center text-sm text-orange-600 font-medium",children:["Dowiedz się więcej",e.jsx(Ke,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-700/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-700 to-pink-600 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(Ms,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Odznaki"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Kolekcjonuj unikalne odznaki za osiągnięcia i kamienie milowe."}),e.jsxs("div",{className:"flex items-center text-sm text-purple-700 font-medium",children:["Dowiedz się więcej",e.jsx(Ke,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-teal-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-teal-500 to-purple-700 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(na,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Analityka"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Szczegółowe statystyki postępów i personalizowane rekomendacje."}),e.jsxs("div",{className:"flex items-center text-sm text-teal-600 font-medium",children:["Dowiedz się więcej",e.jsx(Ke,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]})]})]})}),e.jsx("section",{className:"py-20 bg-white",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"max-w-3xl mx-auto text-center mb-16",children:[e.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Jak to"," ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"działa"})]}),e.jsx("p",{className:"text-lg text-gray-600",children:"Cztery proste kroki do rozpoczęcia nauki z gamifikacją"})]}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 top-0 bottom-0 w-0.5 bg-gray-200"}),e.jsx("div",{className:"space-y-12",children:[{number:"01",title:"Stwórz profil",description:"Wybierz swoją rolę i spersonalizuj doświadczenie nauki",icon:je,color:"from-pink-600 to-purple-700"},{number:"02",title:"Wybierz kursy",description:"Przeglądaj bibliotekę kursów i wybierz te, które Cię interesują",icon:fs,color:"from-purple-700 to-teal-500"},{number:"03",title:"Ucz się i graj",description:"Rozwiązuj quizy, zdobywaj punkty i awansuj na kolejne poziomy",icon:Et,color:"from-teal-500 to-blue-600"},{number:"04",title:"Śledź postępy",description:"Monitoruj swoje osiągnięcia i rywalizuj z innymi",icon:jt,color:"from-orange-500 to-yellow-500"}].map((l,o)=>e.jsx("div",{className:"relative",children:e.jsxs("div",{className:`flex items-center ${o%2===0?"flex-row":"flex-row-reverse"}`,children:[e.jsxs("div",{className:`w-5/12 ${o%2===0?"text-right pr-8":"text-left pl-8"}`,children:[e.jsxs("div",{className:`inline-flex items-center gap-4 mb-2 ${o%2===0?"flex-row-reverse":""}`,children:[e.jsx("h3",{className:"text-2xl font-bold",children:l.title}),e.jsx("span",{className:"text-4xl font-bold text-gray-200",children:l.number})]}),e.jsx("p",{className:"text-gray-600 text-lg",children:l.description})]}),e.jsx("div",{className:"w-2/12 flex justify-center",children:e.jsx("div",{className:`relative z-10 w-16 h-16 bg-gradient-to-br ${l.color} rounded-2xl flex items-center justify-center shadow-lg`,children:e.jsx(l.icon,{className:"w-8 h-8 text-white"})})}),e.jsx("div",{className:"w-5/12"})]})},o))})]})})]})}),e.jsx("section",{className:"py-20 bg-gradient-to-br from-gray-900 to-gray-800",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsx("div",{className:"grid md:grid-cols-4 gap-8",children:[{value:"15k+",label:"Aktywnych uczniów",icon:je},{value:"200+",label:"Kursów",icon:fs},{value:"92%",label:"Ukończalność",icon:$e},{value:"4.9/5",label:"Ocena",icon:Ja}].map((l,o)=>e.jsxs("div",{className:"text-center",children:[e.jsx(l.icon,{className:"w-8 h-8 mx-auto mb-4 text-white/60"}),e.jsx("div",{className:"text-4xl font-bold text-white mb-2",children:l.value}),e.jsx("div",{className:"text-sm text-white/60",children:l.label})]},o))})})}),e.jsx("section",{className:"py-20 bg-white",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsxs("h2",{className:"text-4xl font-bold mb-6",children:["Gotowy na naukę, która"," ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"wciąga"}),"?"]}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 max-w-2xl mx-auto",children:"Dołącz do tysięcy uczniów, którzy odkryli radość z nauki dzięki gamifikacji. Pierwsze 30 dni gratis."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8",children:[e.jsx(D,{type:"email",placeholder:"twoj@email.pl",value:r,onChange:l=>n(l.target.value),className:"max-w-xs h-12"}),e.jsxs(g,{size:"lg",className:"bg-gradient-to-r from-pink-600 to-purple-700 hover:opacity-90 text-white px-8 h-12",onClick:()=>s("/login"),children:["Rozpocznij za darmo",e.jsx(Ke,{className:"ml-2 h-4 w-4"})]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Bez karty kredytowej • Anuluj w każdej chwili • Pełny dostęp"})]})})}),e.jsx("footer",{className:"bg-gray-900 text-white py-12",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center",children:e.jsx(be,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-lg font-bold",children:"Smart Up"})]}),e.jsx("div",{className:"text-sm text-white/60",children:"© 2025 Smart Up. Wszystkie prawa zastrzeżone."})]})})})]})},Dt=()=>{const{data:s}=Ne();return s?.role==="student"?e.jsx(gs,{to:"/student/dashboard",replace:!0}):e.jsx(gs,{to:"/dashboard/overview",replace:!0})};function Dd(){return e.jsx(Ji,{children:e.jsxs(mn,{dataProvider:fn(Y),liveProvider:yn(Y),authProvider:Rt,routerProvider:un,resources:[Il,sc,ic,dc,bc,_c,Pc,Mc,md,Gc,ed],options:{syncWithLocation:!0,warnWhenUnsavedChanges:!0,useNewQueryKeys:!0,liveMode:"auto"},children:[e.jsxs(Yi,{children:[e.jsx(L,{path:"/",element:e.jsx(Ld,{})}),...Md,e.jsxs(L,{element:e.jsx(ia,{fallback:e.jsx(pn,{to:"/login"}),children:e.jsx(Cl,{children:e.jsx(Xi,{})})},"protected-layout"),children:[e.jsx(L,{path:"/admin",element:e.jsx(Dt,{})}),e.jsx(L,{path:"/teacher",element:e.jsx(Dt,{})}),e.jsx(L,{path:"/student",element:e.jsx(gs,{to:"/student/dashboard",replace:!0})}),e.jsx(L,{path:"/dashboard",element:e.jsx(gs,{to:"/dashboard/overview",replace:!0})}),...ql,...tc,...nc,...mc,...pc,...dd,...Uc,...Xc,...vc,...Sc,...Ic,...Lc,...vd,e.jsx(L,{path:"*",element:e.jsx(xn,{})})]}),e.jsx(L,{path:"*",element:e.jsx(ia,{fallback:e.jsx(gs,{to:"/login",replace:!0}),children:e.jsx(Dt,{})},"catch-all-redirect")})]}),e.jsx(hn,{}),e.jsx(jn,{})]})})}const Ed=document.getElementById("root"),Rd=Qn.createRoot(Ed);Rd.render(e.jsxs(G.StrictMode,{children:[e.jsx(Dd,{}),e.jsx(sn,{position:"top-right",richColors:!0,closeButton:!0,duration:4e3,toastOptions:{style:{width:"500px",fontSize:"20px"},className:"sonner-toast"}})]}));
