var Vt=Object.defineProperty;var Kt=(s,a,t)=>a in s?Vt(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;var xs=(s,a,t)=>Kt(s,typeof a!="symbol"?a+"":a,t);import{j as e,R as ya,I as Na,F as va,S as Hs,a as ba,P as Gt,C as za,b as ka,V as Jt,c as Yt,d as _a,e as Qt,T as Sa,f as Xt,g as Ca,h as Pa,i as er,k as Da,l as sr,L as Ea,m as Ma,n as ar,o as tr,p as La,q as rr,r as ir,s as Aa,t as Ra,u as Fa,v as Ta,w as nr,x as ws,y as lr,z as Ia,A as Oa,B as Wa,D as or,E as cr,G as dr,H as $a,J as qa,O as Vs,K as Ba,W as mr,M as Ks,N as xr,Q as Gs,U as Js,X as Ys,Y as Ua,Z as ur,_ as Za,$ as Ha,a0 as hr}from"./radix-ui-DedCFw0E.js";import{l as pr,a as o,n as jr,R as K,e as Ce,o as Y,u as Va,p as fr,N as ps,L as as,B as gr,q as wr,O as yr}from"./react-vendor-SRHEfJrM.js";import{n as je,M as Nr,d as vr,e as br,f as Ae,I as ys,i as Ka,A as Ga,j as zr,H as kr,w as _r,k as Sr,l as Cr,m as Pr,o as Dr,D as Er,p as Mr,E as da,t as Lr,_ as Ar,u as Rr}from"./refine-core-CKzjke6J.js";import{c as Fr,C as cs,b as Tr,I as Ir}from"./refine-ui-C2LA29T8.js";import{t as Or,c as Wr,U as Le,a as ds,C as Ja,b as $r,d as js,M as Ya,X as Ns,L as qr,e as Qa,f as pe,g as Ne,T as Xa,G as Be,P as fs,S as et,h as Qe,i as ve,R as Qs,A as Ie,j as Xs,E as Fs,k as ma,l as Ts,m as gs,n as se,o as $e,H as Cs,p as ge,q as ts,r as Oe,s as Is,u as is,v as vs,F as st,w as Ke,x as Me,D as Os,y as at,z as ns,B as tt,I as rt,J as Ws,K as Te,N as ea,O as ls,Q as Br,V as ze,W as $s,Y as Ps,Z as Ur,_ as Zr,$ as Hr,a0 as qs,a1 as Vr,a2 as Ee,a3 as ke,a4 as it,a5 as Kr,a6 as nt,a7 as bs,a8 as Gr,a9 as Jr,aa as Yr,ab as Qr,ac as xa,ad as ua,ae as Xr,af as ei,ag as si,ah as ai,ai as os,aj as ti,ak as ri,al as ii}from"./ui-utils-D8ILBe48.js";import{c as ni,t as H}from"./utils-DZbqrIy0.js";import{b as Ds,i as li,a as es,c as ss,d as oi,f as J,s as Es,e as Ms,g as us,h as ha,j as Ls,k as pa,l as ja}from"./date-B5YLnBue.js";import{R as ci,B as di,C as mi,X as xi,Y as ui,T as hi,a as pi}from"./tables-CRDxFrVd.js";import"./forms-C0YMKGHR.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();var hs={},fa;function ji(){if(fa)return hs;fa=1;var s=pr();return hs.createRoot=s.createRoot,hs.hydrateRoot=s.hydrateRoot,hs}var fi=ji();const gi="https://xnvmllbnskoigoineyni.supabase.co",wi="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhudm1sbGJuc2tvaWdvaW5leW5pIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyMDc0NTcsImV4cCI6MjA2ODc4MzQ1N30.98-aRoqw4hnlkb2NPCp8-qZzSCPCZycocMa0c5LCc14",I=Fr(gi,wi,{db:{schema:"public"},auth:{persistSession:!0}}),D=(...s)=>Or(Wr(s));class rs extends Error{constructor(t,r,i,n){super(t);xs(this,"code");xs(this,"statusCode");xs(this,"details");this.name="AuthError",this.code=r,this.statusCode=i||400,this.details=n}}const Ve={user_already_exists:"Konto z tym adresem email już istnieje.",password_too_short:"Hasło musi mieć co najmniej 6 znaków.",password_too_long:"Hasło nie może być dłuższe niż 72 znaki.",invalid_email:"Nieprawidłowy format adresu email.",over_email_send_rate_limit:"Za szybko! Poczekaj 2 sekundy przed ponowną próbą.",registration_failed:"Rejestracja nie powiodła się.",invalid_credentials:"Nieprawidłowy email lub hasło.",email_not_confirmed:"Potwierdź swój adres email przed zalogowaniem.",user_not_found:"Nie znaleziono użytkownika.",reset_password_rate_limit:"Zbyt wiele prób. Spróbuj ponownie za chwilę.",invalid_recovery_token:"Link do resetowania hasła wygasł lub jest nieprawidłowy.",update_failed:"Aktualizacja nie powiodła się.",session_expired:"Sesja wygasła. Zaloguj się ponownie.",oauth_error:"Błąd podczas logowania przez zewnętrznego dostawcę.",oauth_cancelled:"Logowanie zostało anulowane.",unknown_error:"Wystąpił nieoczekiwany błąd. Spróbuj ponownie.",network_error:"Błąd połączenia. Sprawdź swoje połączenie internetowe."},ne=s=>{if(!s)return new rs(Ve.unknown_error,"unknown_error");if(s instanceof rs)return s;const a=s.message||s.error_description||"",t=s.code||s.error||"";let r="unknown_error",i=Ve.unknown_error,n=400;if(t)switch(t){case"user_already_exists":case"user_already_registered":r="user_already_exists",n=409;break;case"weak_password":r="password_too_short",n=422;break;case"invalid_email":r="invalid_email",n=422;break;case"over_email_send_rate_limit":r="over_email_send_rate_limit",n=429;break;case"invalid_credentials":r="invalid_credentials",n=401;break;case"email_not_confirmed":r="email_not_confirmed",n=403;break;case"session_not_found":r="session_expired",n=401;break}return r==="unknown_error"&&(a.includes("User already registered")||a.includes("already exists")?(r="user_already_exists",n=409):a.includes("Password should be at least")?(r="password_too_short",n=422):a.includes("Password cannot be longer than 72")?(r="password_too_long",n=422):a.includes("Invalid email")?(r="invalid_email",n=422):a.includes("over_email_send_rate_limit")?(r="over_email_send_rate_limit",n=429):a.includes("Invalid login credentials")?(r="invalid_credentials",n=401):a.includes("Email not confirmed")?(r="email_not_confirmed",n=403):a.includes("Network request failed")&&(r="network_error",n=503)),i=Ve[r]||a||Ve.unknown_error,new rs(i,r,n,{originalError:a,originalCode:t})},ga=s=>Ve[s]||Ve.unknown_error,Bs={login:async({email:s,password:a,providerName:t})=>{try{if(t){const{data:c,error:u}=await I.auth.signInWithOAuth({provider:t});return u?{success:!1,error:ne(u)}:{success:!0,redirectTo:c?.url}}const{data:r,error:i}=await I.auth.signInWithPassword({email:s,password:a});if(i)return{success:!1,error:ne(i)};const{data:n}=await I.from("users").select("*").eq("id",r.user.id).single();return{success:!0,redirectTo:`/${n?.role}`||"/"}}catch(r){return{success:!1,error:ne(r)}}},register:async({email:s,password:a,role:t,operator_id:r})=>{try{const{data:i,error:n}=await I.auth.signUp({email:s,password:a,options:{data:{role:t,...r&&{operator_id:r}}}});return n?{success:!1,error:ne(n)}:i?.user?i.user.identities&&i.user.identities.length>0?{success:!0,user:i.user,session:i.session}:{success:!1,error:new rs(ga("user_already_exists"),"user_already_exists",409)}:{success:!1,error:new rs(ga("registration_failed"),"registration_failed",400)}}catch(i){return{success:!1,error:ne(i)}}},forgotPassword:async({email:s})=>{try{const{error:a}=await I.auth.resetPasswordForEmail(s,{redirectTo:`${window.location.origin}/update-password`});return a?{success:!1,error:ne(a)}:{success:!0}}catch(a){return{success:!1,error:ne(a)}}},updatePassword:async({password:s})=>{try{const{error:a}=await I.auth.updateUser({password:s});return a?{success:!1,error:ne(a)}:{success:!0,redirectTo:"/"}}catch(a){return{success:!1,error:ne(a)}}},logout:async()=>{try{const{error:s}=await I.auth.signOut();return s?{success:!1,error:ne(s)}:{success:!0,redirectTo:"/login"}}catch(s){return{success:!1,error:ne(s)}}},onError:async s=>({error:ne(s)}),check:async()=>{try{const{data:s}=await I.auth.getSession();return{authenticated:!!s.session}}catch(s){return{authenticated:!1,error:ne(s)}}},getPermissions:async()=>{try{const{data:s,error:a}=await I.auth.getUser();if(a||!s?.user)return console.error("Error getting auth user:",ne(a)),null;const{data:t,error:r}=await I.from("users").select("role").eq("id",s.user.id).single();return r?(console.error("Error getting user role:",ne(r)),null):t?.role||null}catch(s){return console.error("Error in getPermissions:",ne(s)),null}},getIdentity:async()=>{try{const{data:s,error:a}=await I.auth.getUser();if(a||!s?.user)return console.error("Error getting auth user:",ne(a)),null;const{data:t,error:r}=await I.from("users").select("*").eq("id",s.user.id).single();return r?(console.error("Error getting user data:",ne(r)),null):{...t,_timestamp:Date.now()}}catch(s){return console.error("Error in getIdentity:",ne(s)),null}}},Xe=({isLoading:s,isError:a,loadingText:t="Loading...",errorMsg:r="Error loading data"})=>s?e.jsx("div",{className:"p-6 text-gray-600 animate-reverse-pulse",children:t}):a?e.jsx("div",{className:"p-6 text-red-500",children:r}):null;function yi(s,a){let t;try{t=s()}catch{return}return{getItem:i=>{var n;const c=m=>m===null?null:JSON.parse(m,void 0),u=(n=t.getItem(i))!=null?n:null;return u instanceof Promise?u.then(c):c(u)},setItem:(i,n)=>t.setItem(i,JSON.stringify(n,void 0)),removeItem:i=>t.removeItem(i)}}const Us=s=>a=>{try{const t=s(a);return t instanceof Promise?t:{then(r){return Us(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return Us(r)(t)}}}},Ni=(s,a)=>(t,r,i)=>{let n={storage:yi(()=>localStorage),partialize:N=>N,version:0,merge:(N,z)=>({...z,...N}),...a},c=!1;const u=new Set,m=new Set;let p=n.storage;if(!p)return s((...N)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),t(...N)},r,i);const w=()=>{const N=n.partialize({...r()});return p.setItem(n.name,{state:N,version:n.version})},g=i.setState;i.setState=(N,z)=>{g(N,z),w()};const f=s((...N)=>{t(...N),w()},r,i);i.getInitialState=()=>f;let x;const b=()=>{var N,z;if(!p)return;c=!1,u.forEach(y=>{var A;return y((A=r())!=null?A:f)});const l=((z=n.onRehydrateStorage)==null?void 0:z.call(n,(N=r())!=null?N:f))||void 0;return Us(p.getItem.bind(p))(n.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==n.version){if(n.migrate){const A=n.migrate(y.state,y.version);return A instanceof Promise?A.then(h=>[!0,h]):[!0,A]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var A;const[h,_]=y;if(x=n.merge(_,(A=r())!=null?A:f),t(x,!0),h)return w()}).then(()=>{l?.(x,void 0),x=r(),c=!0,m.forEach(y=>y(x))}).catch(y=>{l?.(void 0,y)})};return i.persist={setOptions:N=>{n={...n,...N},N.storage&&(p=N.storage)},clearStorage:()=>{p?.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>b(),hasHydrated:()=>c,onHydrate:N=>(u.add(N),()=>{u.delete(N)}),onFinishHydration:N=>(m.add(N),()=>{m.delete(N)})},n.skipHydration||b(),x||f},vi=Ni;class bi{static async call(a,t,r={}){const n={message:this.interpolateTemplate(t.user,r),...t.system&&{system:t.system},...a.model&&{model:a.model}},c=await fetch(a.endpoint,{method:"POST",headers:{"Content-Type":"application/json",...a.apiKey&&{Authorization:`Bearer ${a.apiKey}`}},body:JSON.stringify(n)});if(!c.ok)throw new Error(`LLM API Error: ${c.status} ${c.statusText}`);const u=await c.json();let m=u.response||u.data||u.text||"";return t.responseFormat==="json"?(m=this.cleanJsonResponse(m),JSON.parse(m)):m}static interpolateTemplate(a,t){return a.replace(/\{\{(\w+)\}\}/g,(r,i)=>t[i]!==void 0?String(t[i]):r)}static cleanJsonResponse(a){return a.replace(/```(?:json)?\s*([\s\S]*?)\s*```/,"$1").trim()}}const Ze=ni()(vi((s,a)=>({processes:{},formData:{},llmOperations:{},registeredLLMOperations:{},register:t=>s(r=>({processes:{...r.processes,[t.id]:t}})),unregister:(t,r="all")=>s(i=>{switch(r){case"all":{const{[t]:n,...c}=i.processes,{[t]:u,...m}=i.formData,p=Object.keys(i.llmOperations).filter(g=>!g.startsWith(`${t}-`)).reduce((g,f)=>(g[f]=i.llmOperations[f],g),{}),w=Object.keys(i.registeredLLMOperations).filter(g=>!g.startsWith(`${t}-`)).reduce((g,f)=>(g[f]=i.registeredLLMOperations[f],g),{});return{processes:c,formData:m,llmOperations:p,registeredLLMOperations:w}}case"data":{const{[t]:n,...c}=i.formData;return{...i,formData:c}}default:return i}}),get:t=>a().processes[t]||null,getSchemaFragment:t=>{const[r,...i]=t.split("."),n=a().processes[r];if(!n)return null;let c=n.schema;for(const u of i)c=c?.[u];return c},setData:(t,r)=>s(i=>({formData:{...i.formData,[t]:{...i.formData[t],...r}}})),getData:t=>a().formData[t]||{},reset:t=>s(r=>({formData:{...r.formData,[t]:{}}})),registerLLMOperation:(t,r)=>s(i=>({registeredLLMOperations:{...i.registeredLLMOperations,[`${t}-${r.id}`]:r}})),unregisterLLMOperation:(t,r)=>s(i=>{const{[`${t}-${r}`]:n,...c}=i.registeredLLMOperations;return{registeredLLMOperations:c}}),executeLLMOperation:async(t,r,i={})=>{const n=`${t}-${r}`,c=a().registeredLLMOperations[n];if(!c)throw new Error(`LLM Operation not found: ${n}`);try{a().setLLMOperationState(t,r,{loading:!0,error:null});const u=a().getData(t),m={...u,...i},p=c.inputMapping?c.inputMapping(m):m,w=await bi.call(c.config,c.prompt,p);if(c.validation&&!c.validation(w))throw new Error("LLM result failed validation");let g=w;return c.outputMapping&&(g=c.outputMapping(w,u),a().setData(t,g)),a().setLLMOperationState(t,r,{loading:!1,error:null,result:w}),w}catch(u){throw a().setLLMOperationState(t,r,{loading:!1,error:u.message||"Unknown error",result:null}),u}},setLLMOperationState:(t,r,i)=>s(n=>({llmOperations:{...n.llmOperations,[`${t}-${r}`]:i}})),getLLMOperationState:(t,r)=>a().llmOperations[`${t}-${r}`]||{loading:!1,error:null},clearLLMOperation:(t,r)=>s(i=>{const{[`${t}-${r}`]:n,...c}=i.llmOperations;return{llmOperations:c}})}),{name:"form-schema-store",version:2,partialize:s=>({processes:s.processes,formData:s.formData})})),zi=(s,a)=>{const{registerLLMOperation:t,unregisterLLMOperation:r,executeLLMOperation:i,getLLMOperationState:n,clearLLMOperation:c}=Ze();return{...n(s,a),registerOperation:f=>{t(s,f)},executeOperation:async f=>await i(s,a,f),clearOperation:()=>{c(s,a)},unregisterOperation:()=>{r(s,a)}}},_e=o.forwardRef(({className:s,...a},t)=>e.jsx(ya,{ref:t,className:D("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...a}));_e.displayName=ya.displayName;const Pe=o.forwardRef(({className:s,...a},t)=>e.jsx(Na,{ref:t,className:D("aspect-square h-full w-full object-cover",s),...a}));Pe.displayName=Na.displayName;const Se=o.forwardRef(({className:s,...a},t)=>e.jsx(va,{ref:t,className:D("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...a}));Se.displayName=va.displayName;function As({className:s,...a}){return e.jsx("div",{className:D("animate-pulse rounded-md bg-primary/10",s),...a})}const ki=({className:s})=>{const{data:a,isLoading:t,error:r}=je();if(t)return e.jsxs("div",{className:`flex items-center space-x-3 p-3 ${s}`,children:[e.jsx(As,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(As,{className:"h-4 w-24"}),e.jsx(As,{className:"h-3 w-16"})]})]});if(r)return e.jsxs("div",{className:`flex items-center space-x-3 p-3 text-destructive ${s}`,children:[e.jsx(Le,{className:"h-6 w-6"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Błąd danych"}),e.jsx("div",{className:"text-xs opacity-70",children:"Nie można pobrać profilu"})]})]});if(!a)return e.jsxs("div",{className:`flex items-center space-x-3 p-3 text-muted-foreground ${s}`,children:[e.jsx(Le,{className:"h-6 w-6"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Brak danych"}),e.jsx("div",{className:"text-xs opacity-70",children:"Użytkownik nieznany"})]})]});const i=(m,p)=>m?m.split(" ").map(w=>w[0]).join("").toUpperCase().slice(0,2):p?p.slice(0,2).toUpperCase():"U",n=a.name||a.email||"Użytkownik",c=i(a.name,a.email),u=a.user_metadata?.role;return e.jsxs("div",{className:`flex items-center space-x-3 p-3 ${s}`,children:[e.jsxs(_e,{className:"h-10 w-10",children:[e.jsx(Pe,{src:a.avatar,alt:n}),e.jsx(Se,{className:"bg-primary text-primary-foreground",children:c})]}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[e.jsx("div",{className:"font-medium text-sm truncate",title:n,children:n}),a.email&&e.jsx("div",{className:"text-xs text-muted-foreground truncate",title:a.email,children:a.email}),u&&e.jsxs("div",{className:"text-xs text-muted-foreground truncate",title:u,children:["Rola: ",u]})]})]})},_i=ds("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),re=o.forwardRef(({className:s,variant:a,...t},r)=>e.jsx("div",{ref:r,role:"alert",className:D(_i({variant:a}),s),...t}));re.displayName="Alert";const Si=o.forwardRef(({className:s,...a},t)=>e.jsx("h5",{ref:t,className:D("mb-1 font-medium leading-none tracking-tight",s),...a}));Si.displayName="AlertTitle";const ie=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:D("text-sm [&_p]:leading-relaxed",s),...a}));ie.displayName="AlertDescription";const Ci=ds("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function R({className:s,variant:a,asChild:t=!1,...r}){const i=t?Hs:"span";return e.jsx(i,{"data-slot":"badge",className:D(Ci({variant:a}),s),...r})}const Pi=o.forwardRef(({...s},a)=>e.jsx("nav",{ref:a,"aria-label":"breadcrumb",...s}));Pi.displayName="Breadcrumb";const Di=o.forwardRef(({className:s,...a},t)=>e.jsx("ol",{ref:t,className:D("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",s),...a}));Di.displayName="BreadcrumbList";const Ei=o.forwardRef(({className:s,...a},t)=>e.jsx("li",{ref:t,className:D("inline-flex items-center gap-1.5",s),...a}));Ei.displayName="BreadcrumbItem";const Mi=o.forwardRef(({asChild:s,className:a,...t},r)=>{const i=s?Hs:"a";return e.jsx(i,{ref:r,className:D("transition-colors hover:text-foreground",a),...t})});Mi.displayName="BreadcrumbLink";const Li=o.forwardRef(({className:s,...a},t)=>e.jsx("span",{ref:t,role:"link","aria-disabled":"true","aria-current":"page",className:D("font-normal text-foreground",s),...a}));Li.displayName="BreadcrumbPage";const sa=ds("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),v=o.forwardRef(({className:s,variant:a,size:t,asChild:r=!1,...i},n)=>{const c=r?Hs:"button";return e.jsx(c,{className:D(sa({variant:a,size:t,className:s})),ref:n,...i})});v.displayName="Button";const L=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:D("rounded-xl border bg-card text-card-foreground shadow flex flex-col overflow-hidden",s),...a}));L.displayName="Card";const U=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:D("flex flex-col space-y-1.5 p-6 pb-3 bg-pink-200/25",s),...a}));U.displayName="CardHeader";const V=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:D("text-lg font-semibold leading-tight tracking-tight pt-3",s),...a}));V.displayName="CardTitle";const We=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:D("text-sm text-muted-foreground",s),...a}));We.displayName="CardDescription";const O=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:D("p-3 lg:p-6 pt-3 space-y-3 flex-1 bg-background",s),...a}));O.displayName="CardContent";const Ai=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:D("flex items-center justify-between p-6 pt-0",s),...a}));Ai.displayName="CardFooter";const Ri=ds("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),M=o.forwardRef(({className:s,...a},t)=>e.jsx(ba,{ref:t,className:D(Ri(),s),...a}));M.displayName=ba.displayName;o.createContext({});o.createContext({});const q=o.forwardRef(({className:s,type:a,...t},r)=>e.jsx("input",{type:a,className:D("flex h-9 w-full rounded-md border border-input bg-background px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...t}));q.displayName="Input";const Fi=o.forwardRef(({className:s,align:a="center",sideOffset:t=4,...r},i)=>e.jsx(Gt,{children:e.jsx(za,{ref:i,align:a,sideOffset:t,className:D("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",s),...r})}));Fi.displayName=za.displayName;const Ue=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(ka,{ref:r,className:D("relative overflow-hidden",s),...t,children:[e.jsx(Jt,{className:"h-full w-full rounded-[inherit]",children:a}),e.jsx(lt,{}),e.jsx(Yt,{})]}));Ue.displayName=ka.displayName;const lt=o.forwardRef(({className:s,orientation:a="vertical",...t},r)=>e.jsx(_a,{ref:r,orientation:a,className:D("flex touch-none select-none transition-colors",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...t,children:e.jsx(Qt,{className:"relative flex-1 rounded-full bg-border"})}));lt.displayName=_a.displayName;const ce=rr,de=ir,le=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Sa,{ref:r,className:D("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...t,children:[a,e.jsx(Xt,{asChild:!0,children:e.jsx(Ja,{className:"h-4 w-4 opacity-50"})})]}));le.displayName=Sa.displayName;const ot=o.forwardRef(({className:s,...a},t)=>e.jsx(Ca,{ref:t,className:D("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx($r,{className:"h-4 w-4"})}));ot.displayName=Ca.displayName;const ct=o.forwardRef(({className:s,...a},t)=>e.jsx(Pa,{ref:t,className:D("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Ja,{className:"h-4 w-4"})}));ct.displayName=Pa.displayName;const oe=o.forwardRef(({className:s,children:a,position:t="popper",...r},i)=>e.jsx(er,{children:e.jsxs(Da,{ref:i,className:D("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:t,...r,children:[e.jsx(ot,{}),e.jsx(sr,{className:D("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(ct,{})]})}));oe.displayName=Da.displayName;const Ti=o.forwardRef(({className:s,...a},t)=>e.jsx(Ea,{ref:t,className:D("px-2 py-1.5 text-sm font-semibold",s),...a}));Ti.displayName=Ea.displayName;const W=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Ma,{ref:r,className:D("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ar,{children:e.jsx(js,{className:"h-4 w-4"})})}),e.jsx(tr,{children:a})]}));W.displayName=Ma.displayName;const Ii=o.forwardRef(({className:s,...a},t)=>e.jsx(La,{ref:t,className:D("-mx-1 my-1 h-px bg-muted",s),...a}));Ii.displayName=La.displayName;const he=o.forwardRef(({className:s,orientation:a="horizontal",decorative:t=!0,...r},i)=>e.jsx(Aa,{ref:i,decorative:t,orientation:a,className:D("shrink-0 bg-border",a==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...r}));he.displayName=Aa.displayName;const He=o.forwardRef(({className:s,...a},t)=>e.jsx("textarea",{className:D("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...a}));He.displayName="Textarea";const dt=nr,aa=o.forwardRef(({className:s,...a},t)=>e.jsx(Ra,{ref:t,className:D("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...a}));aa.displayName=Ra.displayName;const Ge=o.forwardRef(({className:s,...a},t)=>e.jsx(Fa,{ref:t,className:D("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...a}));Ge.displayName=Fa.displayName;const Je=o.forwardRef(({className:s,...a},t)=>e.jsx(Ta,{ref:t,className:D("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));Je.displayName=Ta.displayName;var zs="Switch",[Oi,ao]=Ia(zs),[Wi,$i]=Oi(zs),mt=o.forwardRef((s,a)=>{const{__scopeSwitch:t,name:r,checked:i,defaultChecked:n,required:c,disabled:u,value:m="on",onCheckedChange:p,form:w,...g}=s,[f,x]=o.useState(null),b=ws(a,A=>x(A)),N=o.useRef(!1),z=f?w||!!f.closest("form"):!0,[l,y]=lr({prop:i,defaultProp:n??!1,onChange:p,caller:zs});return e.jsxs(Wi,{scope:t,checked:l,disabled:u,children:[e.jsx(Oa.button,{type:"button",role:"switch","aria-checked":l,"aria-required":c,"data-state":pt(l),"data-disabled":u?"":void 0,disabled:u,value:m,...g,ref:b,onClick:Wa(s.onClick,A=>{y(h=>!h),z&&(N.current=A.isPropagationStopped(),N.current||A.stopPropagation())})}),z&&e.jsx(ht,{control:f,bubbles:!N.current,name:r,value:m,checked:l,required:c,disabled:u,form:w,style:{transform:"translateX(-100%)"}})]})});mt.displayName=zs;var xt="SwitchThumb",ut=o.forwardRef((s,a)=>{const{__scopeSwitch:t,...r}=s,i=$i(xt,t);return e.jsx(Oa.span,{"data-state":pt(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:a})});ut.displayName=xt;var qi="SwitchBubbleInput",ht=o.forwardRef(({__scopeSwitch:s,control:a,checked:t,bubbles:r=!0,...i},n)=>{const c=o.useRef(null),u=ws(c,n),m=or(t),p=cr(a);return o.useEffect(()=>{const w=c.current;if(!w)return;const g=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(g,"checked").set;if(m!==t&&x){const b=new Event("click",{bubbles:r});x.call(w,t),w.dispatchEvent(b)}},[m,t,r]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...i,tabIndex:-1,ref:u,style:{...i.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ht.displayName=qi;function pt(s){return s?"checked":"unchecked"}var jt=mt,Bi=ut;const Fe=o.forwardRef(({className:s,...a},t)=>e.jsx(jt,{className:D("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...a,ref:t,children:e.jsx(Bi,{className:D("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Fe.displayName=jt.displayName;const Ui=o.forwardRef(({className:s,sideOffset:a=4,...t},r)=>e.jsx(dr,{children:e.jsx($a,{ref:r,sideOffset:a,className:D("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s),...t})}));Ui.displayName=$a.displayName;const Zi=({onClose:s})=>{const{mutate:a}=Nr(),{menuItems:t}=vr(),{data:r}=je(),i=()=>{s&&s()},n=r?.role,c=t.filter(u=>u.meta?.roles?u.meta.roles.includes(n):!0);return e.jsxs("div",{className:"flex h-full w-64 flex-col border-r bg-background",children:[e.jsxs("div",{className:"flex h-16 items-center justify-between border-b px-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ya,{className:"h-6 w-6 mr-2"}),e.jsx("span",{className:"font-semibold",children:"Dance Hub"})]}),s&&e.jsx(v,{variant:"ghost",size:"sm",onClick:s,className:"lg:hidden",children:e.jsx(Ns,{className:"h-4 w-4"})})]}),e.jsx(Ue,{className:"flex-1 px-3 py-4",children:e.jsx("nav",{className:"space-y-2",children:c.map(u=>e.jsxs(jr,{to:u.route??"/",onClick:i,className:({isActive:m})=>D("flex items-center rounded-md px-3 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground",m?"bg-accent text-accent-foreground":"text-muted-foreground"),children:[u.icon&&e.jsx("span",{className:"mr-3 flex items-center",children:(K.isValidElement(u.icon),u.icon)}),u.label]},u.key))})}),e.jsx(he,{}),e.jsx(ki,{className:"border-b"}),e.jsx("div",{className:"p-4",children:e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>{a(),s&&s()},className:"w-full justify-start",children:[e.jsx(qr,{className:"mr-2 h-4 w-4"}),"Logout"]})})]})},ae=({children:s})=>e.jsx("div",{className:"p-2 md:p-12 space-y-6 max-w-7xl mx-auto",children:s}),Hi=({children:s})=>{const[a,t]=o.useState(!1),r=()=>{t(!a)};return e.jsx("div",{className:"min-h-screen bg-background relative overflow-x-hidden",children:e.jsxs("div",{className:"flex relative",children:[a&&e.jsx("div",{className:"fixed inset-0 z-40 bg-purple-900/20 backdrop-blur-sm lg:hidden",onClick:()=>t(!1)}),e.jsx("aside",{className:`
            h-screen w-64 transform transition-transform duration-300 ease-in-out
            fixed left-0 top-0 z-50
            ${a?"translate-x-0":"-translate-x-full"}
            lg:translate-x-0
            bg-background/95 backdrop-blur-md border-r border-purple-200/20
          `,children:e.jsx(Zi,{onClose:()=>t(!1)})}),e.jsxs("main",{className:"flex-1 lg:ml-64 min-w-0 relative z-10",children:[e.jsxs("div",{className:"sticky top-0 z-30 flex h-16 items-center border-b border-purple-200/20 bg-background/80 backdrop-blur-md px-4 lg:hidden",children:[e.jsx(v,{variant:"ghost",size:"sm",onClick:r,className:"mr-2 hover:bg-purple-100/20 hover:text-purple-700",children:e.jsx(Ya,{className:"h-6 w-6"})}),e.jsx("span",{className:"font-semibold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Dance Hub"})]}),s]})]})})},Vi={"between-center":"flex justify-between items-center gap-2",center:"flex justify-center items-center gap-2",start:"flex justify-start items-center gap-2",end:"flex justify-end items-center gap-2"},te=({children:s,variant:a="between-center",className:t=""})=>{const r=Vi[a],i=t?`${r} ${t}`:r;return e.jsx("div",{className:i,children:s})},Ki={"1-2-3":"grid gap-6 md:grid-cols-2 lg:grid-cols-3","1-2-2":"grid gap-6 md:grid-cols-2","1-1-1":"grid gap-6"},fe=({children:s,variant:a="1-2-3",className:t=""})=>{const r=Ki[a],i=t?`${r} ${t}`:r;return e.jsx("div",{className:i,children:s})},Gi={card:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},lg:{wrap:"space-y-0",title:"text-3xl font-bold tracking-tight",description:"text-muted-foreground"},md:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},sm:{wrap:"space-y-1",title:"font-medium text-sm text-muted-foreground mb-1",description:"text-sm"}},ye=({title:s,description:a,variant:t="lg"})=>{const r=Gi[t],i=()=>{switch(t){case"lg":return e.jsx("h1",{className:r.title,children:s});case"md":return e.jsx("h2",{className:r.title,children:s});case"sm":return e.jsx("h3",{className:r.title,children:s});default:return e.jsx("h1",{className:r.title,children:s})}};return t==="card"?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"text-lg font-semibold leading-tight flex items-center gap-2",children:s}),e.jsx(We,{className:"text-sm text-muted-foreground mt-2",children:a})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:r.wrap,children:[i(),e.jsx("p",{className:`prose ${r.description}`,children:a})]})})},ks=({children:s,onSubmit:a,className:t="",...r})=>{const i="space-y-6",n=t?`${i} ${t}`:i;return e.jsx("form",{onSubmit:a,className:n,...r,children:s})},ee=({children:s,label:a,htmlFor:t,error:r,required:i=!1,className:n=""})=>{const c="space-y-2",u=n?`${c} ${n}`:c,m=()=>a?typeof a=="string"?e.jsxs(M,{htmlFor:t,children:[a,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):e.jsxs(M,{htmlFor:t,className:"flex items-center",children:[a,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):null,p=o.isValidElement(s)?o.cloneElement(s,{className:`${s.props.className||""} ${r?"border-red-500 ring-1 ring-red-500":""}`.trim()}):s;return e.jsxs("div",{className:u,children:[m(),p,r&&e.jsx("p",{className:"text-sm text-red-500",children:r})]})},_s=({children:s,className:a=""})=>{const t="flex justify-end items-center gap-4 pt-6 border-t",r=a?`${t} ${a}`:t;return e.jsx("div",{className:r,children:s})},Ji=()=>{const{data:s,isLoading:a}=je(),t=Ce(),[r,i]=o.useState(null),[n,c]=o.useState([]),[u,m]=o.useState([]),[p,w]=o.useState(!1),[g,f]=o.useState(null),[x,b]=o.useState(!1),[N,z]=o.useState(null),[l,y]=o.useState(!1),A=o.useRef(null),{mutate:h}=br(),{register:_,handleSubmit:F,setValue:Z,watch:B,reset:j,formState:{errors:C,isSubmitting:E}}=cs();o.useEffect(()=>{s?.id&&(w(!0),f(null),I.from("users").select("*").eq("id",s.id).single().then(({data:S,error:T})=>{T?(console.error("Error fetching user:",T),f("Nie udało się pobrać danych użytkownika")):S&&(i(S),j(S),S.profile_photo_url&&z(S.profile_photo_url))}),I.from("user_dance_styles").select(`
          *,
          dance_style:dance_styles(*)
        `).eq("user_id",s.id).order("created_at",{ascending:!1}).then(({data:S,error:T})=>{T?console.error("Error fetching user dance styles:",T):S&&c(S),w(!1)}),I.from("dance_styles").select("*").eq("is_active",!0).order("name").then(({data:S,error:T})=>{T?console.error("Error fetching dance styles:",T):S&&m(S)}))},[s?.id,j]);const P=async S=>{const T=S.target.files?.[0];if(!(!T||!s?.id)){if(T.size>5*1024*1024){alert("Plik jest za duży. Maksymalny rozmiar to 5MB.");return}if(!T.type.startsWith("image/")){alert("Proszę wybrać plik graficzny.");return}b(!0);try{if(r?.profile_photo_url){const ca=r.profile_photo_url.split("/").pop();ca&&await I.storage.from("profile-photos").remove([`${s.id}/${ca}`])}const Q=T.name.split(".").pop(),X=`${Date.now()}.${Q}`,me=`${s.id}/${X}`,{error:xe,data:we}=await I.storage.from("profile-photos").upload(me,T,{cacheControl:"3600",upsert:!1});if(xe)throw xe;const{data:{publicUrl:De}}=I.storage.from("profile-photos").getPublicUrl(me);z(De),Z("profile_photo_url",De);const{error:ms}=await I.from("users").update({profile_photo_url:De}).eq("id",s.id);if(ms)throw ms}catch(Q){console.error("Error uploading photo:",Q),alert("Nie udało się przesłać zdjęcia. Spróbuj ponownie.")}finally{b(!1)}}},d=async()=>{if(!(!s?.id||!r?.profile_photo_url)&&confirm("Czy na pewno chcesz usunąć zdjęcie profilowe?")){b(!0);try{const S=r.profile_photo_url.split("/").pop();S&&await I.storage.from("profile-photos").remove([`${s.id}/${S}`]);const{error:T}=await I.from("users").update({profile_photo_url:null}).eq("id",s.id);if(T)throw T;z(null),Z("profile_photo_url",null)}catch(S){console.error("Error removing photo:",S),alert("Nie udało się usunąć zdjęcia. Spróbuj ponownie.")}finally{b(!1)}}},k=async()=>{if(!s?.id)return;const S=B("new_dance_style_id"),T=B("new_skill_level"),Q=B("new_years_experience"),X=B("new_is_teaching");if(!(!S||!T))try{const{data:me,error:xe}=await I.from("user_dance_styles").insert({user_id:s.id,dance_style_id:S,skill_level:T,years_experience:Q||null,is_teaching:X||!1}).select(`
          *,
          dance_style:dance_styles(*)
        `).single();if(xe)throw xe;me&&(c([...n,me]),y(!1),Z("new_dance_style_id",""),Z("new_skill_level",""),Z("new_years_experience",""),Z("new_is_teaching",!1))}catch(me){console.error("Error adding dance style:",me),alert("Nie udało się dodać stylu tańca. Spróbuj ponownie.")}},$=async S=>{if(confirm("Czy na pewno chcesz usunąć ten styl tańca?"))try{const{error:T}=await I.from("user_dance_styles").delete().eq("id",S);if(T)throw T;c(n.filter(Q=>Q.id!==S))}catch(T){console.error("Error removing dance style:",T),alert("Nie udało się usunąć stylu tańca. Spróbuj ponownie.")}},G=S=>{if(!s?.id)return;const{new_dance_style_id:T,new_skill_level:Q,new_years_experience:X,new_is_teaching:me,...xe}=S;h({resource:"users",id:s.id,values:xe},{onSuccess:()=>{t("/profiles/show")},onError:we=>{console.error("Błąd aktualizacji profilu:",we),alert("Wystąpił błąd podczas zapisywania profilu. Spróbuj ponownie.")}})};return a?e.jsx(ae,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Ładowanie danych użytkownika..."})]})})}):s?.id?p?e.jsx(ae,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Ładowanie profilu..."})]})})}):g?e.jsx(ae,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 text-lg",children:g}),e.jsx(v,{className:"mt-4",onClick:()=>window.location.reload(),children:"Odśwież stronę"})]})})}):e.jsxs(ae,{children:[e.jsx(te,{children:e.jsx(ye,{title:"Mój Profil",description:"Zarządzaj swoimi danymi i preferencjami"})}),e.jsxs(ks,{onSubmit:F(G),children:[e.jsxs(fe,{variant:"1-1-1",children:[e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-5 h-5"}),"Dane podstawowe"]})}),e.jsxs(O,{children:[e.jsx("div",{className:"mb-6",children:e.jsxs(ee,{label:"Zdjęcie profilowe",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(_e,{className:"h-24 w-24",children:[e.jsx(Pe,{src:N||void 0}),e.jsx(Se,{children:r?.name?.charAt(0)?.toUpperCase()||"U"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:A,type:"file",accept:"image/*",onChange:P,className:"hidden"}),e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:()=>A.current?.click(),disabled:x,children:[e.jsx(Qa,{className:"w-4 h-4 mr-2"}),x?"Przesyłanie...":"Zmień zdjęcie"]}),N&&e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:d,disabled:x,children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),"Usuń"]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Dozwolone formaty: JPG, PNG, GIF. Maksymalny rozmiar: 5MB"})]})}),e.jsxs(fe,{variant:"1-2-2",children:[e.jsx(ee,{label:"Imię i nazwisko",htmlFor:"name",error:C.name?.message,required:!0,children:e.jsx(q,{id:"name",..._("name",{required:"Imię jest wymagane"})})}),e.jsx(ee,{label:"Email",htmlFor:"email",error:C.email?.message,required:!0,children:e.jsx(q,{id:"email",type:"email",..._("email",{required:"Email jest wymagany"}),disabled:!0})}),e.jsx(ee,{label:"Data urodzenia",htmlFor:"birth_date",error:C.birth_date?.message,children:e.jsx(q,{id:"birth_date",type:"date",..._("birth_date")})}),e.jsx(ee,{label:"Wzrost (cm)",htmlFor:"height",error:C.height?.message,children:e.jsx(q,{id:"height",type:"number",min:"100",max:"250",..._("height",{min:{value:100,message:"Minimalny wzrost to 100cm"},max:{value:250,message:"Maksymalny wzrost to 250cm"},valueAsNumber:!0})})})]}),e.jsx(ee,{label:"O mnie",htmlFor:"bio",error:C.bio?.message,children:e.jsx(He,{id:"bio",rows:4,placeholder:"Opowiedz coś o sobie...",..._("bio",{maxLength:{value:500,message:"Maksymalnie 500 znaków"}})})}),e.jsxs(fe,{variant:"1-2-2",children:[e.jsx(ee,{label:"Jestem trenerem",children:e.jsxs(te,{variant:"start",children:[e.jsx(Fe,{checked:B("is_trainer")||!1,onCheckedChange:S=>Z("is_trainer",S)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Zaznacz jeśli prowadzisz zajęcia taneczne"})]})}),e.jsx(ee,{label:"Posiadam szkołę tańca",children:e.jsxs(te,{variant:"start",children:[e.jsx(Fe,{checked:B("is_school_owner")||!1,onCheckedChange:S=>Z("is_school_owner",S)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Zaznacz jeśli prowadzisz szkołę tańca"})]})})]})]})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Lokalizacja i prywatność"]})}),e.jsxs(O,{children:[e.jsxs(fe,{variant:"1-2-2",children:[e.jsx(ee,{label:"Miasto",htmlFor:"city",error:C.city?.message,children:e.jsx(q,{id:"city",placeholder:"np. Warszawa",..._("city")})}),e.jsx(ee,{label:"Promień wyszukiwania (km)",htmlFor:"search_radius_km",error:C.search_radius_km?.message,children:e.jsx(q,{id:"search_radius_km",type:"number",min:"5",max:"200",defaultValue:50,..._("search_radius_km",{min:{value:5,message:"Minimum 5km"},max:{value:200,message:"Maksimum 200km"},valueAsNumber:!0})})}),e.jsx(ee,{label:"Widoczność profilu",error:C.visibility?.message,children:e.jsxs(ce,{value:B("visibility")||"public",onValueChange:S=>Z("visibility",S),children:[e.jsx(le,{children:e.jsx(de,{placeholder:"Wybierz widoczność"})}),e.jsxs(oe,{children:[e.jsx(W,{value:"public",children:"Publiczny"}),e.jsx(W,{value:"friends",children:"Tylko znajomi"}),e.jsx(W,{value:"private",children:"Prywatny"})]})]})})]}),e.jsxs(fe,{variant:"1-2-2",children:[e.jsx(ee,{label:"Pokaż wiek",children:e.jsxs(te,{variant:"start",children:[e.jsx(Fe,{checked:B("show_age")!==!1,onCheckedChange:S=>Z("show_age",S)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Twój wiek będzie widoczny w profilu"})]})}),e.jsx(ee,{label:"Pokaż dokładną lokalizację",children:e.jsxs(te,{variant:"start",children:[e.jsx(Fe,{checked:B("show_exact_location")||!1,onCheckedChange:S=>Z("show_exact_location",S)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Pokazuj dokładną lokalizację zamiast tylko miasta"})]})})]})]})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),"Style tańca"]}),n.length>0&&e.jsx(R,{variant:"secondary",children:n.length})]})}),e.jsxs(O,{children:[n.length>0&&e.jsx("div",{className:"space-y-3 mb-4",children:n.map(S=>e.jsxs("div",{className:"p-3 rounded-lg border bg-muted/30",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:S.dance_style?.name||"Nieznany styl"}),S.dance_style?.category&&e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:S.dance_style.category})]}),e.jsx(v,{type:"button",variant:"ghost",size:"sm",onClick:()=>$(S.id),children:e.jsx(Xa,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(R,{variant:"outline",className:"capitalize",children:S.skill_level}),S.is_teaching&&e.jsxs(R,{variant:"secondary",className:"text-xs",children:[e.jsx(Be,{className:"w-3 h-3 mr-1"}),"Uczę"]}),S.years_experience&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["• ",S.years_experience," ",S.years_experience===1?"rok":S.years_experience<5?"lata":"lat"]})]})]},S.id))}),l?e.jsxs("div",{className:"space-y-3 p-4 border rounded-lg bg-muted/20",children:[e.jsxs(fe,{variant:"1-2-2",children:[e.jsx(ee,{label:"Styl tańca",required:!0,children:e.jsxs(ce,{value:B("new_dance_style_id")||"",onValueChange:S=>Z("new_dance_style_id",S),children:[e.jsx(le,{children:e.jsx(de,{placeholder:"Wybierz styl"})}),e.jsx(oe,{children:u.filter(S=>!n.some(T=>T.dance_style_id===S.id)).map(S=>e.jsxs(W,{value:S.id,children:[S.name," ",S.category&&`(${S.category})`]},S.id))})]})}),e.jsx(ee,{label:"Poziom zaawansowania",required:!0,children:e.jsxs(ce,{value:B("new_skill_level")||"",onValueChange:S=>Z("new_skill_level",S),children:[e.jsx(le,{children:e.jsx(de,{placeholder:"Wybierz poziom"})}),e.jsxs(oe,{children:[e.jsx(W,{value:"beginner",children:"Początkujący"}),e.jsx(W,{value:"intermediate",children:"Średniozaawansowany"}),e.jsx(W,{value:"advanced",children:"Zaawansowany"}),e.jsx(W,{value:"professional",children:"Profesjonalny"})]})]})}),e.jsx(ee,{label:"Lata doświadczenia",children:e.jsx(q,{type:"number",min:"0",max:"50",..._("new_years_experience",{valueAsNumber:!0,min:0,max:50})})}),e.jsx(ee,{label:"Uczę tego stylu",children:e.jsxs(te,{variant:"start",children:[e.jsx(Fe,{checked:B("new_is_teaching")||!1,onCheckedChange:S=>Z("new_is_teaching",S)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Zaznacz jeśli uczysz tego stylu"})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{type:"button",size:"sm",onClick:k,disabled:!B("new_dance_style_id")||!B("new_skill_level"),children:"Dodaj styl"}),e.jsx(v,{type:"button",variant:"outline",size:"sm",onClick:()=>{y(!1),Z("new_dance_style_id",""),Z("new_skill_level",""),Z("new_years_experience",""),Z("new_is_teaching",!1)},children:"Anuluj"})]})]}):e.jsxs(v,{type:"button",variant:"outline",size:"sm",onClick:()=>y(!0),className:"w-full",children:[e.jsx(fs,{className:"w-4 h-4 mr-2"}),"Dodaj styl tańca"]})]})]})]}),e.jsxs(_s,{children:[e.jsx(v,{type:"submit",disabled:E,children:E?"Zapisywanie...":"Zapisz zmiany"}),e.jsx(v,{type:"button",variant:"outline",onClick:()=>t("/profiles/show"),disabled:E,children:"Anuluj"})]})]})]}):e.jsx(ae,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 text-lg",children:"Nie można załadować danych użytkownika"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Spróbuj odświeżyć stronę"})]})})})},Yi=()=>{const{data:s,isLoading:a}=je(),t=Ce(),[r,i]=o.useState(null),[n,c]=o.useState([]),[u,m]=o.useState(!1),[p,w]=o.useState(null);if(o.useEffect(()=>{s?.id&&(m(!0),w(null),I.from("users").select("*").eq("id",s.id).single().then(({data:f,error:x})=>{x?(console.error("Error fetching user:",x),w("Nie udało się pobrać danych użytkownika")):f&&i(f)}),I.from("user_dance_styles").select(`
          *,
          dance_style:dance_styles(*)
        `).eq("user_id",s.id).order("created_at",{ascending:!1}).then(({data:f,error:x})=>{x?console.error("Error fetching dance styles:",x):f&&c(f),m(!1)}))},[s?.id]),a)return e.jsx(ae,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Ładowanie danych użytkownika..."})]})})});if(!s?.id)return e.jsx(ae,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 text-lg",children:"Nie można załadować danych użytkownika"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Spróbuj odświeżyć stronę"})]})})});if(u)return e.jsx(ae,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Ładowanie profilu..."})]})})});if(p||!r)return e.jsx(ae,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 text-lg",children:p||"Nie znaleziono profilu"}),e.jsx(v,{className:"mt-4",onClick:()=>window.location.reload(),children:"Odśwież stronę"})]})})});const g=r.birth_date?new Date().getFullYear()-new Date(r.birth_date).getFullYear():null;return e.jsxs(ae,{children:[e.jsxs(te,{children:[e.jsx(ye,{title:"Mój Profil",description:"Podgląd Twojego profilu"}),e.jsxs(v,{onClick:()=>t("/profiles/edit"),children:[e.jsx(et,{className:"w-4 h-4 mr-2"}),"Edytuj profil"]})]}),e.jsxs(fe,{children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-5 h-5"}),"Informacje podstawowe"]})}),e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsxs(_e,{className:"h-32 w-32",children:[e.jsx(Pe,{src:r.profile_photo_url||void 0}),e.jsx(Se,{className:"text-2xl",children:r.name?.charAt(0)?.toUpperCase()||"U"})]}),!r.profile_photo_url&&e.jsxs("p",{className:"text-xs text-muted-foreground text-center mt-2",children:[e.jsx(Qa,{className:"w-3 h-3 inline mr-1"}),"Brak zdjęcia"]})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Imię i nazwisko"}),e.jsx("p",{className:"text-lg",children:r.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Email"}),e.jsxs("p",{className:"text-lg flex items-center gap-2",children:[e.jsx(Qe,{className:"w-4 h-4"}),r.email]})]}),r.birth_date&&g&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Wiek"}),e.jsxs("p",{className:"text-lg flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"}),g," lat"]})]}),r.height&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Wzrost"}),e.jsxs("p",{className:"text-lg flex items-center gap-2",children:[e.jsx(Qs,{className:"w-4 h-4"}),r.height," cm"]})]})]})]}),r.bio&&e.jsxs(e.Fragment,{children:[e.jsx(he,{}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"O mnie"}),e.jsx("p",{className:"text-muted-foreground whitespace-pre-wrap",children:r.bio})]})]}),e.jsx(he,{}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.is_trainer&&e.jsxs(R,{variant:"secondary",children:[e.jsx(Ie,{className:"w-3 h-3 mr-1"}),"Trener"]}),r.is_school_owner&&e.jsxs(R,{variant:"secondary",children:[e.jsx(Ie,{className:"w-3 h-3 mr-1"}),"Właściciel szkoły"]}),r.is_verified&&e.jsxs(R,{variant:"default",children:[e.jsx(Xs,{className:"w-3 h-3 mr-1"}),"Zweryfikowany"]})]})]})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Lokalizacja"]})}),e.jsxs(O,{className:"space-y-3",children:[r.city&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Miasto"}),e.jsx("p",{className:"text-lg",children:r.city})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Promień wyszukiwania"}),e.jsxs("p",{className:"text-lg",children:[r.search_radius_km||50," km"]})]})]})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),"Style tańca"]})}),e.jsx(O,{children:n.length>0?e.jsx("div",{className:"space-y-3",children:n.map(f=>e.jsxs("div",{className:"p-3 rounded-lg border bg-muted/30",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:f.dance_style?.name||"Nieznany styl"}),f.dance_style?.category&&e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:f.dance_style.category})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx(R,{variant:"outline",className:"capitalize",children:f.skill_level}),f.is_teaching&&e.jsxs(R,{variant:"secondary",className:"text-xs",children:[e.jsx(Be,{className:"w-3 h-3 mr-1"}),"Uczę"]})]})]}),f.years_experience&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Doświadczenie: ",f.years_experience," ",f.years_experience===1?"rok":f.years_experience<5?"lata":"lat"]})]},f.id))}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nie dodano jeszcze żadnych stylów tańca"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(V,{className:"text-lg",children:"Ustawienia prywatności"})}),e.jsxs(O,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Widoczność profilu"}),e.jsx(R,{variant:"outline",className:"capitalize",children:r.visibility==="public"?"Publiczny":r.visibility==="friends"?"Znajomi":"Prywatny"})]}),e.jsx(he,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm flex items-center gap-2",children:[r.show_age?e.jsx(Fs,{className:"w-3 h-3"}):e.jsx(ma,{className:"w-3 h-3"}),"Pokazuj wiek"]}),e.jsx("span",{className:"text-sm font-medium",children:r.show_age?"Tak":"Nie"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm flex items-center gap-2",children:[r.show_exact_location?e.jsx(Fs,{className:"w-3 h-3"}):e.jsx(ma,{className:"w-3 h-3"}),"Dokładna lokalizacja"]}),e.jsx("span",{className:"text-sm font-medium",children:r.show_exact_location?"Tak":"Nie"})]})]})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(V,{className:"text-lg",children:"Status konta"})}),e.jsxs(O,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Status"}),e.jsx(R,{variant:r.is_active?"default":"secondary",children:r.is_active?"Aktywny":"Nieaktywny"})]}),e.jsx(he,{}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:["Utworzono:"," ",new Date(r.created_at).toLocaleDateString("pl-PL")]}),e.jsxs("p",{children:["Ostatnia aktualizacja:"," ",new Date(r.updated_at).toLocaleDateString("pl-PL")]})]})]})]})]})]})]})},Qi={name:"users",list:"/profiles",show:"/profiles/show",edit:"/profiles/edit",meta:{label:"Mój Profil"}},Xi=[e.jsx(Y,{path:"/profiles/show",element:e.jsx(Yi,{})},"profiles-show"),e.jsx(Y,{path:"/profiles/edit",element:e.jsx(Ji,{})},"profiles-edit")],Ss=({current:s,pageSize:a,total:t,setCurrent:r,setPageSize:i,itemName:n="elementów",pageSizeOptions:c=[10,20,50]})=>{const u=Math.ceil(t/a),m=(s-1)*a+1,p=Math.min(s*a,t),w=s>1,g=s<u,f=()=>{const x=[];if(u<=5)for(let N=1;N<=u;N++)x.push(N);else{x.push(1),s>3&&x.push("...");const N=Math.max(2,s-1),z=Math.min(u-1,s+1);for(let l=N;l<=z;l++)x.push(l);s<u-2&&x.push("..."),x.push(u)}return x};return t===0?null:e.jsxs(te,{className:"mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pokazuje ",m,"-",p," z ",t," ",n]}),e.jsxs(te,{className:"gap-2",children:[i&&e.jsxs(ce,{value:a.toString(),onValueChange:x=>{i(parseInt(x)),r(1)},children:[e.jsx(le,{className:"w-[100px]",children:e.jsx(de,{})}),e.jsx(oe,{children:c.map(x=>e.jsxs(W,{value:x.toString(),children:[x," / str."]},x))})]}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>r(s-1),disabled:!w,children:e.jsx(Ts,{className:"w-4 h-4"})}),e.jsx("div",{className:"hidden sm:flex gap-1",children:f().map((x,b)=>x==="..."?e.jsx("span",{className:"px-3 py-1 text-sm text-muted-foreground",children:"..."},`ellipsis-${b}`):e.jsx(v,{variant:s===x?"default":"outline",size:"sm",onClick:()=>r(x),className:"min-w-[40px]",children:x},x))}),e.jsxs("div",{className:"flex sm:hidden items-center px-3 text-sm",children:[s," / ",u]}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>r(s+1),disabled:!g,children:e.jsx(gs,{className:"w-4 h-4"})})]})]})},en=()=>{const{create:s}=Ae(),{tableQuery:{data:a,isLoading:t,isError:r},current:i,setCurrent:n,pageSize:c,setFilters:u}=ys({sorters:{initial:[{field:"name",order:"asc"}]}}),m=Xe({isLoading:t,isError:r});return m||e.jsxs(ae,{children:[e.jsxs(te,{children:[e.jsx(ye,{title:"Style tańca",description:"Katalog dostępnych stylów tańca"}),e.jsxs(v,{onClick:()=>s("dance_styles"),children:[e.jsx(fs,{className:"w-4 h-4 mr-2"}),"Dodaj styl"]})]}),e.jsx(te,{children:e.jsx(q,{placeholder:"Szukaj stylów...",className:"max-w-sm",onChange:p=>{u([{field:"name",operator:"contains",value:p.target.value}])}})}),e.jsx(fe,{children:a?.data?.map(p=>e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(te,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),p.name]}),e.jsxs(R,{variant:"outline",children:[e.jsx(se,{className:"w-3 h-3 mr-1"}),p.dancers_count||0]})]})}),p.description&&e.jsx(O,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:p.description})})]},p.id))}),e.jsx(Ss,{current:i,pageSize:c,total:a?.total||0,setCurrent:n,itemName:"stylów"})]})},sn=()=>{const{list:s}=Ae(),{refineCore:{onFinish:a},register:t,handleSubmit:r,formState:{errors:i,isSubmitting:n}}=cs();return e.jsxs(ae,{children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>s("dance_styles"),children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(te,{children:e.jsx(ye,{title:"Dodaj styl tańca",description:"Dodaj nowy styl do katalogu"})}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(V,{children:"Informacje o stylu"})}),e.jsx(O,{children:e.jsxs(ks,{onSubmit:r(a),children:[e.jsx(ee,{label:"Nazwa stylu",htmlFor:"name",error:i.name?.message,required:!0,children:e.jsx(q,{id:"name",placeholder:"np. Salsa Kubańska",...t("name",{required:"Nazwa stylu jest wymagana",minLength:{value:2,message:"Nazwa musi mieć minimum 2 znaki"}})})}),e.jsx(ee,{label:"Kategoria",htmlFor:"category",error:i.category?.message,children:e.jsx(q,{id:"category",placeholder:"np. Latynoamerykańskie, Standardowe, Uliczne",...t("category")})}),e.jsx(ee,{label:"Opis",htmlFor:"description",error:i.description?.message,children:e.jsx(He,{id:"description",placeholder:"Opisz charakterystykę stylu, pochodzenie, podstawowe kroki...",rows:4,...t("description")})}),e.jsxs(_s,{children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>s("dance_styles"),children:"Anuluj"}),e.jsx(v,{type:"submit",disabled:n,children:n?"Dodawanie...":"Dodaj styl"})]})]})})]})]})},an={name:"dance_styles",list:"/dance-styles",create:"/dance-styles/create",meta:{canDelete:!1,label:"Style tańca"}},tn=[e.jsx(Y,{path:"/dance-styles",element:e.jsx(en,{})},"dance-styles-list"),e.jsx(Y,{path:"/dance-styles/create",element:e.jsx(sn,{})},"dance-styles-create")],rn=()=>{const{data:s}=je(),{show:a}=Ae(),[t,r]=o.useState([]),[i,n]=o.useState([]),[c,u]=o.useState([]),[m,p]=o.useState(!0),[w,g]=o.useState("matches");o.useEffect(()=>{s?.id&&f()},[s?.id]);const f=async()=>{if(s?.id){p(!0);try{const{data:l,error:y}=await I.from("likes").select(`
          *,
          to_user:v_public_dancers!likes_to_user_id_fkey (
            id,
            name,
            profile_photo_url,
            city,
            age,
            bio,
            is_verified
          )
        `).eq("from_user_id",s.id);if(y)throw y;const{data:A,error:h}=await I.from("likes").select(`
          *,
          from_user:v_public_dancers!likes_from_user_id_fkey (
            id,
            name,
            profile_photo_url,
            city,
            age,
            bio,
            is_verified
          )
        `).eq("to_user_id",s.id);if(h)throw h;const _=[],F=[],Z=[];l?.forEach(B=>{A?.some(C=>C.from_user_id===B.to_user_id)?_.push(B):F.push(B)}),A?.forEach(B=>{_.some(C=>C.to_user_id===B.from_user_id)||Z.push(B)}),r(_),n(F),u(Z)}catch(l){console.error("Error fetching data:",l),H.error("Błąd pobierania danych")}finally{p(!1)}}},x=async l=>{try{const{error:y}=await I.from("likes").delete().eq("id",l);if(y)throw y;H.success("Usunięto polubienie"),f()}catch(y){console.error("Error removing like:",y),H.error("Błąd usuwania polubienia")}},b=l=>{const y=new Date(l),h=Math.abs(new Date().getTime()-y.getTime()),_=Math.ceil(h/(1e3*60*60*24));return _===0?"Dzisiaj":_===1?"Wczoraj":_<7?`${_} dni temu`:_<30?`${Math.floor(_/7)} tyg. temu`:`${Math.floor(_/30)} mies. temu`},N=({user:l,likeDate:y,likeId:A,showRemove:h=!1})=>l?e.jsx(L,{className:"group hover:shadow-lg transition-all duration-300 cursor-pointer overflow-hidden",onClick:()=>a("v_public_dancers",l.id),children:e.jsxs("div",{className:"flex items-center gap-4 p-4",children:[e.jsxs(_e,{className:"h-16 w-16 flex-shrink-0",children:[e.jsx(Pe,{src:l.profile_photo_url||void 0}),e.jsx(Se,{className:"text-lg bg-gradient-to-br from-pink-400 to-purple-400 text-white",children:l.name?.charAt(0)?.toUpperCase()||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-base truncate",children:l.name}),l.is_verified&&e.jsx(R,{variant:"secondary",className:"text-xs",children:e.jsx(Oe,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[l.age&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ve,{className:"w-3 h-3"}),l.age," lat"]}),l.city&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),l.city]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:b(y)})]}),e.jsxs("div",{className:"flex gap-2",children:[w==="matches"&&e.jsx(v,{size:"sm",variant:"default",onClick:_=>{_.stopPropagation(),H.info("Funkcja czatu będzie dostępna wkrótce")},children:e.jsx(Is,{className:"w-4 h-4"})}),h&&e.jsx(v,{size:"sm",variant:"ghost",onClick:_=>{_.stopPropagation(),x(A)},children:e.jsx(ge,{className:"w-4 h-4 fill-current"})}),e.jsx(v,{size:"sm",variant:"ghost",className:"group-hover:bg-accent",children:e.jsx(is,{className:"w-4 h-4"})})]})]})}):null,z=({icon:l,title:y,description:A})=>e.jsxs(L,{className:"p-12 text-center border-dashed",children:[e.jsx(l,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:y}),e.jsx("p",{className:"text-muted-foreground",children:A})]});return m?e.jsx(ae,{children:e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})}):e.jsxs(ae,{children:[e.jsx(te,{children:e.jsx(ye,{title:"Polubienia i dopasowania",description:"Zarządzaj swoimi połączeniami z innymi tancerzami"})}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs(R,{variant:"outline",className:"text-sm",children:[e.jsx(Cs,{className:"w-3 h-3 mr-1"}),t.length," dopasowań"]}),e.jsxs(R,{variant:"outline",className:"text-sm",children:[e.jsx(ge,{className:"w-3 h-3 mr-1"}),i.length," polubionych"]}),e.jsxs(R,{variant:"outline",className:"text-sm",children:[e.jsx(ts,{className:"w-3 h-3 mr-1"}),c.length," polubień"]})]}),e.jsxs(dt,{value:w,onValueChange:g,children:[e.jsxs(aa,{className:"grid w-full grid-cols-3",children:[e.jsxs(Ge,{value:"matches",className:"gap-2",children:[e.jsx(Cs,{className:"w-4 h-4"}),"Dopasowania (",t.length,")"]}),e.jsxs(Ge,{value:"my-likes",className:"gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),"Moje polubienia (",i.length,")"]}),e.jsxs(Ge,{value:"likes-me",className:"gap-2",children:[e.jsx(ts,{className:"w-4 h-4"}),"Polubili mnie (",c.length,")"]})]}),e.jsx(Je,{value:"matches",className:"mt-6 space-y-3",children:t.length>0?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"🎉 Gratulacje! Masz wzajemne dopasowania. Możesz rozpocząć rozmowę."}),t.map(l=>e.jsx(N,{user:l.to_user,likeDate:l.created_at,likeId:l.id},l.id))]}):e.jsx(z,{icon:Cs,title:"Brak dopasowań",description:"Gdy ktoś kogo polubiłeś również Cię polubi, pojawi się tutaj jako dopasowanie"})}),e.jsx(Je,{value:"my-likes",className:"mt-6 space-y-3",children:i.length>0?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Profile które polubiłeś. Czekaj aż odwzajemnią polubienie!"}),i.map(l=>e.jsx(N,{user:l.to_user,likeDate:l.created_at,likeId:l.id,showRemove:!0},l.id))]}):e.jsx(z,{icon:ge,title:"Brak polubionych profili",description:"Przeglądaj profile i polub tych, którzy Ci się spodobają"})}),e.jsx(Je,{value:"likes-me",className:"mt-6 space-y-3",children:c.length>0?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Te osoby czekają na Twoje polubienie. Polub je, aby utworzyć dopasowanie!"}),c.map(l=>e.jsx(N,{user:l.from_user,likeDate:l.created_at,likeId:l.id},l.id))]}):e.jsx(z,{icon:ts,title:"Nikt jeszcze Cię nie polubił",description:"Uzupełnij swój profil i dodaj zdjęcia, aby zwiększyć szanse na polubienia"})})]})]})},nn={name:"matches",list:"/matches",meta:{label:"Dopasowania"}},ln=[e.jsx(Y,{path:"/matches",element:e.jsx(rn,{})},"matches-list")],Zs=({targetUserId:s,variant:a="default",className:t="",onLikeChange:r,initialLiked:i=!1})=>{const{data:n}=je(),[c,u]=o.useState(i),[m,p]=o.useState(!1),[w,g]=o.useState(!0),[f,x]=o.useState(!1);o.useEffect(()=>{n?.id&&s&&i===void 0?b():g(!1)},[n?.id,s,i]);const b=async()=>{if(n?.id)try{const{data:z,error:l}=await I.from("likes").select("id").eq("from_user_id",n.id).eq("to_user_id",s).single();!l&&z&&u(!0)}catch(z){console.error("Error checking like status:",z)}finally{g(!1)}},N=async z=>{if(z.stopPropagation(),!n?.id){H.error("Musisz być zalogowany",{description:"Zaloguj się, aby polubić profile"});return}if(n.id===s){H.error("Nie możesz polubić własnego profilu");return}c||(x(!0),setTimeout(()=>x(!1),600)),p(!0);try{if(c){const{error:l}=await I.from("likes").delete().eq("from_user_id",n.id).eq("to_user_id",s);if(l)throw l;u(!1),r?.(!1),H.info("Usunięto polubienie",{description:"Profil został usunięty z polubionych"})}else{const{error:l}=await I.from("likes").insert({from_user_id:n.id,to_user_id:s});if(l)throw l;u(!0),r?.(!0);const{data:y}=await I.from("likes").select("id").eq("from_user_id",s).eq("to_user_id",n.id).single();y?H.success("To dopasowanie! 🎉",{description:"Oboje się polubiliście! Możecie teraz rozpocząć konwersację."}):H.success("Polubiono profil",{description:"Profil został dodany do polubionych"})}}catch(l){console.error("Error handling like:",l),H.error("Błąd",{description:"Nie udało się zaktualizować polubienia"})}finally{p(!1)}};return n?.id===s?null:a==="card"?e.jsxs("button",{className:D("relative",t),onClick:N,disabled:m||w,children:[e.jsx("div",{className:D("w-12 h-12 rounded-full flex items-center justify-center transition-all duration-300",c?"bg-gradient-to-br from-pink-500 to-red-500 shadow-xl":"bg-white shadow-lg border-2 border-gray-200 hover:border-red-300","hover:scale-110 hover:shadow-xl"),children:e.jsx(ge,{className:D("w-6 h-6 transition-all duration-300",c?"text-white fill-white":"text-red-500 hover:fill-red-500",f&&"animate-ping")})}),f&&e.jsx("div",{className:"absolute inset-0 rounded-full animate-ping bg-pink-400/50"}),e.jsx("div",{className:D("absolute inset-0 rounded-full opacity-0 hover:opacity-100","bg-gradient-to-br from-pink-400/20 to-red-400/20","transition-opacity duration-300")})]}):e.jsxs(v,{variant:c?"default":"outline",onClick:N,disabled:m||w,className:t,children:[e.jsx(ge,{className:`w-4 h-4 mr-2 ${c?"fill-current":""}`}),c?"Polubione":"Polub profil"]})},on=()=>{const[s,a]=o.useState(""),{tableQuery:{data:t,isLoading:r,isError:i},current:n,setCurrent:c,pageSize:u,setFilters:m}=ys({resource:"v_public_dancers",pagination:{pageSize:12},sorters:{initial:[{field:"created_at",order:"desc"}]}}),{show:p}=Ae(),w=x=>{a(x),m(x?[{field:"name",operator:"contains",value:x}]:[])},g=Xe({isLoading:r,isError:i});if(g)return g;const f=t?.data||[];return e.jsxs(ae,{children:[e.jsx(te,{children:e.jsx(ye,{title:"Tancerze",description:"Przeglądaj profile tancerzy w Twojej okolicy"})}),e.jsxs(te,{children:[e.jsxs("div",{className:"relative max-w-md w-full",children:[e.jsx(vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(q,{placeholder:"Szukaj tancerzy po imieniu...",className:"pl-10",value:s,onChange:x=>w(x.target.value)})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(R,{variant:"outline",children:[e.jsx(se,{className:"w-3 h-3 mr-1"}),t?.total||0," tancerzy"]})})]}),e.jsx(fe,{variant:"1-2-3",children:f.map(x=>e.jsxs(L,{className:"group relative overflow-hidden rounded-2xl border-0 shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer",onClick:()=>p("v_public_dancers",x.id),children:[e.jsxs("div",{className:"relative h-[400px] sm:h-[450px] overflow-hidden bg-gradient-to-br from-pink-100 to-purple-100",children:[x.profile_photo_url?e.jsx("img",{src:x.profile_photo_url,alt:x.name,className:"absolute inset-0 w-full h-full object-cover"}):e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(_e,{className:"h-32 w-32 border-4 border-white shadow-xl",children:e.jsx(Se,{className:"text-4xl bg-gradient-to-br from-pink-400 to-purple-400 text-white",children:x.name?.charAt(0)?.toUpperCase()||"T"})})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"}),e.jsxs("div",{className:"absolute top-3 left-3 flex flex-col gap-2",children:[x.is_verified&&e.jsxs(R,{className:"bg-blue-500/90 backdrop-blur-sm text-white border-0 shadow-lg",children:[e.jsx(Ie,{className:"w-3 h-3 mr-1"}),"Zweryfikowany"]}),x.is_trainer&&e.jsxs(R,{className:"bg-purple-500/90 backdrop-blur-sm text-white border-0 shadow-lg",children:[e.jsx(Be,{className:"w-4 h-4 mr-1"}),"Trener"]}),x.is_matched&&e.jsxs(R,{className:"bg-green-500/90 backdrop-blur-sm text-white border-0 shadow-lg",children:[e.jsx(Oe,{className:"w-4 h-4 mr-1"}),"Dopasowanie!"]}),!x.is_matched&&x.liked_me&&e.jsxs(R,{className:"bg-pink-500/90 backdrop-blur-sm text-white border-0 shadow-lg",children:[e.jsx(ge,{className:"w-4 h-4 mr-1"}),"Lubi Cię!"]})]}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx(Zs,{targetUserId:x.id,variant:"card",initialLiked:x.i_liked})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 text-white",children:[e.jsxs("h3",{className:"text-2xl font-bold mb-1",children:[x.name,x.age&&`, ${x.age}`]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm mb-2 opacity-90",children:[x.city&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),x.city]}),x.height&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Qs,{className:"w-3 h-3"}),x.height," cm"]})]}),x.bio&&e.jsx("p",{className:"text-sm opacity-90 line-clamp-2 mb-3",children:x.bio}),x.dance_styles&&x.dance_styles.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[x.dance_styles.slice(0,3).map((b,N)=>e.jsxs(R,{className:"bg-white/20 backdrop-blur-sm text-white border-white/30 text-xs",children:[e.jsx(Ne,{className:"w-3 h-3 mr-1"}),b.style_name]},N)),x.dance_styles.length>3&&e.jsxs(R,{className:"bg-white/20 backdrop-blur-sm text-white border-white/30 text-xs",children:["+",x.dance_styles.length-3]})]})]})]}),e.jsx(O,{className:"p-3 bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{size:"sm",variant:"ghost",className:"text-muted-foreground hover:text-primary",onClick:b=>{b.stopPropagation()},children:e.jsx(Is,{className:"w-4 h-4"})}),e.jsx(v,{size:"sm",variant:"ghost",className:"text-muted-foreground hover:text-primary",onClick:b=>{b.stopPropagation(),p("v_public_dancers",x.id)},children:e.jsx(Fs,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:x.is_matched?e.jsxs(e.Fragment,{children:[e.jsx(Is,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{className:"text-green-600 font-medium",children:"Możesz pisać!"})]}):x.liked_me?e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-3 h-3 text-pink-500"}),e.jsx("span",{className:"text-pink-600 font-medium",children:"Czeka na polubienie"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"w-3 h-3"}),e.jsx("span",{children:"Aktywny dzisiaj"})]})})]})})]},x.id))}),f.length===0&&e.jsxs(L,{className:"p-12 text-center border-dashed",children:[e.jsx(se,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Nie znaleziono tancerzy"}),e.jsx("p",{className:"text-muted-foreground",children:s?"Spróbuj zmienić kryteria wyszukiwania":"Brak dostępnych profili w tym momencie"})]}),e.jsx(Ss,{current:n,pageSize:u,total:t?.total||0,setCurrent:c,itemName:"tancerzy"})]})},cn=()=>{const{queryResult:s}=Ka({resource:"v_public_dancers"}),{list:a}=Ae(),{data:t,isLoading:r,isError:i}=s,n=t?.data,c=Xe({isLoading:r,isError:i});if(c)return c;if(!n)return e.jsx("div",{className:"p-6 mx-auto",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-500 text-lg",children:"Profil nie został znaleziony"}),e.jsx(v,{className:"mt-4",onClick:()=>a("v_public_dancers"),children:"Wróć do listy"})]})});const u=m=>({beginner:"Początkujący",intermediate:"Średniozaawansowany",advanced:"Zaawansowany",professional:"Profesjonalny"})[m]||m;return e.jsxs(ae,{children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>a("v_public_dancers"),children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"Wróć do listy"]}),e.jsx(L,{children:e.jsx(O,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-start",children:[e.jsxs(_e,{className:"h-24 w-24 flex-shrink-0",children:[e.jsx(Pe,{src:n.profile_photo_url||void 0}),e.jsx(Se,{className:"text-2xl",children:n.name?.charAt(0)?.toUpperCase()||"T"})]}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2 flex-wrap",children:[n.name,n.is_verified&&e.jsxs(R,{variant:"secondary",children:[e.jsx(Ie,{className:"w-4 h-4 mr-1"}),"Zweryfikowany"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-muted-foreground mt-2",children:[n.age&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ve,{className:"w-4 h-4"}),n.age," lat"]}),n.height&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Qs,{className:"w-4 h-4"}),n.height," cm"]}),n.city&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-4 h-4"}),n.city]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.is_trainer&&e.jsxs(R,{variant:"secondary",children:[e.jsx(Be,{className:"w-4 h-4 mr-1"}),"Trener"]}),n.is_matched&&e.jsxs(R,{variant:"default",className:"bg-green-500",children:[e.jsx(Oe,{className:"w-4 h-4 mr-1"}),"Dopasowanie!"]}),!n.is_matched&&n.liked_me&&e.jsxs(R,{variant:"default",className:"bg-pink-500",children:[e.jsx(ge,{className:"w-4 h-4 mr-1"}),"Lubi Cię!"]})]}),e.jsx(Zs,{targetUserId:n.id,variant:"default",initialLiked:n.i_liked})]})]})})}),e.jsxs(fe,{children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[n.bio&&e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-5 h-5"}),"O mnie"]})}),e.jsx(O,{children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:n.bio})})]}),n.dance_styles&&n.dance_styles.length>0&&e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),"Style taneczne (",n.dance_styles.length,")"]})}),e.jsx(O,{children:e.jsx("div",{className:"space-y-3",children:n.dance_styles.map((m,p)=>e.jsxs("div",{className:"border rounded-lg p-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m.style_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Poziom: ",u(m.skill_level)]})]}),m.is_teaching&&e.jsx(R,{variant:"outline",children:"Uczy"})]},p))})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(V,{className:"text-lg",children:"Szczegóły profilu"})}),e.jsx(O,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Dołączył"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(n.created_at).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})})]})]}),e.jsx(he,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Status profilu"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.is_verified&&e.jsxs(R,{variant:"secondary",children:[e.jsx(Ie,{className:"w-3 h-3 mr-1"}),"Zweryfikowany"]}),n.is_trainer&&e.jsxs(R,{variant:"secondary",children:[e.jsx(Be,{className:"w-3 h-3 mr-1"}),"Trener"]}),n.is_matched&&e.jsxs(R,{variant:"default",className:"bg-green-500",children:[e.jsx(Oe,{className:"w-3 h-3 mr-1"}),"Dopasowanie"]}),!n.is_matched&&n.liked_me&&e.jsxs(R,{variant:"default",className:"bg-pink-500",children:[e.jsx(ge,{className:"w-3 h-3 mr-1"}),"Lubi Cię"]})]})]})]})})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(V,{className:"text-lg",children:"Akcje"})}),e.jsxs(O,{className:"space-y-2",children:[e.jsx(Zs,{targetUserId:n.id,variant:"default",className:"w-full",initialLiked:n.i_liked}),e.jsx(v,{variant:"outline",className:"w-full",disabled:!n.is_matched,children:n.is_matched?"Wyślij wiadomość":"Najpierw musicie się dopasować"}),e.jsx(v,{variant:"outline",className:"w-full",children:"Zgłoś profil"})]})]})]})]})]})},dn={name:"v_public_dancers",list:"/dancers",show:"/dancers/show/:id",meta:{label:"Tancerze"}},mn=[e.jsx(Y,{path:"/dancers",element:e.jsx(on,{})},"dancers-list"),e.jsx(Y,{path:"/dancers/show/:id",element:e.jsx(cn,{})},"dancers-show")],xn={lessThanXSeconds:{one:{regular:"mniej niż sekunda",past:"mniej niż sekundę",future:"mniej niż sekundę"},twoFour:"mniej niż {{count}} sekundy",other:"mniej niż {{count}} sekund"},xSeconds:{one:{regular:"sekunda",past:"sekundę",future:"sekundę"},twoFour:"{{count}} sekundy",other:"{{count}} sekund"},halfAMinute:{one:"pół minuty",twoFour:"pół minuty",other:"pół minuty"},lessThanXMinutes:{one:{regular:"mniej niż minuta",past:"mniej niż minutę",future:"mniej niż minutę"},twoFour:"mniej niż {{count}} minuty",other:"mniej niż {{count}} minut"},xMinutes:{one:{regular:"minuta",past:"minutę",future:"minutę"},twoFour:"{{count}} minuty",other:"{{count}} minut"},aboutXHours:{one:{regular:"około godziny",past:"około godziny",future:"około godzinę"},twoFour:"około {{count}} godziny",other:"około {{count}} godzin"},xHours:{one:{regular:"godzina",past:"godzinę",future:"godzinę"},twoFour:"{{count}} godziny",other:"{{count}} godzin"},xDays:{one:{regular:"dzień",past:"dzień",future:"1 dzień"},twoFour:"{{count}} dni",other:"{{count}} dni"},aboutXWeeks:{one:"około tygodnia",twoFour:"około {{count}} tygodni",other:"około {{count}} tygodni"},xWeeks:{one:"tydzień",twoFour:"{{count}} tygodnie",other:"{{count}} tygodni"},aboutXMonths:{one:"około miesiąc",twoFour:"około {{count}} miesiące",other:"około {{count}} miesięcy"},xMonths:{one:"miesiąc",twoFour:"{{count}} miesiące",other:"{{count}} miesięcy"},aboutXYears:{one:"około rok",twoFour:"około {{count}} lata",other:"około {{count}} lat"},xYears:{one:"rok",twoFour:"{{count}} lata",other:"{{count}} lat"},overXYears:{one:"ponad rok",twoFour:"ponad {{count}} lata",other:"ponad {{count}} lat"},almostXYears:{one:"prawie rok",twoFour:"prawie {{count}} lata",other:"prawie {{count}} lat"}};function un(s,a){if(a===1)return s.one;const t=a%100;if(t<=20&&t>10)return s.other;const r=t%10;return r>=2&&r<=4?s.twoFour:s.other}function Rs(s,a,t){const r=un(s,a);return(typeof r=="string"?r:r[t]).replace("{{count}}",String(a))}const hn=(s,a,t)=>{const r=xn[s];return t?.addSuffix?t.comparison&&t.comparison>0?"za "+Rs(r,a,"future"):Rs(r,a,"past")+" temu":Rs(r,a,"regular")},pn={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},jn={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},fn={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},gn={date:Ds({formats:pn,defaultWidth:"full"}),time:Ds({formats:jn,defaultWidth:"full"}),dateTime:Ds({formats:fn,defaultWidth:"full"})},wn={masculine:"ostatni",feminine:"ostatnia"},yn={masculine:"ten",feminine:"ta"},Nn={masculine:"następny",feminine:"następna"},vn={0:"feminine",1:"masculine",2:"masculine",3:"feminine",4:"masculine",5:"masculine",6:"feminine"};function wa(s,a,t,r){let i;if(li(a,t,r))i=yn;else if(s==="lastWeek")i=wn;else if(s==="nextWeek")i=Nn;else throw new Error(`Cannot determine adjectives for token ${s}`);const n=a.getDay(),c=vn[n];return`'${i[c]}' eeee 'o' p`}const bn={lastWeek:wa,yesterday:"'wczoraj o' p",today:"'dzisiaj o' p",tomorrow:"'jutro o' p",nextWeek:wa,other:"P"},zn=(s,a,t,r)=>{const i=bn[s];return typeof i=="function"?i(s,a,t,r):i},kn={narrow:["p.n.e.","n.e."],abbreviated:["p.n.e.","n.e."],wide:["przed naszą erą","naszej ery"]},_n={narrow:["1","2","3","4"],abbreviated:["I kw.","II kw.","III kw.","IV kw."],wide:["I kwartał","II kwartał","III kwartał","IV kwartał"]},Sn={narrow:["S","L","M","K","M","C","L","S","W","P","L","G"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],wide:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"]},Cn={narrow:["s","l","m","k","m","c","l","s","w","p","l","g"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],wide:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"]},Pn={narrow:["N","P","W","Ś","C","P","S"],short:["nie","pon","wto","śro","czw","pią","sob"],abbreviated:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],wide:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"]},Dn={narrow:["n","p","w","ś","c","p","s"],short:["nie","pon","wto","śro","czw","pią","sob"],abbreviated:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],wide:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"]},En={narrow:{am:"a",pm:"p",midnight:"półn.",noon:"poł",morning:"rano",afternoon:"popoł.",evening:"wiecz.",night:"noc"},abbreviated:{am:"AM",pm:"PM",midnight:"północ",noon:"południe",morning:"rano",afternoon:"popołudnie",evening:"wieczór",night:"noc"},wide:{am:"AM",pm:"PM",midnight:"północ",noon:"południe",morning:"rano",afternoon:"popołudnie",evening:"wieczór",night:"noc"}},Mn={narrow:{am:"a",pm:"p",midnight:"o półn.",noon:"w poł.",morning:"rano",afternoon:"po poł.",evening:"wiecz.",night:"w nocy"},abbreviated:{am:"AM",pm:"PM",midnight:"o północy",noon:"w południe",morning:"rano",afternoon:"po południu",evening:"wieczorem",night:"w nocy"},wide:{am:"AM",pm:"PM",midnight:"o północy",noon:"w południe",morning:"rano",afternoon:"po południu",evening:"wieczorem",night:"w nocy"}},Ln=(s,a)=>String(s),An={ordinalNumber:Ln,era:es({values:kn,defaultWidth:"wide"}),quarter:es({values:_n,defaultWidth:"wide",argumentCallback:s=>s-1}),month:es({values:Sn,defaultWidth:"wide",formattingValues:Cn,defaultFormattingWidth:"wide"}),day:es({values:Pn,defaultWidth:"wide",formattingValues:Dn,defaultFormattingWidth:"wide"}),dayPeriod:es({values:En,defaultWidth:"wide",formattingValues:Mn,defaultFormattingWidth:"wide"})},Rn=/^(\d+)?/i,Fn=/\d+/i,Tn={narrow:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,abbreviated:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,wide:/^(przed\s*nasz(ą|a)\s*er(ą|a)|naszej\s*ery)/i},In={any:[/^p/i,/^n/i]},On={narrow:/^[1234]/i,abbreviated:/^(I|II|III|IV)\s*kw\.?/i,wide:/^(I|II|III|IV)\s*kwarta(ł|l)/i},Wn={narrow:[/1/i,/2/i,/3/i,/4/i],any:[/^I kw/i,/^II kw/i,/^III kw/i,/^IV kw/i]},$n={narrow:/^[slmkcwpg]/i,abbreviated:/^(sty|lut|mar|kwi|maj|cze|lip|sie|wrz|pa(ź|z)|lis|gru)/i,wide:/^(stycznia|stycze(ń|n)|lutego|luty|marca|marzec|kwietnia|kwiecie(ń|n)|maja|maj|czerwca|czerwiec|lipca|lipiec|sierpnia|sierpie(ń|n)|wrze(ś|s)nia|wrzesie(ń|n)|pa(ź|z)dziernika|pa(ź|z)dziernik|listopada|listopad|grudnia|grudzie(ń|n))/i},qn={narrow:[/^s/i,/^l/i,/^m/i,/^k/i,/^m/i,/^c/i,/^l/i,/^s/i,/^w/i,/^p/i,/^l/i,/^g/i],any:[/^st/i,/^lu/i,/^mar/i,/^k/i,/^maj/i,/^c/i,/^lip/i,/^si/i,/^w/i,/^p/i,/^lis/i,/^g/i]},Bn={narrow:/^[npwścs]/i,short:/^(nie|pon|wto|(ś|s)ro|czw|pi(ą|a)|sob)/i,abbreviated:/^(niedz|pon|wt|(ś|s)r|czw|pt|sob)\.?/i,wide:/^(niedziela|poniedzia(ł|l)ek|wtorek|(ś|s)roda|czwartek|pi(ą|a)tek|sobota)/i},Un={narrow:[/^n/i,/^p/i,/^w/i,/^ś/i,/^c/i,/^p/i,/^s/i],abbreviated:[/^n/i,/^po/i,/^w/i,/^(ś|s)r/i,/^c/i,/^pt/i,/^so/i],any:[/^n/i,/^po/i,/^w/i,/^(ś|s)r/i,/^c/i,/^pi/i,/^so/i]},Zn={narrow:/^(^a$|^p$|pó(ł|l)n\.?|o\s*pó(ł|l)n\.?|po(ł|l)\.?|w\s*po(ł|l)\.?|po\s*po(ł|l)\.?|rano|wiecz\.?|noc|w\s*nocy)/i,any:/^(am|pm|pó(ł|l)noc|o\s*pó(ł|l)nocy|po(ł|l)udnie|w\s*po(ł|l)udnie|popo(ł|l)udnie|po\s*po(ł|l)udniu|rano|wieczór|wieczorem|noc|w\s*nocy)/i},Hn={narrow:{am:/^a$/i,pm:/^p$/i,midnight:/pó(ł|l)n/i,noon:/po(ł|l)/i,morning:/rano/i,afternoon:/po\s*po(ł|l)/i,evening:/wiecz/i,night:/noc/i},any:{am:/^am/i,pm:/^pm/i,midnight:/pó(ł|l)n/i,noon:/po(ł|l)/i,morning:/rano/i,afternoon:/po\s*po(ł|l)/i,evening:/wiecz/i,night:/noc/i}},Vn={ordinalNumber:oi({matchPattern:Rn,parsePattern:Fn,valueCallback:s=>parseInt(s,10)}),era:ss({matchPatterns:Tn,defaultMatchWidth:"wide",parsePatterns:In,defaultParseWidth:"any"}),quarter:ss({matchPatterns:On,defaultMatchWidth:"wide",parsePatterns:Wn,defaultParseWidth:"any",valueCallback:s=>s+1}),month:ss({matchPatterns:$n,defaultMatchWidth:"wide",parsePatterns:qn,defaultParseWidth:"any"}),day:ss({matchPatterns:Bn,defaultMatchWidth:"wide",parsePatterns:Un,defaultParseWidth:"any"}),dayPeriod:ss({matchPatterns:Zn,defaultMatchWidth:"any",parsePatterns:Hn,defaultParseWidth:"any"})},ue={code:"pl",formatDistance:hn,formatLong:gn,formatRelative:zn,localize:An,match:Vn,options:{weekStartsOn:1,firstWeekContainsDate:4}},Kn=()=>{const{data:s}=je(),[a,t]=o.useState(""),[r,i]=o.useState("all"),[n,c]=o.useState("published"),{tableQuery:{data:u,isLoading:m,isError:p},current:w,setCurrent:g,pageSize:f,setFilters:x}=ys({resource:"v_events_with_counts",pagination:{pageSize:12},filters:{initial:[{field:"status",operator:"eq",value:"published"}]},sorters:{initial:[{field:"start_at",order:"asc"}]}}),{show:b,create:N}=Ae(),z=d=>{t(d),A(d,r,n)},l=d=>{i(d),A(a,d,n)},y=d=>{c(d),A(a,r,d)},A=(d,k,$)=>{const G=[];$!=="all"&&G.push({field:"status",operator:"eq",value:$}),k!=="all"&&G.push({field:"event_type",operator:"eq",value:k}),d&&G.push({field:"title",operator:"contains",value:d}),x(G)},h=Xe({isLoading:m,isError:p});if(h)return h;const _=u?.data||[],F=d=>({lesson:e.jsx(rt,{className:"w-4 h-4"}),workshop:e.jsx(Be,{className:"w-4 h-4"}),social:e.jsx(tt,{className:"w-4 h-4"}),competition:e.jsx(ns,{className:"w-4 h-4"}),performance:e.jsx(at,{className:"w-4 h-4"})})[d]||e.jsx(Ke,{className:"w-4 h-4"}),Z=d=>({lesson:"Lekcja",workshop:"Warsztaty",social:"Potańcówka",competition:"Zawody",performance:"Występ"})[d]||d,B=d=>({physical:e.jsx(pe,{className:"w-3 h-3"}),online:e.jsx(Ws,{className:"w-3 h-3"}),hybrid:e.jsx(se,{className:"w-3 h-3"})})[d]||e.jsx(pe,{className:"w-3 h-3"}),j=d=>({beginner:"Początkujący",intermediate:"Średniozaawansowany",advanced:"Zaawansowany",professional:"Profesjonalny"})[d]||d,C=d=>{const k={draft:{icon:e.jsx(ls,{className:"w-3 h-3"}),variant:"secondary",label:"Szkic"},published:{icon:e.jsx(Te,{className:"w-3 h-3"}),variant:"default",label:"Opublikowane"},cancelled:{icon:e.jsx(ea,{className:"w-3 h-3"}),variant:"destructive",label:"Odwołane"},completed:{icon:e.jsx(Te,{className:"w-3 h-3"}),variant:"outline",label:"Zakończone"}},$=k[d]||k.draft;return e.jsxs(R,{variant:$.variant,children:[$.icon,e.jsx("span",{className:"ml-1",children:$.label})]})},E=d=>new Date(d)<new Date,P=(d,k)=>{const $=new Date(d),G=new Date(k);return $.toDateString()===G.toDateString()?`${J($,"d MMM yyyy",{locale:ue})} • ${J($,"HH:mm")} - ${J(G,"HH:mm")}`:`${J($,"d MMM",{locale:ue})} - ${J(G,"d MMM yyyy",{locale:ue})}`};return e.jsxs(ae,{children:[e.jsxs(te,{className:"flex-col sm:flex-row gap-4",children:[e.jsx(ye,{title:"Wydarzenia",description:"Przeglądaj i zarządzaj wydarzeniami tanecznymi"}),e.jsxs(v,{onClick:()=>N("events"),className:"w-full sm:w-auto",children:[e.jsx(fs,{className:"w-4 h-4 mr-2"}),"Dodaj wydarzenie"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(q,{placeholder:"Szukaj wydarzeń...",className:"pl-10 w-full",value:a,onChange:d=>z(d.target.value)})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(ce,{value:r,onValueChange:l,children:[e.jsxs(le,{className:"w-full sm:w-[160px]",children:[e.jsx(st,{className:"w-4 h-4 mr-2"}),e.jsx(de,{placeholder:"Typ wydarzenia"})]}),e.jsxs(oe,{children:[e.jsx(W,{value:"all",children:"Wszystkie typy"}),e.jsx(W,{value:"lesson",children:"Lekcje"}),e.jsx(W,{value:"workshop",children:"Warsztaty"}),e.jsx(W,{value:"social",children:"Potańcówki"}),e.jsx(W,{value:"competition",children:"Zawody"}),e.jsx(W,{value:"performance",children:"Występy"})]})]}),e.jsxs(ce,{value:n,onValueChange:y,children:[e.jsx(le,{className:"w-full sm:w-[140px]",children:e.jsx(de,{placeholder:"Status"})}),e.jsxs(oe,{children:[e.jsx(W,{value:"all",children:"Wszystkie"}),e.jsx(W,{value:"published",children:"Opublikowane"}),e.jsx(W,{value:"draft",children:"Szkice"}),e.jsx(W,{value:"cancelled",children:"Odwołane"}),e.jsx(W,{value:"completed",children:"Zakończone"})]})]})]}),e.jsxs(R,{variant:"outline",className:"self-start sm:self-auto",children:[e.jsx(Ke,{className:"w-3 h-3 mr-1"}),u?.total||0," wydarzeń"]})]})]}),e.jsx(fe,{variant:"1-2-3",className:"gap-4 sm:gap-6",children:_.map(d=>{const k=E(d.end_at),$=d.organizer_id===s?.id,G=d.max_participants?d.max_participants-d.participant_count:null,S=G!==null&&G<=0;return e.jsxs(L,{className:`group relative overflow-hidden transition-all duration-300 hover:shadow-lg cursor-pointer ${k?"opacity-60":""}`,onClick:()=>b("events",d.id),children:[e.jsxs(U,{className:"pb-3 space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2",children:[e.jsxs(R,{variant:"secondary",className:"flex items-center gap-1 w-fit",children:[F(d.event_type),e.jsx("span",{className:"whitespace-nowrap",children:Z(d.event_type)})]}),$&&e.jsx(R,{variant:"outline",className:"text-xs w-fit",children:"Moje wydarzenie"})]}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold line-clamp-2",children:d.title})]}),e.jsxs(O,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(Me,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"line-clamp-2 break-words",children:P(d.start_at,d.end_at)})]}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[B(d.location_type),e.jsx("span",{className:"line-clamp-2 break-words",children:d.location_type==="online"?d.online_platform||"Online":d.location_name||d.city||"Brak lokalizacji"})]}),d.dance_style&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),e.jsx(R,{variant:"outline",className:"text-xs",children:d.dance_style.name})]}),(d.skill_level_min||d.skill_level_max)&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Poziom:"," ",d.skill_level_min&&j(d.skill_level_min),d.skill_level_min&&d.skill_level_max&&d.skill_level_min!==d.skill_level_max&&" - ",d.skill_level_max&&d.skill_level_min!==d.skill_level_max&&j(d.skill_level_max)]}),d.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:d.description}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[d.price>0?e.jsxs(R,{variant:"outline",className:"text-xs",children:[e.jsx(Os,{className:"w-3 h-3 mr-1"}),d.price," ",d.currency]}):e.jsx(R,{variant:"outline",className:"text-xs text-green-600",children:"Bezpłatne"}),d.requires_partner&&e.jsxs(R,{variant:"outline",className:"text-xs",children:[e.jsx(se,{className:"w-3 h-3 mr-1"}),"W parze"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[e.jsx(se,{className:"w-3 h-3"}),e.jsx("span",{className:"font-medium",children:d.participant_count}),d.max_participants&&e.jsxs("span",{className:"text-muted-foreground",children:["/",d.max_participants]}),d.waitlist_count>0&&e.jsxs(R,{variant:"secondary",className:"ml-1 text-xs",children:["+",d.waitlist_count]}),S&&d.waitlist_count===0&&e.jsx(R,{variant:"destructive",className:"ml-1 text-xs",children:"Brak miejsc"})]})]}),d.status!=="published"&&e.jsx("div",{className:"pt-2",children:C(d.status)})]})]},d.id)})}),_.length===0&&e.jsxs(L,{className:"p-8 sm:p-12 text-center border-dashed",children:[e.jsx(Ke,{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold mb-2",children:"Nie znaleziono wydarzeń"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mb-4",children:a||r!=="all"||n!=="published"?"Spróbuj zmienić kryteria wyszukiwania":"Brak dostępnych wydarzeń w tym momencie"}),e.jsxs(v,{onClick:()=>N("events"),className:"w-full sm:w-auto",children:[e.jsx(fs,{className:"w-4 h-4 mr-2"}),"Dodaj pierwsze wydarzenie"]})]}),e.jsx(Ss,{current:w,pageSize:f,total:u?.total||0,setCurrent:g,itemName:"wydarzeń"})]})};var ft="AlertDialog",[Gn,to]=Ia(ft,[qa]),Re=qa(),gt=s=>{const{__scopeAlertDialog:a,...t}=s,r=Re(a);return e.jsx(Ua,{...r,...t,modal:!0})};gt.displayName=ft;var Jn="AlertDialogTrigger",Yn=o.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...r}=s,i=Re(t);return e.jsx(ur,{...i,...r,ref:a})});Yn.displayName=Jn;var Qn="AlertDialogPortal",wt=s=>{const{__scopeAlertDialog:a,...t}=s,r=Re(a);return e.jsx(Ba,{...r,...t})};wt.displayName=Qn;var Xn="AlertDialogOverlay",yt=o.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...r}=s,i=Re(t);return e.jsx(Vs,{...i,...r,ref:a})});yt.displayName=Xn;var Ye="AlertDialogContent",[el,sl]=Gn(Ye),al=xr("AlertDialogContent"),Nt=o.forwardRef((s,a)=>{const{__scopeAlertDialog:t,children:r,...i}=s,n=Re(t),c=o.useRef(null),u=ws(a,c),m=o.useRef(null);return e.jsx(mr,{contentName:Ye,titleName:vt,docsSlug:"alert-dialog",children:e.jsx(el,{scope:t,cancelRef:m,children:e.jsxs(Ks,{role:"alertdialog",...n,...i,ref:u,onOpenAutoFocus:Wa(i.onOpenAutoFocus,p=>{p.preventDefault(),m.current?.focus({preventScroll:!0})}),onPointerDownOutside:p=>p.preventDefault(),onInteractOutside:p=>p.preventDefault(),children:[e.jsx(al,{children:r}),e.jsx(rl,{contentRef:c})]})})})});Nt.displayName=Ye;var vt="AlertDialogTitle",bt=o.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...r}=s,i=Re(t);return e.jsx(Gs,{...i,...r,ref:a})});bt.displayName=vt;var zt="AlertDialogDescription",kt=o.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...r}=s,i=Re(t);return e.jsx(Js,{...i,...r,ref:a})});kt.displayName=zt;var tl="AlertDialogAction",_t=o.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...r}=s,i=Re(t);return e.jsx(Ys,{...i,...r,ref:a})});_t.displayName=tl;var St="AlertDialogCancel",Ct=o.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...r}=s,{cancelRef:i}=sl(St,t),n=Re(t),c=ws(a,i);return e.jsx(Ys,{...n,...r,ref:c})});Ct.displayName=St;var rl=({contentRef:s})=>{const a=`\`${Ye}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Ye}\` by passing a \`${zt}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Ye}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return o.useEffect(()=>{document.getElementById(s.current?.getAttribute("aria-describedby"))||console.warn(a)},[a,s]),null},il=gt,nl=wt,Pt=yt,Dt=Nt,Et=_t,Mt=Ct,Lt=bt,At=kt;const ll=il,ol=nl,Rt=o.forwardRef(({className:s,...a},t)=>e.jsx(Pt,{className:D("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t}));Rt.displayName=Pt.displayName;const Ft=o.forwardRef(({className:s,...a},t)=>e.jsxs(ol,{children:[e.jsx(Rt,{}),e.jsx(Dt,{ref:t,className:D("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a})]}));Ft.displayName=Dt.displayName;const Tt=({className:s,...a})=>e.jsx("div",{className:D("flex flex-col space-y-2 text-center sm:text-left",s),...a});Tt.displayName="AlertDialogHeader";const It=({className:s,...a})=>e.jsx("div",{className:D("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a});It.displayName="AlertDialogFooter";const Ot=o.forwardRef(({className:s,...a},t)=>e.jsx(Lt,{ref:t,className:D("text-lg font-semibold",s),...a}));Ot.displayName=Lt.displayName;const Wt=o.forwardRef(({className:s,...a},t)=>e.jsx(At,{ref:t,className:D("text-sm text-muted-foreground",s),...a}));Wt.displayName=At.displayName;const $t=o.forwardRef(({className:s,...a},t)=>e.jsx(Et,{ref:t,className:D(sa(),s),...a}));$t.displayName=Et.displayName;const qt=o.forwardRef(({className:s,...a},t)=>e.jsx(Mt,{ref:t,className:D(sa({variant:"outline"}),"mt-2 sm:mt-0",s),...a}));qt.displayName=Mt.displayName;const Bt=({eventId:s,onRegistrationChange:a,className:t,variant:r,size:i="default",disabled:n=!1})=>{const{data:c}=je(),u=Ga(),[m,p]=o.useState(!1),[w,g]=o.useState(null),[f,x]=o.useState(0);o.useEffect(()=>{(async()=>{if(s)try{if(c?.id){const{data:y,error:A}=await I.from("event_participants").select("*").eq("event_id",s).eq("user_id",c.id).maybeSingle();A||g(y)}const{count:z,error:l}=await I.from("event_participants").select("*",{count:"exact",head:!0}).eq("event_id",s).in("status",["registered","confirmed","attended"]);!l&&z!==null&&x(z)}catch(z){console.error("Error checking registration status:",z)}})()},[s,c?.id]);const b=async()=>{if(!c?.id){H.error("Musisz być zalogowany",{description:"Zaloguj się, aby zapisać się na wydarzenie"});return}p(!0);try{if(w){const{error:N}=await I.from("event_participants").delete().eq("id",w.id);if(N)throw N;const z=f-1;g(null),x(z),H.success("Wypisano z wydarzenia"),a?.(!1,z),u({resource:"events",invalidates:["detail","list"],id:s}),u({resource:"v_events_with_counts",invalidates:["list"]})}else{const{data:N,error:z}=await I.from("event_participants").insert({event_id:s,user_id:c.id,status:"registered"}).select().single();if(z){if(z.code==="23505"){const{data:y}=await I.from("event_participants").select("*").eq("event_id",s).eq("user_id",c.id).maybeSingle();if(y){g(y),H.error("Już jesteś zapisany na to wydarzenie");return}}throw z}const l=f+1;g(N),x(l),H.success("Zapisano na wydarzenie!",{description:"Otrzymasz potwierdzenie na email"}),a?.(!0,l),u({resource:"events",invalidates:["detail","list"],id:s}),u({resource:"v_events_with_counts",invalidates:["list"]})}}catch(N){console.error("Registration error:",N),H.error("Błąd",{description:N.message||"Nie udało się wykonać operacji"})}finally{p(!1)}};return e.jsx(v,{className:t,variant:w?"outline":r||"default",size:i,disabled:n||m,onClick:b,children:m?"Przetwarzanie...":w?e.jsxs(e.Fragment,{children:[e.jsx(ea,{className:"w-4 h-4 mr-2"}),"Wypisz się"]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"w-4 h-4 mr-2"}),"Zapisz się"]})})},cl=()=>{const{data:s}=je(),{queryResult:a}=Ka({resource:"events",meta:{select:"*, dance_style:dance_styles(*), organizer:users(*)"}}),{list:t,edit:r}=Ae(),{mutate:i}=zr();Ga();const[n,c]=o.useState(!1),[u,m]=o.useState(0),[p,w]=o.useState([]),[g,f]=o.useState(!1),{data:x,isLoading:b,isError:N,refetch:z}=a,l=x?.data,y=async()=>{if(l?.id){f(!0);try{const{data:T,error:Q}=await I.from("event_participants").select("*").eq("event_id",l.id).in("status",["registered","confirmed","attended"]).order("registered_at",{ascending:!1});if(console.log("Raw participants data:",T),Q)throw console.error("Error fetching participants:",Q),Q;if(T&&T.length>0){const X=T.map(De=>De.user_id),{data:me,error:xe}=await I.from("users").select("id, name, profile_photo_url, is_verified").in("id",X);console.log("Users data:",me),xe&&console.error("Error fetching users:",xe);const we=T.map(De=>({...De,user:me?.find(ms=>ms.id===De.user_id)||null}));console.log("Final participants with users:",we),w(we),m(we.length)}else w([]),m(0)}catch(T){console.error("Error in fetchParticipants:",T),H.error("Nie udało się pobrać listy uczestników")}finally{f(!1)}}};o.useEffect(()=>{l?.id&&y()},[l?.id]);const A=Xe({isLoading:b,isError:N});if(A)return A;if(!l)return e.jsx(ae,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-500 text-lg",children:"Wydarzenie nie zostało znalezione"}),e.jsx(v,{className:"mt-4",onClick:()=>t("events"),children:"Wróć do listy"})]})});const h=l.organizer_id===s?.id,_=new Date(l.end_at)<new Date,F=new Date(l.start_at)>new Date,Z=!_&&!F,B=l?.max_participants?l.max_participants-u:null,j=B!==null&&B<=0,C=!_&&!j&&l.status==="published"&&!h,E=T=>({lesson:e.jsx(rt,{className:"w-5 h-5"}),workshop:e.jsx(Be,{className:"w-5 h-5"}),social:e.jsx(tt,{className:"w-5 h-5"}),competition:e.jsx(ns,{className:"w-5 h-5"}),performance:e.jsx(at,{className:"w-5 h-5"})})[T]||e.jsx(Ke,{className:"w-5 h-5"}),P=T=>({lesson:"Lekcja",workshop:"Warsztaty",social:"Potańcówka",competition:"Zawody",performance:"Występ"})[T]||T,d=T=>({physical:"Stacjonarne",online:"Online",hybrid:"Hybrydowe"})[T]||T,k=T=>({beginner:"Początkujący",intermediate:"Średniozaawansowany",advanced:"Zaawansowany",professional:"Profesjonalny"})[T]||T,$=T=>{const Q={draft:{icon:e.jsx(ls,{className:"w-4 h-4"}),variant:"secondary",label:"Szkic"},published:{icon:e.jsx(Te,{className:"w-4 h-4"}),variant:"default",label:"Opublikowane"},cancelled:{icon:e.jsx(ea,{className:"w-4 h-4"}),variant:"destructive",label:"Odwołane"},completed:{icon:e.jsx(Te,{className:"w-4 h-4"}),variant:"outline",label:"Zakończone"}},X=Q[T]||Q.draft;return e.jsxs(R,{variant:X.variant,children:[X.icon,e.jsx("span",{className:"ml-1",children:X.label})]})},G=()=>{i({resource:"events",id:l.id},{onSuccess:()=>{H.success("Wydarzenie zostało usunięte"),t("events")},onError:T=>{console.error("Delete error:",T),H.error("Nie udało się usunąć wydarzenia")}})},S=()=>{navigator.share?navigator.share({title:l.title,text:l.description,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),H.success("Link skopiowany do schowka"))};return e.jsxs(ae,{children:[e.jsxs(te,{children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>t("events"),children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"Wróć do listy"]}),h&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>r("events",l.id),children:[e.jsx(et,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>c(!0),children:[e.jsx(Xa,{className:"w-4 h-4 mr-2"}),"Usuń"]})]})]}),e.jsx(L,{children:e.jsx(O,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(R,{variant:"default",className:"text-sm",children:[E(l.event_type),e.jsx("span",{className:"ml-1",children:P(l.event_type)})]}),$(l.status),_&&e.jsxs(R,{variant:"secondary",children:[e.jsx(Me,{className:"w-3 h-3 mr-1"}),"Zakończone"]}),Z&&e.jsxs(R,{variant:"default",className:"bg-green-500",children:[e.jsx(Me,{className:"w-3 h-3 mr-1"}),"W trakcie"]}),l.is_recurring&&e.jsxs(R,{variant:"outline",children:[e.jsx(Br,{className:"w-3 h-3 mr-1"}),"Cykliczne"]})]}),e.jsx("h1",{className:"text-3xl font-bold",children:l.title}),l.organizer&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsxs("span",{children:["Organizator: ",l.organizer.name]}),l.organizer.is_verified&&e.jsxs(R,{variant:"outline",className:"text-xs",children:[e.jsx(Te,{className:"w-3 h-3 mr-1"}),"Zweryfikowany"]})]})]})})}),e.jsxs(fe,{children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs(dt,{defaultValue:"details",className:"w-full",children:[e.jsxs(aa,{className:"grid w-full grid-cols-2",children:[e.jsx(Ge,{value:"details",children:"Szczegóły"}),e.jsxs(Ge,{value:"participants",children:["Uczestnicy (",u,")"]})]}),e.jsxs(Je,{value:"details",className:"space-y-6",children:[l.description&&e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5"}),"Opis wydarzenia"]})}),e.jsx(O,{children:e.jsx("p",{className:"whitespace-pre-wrap",children:l.description})})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"w-5 h-5"}),"Szczegóły"]})}),e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Data i czas"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4 text-muted-foreground"}),J(new Date(l.start_at),"EEEE, d MMMM yyyy",{locale:ue})]}),e.jsxs("p",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Me,{className:"w-4 h-4"}),J(new Date(l.start_at),"HH:mm")," -",J(new Date(l.end_at),"HH:mm")]})]})]}),e.jsx(he,{}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Lokalizacja"}),e.jsx(R,{variant:"outline",className:"mb-2",children:d(l.location_type)}),l.location_type==="online"?e.jsxs("div",{className:"space-y-2 mt-2",children:[l.online_platform&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(Ws,{className:"w-4 h-4 text-muted-foreground"}),l.online_platform]}),l.online_link&&e.jsxs(v,{variant:"link",className:"p-0 h-auto justify-start",onClick:()=>window.open(l.online_link,"_blank"),children:[e.jsx($s,{className:"w-4 h-4 mr-2"}),"Link do spotkania",e.jsx(Ps,{className:"w-3 h-3 ml-1"})]})]}):e.jsxs("div",{className:"space-y-2 mt-2",children:[l.location_name&&e.jsx("p",{className:"font-medium",children:l.location_name}),l.address&&e.jsxs("p",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(pe,{className:"w-4 h-4"}),l.address]}),l.city&&e.jsx("p",{className:"text-muted-foreground",children:l.city})]})]}),(l.dance_style||l.skill_level_min||l.skill_level_max)&&e.jsxs(e.Fragment,{children:[e.jsx(he,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.dance_style&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Styl tańca"}),e.jsxs(R,{variant:"secondary",children:[e.jsx(Ne,{className:"w-3 h-3 mr-1"}),l.dance_style.name]})]}),(l.skill_level_min||l.skill_level_max)&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Poziom"}),e.jsxs("p",{className:"text-sm",children:[l.skill_level_min&&k(l.skill_level_min),l.skill_level_min&&l.skill_level_max&&l.skill_level_min!==l.skill_level_max&&" - ",l.skill_level_max&&l.skill_level_min!==l.skill_level_max&&k(l.skill_level_max)]})]})]})]}),(l.requires_partner||l.age_min||l.age_max)&&e.jsxs(e.Fragment,{children:[e.jsx(he,{}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Wymagania"}),e.jsxs("div",{className:"space-y-1",children:[l.requires_partner&&e.jsxs(R,{variant:"outline",children:[e.jsx(ts,{className:"w-3 h-3 mr-1"}),"Wymagany partner"]}),(l.age_min||l.age_max)&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Wiek: ",l.age_min||"0"," - ",l.age_max||"99"," lat"]})]})]})]}),(l.website_url||l.registration_url)&&e.jsxs(e.Fragment,{children:[e.jsx(he,{}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Linki"}),e.jsxs("div",{className:"space-y-2",children:[l.website_url&&e.jsxs(v,{variant:"link",className:"p-0 h-auto justify-start",onClick:()=>window.open(l.website_url,"_blank"),children:[e.jsx(Ws,{className:"w-4 h-4 mr-2"}),"Strona wydarzenia",e.jsx(Ps,{className:"w-3 h-3 ml-1"})]}),l.registration_url&&e.jsxs(v,{variant:"link",className:"p-0 h-auto justify-start",onClick:()=>window.open(l.registration_url,"_blank"),children:[e.jsx($s,{className:"w-4 h-4 mr-2"}),"Rejestracja zewnętrzna",e.jsx(Ps,{className:"w-3 h-3 ml-1"})]})]})]})]})]})]})]}),e.jsx(Je,{value:"participants",className:"space-y-6",children:e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Lista uczestników"]})}),e.jsxs(O,{children:[g?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Ładowanie listy uczestników..."}):p.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Brak zapisanych uczestników"}):e.jsx("div",{className:"space-y-3",children:p.map(T=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(_e,{className:"h-10 w-10",children:[e.jsx(Pe,{src:T.user?.profile_photo_url,alt:T.user?.name}),e.jsx(Se,{children:T.user?.name?.charAt(0).toUpperCase()||"?"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium",children:T.user?.name||"Nieznany użytkownik"}),T.user?.is_verified&&e.jsxs(R,{variant:"outline",className:"text-xs",children:[e.jsx(Te,{className:"w-3 h-3 mr-1"}),"Zweryfikowany"]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Zapisany: ",J(new Date(T.registered_at),"d MMM yyyy, HH:mm",{locale:ue})]})]})]}),e.jsx(R,{variant:T.status==="attended"?"default":T.status==="confirmed"?"secondary":"outline",children:T.status==="attended"?"Uczestniczył":T.status==="confirmed"?"Potwierdzony":"Zapisany"})]},T.id))}),h&&p.length>0&&e.jsx("div",{className:"mt-4 pt-4 border-t text-sm text-muted-foreground",children:e.jsx("p",{children:"Jako organizator widzisz pełną listę uczestników."})}),!h&&p.length>0&&e.jsx("div",{className:"mt-4 pt-4 border-t text-sm text-muted-foreground",children:e.jsx("p",{children:"Lista uczestników jest widoczna dla wszystkich zapisanych."})})]})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(V,{className:"text-lg",children:"Udział"})}),e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Cena"}),l.price>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-2xl font-bold",children:[l.price," ",l.currency]}),l.early_bird_price&&l.early_bird_deadline&&new Date(l.early_bird_deadline)>new Date&&e.jsxs("div",{className:"p-2 bg-green-50 dark:bg-green-900/20 rounded-md",children:[e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400",children:[e.jsx(Ur,{className:"w-3 h-3 inline mr-1"}),"Early Bird: ",l.early_bird_price," ",l.currency]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["do ",J(new Date(l.early_bird_deadline),"d MMM",{locale:ue})]})]})]}):e.jsx(R,{variant:"default",className:"bg-green-500",children:"Bezpłatne"})]}),e.jsx(he,{}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Liczba miejsc"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),u," ",u===1?"osoba zapisana":"zapisanych"]}),l.max_participants&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["z ",l.max_participants]})]}),B!==null&&B>0&&B<=5&&e.jsxs("p",{className:"text-sm text-orange-600 dark:text-orange-400 mt-2",children:["Pozostało tylko ",B," ",B===1?"miejsce":B<=4?"miejsca":"miejsc","!"]}),j&&e.jsx(R,{variant:"destructive",className:"mt-2 w-full justify-center",children:"Brak wolnych miejsc"})]}),!h&&e.jsxs(e.Fragment,{children:[e.jsx(he,{}),e.jsx(Bt,{eventId:l.id,className:"w-full",disabled:!C&&!l.status,onRegistrationChange:(T,Q)=>{m(Q),y()}}),!C&&e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:_?"Wydarzenie się zakończyło":j?"Brak wolnych miejsc":l.status!=="published"?"Wydarzenie nie jest opublikowane":"Rejestracja niedostępna"})]})]})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(V,{className:"text-lg",children:"Akcje"})}),e.jsxs(O,{className:"space-y-2",children:[e.jsxs(v,{variant:"outline",className:"w-full",onClick:S,children:[e.jsx(Zr,{className:"w-4 h-4 mr-2"}),"Udostępnij"]}),e.jsxs(v,{variant:"outline",className:"w-full",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Dodaj do ulubionych"]}),l.organizer&&e.jsxs(v,{variant:"outline",className:"w-full",children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Kontakt z organizatorem"]})]})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(V,{className:"text-lg",children:"Informacje"})}),e.jsxs(O,{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Utworzono:"," ",J(new Date(l.created_at),"d MMM yyyy",{locale:ue})]}),e.jsxs("p",{children:["Ostatnia aktualizacja:"," ",J(new Date(l.updated_at),"d MMM yyyy",{locale:ue})]}),e.jsxs("p",{children:["ID wydarzenia: ",l.id.slice(0,8),"..."]})]})]})]})]}),e.jsx(ll,{open:n,onOpenChange:c,children:e.jsxs(Ft,{children:[e.jsxs(Tt,{children:[e.jsx(Ot,{children:"Czy na pewno chcesz usunąć to wydarzenie?"}),e.jsxs(Wt,{children:['Ta akcja jest nieodwracalna. Wydarzenie "',l.title,'" zostanie trwale usunięte wraz ze wszystkimi zapisami uczestników.']})]}),e.jsxs(It,{children:[e.jsx(qt,{children:"Anuluj"}),e.jsx($t,{onClick:G,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Usuń wydarzenie"})]})]})})]})},ta=o.forwardRef(({className:s,...a},t)=>e.jsx(Za,{className:D("grid gap-2",s),...a,ref:t}));ta.displayName=Za.displayName;const qe=o.forwardRef(({className:s,...a},t)=>e.jsx(Ha,{ref:t,className:D("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:e.jsx(hr,{className:"flex items-center justify-center",children:e.jsx(Hr,{className:"h-3.5 w-3.5 fill-primary"})})}));qe.displayName=Ha.displayName;const Ut=Ua,dl=Ba,Zt=o.forwardRef(({className:s,...a},t)=>e.jsx(Vs,{className:D("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t}));Zt.displayName=Vs.displayName;const ml=ds("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),ra=o.forwardRef(({side:s="right",className:a,children:t,...r},i)=>e.jsxs(dl,{children:[e.jsx(Zt,{}),e.jsxs(Ks,{ref:i,className:D(ml({side:s}),a),...r,children:[e.jsxs(Ys,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Ns,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]}),t]})]}));ra.displayName=Ks.displayName;const ia=({className:s,...a})=>e.jsx("div",{className:D("flex flex-col space-y-2 text-center sm:text-left",s),...a});ia.displayName="SheetHeader";const na=({className:s,...a})=>e.jsx("div",{className:D("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a});na.displayName="SheetFooter";const la=o.forwardRef(({className:s,...a},t)=>e.jsx(Gs,{ref:t,className:D("text-lg font-semibold text-foreground",s),...a}));la.displayName=Gs.displayName;const oa=o.forwardRef(({className:s,...a},t)=>e.jsx(Js,{ref:t,className:D("text-sm text-muted-foreground",s),...a}));oa.displayName=Js.displayName;const xl=()=>{const s=["Salsa","Bachata","Tango","Kizomba","Zumba","Flamenco","Hip Hop","Swing","Latin","Samba"],a=["Noc","Wieczór","Potańcówka","Impreza","Festiwal","Maraton","Party","Jam"],t=["Klub Havana","Studio Tańca Ritmo","Sala Balowa","Centrum Tańca","Klub Latino","Scena Viva","Pałac Kultury","Ogród Taneczny"],r=["Gorąca","Latynoska","Karaibska","Namiętna","Energetyczna","Kolorowa","","Klasyczna"],i=s[Math.floor(Math.random()*s.length)],n=a[Math.floor(Math.random()*a.length)],c=t[Math.floor(Math.random()*t.length)],u=r[Math.floor(Math.random()*r.length)];return`${u?`${u} `:""}${i} ${n} w ${c}`},ul=({open:s,onOpenChange:a,onImportSuccess:t})=>{const{data:r}=je(),[i,n]=o.useState("input"),[c,u]=o.useState(""),[m,p]=o.useState(!1),[w,g]=o.useState(null),{register:f,handleSubmit:x,setValue:b,watch:N,reset:z,formState:{errors:l}}=cs({defaultValues:{title:"",description:"",event_date:"",start_time:"",end_time:"",location_type:"physical",location_name:"",address:"",city:"",event_category:"social",dance_style_id:"",max_participants:"",price_amount:"0"}}),y=async()=>{if(!c){H.error("Podaj link do wydarzenia");return}p(!0);try{await new Promise(B=>setTimeout(B,1500));const _={title:xl(),description:`🎉 Zapraszamy na gorącą noc pełną tańca! 🎉

Dołącz do nas na niezapomnianą potańcówkę w rytmach latynoskich!

W programie:
✨ 20:00-21:00 - Warsztaty dla początkujących
✨ 21:00-02:00 - Potańcówka z DJ-em
✨ Pokazy taneczne
✨ Konkursy z nagrodami

Wstęp: 30 PLN (z warsztatami 40 PLN)

Nie zapomnij wygodnych butów do tańca!`,start_time:"2025-08-15T20:00:00",end_time:"2025-08-16T02:00:00",location:{name:"Klub Havana",address:"ul. Marszałkowska 55",city:"Warszawa"},is_online:!1,cover:{source:"https://example.com/cover.jpg"}};g(_);const F=new Date(_.start_time),Z=new Date(_.end_time);b("title",_.title),b("description",_.description),b("event_date",J(F,"yyyy-MM-dd")),b("start_time",J(F,"HH:mm")),b("end_time",J(Z,"HH:mm")),b("location_type",_.is_online?"online":"physical"),b("location_name",_.location?.name||""),b("address",_.location?.address||""),b("city",_.location?.city||""),n("preview"),H.success("Dane wydarzenia pobrane pomyślnie!")}catch(_){console.error("Error fetching Facebook event:",_),H.error("Nie udało się pobrać danych wydarzenia",{description:"Sprawdź czy link jest poprawny i spróbuj ponownie"})}finally{p(!1)}},A=async _=>{n("importing");try{await new Promise(F=>setTimeout(F,1e3)),H.success("Wydarzenie zaimportowane!",{description:"Możesz teraz dokończyć konfigurację wydarzenia"}),t&&t(_),n("input"),u(""),g(null),z(),a(!1)}catch(F){console.error("Import error:",F),H.error("Błąd podczas importu"),n("preview")}},h=()=>{n("input"),g(null),z()};return e.jsx(Ut,{open:s,onOpenChange:a,children:e.jsxs(ra,{className:"w-full sm:max-w-xl",children:[e.jsxs(ia,{children:[e.jsxs(la,{className:"flex items-center gap-2",children:[e.jsx(qs,{className:"w-5 h-5 text-blue-600"}),"Import wydarzenia z Facebooka"]}),e.jsxs(oa,{children:[i==="input"&&"Wklej link do wydarzenia na Facebooku",i==="preview"&&"Sprawdź i edytuj dane przed importem",i==="importing"&&"Importowanie wydarzenia..."]})]}),e.jsxs("div",{className:"mt-6",children:[i==="input"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"facebook-url",children:"Link do wydarzenia"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{id:"facebook-url",placeholder:"https://www.facebook.com/events/...",value:c,onChange:_=>u(_.target.value),className:"flex-1"}),e.jsx(v,{size:"icon",variant:"outline",onClick:()=>{navigator.clipboard.readText().then(_=>{u(_),H.success("Wklejono ze schowka")})},children:e.jsx(Vr,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Upewnij się, że wydarzenie jest publiczne"})]}),e.jsx("div",{className:"rounded-lg bg-orange-50 border border-orange-200 p-4 space-y-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ls,{className:"w-5 h-5 text-orange-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{className:"font-medium text-orange-900",children:"Ważne ograniczenia Facebook API"}),e.jsxs("ul",{className:"space-y-2 text-orange-800",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-orange-600",children:"•"}),e.jsxs("span",{children:["Możesz importować tylko wydarzenia ",e.jsx("strong",{children:"publiczne"})," ze stron, którymi zarządzasz"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-orange-600",children:"•"}),e.jsxs("span",{children:["Wydarzenia z grup Facebook ",e.jsx("strong",{children:"nie są dostępne"})," przez API"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-orange-600",children:"•"}),e.jsxs("span",{children:["Wydarzenia prywatne lub z ograniczonym dostępem ",e.jsx("strong",{children:"nie mogą być importowane"})]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-orange-600",children:"•"}),e.jsx("span",{children:"Facebook ograniczył dostęp do API wydarzeń ze względów bezpieczeństwa"})]})]})]})]})}),e.jsx("div",{className:"rounded-lg bg-blue-50 border border-blue-200 p-4 space-y-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ze,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Jak znaleźć link do wydarzenia?"}),e.jsxs("ol",{className:"space-y-1 text-blue-800",children:[e.jsx("li",{children:"1. Otwórz wydarzenie na Facebooku"}),e.jsx("li",{children:'2. Kliknij przycisk "Udostępnij"'}),e.jsx("li",{children:'3. Wybierz "Kopiuj link"'}),e.jsx("li",{children:"4. Wklej link tutaj"})]})]})]})}),e.jsx("div",{className:"rounded-lg bg-gray-50 border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Xs,{className:"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Alternatywne rozwiązanie"}),e.jsx("p",{className:"text-gray-700",children:"Jeśli nie możesz zaimportować wydarzenia automatycznie, możesz skopiować dane ręcznie z Facebooka i utworzyć wydarzenie używając standardowego formularza."})]})]})}),e.jsx(v,{className:"w-full",onClick:y,disabled:!c||m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"w-4 h-4 mr-2 animate-spin"}),"Pobieranie danych..."]}):e.jsxs(e.Fragment,{children:[e.jsx($s,{className:"w-4 h-4 mr-2"}),"Pobierz dane wydarzenia"]})})]}),i==="preview"&&w&&e.jsxs("form",{onSubmit:x(A),children:[e.jsx(Ue,{className:"h-[calc(100vh-240px)] pr-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(qs,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Dane z Facebooka"}),e.jsxs(R,{variant:"outline",className:"ml-auto",children:[e.jsx(ke,{className:"w-3 h-3 mr-1"}),"Pobrano"]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{children:J(new Date(w.start_time),"d MMMM yyyy, HH:mm",{locale:ue})})]}),w.location&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{children:w.location.name})]})]})]}),e.jsx(he,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"title",children:"Nazwa wydarzenia"}),e.jsx(q,{id:"title",className:"mt-1",...f("title",{required:"Nazwa jest wymagana"})}),l.title&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.title.message})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"description",children:"Opis"}),e.jsx(He,{id:"description",rows:4,className:"mt-1",...f("description")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"event_date",children:"Data"}),e.jsx(q,{id:"event_date",type:"date",className:"mt-1",...f("event_date",{required:!0})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"start_time",children:"Od"}),e.jsx(q,{id:"start_time",type:"time",className:"mt-1",...f("start_time",{required:!0})})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"end_time",children:"Do"}),e.jsx(q,{id:"end_time",type:"time",className:"mt-1",...f("end_time",{required:!0})})]})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"location_name",children:"Miejsce"}),e.jsx(q,{id:"location_name",className:"mt-1",...f("location_name")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"city",children:"Miasto"}),e.jsx(q,{id:"city",className:"mt-1",...f("city")})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"price_amount",children:"Cena (PLN)"}),e.jsx(q,{id:"price_amount",type:"number",min:"0",className:"mt-1",...f("price_amount")})]})]})]})]})}),e.jsxs(na,{className:"mt-6 gap-2",children:[e.jsx(v,{type:"button",variant:"outline",onClick:h,children:"Wróć"}),e.jsxs(v,{type:"submit",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Importuj wydarzenie"]})]})]}),i==="importing"&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(Ee,{className:"w-12 h-12 animate-spin text-primary"}),e.jsx("p",{className:"text-lg font-medium",children:"Importowanie wydarzenia..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"To może potrwać chwilę"})]})]})]})})},hl=[{title:"Warsztaty salsy",prompt:"Zorganizuj warsztaty salsy kubańskiej dla średniozaawansowanych, w sobotnie popołudnie, 2 godziny, maksymalnie 20 osób, cena 60 zł"},{title:"Potańcówka taneczna",prompt:"Stwórz wydarzenie - potańcówka z muzyką latynoską, piątkowy wieczór od 20:00 do 1:00, dla wszystkich poziomów, wstęp 30 zł"},{title:"Lekcja tanga",prompt:"Lekcja tanga argentyńskiego dla początkujących, środa 19:00, 90 minut, wymagany partner, maksymalnie 8 par, 40 zł od osoby"},{title:"Turniej taneczny",prompt:"Zawody taneczne w stylach standardowych, niedziela od 10:00, dla zaawansowanych i profesjonalnych, wpisowe 100 zł"}],pl=async(s,a=3,t=1e3)=>{for(let r=1;r<=a;r++)try{return await s()}catch(i){if(i.message.includes("500")&&r<a){console.warn(`Retry ${r}/${a} after 500 error`),await new Promise(n=>setTimeout(n,t));continue}throw i}},jl=({open:s,onOpenChange:a,onGenerateSuccess:t})=>{const{data:r}=je(),[i,n]=o.useState("input"),[c,u]=o.useState(""),[m,p]=o.useState(null),{register:w,setData:g,getData:f,registerLLMOperation:x}=Ze(),{loading:b,error:N,executeOperation:z,clearOperation:l}=zi("event-assistant","generate-event");o.useEffect(()=>{w({id:"event-assistant",title:"Asystent tworzenia wydarzeń",schema:{title:"Generowanie wydarzenia",properties:{prompt:{type:"text",title:"Opis wydarzenia"}},required:["prompt"]}}),x("event-assistant",{id:"generate-event",name:"Generuj dane wydarzenia",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś asystentem tworzenia wydarzeń tanecznych. Generujesz dane wydarzeń w formacie JSON.",user:`
  Stwórz wydarzenie taneczne na podstawie opisu: {{prompt}}
  
  Wygeneruj JSON:
  {
    "title": "<krótka nazwa wydarzenia>",
    "description": "<szczegółowy opis wydarzenia 50-150 słów>",
    "event_category": "<jedna z: lesson, workshop, social, competition, performance>",
    "dance_style": "<styl tańca lub null jeśli nie określono>",
    "event_date": "<data w formacie YYYY-MM-DD>",
    "start_time": "<godzina rozpoczęcia HH:MM>",
    "end_time": "<godzina zakończenia HH:MM>",
    "skill_level_required": "<jedna z: beginner, intermediate, advanced, professional lub null>",
    "max_participants": "<maksymalna liczba uczestników lub null>",
    "price_amount": "<cena w PLN jako string lub '0' jeśli darmowe>",
    "requires_partner": <true jeśli wymagany partner, false w przeciwnym razie>
  }
  
  Wymagania:
  - Zwróć TYLKO obiekt JSON, bez dodatkowego tekstu
  - Użyj najbliższej soboty jako daty jeśli nie określono
  - Domyślny czas trwania to 2 godziny
  - Wszystkie wartości muszą być poprawne
  `,responseFormat:"json"},inputMapping:F=>({prompt:F.prompt}),outputMapping:(F,Z)=>({...Z,...F}),validation:F=>F&&typeof F=="object"&&F.title&&F.event_category&&F.event_date&&F.start_time&&F.end_time})},[]);const y=async()=>{if(!c.trim()){H.error("Opisz wydarzenie, które chcesz stworzyć");return}try{l(),g("event-assistant",{prompt:c});const F=await pl(()=>z({prompt:c}));console.log("Raw LLM result:",F),p(F),n("preview"),H.success("Wydarzenie wygenerowane!",{description:"Sprawdź dane przed importem"})}catch(F){console.error("Generation error:",{message:F.message,stack:F.stack,prompt:c})}},A=()=>{m&&(t&&t({...m,location_type:"physical"}),n("input"),u(""),p(null),l(),a(!1),H.success("Dane zostały zaimportowane!",{description:"Uzupełnij lokalizację i pozostałe szczegóły"}))},h=F=>{u(F)},_=()=>{n("input"),p(null),l()};return e.jsx(Ut,{open:s,onOpenChange:a,children:e.jsxs(ra,{className:"w-full sm:max-w-xl",children:[e.jsxs(ia,{children:[e.jsxs(la,{className:"flex items-center gap-2",children:[e.jsx(it,{className:"w-5 h-5 text-purple-600"}),"Asystent AI"]}),e.jsxs(oa,{children:[i==="input"&&"Opisz wydarzenie, a AI wygeneruje szczegóły",i==="preview"&&"Sprawdź wygenerowane dane"]})]}),e.jsxs("div",{className:"mt-6",children:[i==="input"&&e.jsx(Ue,{className:"h-[calc(100vh-240px)]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"prompt",children:"Opisz swoje wydarzenie"}),e.jsx(He,{id:"prompt",placeholder:"np. Warsztaty bachaty dla początkujących w sobotę wieczorem, 2 godziny, maksymalnie 15 osób...",value:c,onChange:F=>u(F.target.value),rows:4,className:"resize-none"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Opisz typ wydarzenia, poziom uczestników, termin, długość trwania i inne ważne szczegóły"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-medium",children:"Przykładowe opisy:"}),e.jsx("div",{className:"grid gap-2",children:hl.map((F,Z)=>e.jsxs(L,{className:"p-3 cursor-pointer hover:bg-accent transition-colors",onClick:()=>h(F.prompt),children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:F.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:F.prompt})]},Z))})]}),e.jsx("div",{className:"rounded-lg bg-purple-50 border border-purple-200 p-4 space-y-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ze,{className:"w-5 h-5 text-purple-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{className:"font-medium text-purple-900",children:"Co może wygenerować AI?"}),e.jsxs("ul",{className:"space-y-1 text-purple-800",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Oe,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Tytuł i opis wydarzenia"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(ve,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Sugerowaną datę i godziny"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Ne,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Typ wydarzenia i styl tańca"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(se,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Poziom trudności i limit miejsc"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Os,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Sugerowaną cenę"})]})]})]})]})}),e.jsx("div",{className:"rounded-lg bg-orange-50 border border-orange-200 p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ls,{className:"w-5 h-5 text-orange-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-orange-900 mb-1",children:"Lokalizację dodasz później"}),e.jsx("p",{className:"text-orange-800",children:"AI nie generuje adresów - będziesz mógł je uzupełnić w kolejnym kroku"})]})]})}),N&&e.jsx("div",{className:"rounded-lg bg-red-50 border border-red-200 p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ls,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-red-900",children:"Błąd generowania"}),e.jsx("p",{className:"text-red-800",children:N})]})]})}),e.jsx(v,{className:"w-full",onClick:y,disabled:!c.trim()||b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"w-4 h-4 mr-2 animate-spin"}),"Generowanie..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Kr,{className:"w-4 h-4 mr-2"}),"Wygeneruj wydarzenie"]})})]})}),i==="preview"&&m&&e.jsx(Ue,{className:"h-[calc(100vh-240px)]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[e.jsx("div",{className:"rounded-lg border border-green-200 bg-green-50 p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-900",children:"Wydarzenie wygenerowane pomyślnie"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{className:"text-sm text-muted-foreground",children:"Nazwa"}),e.jsx("p",{className:"font-semibold text-lg",children:m.title})]}),e.jsxs("div",{children:[e.jsx(M,{className:"text-sm text-muted-foreground",children:"Opis"}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:m.description})]}),e.jsx(he,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{className:"text-sm text-muted-foreground",children:"Typ"}),e.jsxs(R,{variant:"secondary",className:"mt-1",children:[m.event_category==="lesson"&&"Lekcja",m.event_category==="workshop"&&"Warsztaty",m.event_category==="social"&&"Potańcówka",m.event_category==="competition"&&"Zawody",m.event_category==="performance"&&"Występ"]})]}),m.dance_style&&e.jsxs("div",{children:[e.jsx(M,{className:"text-sm text-muted-foreground",children:"Styl tańca"}),e.jsx("p",{className:"text-sm font-medium",children:m.dance_style})]})]}),e.jsxs("div",{children:[e.jsx(M,{className:"text-sm text-muted-foreground",children:"Termin"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx(ve,{className:"w-3 h-3 inline mr-1"}),J(new Date(m.event_date),"EEEE, d MMMM yyyy",{locale:ue})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx(Me,{className:"w-3 h-3 inline mr-1"}),m.start_time," - ",m.end_time]})]})]}),e.jsx(he,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.skill_level_required&&e.jsxs("div",{children:[e.jsx(M,{className:"text-sm text-muted-foreground",children:"Poziom"}),e.jsxs("p",{className:"text-sm font-medium",children:[m.skill_level_required==="beginner"&&"Początkujący",m.skill_level_required==="intermediate"&&"Średniozaawansowany",m.skill_level_required==="advanced"&&"Zaawansowany",m.skill_level_required==="professional"&&"Profesjonalny"]})]}),m.max_participants&&e.jsxs("div",{children:[e.jsx(M,{className:"text-sm text-muted-foreground",children:"Limit miejsc"}),e.jsxs("p",{className:"text-sm font-medium",children:[e.jsx(se,{className:"w-3 h-3 inline mr-1"}),m.max_participants," osób"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{className:"text-sm text-muted-foreground",children:"Cena"}),e.jsx("p",{className:"text-sm font-medium",children:m.price_amount==="0"?e.jsx(R,{variant:"outline",className:"text-green-600",children:"Bezpłatne"}):e.jsxs(e.Fragment,{children:[e.jsx(Os,{className:"w-3 h-3 inline mr-1"}),m.price_amount," PLN"]})})]}),m.requires_partner&&e.jsxs("div",{children:[e.jsx(M,{className:"text-sm text-muted-foreground",children:"Wymagania"}),e.jsxs(R,{variant:"outline",children:[e.jsx(se,{className:"w-3 h-3 mr-1"}),"Wymagany partner"]})]})]})]}),e.jsx("div",{className:"rounded-lg bg-blue-50 border border-blue-200 p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ze,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Pamiętaj o uzupełnieniu lokalizacji"}),e.jsx("p",{className:"text-blue-800",children:"Po imporcie dodaj adres miejsca, w którym odbędzie się wydarzenie"})]})]})})]})})]}),e.jsx(na,{className:"mt-6",children:i==="input"?e.jsx(v,{variant:"outline",onClick:()=>a(!1),children:"Anuluj"}):e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsxs(v,{variant:"outline",onClick:_,children:[e.jsx(is,{className:"w-4 h-4 mr-2 rotate-180"}),"Wróć"]}),e.jsxs(v,{variant:"outline",onClick:y,children:[e.jsx(nt,{className:"w-4 h-4 mr-2"}),"Generuj ponownie"]}),e.jsxs(v,{onClick:A,className:"flex-1",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Importuj dane"]})]})})]})})},fl=()=>{const{list:s}=Ae(),{data:a}=je(),[t,r]=o.useState([]),[i,n]=o.useState(1),[c,u]=o.useState(!1),[m,p]=o.useState(!1),{register:w,handleSubmit:g,setValue:f,watch:x,formState:{errors:b,isSubmitting:N}}=cs({defaultValues:{event_category:"lesson",location_type:"physical",visibility:"public",status:"published",requires_partner:!1}}),z=x("event_category"),l=x("location_type"),y=x("price_amount");o.useEffect(()=>{(async()=>{const{data:C,error:E}=await I.from("dance_styles").select("id, name, category").order("name");C&&r(C)})()},[]);const A=[{value:"lesson",label:"Lekcja",icon:e.jsx(Ne,{className:"w-4 h-4"}),description:"Indywidualne lub grupowe zajęcia"},{value:"workshop",label:"Warsztaty",icon:e.jsx(bs,{className:"w-4 h-4"}),description:"Intensywne szkolenie tematyczne"},{value:"social",label:"Potańcówka",icon:e.jsx(Oe,{className:"w-4 h-4"}),description:"Impreza taneczna"},{value:"competition",label:"Zawody",icon:e.jsx(ns,{className:"w-4 h-4"}),description:"Turniej taneczny"},{value:"performance",label:"Występ",icon:e.jsx(Gr,{className:"w-4 h-4"}),description:"Pokaz taneczny"}],h=j=>{Object.keys(j).forEach(C=>{j[C]&&f(C,j[C])}),n(1),H.success("Dane zostały zaimportowane",{description:"Możesz teraz dokończyć tworzenie wydarzenia"})},_=j=>{Object.keys(j).forEach(C=>{j[C]!==void 0&&j[C]!==null&&f(C,j[C])}),n(1),H.success("Dane zostały wygenerowane",{description:"Uzupełnij lokalizację i dokończ tworzenie wydarzenia"})},F=async j=>{if(!a?.id){H.error("Błąd",{description:"Musisz być zalogowany, aby utworzyć wydarzenie"});return}try{const C={organizer_id:a.id,title:j.title,description:j.description,event_type:j.event_category,dance_style_id:j.dance_style_id||null,start_at:new Date(`${j.event_date}T${j.start_time}`).toISOString(),end_at:new Date(`${j.event_date}T${j.end_time}`).toISOString(),is_recurring:!1,location_type:j.location_type,location_name:j.location_name||null,address:j.address||null,city:j.city||null,online_platform:j.online_platform||null,online_link:j.online_link||null,price:j.price_amount?parseFloat(j.price_amount):0,currency:"PLN",max_participants:j.max_participants?parseInt(j.max_participants):null,min_participants:1,skill_level_min:j.skill_level_required||null,skill_level_max:j.skill_level_required||null,requires_partner:j.requires_partner,visibility:j.visibility,status:j.status},{data:E,error:P}=await I.from("events").insert(C).select().single();if(P)throw new Error(P.message);H.success("Sukces!",{description:"Wydarzenie zostało utworzone"}),s("events")}catch(C){console.error("Błąd podczas tworzenia wydarzenia:",C),H.error("Błąd",{description:"Nie udało się utworzyć wydarzenia"})}},Z=[{number:1,title:"Podstawy",icon:e.jsx(ze,{className:"w-4 h-4"})},{number:2,title:"Termin",icon:e.jsx(ve,{className:"w-4 h-4"})},{number:3,title:"Miejsce",icon:e.jsx(pe,{className:"w-4 h-4"})},{number:4,title:"Szczegóły",icon:e.jsx(se,{className:"w-4 h-4"})}],B=()=>{switch(i){case 1:return x("title")&&x("event_category")&&x("description");case 2:return x("event_date")&&x("start_time")&&x("end_time");case 3:return l==="online"?x("online_platform"):x("address")&&x("city");case 4:return!0;default:return!1}};return e.jsxs("div",{className:"min-h-screen bg-gray-50/50",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-white border-b",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-4  flex items-center justify-between h-16",children:[e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>s("events"),children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),e.jsx("h1",{className:"font-semibold text-xl",children:"Nowe wydarzenie"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>p(!0),className:"text-purple-600 hover:text-purple-700 hover:bg-purple-50",title:"Asystent AI",children:[e.jsx(it,{className:"w-4 h-4 mr-2"}),"Asystent"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>u(!0),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"Importuj z Facebooka",children:[e.jsx(qs,{className:"w-4 h-4 mr-2"}),"Import"]})]})]})}),e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"max-w-3xl mx-auto px-4 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:Z.map((j,C)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("button",{type:"button",onClick:()=>i>j.number&&n(j.number),className:D("flex items-center gap-2 px-3 py-2 rounded-lg transition-all",i===j.number&&"bg-purple-100 text-purple-700",i>j.number&&"text-green-600 cursor-pointer hover:bg-gray-100",i<j.number&&"text-gray-400"),disabled:i<j.number,children:[e.jsx("div",{className:D("w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-all",i===j.number&&"bg-purple-600 text-white",i>j.number&&"bg-green-600 text-white",i<j.number&&"bg-gray-200"),children:i>j.number?e.jsx(ke,{className:"w-5 h-5"}):j.number}),e.jsx("span",{className:"hidden sm:inline font-medium",children:j.title})]}),C<Z.length-1&&e.jsx("div",{className:D("w-12 h-0.5 mx-2",i>j.number?"bg-green-600":"bg-gray-200")})]},j.number))})})}),e.jsxs("form",{onSubmit:g(F),className:"max-w-3xl mx-auto px-4 py-6",children:[i===1&&e.jsx("div",{className:"space-y-6",children:e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(V,{children:"O czym jest Twoje wydarzenie?"})}),e.jsxs(O,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(M,{className:"text-base font-medium mb-3 block",children:"Wybierz typ wydarzenia"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:A.map(j=>e.jsxs("button",{type:"button",onClick:()=>f("event_category",j.value),className:D("p-4 rounded-lg border-2 transition-all text-left",z===j.value?"border-purple-600 bg-purple-50":"border-gray-200 hover:border-gray-300"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:D("p-1.5 rounded",z===j.value?"bg-purple-600 text-white":"bg-gray-100"),children:j.icon}),e.jsx("span",{className:"font-medium",children:j.label})]}),e.jsx("p",{className:"text-xs text-gray-600",children:j.description})]},j.value))})]}),e.jsxs("div",{children:[e.jsxs(M,{htmlFor:"title",children:["Nazwa wydarzenia ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{id:"title",placeholder:"np. Salsa kubańska dla początkujących",className:"mt-1",...w("title",{required:"Nazwa jest wymagana",minLength:{value:5,message:"Nazwa musi mieć minimum 5 znaków"}})}),b.title&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:String(b.title.message)})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"dance_style_id",children:"Styl tańca"}),e.jsxs(ce,{value:x("dance_style_id"),onValueChange:j=>f("dance_style_id",j),children:[e.jsx(le,{className:"mt-1",children:e.jsx(de,{placeholder:"Wybierz styl tańca"})}),e.jsx(oe,{children:t.map(j=>e.jsx(W,{value:j.id,children:j.name},j.id))})]})]}),e.jsxs("div",{children:[e.jsxs(M,{htmlFor:"description",children:["Opis wydarzenia ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(He,{id:"description",placeholder:"Opisz co będzie się działo, dla kogo jest wydarzenie, czego nauczysz...",rows:4,className:"mt-1",...w("description",{required:"Opis jest wymagany",minLength:{value:20,message:"Opis musi mieć minimum 20 znaków"}})}),b.description&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:String(b.description.message)})]})]})]})}),i===2&&e.jsx("div",{className:"space-y-6",children:e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(V,{children:"Kiedy się odbędzie?"})}),e.jsxs(O,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(M,{htmlFor:"event_date",children:["Data ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{id:"event_date",type:"date",min:new Date().toISOString().split("T")[0],className:"mt-1",...w("event_date",{required:"Data jest wymagana"})}),b.event_date&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:String(b.event_date.message)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(M,{htmlFor:"start_time",children:["Godzina rozpoczęcia"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{id:"start_time",type:"time",className:"mt-1",...w("start_time",{required:"Godzina rozpoczęcia jest wymagana"})}),b.start_time&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:String(b.start_time.message)})]}),e.jsxs("div",{children:[e.jsxs(M,{htmlFor:"end_time",children:["Godzina zakończenia"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{id:"end_time",type:"time",className:"mt-1",...w("end_time",{required:"Godzina zakończenia jest wymagana"})}),b.end_time&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:String(b.end_time.message)})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Popularne godziny:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["18:00","19:00","20:00","10:00","11:00"].map(j=>e.jsx(v,{type:"button",variant:"outline",size:"sm",onClick:()=>f("start_time",j),children:j},j))})]})]})]})}),i===3&&e.jsx("div",{className:"space-y-6",children:e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(V,{children:"Gdzie się odbędzie?"})}),e.jsxs(O,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(M,{children:"Typ lokalizacji"}),e.jsxs(ta,{value:l,onValueChange:j=>f("location_type",j),className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg hover:bg-gray-50",children:[e.jsx(qe,{value:"physical",id:"physical"}),e.jsxs(M,{htmlFor:"physical",className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:"Stacjonarne"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Studio, sala, klub"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg hover:bg-gray-50",children:[e.jsx(qe,{value:"online",id:"online"}),e.jsxs(M,{htmlFor:"online",className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:"Online"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Zoom, Google Meet, itp."})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg hover:bg-gray-50",children:[e.jsx(qe,{value:"hybrid",id:"hybrid"}),e.jsxs(M,{htmlFor:"hybrid",className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:"Hybrydowe"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Stacjonarnie i online"})]})]})]})]}),l==="online"?e.jsxs("div",{children:[e.jsxs(M,{htmlFor:"online_platform",children:["Platforma ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(ce,{value:x("online_platform"),onValueChange:j=>f("online_platform",j),children:[e.jsx(le,{className:"mt-1",children:e.jsx(de,{placeholder:"Wybierz platformę"})}),e.jsxs(oe,{children:[e.jsx(W,{value:"zoom",children:"Zoom"}),e.jsx(W,{value:"google_meet",children:"Google Meet"}),e.jsx(W,{value:"skype",children:"Skype"}),e.jsx(W,{value:"other",children:"Inne"})]})]})]}):(l==="physical"||l==="hybrid")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"location_name",children:"Nazwa miejsca"}),e.jsx(q,{id:"location_name",placeholder:"np. Studio Tańca Salsa",className:"mt-1",...w("location_name")})]}),e.jsxs("div",{children:[e.jsxs(M,{htmlFor:"address",children:["Adres ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{id:"address",placeholder:"ul. Taneczna 10",className:"mt-1",...w("address",{required:l==="physical"||l==="hybrid"?"Adres jest wymagany":!1})}),b.address&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:String(b.address.message)})]}),e.jsxs("div",{children:[e.jsxs(M,{htmlFor:"city",children:["Miasto ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{id:"city",placeholder:"Warszawa",className:"mt-1",...w("city",{required:l==="physical"||l==="hybrid"?"Miasto jest wymagane":!1})}),b.city&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:String(b.city.message)})]})]})]})]})}),i===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsx(U,{children:e.jsx(V,{children:"Ostatnie szczegóły"})}),e.jsxs(O,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"price_amount",children:"Cena (PLN)"}),e.jsx(q,{id:"price_amount",type:"number",min:"0",step:"5",placeholder:"0",className:"mt-1",...w("price_amount")}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Zostaw puste lub wpisz 0 dla wydarzenia darmowego"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"max_participants",children:"Maksymalna liczba uczestników"}),e.jsx(q,{id:"max_participants",type:"number",min:"1",placeholder:"Bez limitu",className:"mt-1",...w("max_participants")})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"skill_level_required",children:"Poziom zaawansowania"}),e.jsxs(ce,{value:x("skill_level_required"),onValueChange:j=>f("skill_level_required",j),children:[e.jsx(le,{className:"mt-1",children:e.jsx(de,{placeholder:"Dla każdego"})}),e.jsxs(oe,{children:[e.jsx(W,{value:"beginner",children:"Początkujący"}),e.jsx(W,{value:"intermediate",children:"Średniozaawansowany"}),e.jsx(W,{value:"advanced",children:"Zaawansowany"}),e.jsx(W,{value:"professional",children:"Profesjonalny"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"requires_partner",className:"text-base font-medium",children:"Wymagany partner"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Czy uczestnicy muszą przyjść w parach?"})]}),e.jsx(Fe,{id:"requires_partner",checked:x("requires_partner"),onCheckedChange:j=>f("requires_partner",j)})]})]})]}),e.jsxs(L,{className:"bg-purple-50 border-purple-200",children:[e.jsx(U,{children:e.jsx(V,{className:"text-lg",children:"Podsumowanie"})}),e.jsxs(O,{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Nazwa:"}),e.jsx("span",{className:"font-medium",children:x("title")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Data:"}),e.jsx("span",{className:"font-medium",children:x("event_date")&&J(new Date(x("event_date")),"d MMMM yyyy",{locale:ue})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Godzina:"}),e.jsxs("span",{className:"font-medium",children:[x("start_time")," - ",x("end_time")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Cena:"}),e.jsx("span",{className:"font-medium",children:y?`${y} PLN`:"Darmowe"})]})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-8",children:[i>1?e.jsx(v,{type:"button",variant:"outline",onClick:()=>n(i-1),children:"Wstecz"}):e.jsx("div",{}),i<4?e.jsx(v,{type:"button",onClick:()=>n(i+1),disabled:!B(),children:"Dalej"}):e.jsx(v,{type:"submit",disabled:N,children:N?"Tworzenie...":"Utwórz wydarzenie"})]})]}),e.jsx(ul,{open:c,onOpenChange:u,onImportSuccess:h}),e.jsx(jl,{open:m,onOpenChange:p,onGenerateSuccess:_})]})},gl=()=>{const{id:s}=Va(),{data:a}=je(),t=Ce(),[r,i]=o.useState(null),[n,c]=o.useState(!0),[u,m]=o.useState(null),[p,w]=o.useState([]),{register:g,handleSubmit:f,setValue:x,watch:b,reset:N,formState:{errors:z,isSubmitting:l}}=cs();o.useEffect(()=>{(async()=>{const{data:_,error:F}=await I.from("dance_styles").select("id, name, category").order("name");_&&w(_)})()},[]),o.useEffect(()=>{s&&(c(!0),m(null),I.from("events").select("*").eq("id",s).single().then(({data:h,error:_})=>{if(_)console.error("Error fetching event:",_),m("Nie udało się pobrać wydarzenia");else if(h){i(h);const F=new Date(h.start_at),Z=new Date(h.end_at),B=j=>{const C=E=>String(E).padStart(2,"0");return`${j.getFullYear()}-${C(j.getMonth()+1)}-${C(j.getDate())}T${C(j.getHours())}:${C(j.getMinutes())}`};N({title:h.title,event_type:h.event_type,dance_style_id:h.dance_style_id||"",description:h.description||"",start_at:B(F),end_at:B(Z),location_type:h.location_type,online_platform:h.online_platform||"",online_link:h.online_link||"",location_name:h.location_name||"",address:h.address||"",city:h.city||"",max_participants:h.max_participants?.toString()||"",skill_level_min:h.skill_level_min||"all",skill_level_max:h.skill_level_max||"all",requires_partner:h.requires_partner||!1,price:h.price?.toString()||"0",currency:h.currency||"PLN",visibility:h.visibility||"public",status:h.status||"published"})}c(!1)}))},[s,N]);const y=b("location_type"),A=async h=>{if(!a?.id){H.error("Musisz być zalogowany");return}if(!r||r.organizer_id!==a.id){H.error("Nie masz uprawnień do edycji tego wydarzenia");return}try{const _={title:h.title,description:h.description||null,event_type:h.event_type,dance_style_id:h.dance_style_id||null,start_at:new Date(h.start_at).toISOString(),end_at:new Date(h.end_at).toISOString(),location_type:h.location_type,location_name:h.location_name||null,address:h.address||null,city:h.city||null,online_platform:h.online_platform||null,online_link:h.online_link||null,price:parseFloat(h.price)||0,currency:h.currency,max_participants:h.max_participants?parseInt(h.max_participants):null,skill_level_min:h.skill_level_min==="all"?null:h.skill_level_min||null,skill_level_max:h.skill_level_max==="all"?null:h.skill_level_max||null,requires_partner:h.requires_partner||!1,visibility:h.visibility,status:h.status},{error:F}=await I.from("events").update(_).eq("id",s);if(F)throw F;H.success("Wydarzenie zostało zaktualizowane!"),t(`/events/show/${s}`)}catch(_){console.error("Update error:",_),H.error("Błąd aktualizacji",{description:_.message||"Spróbuj ponownie"})}};return n?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Ładowanie wydarzenia..."})]})}):u||!r?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-500 text-lg",children:u||"Wydarzenie nie zostało znalezione"}),e.jsx(v,{className:"mt-4",onClick:()=>t("/events"),children:"Wróć do listy"})]}):r.organizer_id!==a?.id?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-500 text-lg",children:"Nie masz uprawnień do edycji tego wydarzenia"}),e.jsx(v,{className:"mt-4",onClick:()=>t(`/events/show/${s}`),children:"Wróć do wydarzenia"})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50/50",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-white border-b",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 flex items-center justify-between h-16",children:[e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>t(`/events/show/${s}`),children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),e.jsx("h1",{className:"font-semibold text-xl",children:"Edytuj wydarzenie"}),e.jsx("div",{className:"w-20"})]})}),e.jsxs("form",{onSubmit:f(A),className:"max-w-5xl mx-auto px-4 py-6 space-y-6",children:[e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5"}),"Podstawowe informacje"]})}),e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(M,{htmlFor:"title",children:["Nazwa wydarzenia ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{id:"title",className:"mt-1",...g("title",{required:"Nazwa jest wymagana",minLength:{value:5,message:"Nazwa musi mieć minimum 5 znaków"}})}),z.title&&typeof z.title.message=="string"&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:z.title.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{children:"Typ wydarzenia"}),e.jsxs(ce,{value:b("event_type"),onValueChange:h=>x("event_type",h),children:[e.jsx(le,{className:"mt-1",children:e.jsx(de,{})}),e.jsxs(oe,{children:[e.jsx(W,{value:"lesson",children:"Lekcja"}),e.jsx(W,{value:"workshop",children:"Warsztaty"}),e.jsx(W,{value:"social",children:"Potańcówka"}),e.jsx(W,{value:"competition",children:"Zawody"}),e.jsx(W,{value:"performance",children:"Występ"})]})]})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Styl tańca"}),e.jsxs(ce,{value:b("dance_style_id"),onValueChange:h=>x("dance_style_id",h),children:[e.jsx(le,{className:"mt-1",children:e.jsx(de,{placeholder:"Wybierz styl"})}),e.jsx(oe,{children:p.map(h=>e.jsx(W,{value:h.id,children:h.name},h.id))})]})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"description",children:"Opis"}),e.jsx(He,{id:"description",rows:4,className:"mt-1",...g("description")})]})]})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),"Data i czas"]})}),e.jsx(O,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(M,{htmlFor:"start_at",children:["Data i godzina rozpoczęcia ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{id:"start_at",type:"datetime-local",className:"mt-1",...g("start_at",{required:"Data rozpoczęcia jest wymagana"})}),z.start_at&&typeof z.start_at.message=="string"&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:z.start_at.message})]}),e.jsxs("div",{children:[e.jsxs(M,{htmlFor:"end_at",children:["Data i godzina zakończenia ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{id:"end_at",type:"datetime-local",className:"mt-1",...g("end_at",{required:"Data zakończenia jest wymagana"})}),z.end_at&&typeof z.end_at.message=="string"&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:z.end_at.message})]})]})})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Lokalizacja"]})}),e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{children:"Typ lokalizacji"}),e.jsxs(ta,{value:y,onValueChange:h=>x("location_type",h),className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qe,{value:"physical",id:"physical"}),e.jsx(M,{htmlFor:"physical",className:"font-normal",children:"Stacjonarne"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qe,{value:"online",id:"online"}),e.jsx(M,{htmlFor:"online",className:"font-normal",children:"Online"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qe,{value:"hybrid",id:"hybrid"}),e.jsx(M,{htmlFor:"hybrid",className:"font-normal",children:"Hybrydowe"})]})]})]}),y==="online"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"online_platform",children:"Platforma"}),e.jsx(q,{id:"online_platform",placeholder:"np. Zoom, Google Meet",className:"mt-1",...g("online_platform")})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"online_link",children:"Link do spotkania"}),e.jsx(q,{id:"online_link",type:"url",placeholder:"https://...",className:"mt-1",...g("online_link")})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"location_name",children:"Nazwa miejsca"}),e.jsx(q,{id:"location_name",placeholder:"np. Studio Tańca Salsa",className:"mt-1",...g("location_name")})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"address",children:"Adres"}),e.jsx(q,{id:"address",placeholder:"ul. Taneczna 10",className:"mt-1",...g("address")})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"city",children:"Miasto"}),e.jsx(q,{id:"city",placeholder:"Warszawa",className:"mt-1",...g("city")})]})]})]})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Szczegóły"]})}),e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"price",children:"Cena (PLN)"}),e.jsx(q,{id:"price",type:"number",min:"0",step:"5",className:"mt-1",...g("price")})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"max_participants",children:"Max. liczba uczestników"}),e.jsx(q,{id:"max_participants",type:"number",min:"1",placeholder:"Bez limitu",className:"mt-1",...g("max_participants")})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Poziom minimalny"}),e.jsxs(ce,{value:b("skill_level_min"),onValueChange:h=>x("skill_level_min",h),children:[e.jsx(le,{className:"mt-1",children:e.jsx(de,{placeholder:"Dla każdego"})}),e.jsxs(oe,{children:[e.jsx(W,{value:"all",children:"Dla każdego"}),e.jsx(W,{value:"beginner",children:"Początkujący"}),e.jsx(W,{value:"intermediate",children:"Średniozaawansowany"}),e.jsx(W,{value:"advanced",children:"Zaawansowany"}),e.jsx(W,{value:"professional",children:"Profesjonalny"})]})]})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Poziom maksymalny"}),e.jsxs(ce,{value:b("skill_level_max"),onValueChange:h=>x("skill_level_max",h),children:[e.jsx(le,{className:"mt-1",children:e.jsx(de,{placeholder:"Bez ograniczeń"})}),e.jsxs(oe,{children:[e.jsx(W,{value:"all",children:"Bez ograniczeń"}),e.jsx(W,{value:"beginner",children:"Początkujący"}),e.jsx(W,{value:"intermediate",children:"Średniozaawansowany"}),e.jsx(W,{value:"advanced",children:"Zaawansowany"}),e.jsx(W,{value:"professional",children:"Profesjonalny"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(M,{className:"text-base font-medium",children:"Wymagany partner"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Czy uczestnicy muszą przyjść w parach?"})]}),e.jsx(Fe,{checked:b("requires_partner"),onCheckedChange:h=>x("requires_partner",h)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{children:"Status"}),e.jsxs(ce,{value:b("status"),onValueChange:h=>x("status",h),children:[e.jsx(le,{className:"mt-1",children:e.jsx(de,{})}),e.jsxs(oe,{children:[e.jsx(W,{value:"draft",children:"Szkic"}),e.jsx(W,{value:"published",children:"Opublikowane"}),e.jsx(W,{value:"cancelled",children:"Odwołane"}),e.jsx(W,{value:"completed",children:"Zakończone"})]})]})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Widoczność"}),e.jsxs(ce,{value:b("visibility"),onValueChange:h=>x("visibility",h),children:[e.jsx(le,{className:"mt-1",children:e.jsx(de,{})}),e.jsxs(oe,{children:[e.jsx(W,{value:"public",children:"Publiczne"}),e.jsx(W,{value:"private",children:"Prywatne"}),e.jsx(W,{value:"unlisted",children:"Niewidoczne w liście"})]})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>t(`/events/show/${s}`),children:"Anuluj"}),e.jsx(v,{type:"submit",disabled:l,children:l?"Zapisywanie...":"Zapisz zmiany"})]})]})]})},wl={name:"events",list:"/events",show:"/events/show/:id",create:"/events/create",edit:"/events/edit/:id",meta:{label:"Wydarzenia"}},yl=[e.jsx(Y,{path:"/events",element:e.jsx(Kn,{})},"events-list"),e.jsx(Y,{path:"/events/show/:id",element:e.jsx(cl,{})},"events-show"),e.jsx(Y,{path:"/events/create",element:e.jsx(fl,{})},"events-create"),e.jsx(Y,{path:"/events/edit/:id",element:e.jsx(gl,{})},"events-edit")],Nl=()=>{const[s,a]=o.useState(""),[t,r]=o.useState("all"),[i,n]=o.useState("all"),[c,u]=o.useState({}),[m,p]=o.useState({}),{tableQuery:{data:w,isLoading:g,isError:f},current:x,setCurrent:b,pageSize:N,setFilters:z}=ys({resource:"users",pagination:{pageSize:12},filters:{initial:[{field:"is_trainer",operator:"eq",value:!0}]},sorters:{initial:[{field:"created_at",order:"desc"}]}}),{show:l,create:y}=Ae();o.useEffect(()=>{(async()=>{if(!w?.data)return;const k=w.data.map($=>$.id);console.log("Fetching stats for trainers:",k);try{const{data:$,error:G}=await I.from("v_trainer_stats").select("*").in("trainer_id",k);if(console.log("Trainer stats response:",{stats:$,error:G}),console.log("Detailed stats data:",$?.map(X=>({trainer_id:X.trainer_id,name:X.name,total_events:X.total_events,unique_students:X.unique_students,average_rating:X.average_rating,review_count:X.review_count}))),G&&console.error("Error fetching trainer stats:",G),!G&&$){const X=$.reduce((me,xe)=>(me[xe.trainer_id]=xe,me),{});console.log("Stats map:",X),u(X)}console.log("Fetching price ranges for trainers...");const{data:S,error:T}=await I.from("events").select("id, organizer_id, price, status, title, event_type").in("organizer_id",k).in("event_type",["lesson","workshop"]);console.log("Lesson and workshop events for trainers:",S);const Q={};!T&&S&&k.forEach(X=>{const me=S.filter(we=>we.organizer_id===X);console.log(`Lessons/workshops for trainer ${X}:`,me);const xe=me.filter(we=>we.price>0);if(console.log(`Lessons/workshops with price > 0 for trainer ${X}:`,xe),xe.length>0){const we=xe.map(De=>De.price);Q[X]={min:Math.min(...we),max:Math.max(...we)}}}),console.log("Final price map:",Q),p(Q)}catch($){console.error("Error fetching trainer stats:",$)}})()},[w?.data]);const A=d=>{a(d),F(d,t,i)},h=d=>{r(d),F(s,d,i)},_=d=>{n(d),F(s,t,d)},F=(d,k,$)=>{const G=[];k!=="all"&&G.push({field:"city",operator:"eq",value:k}),$!=="all"&&G.push({field:"teaching_styles",operator:"contains",value:$}),d&&G.push({field:"name",operator:"contains",value:d}),G.push({field:"is_trainer",operator:"eq",value:!0}),z(G)},Z=Xe({isLoading:g,isError:f});if(Z)return Z;const B=w?.data||[],j=Array.from(new Set(B.map(d=>d.city).filter(Boolean))),C=new Set;Object.values(c).forEach(d=>{d.teaching_styles&&d.teaching_styles.forEach(k=>C.add(k))});const E=d=>{const k=m[d];return k?k.min===k.max?`${k.min} PLN`:`${k.min}-${k.max} PLN`:"Free"};let P=B;return i!=="all"&&(P=B.filter(d=>c[d.id]?.teaching_styles?.includes(i))),e.jsxs(ae,{children:[e.jsx(te,{children:e.jsx(ye,{title:"Znajdź trenera",description:"Umów się na zajęcia taneczne z najlepszymi instruktorami"})}),e.jsxs(te,{children:[e.jsxs("div",{className:"relative max-w-md w-full",children:[e.jsx(vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(q,{placeholder:"Szukaj trenera...",className:"pl-10",value:s,onChange:d=>A(d.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ce,{value:t,onValueChange:h,children:[e.jsxs(le,{className:"w-[140px]",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),e.jsx(de,{placeholder:"Miasto"})]}),e.jsxs(oe,{children:[e.jsx(W,{value:"all",children:"Wszystkie miasta"}),j.map(d=>e.jsx(W,{value:d,children:d},d))]})]}),e.jsxs(ce,{value:i,onValueChange:_,children:[e.jsxs(le,{className:"w-[160px]",children:[e.jsx(st,{className:"w-4 h-4 mr-2"}),e.jsx(de,{placeholder:"Styl tańca"})]}),e.jsxs(oe,{children:[e.jsx(W,{value:"all",children:"Wszystkie style"}),Array.from(C).sort().map(d=>e.jsx(W,{value:d,children:d},d))]})]})]}),e.jsxs(R,{variant:"outline",children:[e.jsx(se,{className:"w-3 h-3 mr-1"}),P.length," trenerów"]})]}),e.jsx(fe,{variant:"1-2-3",children:P.map(d=>{const k=c[d.id],$=k?.teaching_styles||[];return console.log(`Rendering trainer ${d.name}:`,{id:d.id,stats:k,hasStats:!!k,totalEvents:k?.total_events,uniqueStudents:k?.unique_students}),e.jsx(L,{className:"group overflow-hidden hover:shadow-lg transition-all duration-300",children:e.jsxs(O,{className:"p-0",children:[e.jsxs("div",{className:"p-6 pb-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs(_e,{className:"h-16 w-16 ring-2 ring-offset-2 ring-gray-200",children:[e.jsx(Pe,{src:d.profile_photo_url}),e.jsx(Se,{className:"text-xl bg-gradient-to-br from-purple-500 to-pink-500 text-white",children:d.name?.[0]?.toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-lg truncate",children:d.name}),d.is_verified&&e.jsx(Ie,{className:"w-4 h-4 text-blue-500 flex-shrink-0"})]}),d.city&&e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),d.city]}),k?.average_rating&&k.review_count>0&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(bs,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"font-medium",children:Number(k.average_rating).toFixed(1)})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",k.review_count," ",k.review_count===1?"opinia":"opinii",")"]})]})]})]}),d.bio&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mt-3",children:d.bio}),$.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-3",children:[$.slice(0,3).map((G,S)=>e.jsx(R,{variant:"secondary",className:"text-xs",children:G},S)),$.length>3&&e.jsxs(R,{variant:"outline",className:"text-xs",children:["+",$.length-3]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-px bg-gray-200",children:[e.jsxs("div",{className:"bg-gray-50 p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-semibold text-primary",children:k?.total_events||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"wydarzeń"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-semibold text-primary",children:k?.unique_students||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"uczniów"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 text-center",children:[e.jsx("p",{className:"text-lg font-semibold text-primary",children:E(d.id)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"cena"})]})]}),e.jsxs("div",{className:"p-4 bg-white border-t",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[k&&k.total_events>0?e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Me,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-green-600 font-medium",children:"Aktywny trener"})]}):e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(se,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Nowy trener"})]}),e.jsx(gs,{className:"w-4 h-4 text-muted-foreground"})]}),e.jsxs(v,{className:"w-full group",onClick:()=>window.location.href=`/trainers/${d.id}/booking`,children:[e.jsx(Jr,{className:"w-4 h-4 mr-2"}),"Umów zajęcia",e.jsx(gs,{className:"w-4 h-4 ml-auto group-hover:translate-x-1 transition-transform"})]})]})]})},d.id)})}),P.length===0&&e.jsxs(L,{className:"p-12 text-center border-dashed",children:[e.jsx(se,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Nie znaleziono trenerów"}),e.jsx("p",{className:"text-muted-foreground",children:s||t!=="all"||i!=="all"?"Spróbuj zmienić kryteria wyszukiwania":"Brak dostępnych trenerów w tym momencie"})]}),e.jsx(Ss,{current:x,pageSize:N,total:P.length,setCurrent:b,itemName:"trenerów"})]})},vl=()=>{const{trainerId:s}=Va(),a=Ce(),{data:t}=je(),[r,i]=o.useState(null),[n,c]=o.useState([]),[u,m]=o.useState(new Date),[p,w]=o.useState(null),[g,f]=o.useState(Es(new Date,{weekStartsOn:1})),[x,b]=o.useState([]),[N,z]=o.useState(!0),[l,y]=o.useState("calendar");o.useEffect(()=>{if(!s)return;(async()=>{try{const{data:C,error:E}=await I.from("v_trainer_stats").select("*").eq("trainer_id",s).single();if(E)throw E;i(C);const{data:P,error:d}=await I.from("user_dance_styles").select(`
            skill_level,
            dance_styles!inner (
              name
            )
          `).eq("user_id",s).eq("is_teaching",!0);!d&&P&&c(P.map(k=>({style_name:k.dance_styles?.name||"",skill_level:k.skill_level})))}catch(C){console.error("Error fetching trainer:",C),H.error("Nie udało się pobrać danych trenera")}})()},[s]);const A=async()=>{z(!0);const j=ha(g,{weekStartsOn:1});try{const{data:C,error:E}=await I.from("v_events_with_counts").select("*").eq("organizer_id",s).gte("start_at",g.toISOString()).lte("start_at",j.toISOString()).in("status",["published"]).order("start_at");if(E)throw E;const P=[];C&&C.forEach(d=>{const k=new Date(d.start_at),$=J(k,"HH:mm"),G=J(new Date(d.end_at),"HH:mm");P.push({id:d.id,event_id:d.id,date:k,start_time:$,end_time:G,is_available:!1,is_recurring:d.is_recurring,event:{id:d.id,title:d.title,event_type:d.event_type,location_type:d.location_type,price:d.price,participant_count:d.participant_count||0,max_participants:d.max_participants||999}})}),b(P)}catch(C){console.error("Error fetching time slots:",C),H.error("Nie udało się pobrać terminów")}finally{z(!1)}};o.useEffect(()=>{s&&A()},[s,g]);const h=j=>{const C=j==="next"?us(g,7):us(g,-7);Ms(C,Es(new Date,{weekStartsOn:1}))||f(C)},_=j=>{j.event&&(j.event.participant_count<j.event.max_participants?(w(j),y("confirmation")):H.error("Brak wolnych miejsc"))},F=()=>{const j=[];for(let C=0;C<7;C++)j.push(us(g,C));return j},Z=j=>x.filter(C=>Ls(C.date,j)).sort((C,E)=>C.start_time.localeCompare(E.start_time)),B=j=>({lesson:"Lekcja",workshop:"Warsztaty",social:"Potańcówka"})[j]||j;return r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4",children:[e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>a(-1),className:"mb-4",children:[e.jsx(Ts,{className:"w-4 h-4 mr-1"}),"Wróć"]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs(_e,{className:"h-20 w-20",children:[e.jsx(Pe,{src:r.profile_photo_url}),e.jsx(Se,{children:r.name?.[0]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h1",{className:"text-2xl font-bold",children:r.name}),r.is_verified&&e.jsxs(R,{variant:"secondary",children:[e.jsx(Ie,{className:"w-3 h-3 mr-1"}),"Zweryfikowany"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mb-2",children:[r.city&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),r.city]}),r.average_rating&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(bs,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"}),r.average_rating.toFixed(1)," (",r.review_count,")"]}),r.total_events&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ke,{className:"w-3 h-3"}),r.total_events," wydarzeń"]})]}),n.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:n.map((j,C)=>e.jsx(R,{variant:"outline",className:"text-xs",children:j.style_name},C))})]})]})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:l==="calendar"?e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(L,{children:[e.jsx(U,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Wybierz termin"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>h("prev"),disabled:Ms(us(g,-7),Es(new Date,{weekStartsOn:1})),children:e.jsx(Ts,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm font-medium px-3",children:[J(g,"d MMM",{locale:ue})," -",J(ha(g,{weekStartsOn:1}),"d MMM yyyy",{locale:ue})]}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>h("next"),children:e.jsx(gs,{className:"w-4 h-4"})})]})]})}),e.jsx(O,{className:"p-0",children:N?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-[800px]",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 p-4 border-b",children:F().map(j=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:J(j,"EEE",{locale:ue})}),e.jsx("div",{className:D("text-lg font-semibold",Ls(j,new Date)&&"text-primary"),children:J(j,"d")})]},j.toISOString()))}),e.jsx("div",{className:"grid grid-cols-7 gap-2 p-4",children:F().map(j=>{const C=Z(j),E=Ms(j,new Date)&&!Ls(j,new Date);return e.jsx("div",{className:"min-h-[300px]",children:E?e.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"-"}):C.length===0?e.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Brak zajęć"}):e.jsx("div",{className:"space-y-2",children:C.map(P=>{if(!P.event)return null;const d=P.event.participant_count>=P.event.max_participants;return e.jsxs("button",{onClick:()=>_(P),disabled:d,className:D("w-full p-3 rounded-lg text-left transition-all text-xs","hover:scale-105 hover:shadow-md",d?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200"),children:[e.jsxs("div",{className:"font-semibold",children:[P.start_time," - ",P.end_time]}),e.jsx("div",{className:"mt-1 line-clamp-2",children:P.event.title}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("span",{children:[e.jsx(se,{className:"w-3 h-3 inline mr-1"}),P.event.participant_count,"/",P.event.max_participants]}),P.event.price>0&&e.jsxs("span",{className:"font-semibold",children:[P.event.price," PLN"]})]})]},P.id)})})},j.toISOString())})})]})})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(L,{children:[e.jsx(U,{children:e.jsx("h3",{className:"font-semibold",children:"Legenda"})}),e.jsxs(O,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-100 border border-blue-200 rounded"}),e.jsx("span",{className:"text-sm",children:"Zajęcia grupowe - są miejsca"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-100 rounded"}),e.jsx("span",{className:"text-sm",children:"Brak wolnych miejsc"})]})]})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsx("h3",{className:"font-semibold",children:"Informacje"})}),e.jsxs(O,{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("p",{className:"flex items-start gap-2",children:[e.jsx(ze,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),"Kliknij na wolny termin aby zarezerwować zajęcia"]}),e.jsxs("p",{className:"flex items-start gap-2",children:[e.jsx(Me,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),"Zajęcia trwają zazwyczaj 60 minut"]}),e.jsxs("p",{className:"flex items-start gap-2",children:[e.jsx(se,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),"Możesz dołączyć do istniejących zajęć grupowych"]})]})]}),r.bio&&e.jsxs(L,{children:[e.jsx(U,{children:e.jsx("h3",{className:"font-semibold",children:"O trenerze"})}),e.jsx(O,{children:e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-4",children:r.bio})})]})]})]}):e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs(L,{children:[e.jsx(U,{children:e.jsx("h2",{className:"text-xl font-semibold",children:"Potwierdź rezerwację"})}),e.jsx(O,{className:"space-y-6",children:p?.event&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:p.event.title}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Data i godzina"}),e.jsxs("p",{className:"font-medium",children:[J(p.date,"EEEE, d MMMM yyyy",{locale:ue}),e.jsx("br",{}),p.start_time," - ",p.end_time]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Rodzaj zajęć"}),e.jsx("p",{className:"font-medium",children:B(p.event.event_type)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Lokalizacja"}),e.jsx("p",{className:"font-medium",children:p.event.location_type==="online"?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Yr,{className:"w-4 h-4"}),"Online"]}):e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-4 h-4"}),r.city]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Cena"}),e.jsx("p",{className:"font-medium",children:p.event.price>0?`${p.event.price} PLN`:"Bezpłatne"})]})]})]}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800 flex items-start gap-2",children:[e.jsx(ze,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),"Po potwierdzeniu rezerwacji otrzymasz email z wszystkimi szczegółami oraz informacją o płatności (jeśli dotyczy)."]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(v,{variant:"outline",className:"flex-1",onClick:()=>{w(null),y("calendar")},children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),e.jsx(Bt,{eventId:p.event.id,className:"flex-1",onRegistrationChange:()=>{y("calendar"),w(null),A()}})]})]})})]})})})]}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})},bl={name:"trainers",list:"/trainers",meta:{label:"Znajdź trenera"}},zl=[e.jsx(Y,{path:"/trainers",element:e.jsx(Nl,{})},"trainers-list"),e.jsx(Y,{path:"/trainers/:trainerId/booking",element:e.jsx(vl,{})},"trainer-booking")],kl=K.memo(({conversation:s,isSelected:a,onClick:t,identity:r,formatMessageTime:i})=>{const n=s.conversation_participants?.find(m=>m.user_id!==r?.id),c=s.conversation_participants?.find(m=>m.user_id===r?.id);if(!n?.user_id)return null;const u=(c?.unread_count||0)>0;return e.jsxs("div",{onClick:t,className:D("flex items-center gap-3 p-4 cursor-pointer transition-colors","hover:bg-muted/50",a&&"bg-muted"),children:[e.jsxs("div",{className:"relative",children:[e.jsxs(_e,{children:[e.jsx(Pe,{src:n.user.profile_photo_url}),e.jsx(Se,{children:n.user.name?.charAt(0)?.toUpperCase()})]}),u&&e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse border-2 border-background"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"font-medium truncate",children:n.user.name}),s.last_message_at&&e.jsx("span",{className:"text-xs text-muted-foreground",children:i(s.last_message_at)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.last_message_preview||"Brak wiadomości"}),u&&c&&e.jsx(R,{className:"ml-2 h-5 px-1.5 min-w-[20px] justify-center",children:c.unread_count})]})]})]})}),_l=K.memo(({message:s,isMyMessage:a,identity:t})=>{const r=s.message_reads?.some(i=>i.user_id!==t?.id);return e.jsx("div",{className:D("flex",a?"justify-end":"justify-start"),children:e.jsxs("div",{className:D("max-w-[70%] rounded-lg px-4 py-2",a?"bg-primary text-primary-foreground":"bg-muted"),children:[e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:s.content}),e.jsxs("div",{className:D("flex items-center gap-1 mt-1",a?"justify-end":"justify-start"),children:[e.jsx("span",{className:D("text-xs",a?"text-primary-foreground/70":"text-muted-foreground"),children:J(new Date(s.created_at),"HH:mm")}),a&&(r?e.jsx(Qr,{className:"h-3 w-3 text-primary-foreground/70"}):e.jsx(js,{className:"h-3 w-3 text-primary-foreground/70"}))]})]})})}),Sl=()=>{const{data:s}=je(),[a,t]=o.useState(null),[r,i]=o.useState([]),[n,c]=o.useState(""),[u,m]=o.useState(""),[p,w]=o.useState(!1),[g,f]=o.useState([]),[x,b]=o.useState(!0),N=o.useRef(null),z=o.useRef(null),l=o.useCallback(E=>{const P=new Date(E);return pa(P)?J(P,"HH:mm"):ja(P)?`Wczoraj ${J(P,"HH:mm")}`:J(P,"dd.MM.yyyy HH:mm",{locale:ue})},[]),y=o.useCallback(E=>{if(!E)return"Dawno temu";const P=new Date(E);return pa(P)?`Ostatnio aktywny(a) dzisiaj o ${J(P,"HH:mm")}`:ja(P)?`Ostatnio aktywny(a) wczoraj o ${J(P,"HH:mm")}`:`Ostatnio aktywny(a) ${J(P,"dd.MM.yyyy",{locale:ue})}`},[]),A=o.useCallback(async()=>{if(s?.id){b(!0);try{const{data:E,error:P}=await I.rpc("get_my_conversations");if(P)throw P;const d=E?.map(k=>({id:k.conversation_id,last_message_at:k.last_message_time,last_message_preview:k.last_message,conversation_participants:[{user_id:k.other_user_id||s.id,unread_count:k.my_unread_count||0,last_read_at:null,user:{id:k.other_user_id,name:k.other_user_name,profile_photo_url:k.other_user_photo,last_seen_at:null,is_active:!1}}]}))||[];f(d)}catch(E){console.error("Error fetching conversations:",E),H.error("Błąd przy pobieraniu konwersacji")}finally{b(!1)}}},[s?.id]),h=o.useCallback((E,P)=>{f(d=>d.map(k=>k.id===E?{...k,...P}:k).sort((k,$)=>new Date($.last_message_at||0).getTime()-new Date(k.last_message_at||0).getTime()))},[]);o.useEffect(()=>{s?.id&&A()},[s?.id,A]),o.useEffect(()=>{if(!a||!s?.id)return;const E=I.channel(`messages-${a}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`conversation_id=eq.${a}`},async P=>{if(console.log("Nowa wiadomość:",P),P.new.sender_id!==s.id){const{data:d}=await I.from("users").select("name, profile_photo_url").eq("id",P.new.sender_id).single(),k={...P.new,sender:d,message_reads:[]};i($=>[...$,k]),h(a,{last_message_preview:P.new.content,last_message_at:P.new.created_at})}}).subscribe();return()=>{I.removeChannel(E)}},[a,s?.id,h]),o.useEffect(()=>{if(!s?.id)return;const E=I.channel("conversation-participants").on("postgres_changes",{event:"UPDATE",schema:"public",table:"conversation_participants",filter:`user_id=eq.${s.id}`},d=>{console.log("Zmiana w uczestnikach:",d),f(k=>k.map($=>{if($.id===d.new.conversation_id){const G=$.conversation_participants.map(S=>S.user_id===s.id?{...S,unread_count:d.new.unread_count}:S);return{...$,conversation_participants:G}}return $}))}).subscribe(),P=I.channel("conversations-list").on("postgres_changes",{event:"INSERT",schema:"public",table:"conversations"},()=>{console.log("Nowa konwersacja"),A()}).subscribe();return()=>{I.removeChannel(E),I.removeChannel(P)}},[s?.id,A]);const _=o.useCallback(async E=>{w(!0);try{const{data:P,error:d}=await I.from("messages").select(`
          *,
          sender:users!sender_id(
            name,
            profile_photo_url
          ),
          message_reads(
            user_id,
            read_at
          )
        `).eq("conversation_id",E).order("created_at",{ascending:!0});if(d)throw d;i(P||[]),P&&P.length>0&&s?.id&&F(E)}catch(P){console.error("Error fetching messages:",P),H.error("Błąd przy pobieraniu wiadomości")}finally{w(!1)}},[s?.id]),F=o.useCallback(async E=>{if(s?.id)try{f(P=>P.map(d=>{if(d.id===E){const k=d.conversation_participants.map($=>$.user_id===s.id?{...$,unread_count:0}:$);return{...d,conversation_participants:k}}return d})),await I.rpc("mark_conversation_read",{p_conversation_id:E})}catch(P){console.error("Error marking messages as read:",P)}},[s?.id]),Z=o.useCallback(async()=>{if(!n.trim()||!a||!s?.id)return;const E=n.trim(),P=`temp-${Date.now()}`,d={id:P,conversation_id:a,sender_id:s.id,content:E,created_at:new Date().toISOString(),sender:{id:s.id,name:s.name,profile_photo_url:s.profile_photo_url},message_reads:[]};i(k=>[...k,d]),c(""),h(a,{last_message_preview:E,last_message_at:new Date().toISOString()});try{const{data:k,error:$}=await I.from("messages").insert({conversation_id:a,sender_id:s.id,content:E}).select().single();if($)throw $;i(G=>G.map(S=>S.id===P?{...k,sender:d.sender}:S))}catch(k){console.error("Error sending message:",k),H.error("Błąd przy wysyłaniu wiadomości"),i($=>$.filter(G=>G.id!==P)),c(E),A()}},[n,a,s,h,A]);o.useEffect(()=>{N.current?.scrollIntoView()},[r]),o.useEffect(()=>{a&&_(a)},[a,_]);const B=o.useMemo(()=>g.filter(E=>E.conversation_participants?.find(d=>d.user_id!==s?.id)?.user?.name?.toLowerCase().includes(u.toLowerCase())),[g,u,s?.id]),j=o.useMemo(()=>g.find(E=>E.id===a),[g,a]),C=o.useMemo(()=>j?.conversation_participants?.find(E=>E.user_id!==s?.id),[j,s?.id]);return e.jsx(ae,{children:e.jsxs("div",{className:"flex h-[calc(100vh-10rem)] gap-4 overflow-hidden",children:[e.jsxs(L,{className:"w-96 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Czaty"}),e.jsx(v,{variant:"ghost",size:"icon",children:e.jsx(xa,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(q,{placeholder:"Szukaj konwersacji...",className:"pl-10",value:u,onChange:E=>m(E.target.value)})]})]}),e.jsx(Ue,{className:"flex-1",children:x?e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:e.jsx("p",{className:"text-sm",children:"Ładowanie konwersacji..."})}):B.length===0?e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx(ua,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Brak konwersacji"}),e.jsx("p",{className:"text-xs mt-2",children:"Dopasuj się z kimś, aby rozpocząć czat"})]}):B.map(E=>e.jsx(kl,{conversation:E,isSelected:a===E.id,onClick:()=>t(E.id),identity:s,formatMessageTime:l},E.id))})]}),a&&C?e.jsxs(L,{className:"flex-1 flex flex-col min-h-0",children:[e.jsxs("div",{className:"p-4 border-b flex items-center gap-3 flex-shrink-0",children:[e.jsxs(_e,{children:[e.jsx(Pe,{src:C.user.profile_photo_url}),e.jsx(Se,{children:C.user.name?.charAt(0)?.toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:C.user.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:C.user.is_active?"Aktywny(a) teraz":y(C.user.last_seen_at)})]}),e.jsx(v,{variant:"ghost",size:"icon",children:e.jsx(xa,{className:"h-4 w-4"})})]}),e.jsx(Ue,{className:"flex-1 p-4",ref:z,children:p?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Ładowanie wiadomości..."})}):r.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground",children:"Brak wiadomości"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Wyślij pierwszą wiadomość!"})]}):e.jsxs("div",{className:"space-y-4",children:[r.map(E=>e.jsx(_l,{message:E,isMyMessage:E.sender_id===s?.id,identity:s},E.id)),e.jsx("div",{ref:N})]})}),e.jsx("div",{className:"p-4 border-t flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{variant:"ghost",size:"icon",children:e.jsx(Xr,{className:"h-4 w-4"})}),e.jsx(q,{placeholder:"Napisz wiadomość...",value:n,onChange:E=>c(E.target.value),onKeyPress:E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),Z())},className:"flex-1"}),e.jsx(v,{variant:"ghost",size:"icon",children:e.jsx(ei,{className:"h-4 w-4"})}),e.jsx(v,{onClick:Z,size:"icon",disabled:!n.trim(),children:e.jsx(si,{className:"h-4 w-4"})})]})})]}):e.jsx(L,{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ua,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Wybierz konwersację"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Wybierz czat z listy, aby zobaczyć wiadomości"})]})})]})})},Cl={name:"conversations",list:"/chat",meta:{label:"Czat"}},Pl=[e.jsx(Y,{path:"/chat",element:e.jsx(Sl,{})},"chat-list")],be=({children:s})=>e.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"h-96 fixed top-0 w-full -rotate-1 scale-125",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-400/0 via-pink-300/15 to-purple-500/10"})}),e.jsx("div",{className:"absolute top-20 -left-32 w-64 h-64 bg-gradient-to-br from-purple-300/20 to-pink-300/20 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-20 -right-32 w-96 h-96 bg-gradient-to-tl from-purple-400/15 to-pink-400/15 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-64 bg-gradient-to-b from-pink-200/10 to-transparent"}),e.jsx("div",{className:"w-full max-w-lg space-y-3 relative z-10",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-300/5 to-pink-300/5 rounded-lg blur-md"}),e.jsx("div",{className:"relative bg-background/80 backdrop-blur-sm rounded-lg shadow-xl shadow-purple-200/20 border border-purple-200/20 p-8",children:s})]})})]}),Dl=()=>{const{mutate:s,isLoading:a,error:t,data:r}=kr(),[i,n]=K.useState(""),[c,u]=K.useState(""),[m,p]=K.useState(!1);K.useEffect(()=>{console.log("🔍 useLogin state:",{hookError:t,loginData:r,isLoading:a})},[t,r,a]);const w=K.useCallback(N=>{if(console.log("🔧 Parsing error:",N),!N)return"Wystąpił nieoczekiwany błąd.";if(typeof N=="string")return N;if(N.name==="AuthApiError"||N.constructor?.name==="AuthApiError"){const z=N.message||"";return z.includes("Invalid login credentials")?"Nieprawidłowe dane logowania. Sprawdź email i hasło.":z.includes("Email not confirmed")?"Konto nie zostało potwierdzone. Sprawdź swoją skrzynkę email i kliknij link aktywacyjny.":z.includes("Too many requests")?"Zbyt wiele prób logowania. Spróbuj ponownie za kilka minut.":z.includes("User not found")?"Nie znaleziono użytkownika z tym adresem email.":z||"Błąd uwierzytelniania."}if(N.message){const z=N.message;return z.includes("Invalid login credentials")?"Nieprawidłowe dane logowania. Sprawdź email i hasło.":z.includes("Email not confirmed")?"Konto nie zostało potwierdzone. Sprawdź swoją skrzynkę email.":z}return"Wystąpił błąd logowania. Spróbuj ponownie."},[]),g=K.useMemo(()=>m?t?(console.log("📍 Using hookError"),w(t)):r?.success===!1&&r.error?(console.log("📍 Using loginData.error"),w(r.error)):null:null,[t,r,m,w]),f=K.useMemo(()=>r?.success===!0,[r]);K.useEffect(()=>{f&&(console.log("✅ Login successful, clearing form"),n(""),u(""))},[f]);const x=K.useCallback(()=>{if(console.log("🚀 Login attempt:",{email:i,password:c?"***":""}),!i.trim()||!c.trim()){console.log("❌ Login blocked - empty fields");return}p(!0);const N={email:i.trim(),password:c};s(N,{onSuccess:z=>{console.log("✅ Login onSuccess:",z)},onError:z=>{console.error("❌ Login onError:",z)}})},[i,c,s]),b=K.useCallback(N=>{N.preventDefault(),console.log("📝 Form submitted"),x()},[x]);return{email:i,password:c,setEmail:n,setPassword:u,isLoading:a,error:g,login:x,handleSubmit:b}},El=()=>{const[s]=fr(),{email:a,password:t,setEmail:r,setPassword:i,isLoading:n,error:c,handleSubmit:u}=Dl(),{data:m,isLoading:p}=_r(),{data:w,isLoading:g}=je(),f=s.get("verified")==="true",x=s.get("passwordChanged")==="true",b=a.trim().length>0&&t.length>0,N=y=>y.includes("nie zostało potwierdzone")?"warning":"destructive",z=y=>y.includes("nie zostało potwierdzone")?ze:os,l=y=>{if(c){if(y==="email"&&c.toLowerCase().includes("email"))return"Sprawdź poprawność adresu email";if(y==="password"&&c.toLowerCase().includes("hasło"))return"Sprawdź poprawność hasła"}};if(p||g)return e.jsx(be,{children:e.jsx(L,{children:e.jsx(O,{className:"flex items-center justify-center py-12",children:e.jsx(Ee,{className:"h-8 w-8 animate-spin"})})})});if(m&&w){const y=w.role?`/${w.role}`:"/profiles";return e.jsx(ps,{to:y,replace:!0})}return e.jsx(be,{children:e.jsxs(L,{children:[e.jsxs(U,{className:"space-y-1",children:[e.jsx(V,{className:"text-2xl text-center",children:"Zaloguj się"}),e.jsx(We,{className:"text-center",children:"Wprowadź swoje dane aby się zalogować"})]}),e.jsxs(O,{children:[f&&e.jsxs(re,{className:"mb-4 border-green-200 bg-green-50",children:[e.jsx(ke,{className:"h-4 w-4 text-green-600"}),e.jsxs(ie,{className:"text-green-800",children:[e.jsx("strong",{children:"Email potwierdzony!"})," Możesz się teraz zalogować."]})]}),x&&e.jsxs(re,{className:"mb-4 border-green-200 bg-green-50",children:[e.jsx(ke,{className:"h-4 w-4 text-green-600"}),e.jsxs(ie,{className:"text-green-800",children:[e.jsx("strong",{children:"Hasło zmienione!"})," Możesz się zalogować używając nowego hasła."]})]}),e.jsxs(ks,{onSubmit:u,children:[e.jsx(ee,{label:e.jsxs("span",{className:"flex items-center",children:[e.jsx(Qe,{className:"mr-2 h-4 w-4"}),"Email"]}),htmlFor:"email",error:l("email"),required:!0,children:e.jsx(q,{id:"email",type:"email",placeholder:"przykład@email.com",value:a,onChange:y=>r(y.target.value),disabled:n,className:l("email")?"border-red-500":""})}),e.jsx(ee,{label:e.jsxs("span",{className:"flex items-center",children:[e.jsx(ai,{className:"mr-2 h-4 w-4"}),"Hasło"]}),htmlFor:"password",error:l("password"),required:!0,children:e.jsx(q,{id:"password",type:"password",placeholder:"Wprowadź hasło",value:t,onChange:y=>i(y.target.value),disabled:n,className:l("password")?"border-red-500":""})}),c&&e.jsxs(re,{variant:N(c),children:[K.createElement(z(c),{className:"h-4 w-4"}),e.jsxs(ie,{children:[e.jsx("strong",{children:"Błąd logowania:"})," ",c,c.includes("nie zostało potwierdzone")&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsxs("p",{children:["💡 ",e.jsx("strong",{children:"Co robić:"})]}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[e.jsx("li",{children:"Sprawdź swoją skrzynkę email (także spam)"}),e.jsx("li",{children:"Kliknij link aktywacyjny w emailu"}),e.jsxs("li",{children:["Jeśli nie otrzymałeś emaila, możesz"," ",e.jsx(as,{to:"/resend-confirmation",className:"underline",children:"wysłać ponownie"})]})]})]}),c.includes("Nieprawidłowe dane")&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsxs("p",{children:["💡 ",e.jsx("strong",{children:"Sprawdź:"})]}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[e.jsx("li",{children:"Czy email jest wpisany poprawnie"}),e.jsx("li",{children:"Czy hasło jest poprawne (uwaga na wielkość liter)"}),e.jsx("li",{children:"Czy masz już założone konto"})]})]})]})]}),e.jsx(_s,{className:"!border-0 !pt-0 justify-center",children:e.jsxs(v,{type:"submit",className:"w-full",disabled:n||!b,children:[n&&e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),n?"Logowanie...":"Zaloguj się"]})})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("div",{className:"text-center text-sm",children:e.jsx(as,{to:"/register/step1",className:"text-blue-600 hover:text-blue-500 transition-colors",children:"Nie masz konta? Zarejestruj się"})}),e.jsx("div",{className:"text-center text-sm",children:e.jsx(as,{to:"/forgot-password",className:"text-blue-600 hover:text-blue-500 transition-colors",children:"Zapomniałeś hasła?"})}),e.jsx("div",{className:"border-t pt-4 mt-4",children:e.jsxs("div",{className:"text-center text-xs text-gray-500",children:[e.jsx("p",{children:"Problemy z logowaniem?"}),e.jsx(as,{to:"/contact",className:"text-blue-600 hover:text-blue-500 transition-colors",children:"Skontaktuj się z pomocą techniczną"})]})})]})]})]})})},Ml=()=>{const{mutate:s,isLoading:a,error:t}=Sr(),[r,i]=K.useState(1),[n,c]=K.useState(""),[u,m]=K.useState(""),[p,w]=K.useState(""),[g,f]=K.useState(""),[x,b]=K.useState(""),N=[{value:"beneficiary",label:"Beneficiary",description:"Użytkownik końcowy systemu",icon:Le},{value:"auditor",label:"Auditor",description:"Audytor z uprawnieniami kontrolnymi",icon:Xs}],z=h=>{if(h.preventDefault(),b(""),u!==p){b("Hasła nie są identyczne");return}if(u.length<6){b("Hasło musi mieć co najmniej 6 znaków");return}i(2)},l=()=>{if(!g){b("Wybierz rolę");return}s({email:n,password:u,role:g})},y=h=>{f(h),b("")},A=()=>{i(1),b("")};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"max-w-md w-full space-y-8",children:r===1?e.jsxs(L,{children:[e.jsxs(U,{className:"space-y-1",children:[e.jsx(V,{className:"text-2xl text-center",children:"Zarejestruj się"}),e.jsx(We,{className:"text-center",children:"Krok 1/2: Podaj swoje dane"})]}),e.jsxs(O,{children:[e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"email",children:"Email"}),e.jsx(q,{id:"email",type:"email",placeholder:"przykład@email.com",value:n,onChange:h=>c(h.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"password",children:"Hasło"}),e.jsx(q,{id:"password",type:"password",placeholder:"Minimum 6 znaków",value:u,onChange:h=>m(h.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"confirmPassword",children:"Potwierdź hasło"}),e.jsx(q,{id:"confirmPassword",type:"password",placeholder:"Powtórz hasło",value:p,onChange:h=>w(h.target.value),required:!0})]}),x&&e.jsx(re,{variant:"destructive",children:e.jsx(ie,{children:x})}),e.jsx(v,{type:"submit",className:"w-full",children:"Dalej"})]}),e.jsx("div",{className:"mt-4 text-center text-sm",children:e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Masz już konto? Zaloguj się"})})]})]}):e.jsxs(L,{children:[e.jsxs(U,{className:"space-y-1",children:[e.jsx(V,{className:"text-2xl text-center",children:"Wybierz rolę"}),e.jsx(We,{className:"text-center",children:"Krok 2/2: Jaka jest Twoja rola w systemie?"})]}),e.jsxs(O,{className:"space-y-4",children:[e.jsx("div",{className:"space-y-3",children:N.map(h=>{const _=h.icon;return e.jsx("div",{onClick:()=>y(h.value),className:`p-4 border-2 rounded-lg cursor-pointer transition-all hover:bg-gray-50 ${g===h.value?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(_,{className:`h-6 w-6 mt-1 ${g===h.value?"text-blue-600":"text-gray-400"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-medium ${g===h.value?"text-blue-900":"text-gray-900"}`,children:h.label}),e.jsx("p",{className:`text-sm ${g===h.value?"text-blue-700":"text-gray-500"}`,children:h.description})]})]})},h.value)})}),x&&e.jsx(re,{variant:"destructive",children:e.jsx(ie,{children:x})}),t&&e.jsx(re,{variant:"destructive",children:e.jsx(ie,{children:t?.message||"Błąd rejestracji"})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(v,{variant:"outline",onClick:A,className:"flex-1",disabled:a,children:[e.jsx($e,{className:"mr-2 h-4 w-4"}),"Wstecz"]}),e.jsxs(v,{onClick:l,className:"flex-1",disabled:a||!g,children:[a&&e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Zarejestruj się"]})]})]})]})})})},Ll=()=>{const{mutate:s,isLoading:a,error:t,isSuccess:r}=Cr(),[i,n]=K.useState(""),c=u=>{u.preventDefault(),s({email:i})};return r?e.jsx(be,{children:e.jsxs(L,{children:[e.jsxs(U,{className:"space-y-1",children:[e.jsxs(V,{className:"text-2xl text-center flex items-center justify-center gap-2",children:[e.jsx(ke,{className:"h-6 w-6 text-green-500"}),"Email wysłany"]}),e.jsx(We,{className:"text-center",children:"Sprawdź swoją skrzynkę odbiorczą"})]}),e.jsxs(O,{children:[e.jsx(re,{children:e.jsxs(ie,{children:["Wysłaliśmy link do resetowania hasła na adres ",e.jsx("strong",{children:i}),". Sprawdź swoją skrzynkę odbiorczą i kliknij w link, aby zresetować hasło."]})}),e.jsx("div",{className:"text-center",children:e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Powrót do logowania"})})]})]})}):e.jsx(be,{children:e.jsxs(L,{children:[e.jsxs(U,{className:"space-y-1",children:[e.jsx(V,{className:"text-2xl text-center",children:"Resetuj hasło"}),e.jsx(We,{className:"text-center",children:"Wprowadź swój email, aby otrzymać link do resetowania hasła"})]}),e.jsxs(O,{children:[e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"email",children:"Email"}),e.jsx(q,{id:"email",type:"email",placeholder:"przykład@email.com",value:i,onChange:u=>n(u.target.value),required:!0})]}),t&&e.jsx(re,{variant:"destructive",children:e.jsx(ie,{children:t.message||"Błąd podczas wysyłania emaila"})}),e.jsxs(v,{type:"submit",className:"w-full",disabled:a,children:[a&&e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Wyślij link resetujący"]})]}),e.jsx("div",{className:"mt-4 text-center text-sm",children:e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Powrót do logowania"})})]})]})})},Al=()=>{const s=Ce(),{mutate:a,isLoading:t,error:r}=Pr(),[i,n]=K.useState(""),[c,u]=K.useState(""),[m,p]=K.useState(""),[w,g]=K.useState(!0),[f,x]=K.useState(!0),[b,N]=K.useState(!1);K.useEffect(()=>{(async()=>{try{const{data:y}=await I.auth.getSession(),h=new URLSearchParams(window.location.hash.substring(1)).get("type");!y.session&&h!=="recovery"?(console.log("No valid recovery session found"),g(!1),setTimeout(()=>{s("/forgot-password")},3e3)):(console.log("Valid session found"),g(!0))}catch(y){console.error("Session check error:",y),g(!1)}finally{x(!1)}})()},[s]);const z=async l=>{if(l.preventDefault(),p(""),i!==c){p("Hasła nie są identyczne");return}if(i.length<6){p("Hasło musi mieć co najmniej 6 znaków");return}if(i.length>72){p("Hasło nie może być dłuższe niż 72 znaki");return}a({password:i},{onSuccess:()=>{N(!0),setTimeout(()=>{s("/login?passwordChanged=true")},3e3)},onError:y=>{console.error("Password update error:",y),p(y?.message||"Błąd aktualizacji hasła")}})};return f?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ee,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("p",{className:"text-gray-600",children:"Weryfikacja sesji..."})]})}):w?b?e.jsx(be,{children:e.jsxs(L,{className:"border-green-200",children:[e.jsx(U,{children:e.jsxs(V,{className:"text-2xl text-center flex items-center justify-center gap-2",children:[e.jsx(ke,{className:"h-6 w-6 text-green-600"}),"Hasło zmienione!"]})}),e.jsx(O,{children:e.jsxs(re,{className:"border-green-200 bg-green-50",children:[e.jsx(ke,{className:"h-4 w-4 text-green-600"}),e.jsx(ie,{className:"text-green-800",children:"Twoje hasło zostało pomyślnie zmienione. Za chwilę zostaniesz przekierowany do strony logowania..."})]})})]})}):e.jsx(be,{children:e.jsxs(L,{children:[e.jsxs(U,{className:"space-y-1",children:[e.jsxs(V,{className:"text-2xl text-center flex items-center justify-center gap-2",children:[e.jsx(ti,{className:"h-6 w-6"}),"Nowe hasło"]}),e.jsx(We,{className:"text-center",children:"Wprowadź nowe hasło dla swojego konta"})]}),e.jsxs(O,{children:[e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"password",children:"Nowe hasło"}),e.jsx(q,{id:"password",type:"password",placeholder:"Minimum 6 znaków",value:i,onChange:l=>n(l.target.value),disabled:t,required:!0,autoFocus:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"confirmPassword",children:"Potwierdź nowe hasło"}),e.jsx(q,{id:"confirmPassword",type:"password",placeholder:"Powtórz nowe hasło",value:c,onChange:l=>u(l.target.value),disabled:t,required:!0})]}),e.jsxs(re,{children:[e.jsx(ze,{className:"h-4 w-4"}),e.jsxs(ie,{children:[e.jsx("strong",{children:"Wymagania hasła:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 text-sm",children:[e.jsx("li",{children:"Minimum 6 znaków"}),e.jsx("li",{children:"Maksimum 72 znaki"}),e.jsx("li",{children:"Zalecane użycie liter, cyfr i znaków specjalnych"})]})]})]}),(r||m)&&e.jsxs(re,{variant:"destructive",children:[e.jsx(os,{className:"h-4 w-4"}),e.jsx(ie,{children:m||r?.message||"Błąd aktualizacji hasła"})]}),e.jsxs(v,{type:"submit",className:"w-full",disabled:t,children:[t&&e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),t?"Aktualizowanie...":"Zaktualizuj hasło"]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Pamiętasz hasło?"," ",e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Wróć do logowania"})]})})]})]})}):e.jsx(be,{children:e.jsx(L,{className:"border-red-200",children:e.jsx(O,{className:"pt-6",children:e.jsxs(re,{variant:"destructive",children:[e.jsx(os,{className:"h-4 w-4"}),e.jsxs(ie,{children:[e.jsx("strong",{children:"Nieprawidłowa lub wygasła sesja."}),e.jsx("br",{}),"Link do resetowania hasła mógł wygasnąć. Za chwilę zostaniesz przekierowany do strony resetowania hasła..."]})]})})})})},Ht=({schemaPath:s,onSubmit:a,submitLabel:t="Dalej",className:r=""})=>{const{getSchemaFragment:i,setData:n,getData:c}=Ze(),[u]=s.split("."),[m,p]=K.useState(""),[w,g]=K.useState({}),f=i(s),x=c(u);if(!f)return e.jsx(re,{variant:"destructive",children:e.jsxs(ie,{children:["Nie znaleziono schematu dla ścieżki: ",s]})});const b=l=>{l.preventDefault(),p(""),g({});const y={};if(f.required)for(const A of f.required)x[A]||(y[A]="To pole jest wymagane");if(Object.keys(y).length>0){g(y);return}if(f.validation){const A=f.validation(x);if(A){p(A);return}}a(x)},N=(l,y)=>{n(u,{...x,[l]:y}),w[l]&&g(A=>{const h={...A};return delete h[l],h})},z=(l,y)=>{const A=x[l]||"",h=f.required?.includes(l),_=w[l];switch(y.type){case"text":case"email":case"password":return e.jsx(ee,{label:y.title||l,htmlFor:l,error:_,required:h,children:e.jsx(q,{id:l,type:y.type,value:A,placeholder:y.placeholder,onChange:F=>N(l,F.target.value),className:_?"border-red-500":""})},l);case"select":return e.jsx(ee,{label:y.title||l,htmlFor:l,error:_,required:h,children:e.jsxs(ce,{value:A,onValueChange:F=>N(l,F),children:[e.jsx(le,{className:_?"border-red-500":"",children:e.jsx(de,{placeholder:y.placeholder||"Wybierz opcję"})}),e.jsx(oe,{children:y.options?.map(F=>e.jsx(W,{value:F.value,children:F.label},F.value))})]})},l);default:return null}};return e.jsxs(L,{className:r,children:[e.jsx(U,{children:e.jsx(V,{children:f.title})}),e.jsx(O,{children:e.jsxs(ks,{onSubmit:b,children:[e.jsxs(fe,{variant:"1-1-1",children:[f.properties&&Object.entries(f.properties).map(([l,y])=>z(l,y)),m&&e.jsx(re,{variant:"destructive",className:"mt-4",children:e.jsx(ie,{children:m})})]}),e.jsx(_s,{className:"mt-6 pt-6",children:e.jsx(v,{type:"submit",className:"w-full sm:w-auto",children:t})})]})})]})},Rl=()=>{const s=Ce(),{register:a}=Ze();o.useEffect(()=>{a({id:"registration",title:"Proces rejestracji",schema:{step1:{title:"Dane podstawowe",type:"object",properties:{email:{type:"email",title:"Email",placeholder:"przykład@email.com"},name:{type:"text",title:"Imię i nazwisko",placeholder:"Jan Kowalski"}},required:["email","name"],validation:r=>r.name&&r.name.trim().length<3?"Imię i nazwisko musi mieć co najmniej 3 znaki":r.name&&!r.name.includes(" ")?"Podaj zarówno imię jak i nazwisko":null},step2:{title:"Hasło",type:"object",properties:{password:{type:"password",title:"Hasło",placeholder:"Minimum 6 znaków"},confirmPassword:{type:"password",title:"Potwierdź hasło",placeholder:"Powtórz hasło"}},required:["password","confirmPassword"],validation:r=>r.password&&r.password.length<6?"Hasło musi mieć co najmniej 6 znaków":r.password!==r.confirmPassword?"Hasła nie są identyczne":null},step3:{title:"Podsumowanie",type:"object",properties:{}}}})},[a]);const t=r=>{console.log("RegisterStep1 - Otrzymane dane z formularza:",r),s("/register/step2")};return e.jsxs(be,{children:[e.jsxs("div",{className:"flex items-start gap-5 ",children:[e.jsx(ts,{className:"mt-2 bg-white rounded-full p-2 w-12 h-12"}),e.jsx(ye,{title:"Rejestracja",description:"1 z 3 Podaj podstawowe informacje"})]}),e.jsx(Ht,{schemaPath:"registration.step1",onSubmit:t,submitLabel:"Dalej"}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(as,{to:"/login",className:"text-blue-600 hover:text-blue-500 text-sm",children:"Masz już konto? Zaloguj się"})})]})},Fl=()=>{const s=Ce(),{setData:a}=Ze(),t=i=>{a("registration",i),s("/register/step3")},r=()=>{s("/register/step1")};return e.jsxs(be,{children:[e.jsxs("div",{className:"flex items-start gap-5 ",children:[e.jsx(ri,{className:"mt-2 bg-white rounded-full p-2 w-12 h-12"}),e.jsx(ye,{title:"Rejestracja",description:"2 z 3 Ustaw hasło do konta"})]}),e.jsx(Ht,{schemaPath:"registration.step2",onSubmit:t,submitLabel:"Dalej"}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsxs(v,{variant:"outline",onClick:r,className:"flex items-center",children:[e.jsx($e,{className:"mr-2 h-4 w-4"}),"Wstecz"]}),e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500 text-sm",children:"Masz już konto? Zaloguj się"})]})]})},Tl=()=>{const s=Ce(),{getData:a,setData:t}=Ze(),[r,i]=K.useState(!1),[n,c]=K.useState(!1),[u,m]=K.useState(null),p=a("registration"),w=K.useCallback(async()=>{if(!Bs.register){m("Funkcja rejestracji nie jest dostępna");return}i(!0),m(null);try{const f=await Bs.register({email:p.email,password:p.password,role:p.role,...p.operator_id&&{operator_id:p.operator_id}});console.log("Registration result:",f),f.success?(c(!0),t("registration",{...p,registrationComplete:!0,registrationDate:new Date().toISOString(),user:f.user}),setTimeout(()=>{s("/register/step4")},1500)):m(f.error?.message||"Rejestracja nie powiodła się")}catch(f){console.error("Registration error:",f),m("Wystąpił nieoczekiwany błąd")}finally{i(!1)}},[p,t,s]),g=K.useCallback(()=>{s("/register/step2")},[s]);return{isLoading:r,isSuccess:n,error:u,register:w,goBack:g,processData:p}},Il=()=>{const s=Ce(),{isLoading:a,isSuccess:t,error:r,register:i,goBack:n,processData:c}=Tl();return!c||!c.email?e.jsxs(be,{children:[e.jsx(ye,{title:"Rejestracja",description:"Błąd - brak danych"}),e.jsxs(re,{variant:"destructive",children:[e.jsx(os,{className:"h-4 w-4"}),e.jsx(ie,{children:"Brak danych rejestracji. Rozpocznij proces od początku."})]}),e.jsx(v,{onClick:()=>s("/register/step1"),className:"mt-4",children:"Wróć do kroku 1"})]}):e.jsxs(be,{children:[e.jsxs("div",{className:"flex items-start gap-5 ",children:[e.jsx(ii,{className:"mt-2 bg-white rounded-full p-2 w-12 h-12"}),e.jsx(ye,{title:"Rejestracja",description:"3 z 4 Potwierdzenie danych"})]}),t&&e.jsxs(re,{className:"mb-4 border-green-200 bg-green-50",children:[e.jsx(js,{className:"h-4 w-4 text-green-600"}),e.jsxs(ie,{className:"text-green-800",children:[e.jsx("strong",{children:"Rejestracja udana!"})," Za chwilę zostaniesz przekierowany..."]})]}),r&&!t&&e.jsxs(re,{variant:"destructive",className:"mb-4",children:[e.jsx(os,{className:"h-4 w-4"}),e.jsxs(ie,{children:[e.jsx("strong",{children:"Rejestracja nieudana:"})," ",r]})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center",children:[e.jsx(js,{className:"mr-2 h-5 w-5 text-blue-600"}),"Podsumowanie"]})}),e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Co się stanie:"}),e.jsxs("ul",{className:"text-sm text-blue-700 mt-2 space-y-1",children:[e.jsx("li",{children:"• Konto zostanie utworzone"}),e.jsx("li",{children:"• Otrzymasz email z potwierdzeniem"}),e.jsx("li",{children:"• Po aktywacji będziesz mógł się zalogować"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Qe,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Email"}),e.jsx("p",{className:"text-sm text-gray-600",children:c.email})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Le,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Imię i nazwisko"}),e.jsx("p",{className:"text-sm text-gray-600",children:c.name})]})]})]}),r&&!t&&e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-sm text-red-800 font-medium",children:"Wskazówki w przypadku problemów:"}),e.jsxs("ul",{className:"text-sm text-red-700 mt-2 space-y-1",children:[e.jsx("li",{children:"• Sprawdź czy email ma prawidłowy format"}),e.jsx("li",{children:"• Upewnij się że hasło spełnia wymagania (6-72 znaków)"}),e.jsx("li",{children:"• Jeśli masz już konto, przejdź do logowania"}),e.jsx("li",{children:"• W przypadku dalszych problemów skontaktuj się z pomocą"})]})]})]})]}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsxs(v,{variant:"outline",onClick:n,disabled:a||t,children:[e.jsx($e,{className:"mr-2 h-4 w-4"}),"Wstecz"]}),e.jsxs(v,{onClick:i,disabled:a||t,children:[a&&e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),a?"Rejestruję...":t?"Udane!":r?"Spróbuj ponownie":"Zarejestruj się"]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500 text-sm",children:"Masz już konto? Zaloguj się"})})]})},Ol=()=>{const s=Ce(),{getData:a,unregister:t}=Ze(),[r,i]=K.useState(!1),[n,c]=K.useState(!1),u=a("registration"),m=u?.email||"user@example.com",p=u?.name||"Użytkownik";K.useEffect(()=>{const f=setTimeout(()=>{t("registration","data")},3e4);return()=>clearTimeout(f)},[t]);const w=async()=>{i(!0);try{await new Promise(f=>setTimeout(f,2e3)),c(!0),setTimeout(()=>c(!1),3e3)}catch(f){console.error("Błąd wysyłania maila:",f)}finally{i(!1)}},g=()=>{t("registration","data"),s("/login")};return e.jsxs(be,{children:[e.jsx(ye,{title:"Rejestracja zakończona!",description:"4 z 4 Sprawdź swoją skrzynkę mailową"}),e.jsxs(L,{className:"border-green-200 bg-green-50",children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center text-green-800",children:[e.jsx(ke,{className:"mr-2 h-6 w-6 text-green-600"}),"Konto zostało utworzone!"]})}),e.jsx(O,{className:"space-y-4",children:e.jsxs("div",{className:"text-green-700",children:[e.jsx("p",{className:"font-medium",children:"Gratulacje! Twoje konto zostało pomyślnie utworzone."}),e.jsxs("p",{className:"text-sm mt-1",children:["Wysłaliśmy email z potwierdzeniem na adres ",e.jsx("strong",{children:m})]})]})})]}),e.jsxs(L,{children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center",children:[e.jsx(Le,{className:"mr-2 h-5 w-5"}),"Podsumowanie konta"]})}),e.jsxs(O,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Qe,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Adres email"}),e.jsx("p",{className:"text-sm text-gray-600",children:m})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Le,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Imię i nazwisko"}),e.jsx("p",{className:"text-sm text-gray-600",children:p})]})]})]})]}),e.jsxs(L,{className:"border-blue-200",children:[e.jsx(U,{children:e.jsxs(V,{className:"flex items-center text-blue-800",children:[e.jsx(Qe,{className:"mr-2 h-5 w-5 text-blue-600"}),"Co dalej?"]})}),e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Sprawdź swoją skrzynkę mailową"}),e.jsxs("p",{className:"text-gray-600",children:["Email potwierdzający został wysłany na adres ",e.jsx("strong",{children:m})]})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Kliknij link w emailu"}),e.jsx("p",{className:"text-gray-600",children:"Aktywuj swoje konto klikając w link potwierdzający"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Zaloguj się do systemu"}),e.jsx("p",{className:"text-gray-600",children:"Po aktywacji możesz się zalogować używając swojego emailu i hasła"})]})]})]}),e.jsxs(re,{children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsxs(ie,{children:[e.jsx("strong",{children:"Ważne:"})," Email może dotrzeć w ciągu kilku minut. Sprawdź także folder SPAM/Niechciane."]})]})]})]}),e.jsx(L,{children:e.jsx(O,{className:"pt-6",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Nie otrzymałeś emaila?"}),n&&e.jsxs(re,{className:"border-green-200 bg-green-50",children:[e.jsx(ke,{className:"h-4 w-4 text-green-600"}),e.jsx(ie,{className:"text-green-800",children:"Email został wysłany ponownie!"})]}),e.jsxs(v,{variant:"outline",onClick:w,disabled:r,className:"w-full sm:w-auto",children:[r&&e.jsx(nt,{className:"mr-2 h-4 w-4 animate-spin"}),r?"Wysyłanie...":"Wyślij email ponownie"]})]})})}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs(v,{onClick:g,className:"w-full",size:"lg",children:["Przejdź do logowania",e.jsx(is,{className:"ml-2 h-4 w-4"})]}),e.jsx("div",{className:"text-center",children:e.jsx("a",{href:"/help",className:"text-blue-600 hover:text-blue-500 text-sm",children:"Potrzebujesz pomocy? Skontaktuj się z nami"})})]})]})},Wl=[e.jsx(Y,{path:"/login",element:e.jsx(El,{})},"auth-login"),e.jsx(Y,{path:"/register",element:e.jsx(Ml,{})},"auth-register"),e.jsx(Y,{path:"/forgot-password",element:e.jsx(Ll,{})},"auth-forgot-password"),e.jsx(Y,{path:"/update-password",element:e.jsx(Al,{})},"auth-update-password"),e.jsx(Y,{path:"/register/step1",element:e.jsx(Rl,{})},"auth-register-1"),e.jsx(Y,{path:"/register/step2",element:e.jsx(Fl,{})},"auth-register-2"),e.jsx(Y,{path:"/register/step3",element:e.jsx(Il,{})},"auth-register-3"),e.jsx(Y,{path:"/register/step4",element:e.jsx(Ol,{})},"auth-register-4")],$l=()=>{const[s,a]=o.useState(!1),[t,r]=o.useState(!1);o.useEffect(()=>{if(localStorage.getItem("disclaimerAccepted")==="true")r(!0);else{const u=setTimeout(()=>{a(!0)},100);return()=>clearTimeout(u)}},[]);const i=()=>{a(!1),r(!0),localStorage.setItem("disclaimerAccepted","true")},n=()=>{localStorage.removeItem("disclaimerAccepted"),window.location.href="https://www.google.com"};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed z-40 bottom-0 left-0 right-0 bg-purple-600 text-purple-50 px-4 py-2 cursor-pointer hover:bg-purple-700 transition-colors duration-300",onClick:()=>a(!0),children:e.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-light tracking-wide",children:"DANCEHUB (SYSTEM DEMONSTRACYJNY). Informacja o przetwarzaniu danych osobowych"})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-purple-900 bg-opacity-40 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-pink-50 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl border border-pink-100",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("h2",{className:"text-2xl font-light text-purple-800 tracking-tight",children:[e.jsx(ze,{className:"inline-block mr-2 mb-1 text-purple-600",size:24}),"Informacja o danych osobowych"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-purple-100 border border-purple-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-purple-900 mb-2",children:"System demonstracyjno-biznesowy"}),e.jsx("p",{className:"text-purple-700 mb-2 text-sm",children:"Zalecamy używanie danych fikcyjnych:"}),e.jsxs("ul",{className:"list-disc list-inside text-purple-600 space-y-1 ml-4 text-sm",children:[e.jsx("li",{children:"Email: np. demo@example.com"}),e.jsx("li",{children:"Imię/Pseudonim: wymyślone"}),e.jsx("li",{children:"Miasto: fikcyjne"}),e.jsx("li",{children:"Wiek i wzrost: dowolne liczby"})]})]}),e.jsxs("div",{className:"bg-pink-100 border border-pink-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-purple-900 mb-2",children:"Jakie dane zbieramy?"}),e.jsx("p",{className:"text-purple-700 mb-2 text-sm",children:"W ramach tego systemu przechowujemy następujące informacje:"}),e.jsxs("ul",{className:"list-disc list-inside text-purple-600 space-y-1 ml-4 text-sm",children:[e.jsx("li",{children:"Adres email"}),e.jsx("li",{children:"Miasto zamieszkania"}),e.jsx("li",{children:"Imię i nazwisko lub pseudonim"}),e.jsx("li",{children:"Wiek"}),e.jsx("li",{children:"Wzrost"})]})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-purple-900 mb-2",children:"Bezpieczeństwo danych"}),e.jsx("p",{className:"text-purple-700 text-sm",children:"System został zabezpieczony zgodnie z najlepszymi praktykami. Twoje dane są przechowywane w bezpieczny sposób i wykorzystywane wyłącznie do celów funkcjonowania aplikacji."})]}),e.jsxs("div",{className:"bg-pink-50 border border-pink-100 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-purple-800 mb-2",children:"Cel przetwarzania"}),e.jsx("p",{className:"text-purple-600 text-sm",children:"Dane są wykorzystywane do personalizacji doświadczeń użytkownika, umożliwienia komunikacji oraz zapewnienia prawidłowego funkcjonowania systemu. Nie udostępniamy danych osobom trzecim bez Twojej zgody."})]}),e.jsxs("div",{className:"bg-pink-50 border border-pink-100 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-purple-800 mb-2",children:"Twoje prawa"}),e.jsx("p",{className:"text-purple-600 text-sm",children:"Masz prawo do dostępu, modyfikacji oraz usunięcia swoich danych osobowych. W przypadku pytań dotyczących przetwarzania danych, skontaktuj się z administratorem systemu."})]}),e.jsxs("div",{className:"bg-rose-100 border border-rose-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-rose-900 mb-2",children:"Wyłączenie odpowiedzialności"}),e.jsxs("p",{className:"text-rose-700 text-sm",children:["Jako system demonstracyjno-biznesowy, ",e.jsx("strong",{className:"text-rose-800",children:"nie ponosimy odpowiedzialności"})," za jakiekolwiek skutki wynikające z używania prawdziwych danych osobowych. Użytkownik korzysta z systemu na własną odpowiedzialność."]})]}),!t&&e.jsx("div",{className:"bg-purple-100 border border-purple-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-purple-700",children:[e.jsx("strong",{className:"text-purple-800",children:"Uwaga:"})," Ten komunikat pojawia się przy pierwszym uruchomieniu aplikacji. Możesz go ponownie otworzyć klikając na pasek informacyjny u dołu strony."]})}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{onClick:i,className:"flex-1 bg-purple-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-purple-700 transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:"Rozumiem i akceptuję"}),e.jsx("button",{onClick:n,className:"flex-1 bg-pink-200 text-purple-800 px-6 py-3 rounded-lg font-medium hover:bg-pink-300 transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:"Nie akceptuję"})]})]})]})})})]})},ql=()=>{const[s,a]=o.useState(0),[t,r]=o.useState(""),i=Ce();o.useEffect(()=>{const m=()=>a(window.scrollY);return window.addEventListener("scroll",m),()=>window.removeEventListener("scroll",m)},[]);const n=[{icon:ve,title:"WYDARZENIA TANECZNE",desc:"Twórz i odkrywaj wydarzenia w klubach, szkołach tańca i plenerze",features:["Imprezy klubowe","Warsztaty taneczne","Eventy plenerowe"],color:"from-purple-500/20 to-purple-600/10"},{icon:ns,title:"SYSTEM GAMIFIKACJI",desc:"Zdobywaj punkty, odznaki i awansuj w rankingu tancerzy",features:["Poziomy doświadczenia","Wyzwania tygodniowe","Nagrody społeczności"],color:"from-amber-500/20 to-amber-600/10"},{icon:se,title:"SPOŁECZNOŚĆ TRENERSKA",desc:"Ucz się od najlepszych lub dziel się swoją wiedzą",features:["Lekcje indywidualne","Grupy treningowe","Mentoring online"],color:"from-blue-500/20 to-blue-600/10"}],c=[{day:"Pon",aktywni:1240,wydarzenia:45},{day:"Wto",aktywni:1650,wydarzenia:62},{day:"Śro",aktywni:1480,wydarzenia:51},{day:"Czw",aktywni:1890,wydarzenia:78},{day:"Pią",aktywni:2450,wydarzenia:125},{day:"Sob",aktywni:3200,wydarzenia:186},{day:"Nie",aktywni:2800,wydarzenia:142}],u=({active:m,payload:p,label:w})=>m&&p&&p.length?e.jsxs("div",{className:"bg-background border rounded-lg shadow-lg p-3",children:[e.jsx("p",{className:"font-medium",children:w}),e.jsxs("p",{className:"text-sm text-primary",children:["Aktywni: ",p[0].value]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Wydarzenia: ",p[0].payload.wydarzenia]})]}):null;return e.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[e.jsx($l,{}),e.jsx("nav",{className:"fixed  top-0 w-full z-30 bg-background/80 backdrop-blur-lg border-b",children:e.jsxs("div",{className:"container mx-auto px-6 py-5 flex justify-between items-center",children:[e.jsxs("div",{className:"text-2xl font-black tracking-tighter flex items-center gap-2",children:[e.jsx(Ne,{className:"w-6 h-6 text-primary"}),"DANCE HUB",e.jsx("span",{className:"text-primary",children:"."})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-8",children:[e.jsx(v,{variant:"ghost",className:"text-sm font-medium",children:"Funkcje"}),e.jsx(v,{variant:"ghost",className:"text-sm font-medium",children:"Społeczność"}),e.jsx(v,{variant:"ghost",className:"text-sm font-medium",children:"Wydarzenia"}),e.jsxs(v,{variant:"default",size:"sm",onClick:()=>i("/register"),children:["Dołącz teraz ",e.jsx(is,{className:"ml-2 h-4 w-4"})]})]})]})}),e.jsxs("section",{className:"relative min-h-screen flex items-center pt-20",children:[e.jsx("div",{className:"absolute inset-0 opacity-5 pointer-events-none",style:{backgroundImage:`linear-gradient(to right, currentColor .25px, transparent 1px),
                              linear-gradient(to bottom, currentColor .25px, transparent 1px)`,backgroundSize:"4rem 4rem"}}),e.jsx("div",{className:"container mx-auto px-6 z-20",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-16 items-center",children:[e.jsxs("div",{children:[e.jsxs(R,{className:"mb-8",variant:"secondary",children:[e.jsx(ge,{className:"mr-2 h-3 w-3"}),"Dla pasjonatów tańca"]}),e.jsxs("h1",{className:"text-5xl md:text-6xl lg:text-7xl font-black tracking-tighter leading-none mb-8",children:["TWOJA",e.jsx("br",{}),e.jsx("span",{className:"text-primary",children:"TANECZNA"}),e.jsx("br",{}),"SPOŁECZNOŚĆ"]}),e.jsx("p",{className:"text-xl text-muted-foreground mb-10 max-w-xl",children:"Odkryj wydarzenia, ucz się od najlepszych, znajdź idealnego partnera tanecznego. Dołącz do platformy, która łączy tancerzy z całej Polski."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-10",children:[e.jsx(q,{type:"email",placeholder:"twoj@email.pl",value:t,onChange:m=>r(m.target.value),className:"flex-1 h-14 px-5 text-base"}),e.jsxs(v,{size:"lg",className:"h-14 px-8 font-bold text-base",children:["Rozpocznij przygodę ",e.jsx(is,{className:"ml-2"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-8 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"15k+ tancerzy"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{children:"500+ wydarzeń/mies."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx("span",{children:"System dopasowań"})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/20 to-primary/5 blur-3xl rounded-3xl",style:{transform:`translateY(${s*.1}px)`}}),e.jsx(L,{className:"relative border shadow-2xl",children:e.jsxs(O,{className:"p-0",children:[e.jsx("div",{className:"border-b px-6 py-4 bg-muted/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm font-semibold",children:"Dance Hub"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"twoj.profil"})]})}),e.jsxs("div",{className:"p-8",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-6 flex items-center gap-2",children:[e.jsx(ns,{className:"w-5 h-5 text-amber-500"}),"Twój Dashboard"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:"42"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Wydarzenia"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-500",children:"Lvl 8"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Poziom"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:"127"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Znajomi"})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-4 text-muted-foreground",children:"Aktywność społeczności"}),e.jsx(ci,{width:"100%",height:200,children:e.jsxs(di,{data:c,children:[e.jsx(mi,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(xi,{dataKey:"day",tick:{fontSize:12},tickLine:!1}),e.jsx(ui,{tick:{fontSize:12},tickLine:!1,axisLine:!1}),e.jsx(hi,{content:e.jsx(u,{}),cursor:{fill:"transparent"}}),e.jsx(pi,{dataKey:"aktywni",fill:"hsl(var(--primary))",radius:[8,8,0,0]})]})})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"w-4 h-4 text-primary"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Salsa Night"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Klub Proxima, dziś 20:00"})]})]}),e.jsx(R,{variant:"secondary",className:"text-xs",children:"23 osoby"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ie,{className:"w-4 h-4 text-amber-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Workshop: Bachata"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Studio Dance, sob 14:00"})]})]}),e.jsx(R,{variant:"secondary",className:"text-xs",children:"8 miejsc"})]})]})]})]})})]})]})})]}),e.jsx("section",{className:"py-32 bg-muted/20",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-20",children:[e.jsxs(R,{className:"mb-6",variant:"outline",children:[e.jsx(Oe,{className:"mr-2 h-3 w-3"}),"Wszystko w jednym miejscu"]}),e.jsxs("h2",{className:"text-4xl md:text-5xl font-black tracking-tight mb-6",children:["PLATFORMA DLA ",e.jsx("span",{className:"text-primary",children:"TANCERZY"})]}),e.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:"Kompleksowe rozwiązanie dla społeczności tanecznej"})]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:n.map((m,p)=>e.jsxs(L,{className:"relative overflow-hidden border hover:shadow-lg transition-all duration-300",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${m.color} opacity-30`}),e.jsxs(O,{className:"relative p-8",children:[e.jsx(m.icon,{className:"w-12 h-12 text-primary mb-6"}),e.jsx("h3",{className:"text-2xl font-bold mb-4",children:m.title}),e.jsx("p",{className:"text-muted-foreground mb-6",children:m.desc}),e.jsx("div",{className:"space-y-3",children:m.features.map((w,g)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Te,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm",children:w})]},g))})]})]},p))}),e.jsx(L,{className:"mt-12 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-pink-500/10 to-purple-500/10",children:e.jsxs(O,{className:"p-12 text-center",children:[e.jsx(ge,{className:"w-16 h-16 text-primary mx-auto mb-6"}),e.jsxs("h3",{className:"text-3xl font-bold mb-4",children:["ZNAJDŹ IDEALNEGO ",e.jsx("span",{className:"text-primary",children:"PARTNERA"})]}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Nasz inteligentny system dopasowań pomoże Ci znaleźć osobę o podobnym poziomie umiejętności, preferencjach muzycznych i dostępności czasowej. Taniec we dwoje nigdy nie był prostszy!"})]})})})]})}),e.jsx("section",{className:"py-32",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"max-w-4xl",children:[e.jsxs("h2",{className:"text-4xl md:text-5xl font-black tracking-tight mb-20",children:["JAK TO ",e.jsx("span",{className:"text-primary",children:"DZIAŁA"})]}),e.jsx("div",{className:"space-y-16",children:[{num:"01",title:"STWÓRZ PROFIL",desc:"Opisz swoje umiejętności, style tańca i cele. System gamifikacji rozpocznie śledzenie Twoich postępów."},{num:"02",title:"ODKRYWAJ WYDARZENIA",desc:"Przeglądaj imprezy w klubach, warsztaty w szkołach tańca i spontaniczne spotkania plenerowe."},{num:"03",title:"UCZ SIĘ I UCZ INNYCH",desc:"Dołącz do lekcji prowadzonych przez doświadczonych tancerzy lub sam zostań trenerem."},{num:"04",title:"BUDUJ SPOŁECZNOŚĆ",desc:"Poznawaj nowych ludzi, znajduj partnerów tanecznych i rozwijaj swoją pasję razem z innymi."}].map((m,p)=>e.jsxs("div",{className:"flex gap-8 items-start",children:[e.jsx("div",{className:"text-6xl font-black text-muted-foreground/20 w-24 flex-shrink-0",children:m.num}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-2xl font-bold mb-3",children:m.title}),e.jsx("p",{className:"text-lg text-muted-foreground",children:m.desc})]})]},p))})]})})}),e.jsx("section",{className:"py-32 bg-muted/20",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[{icon:se,value:"15k+",label:"AKTYWNYCH TANCERZY",desc:"Rosnąca społeczność pasjonatów"},{icon:ve,value:"500+",label:"WYDARZEŃ MIESIĘCZNIE",desc:"W całej Polsce"},{icon:bs,value:"4.8/5",label:"OCENA APLIKACJI",desc:"Od naszych użytkowników"}].map((m,p)=>e.jsx(L,{className:"text-center border-0 shadow-sm",children:e.jsxs(O,{className:"p-8",children:[e.jsx(m.icon,{className:"w-10 h-10 text-primary mx-auto mb-6"}),e.jsx("div",{className:"text-4xl font-black text-primary mb-2",children:m.value}),e.jsx("div",{className:"text-sm font-semibold uppercase tracking-wider mb-2",children:m.label}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m.desc})]})},p))})})}),e.jsx("section",{className:"py-32",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsx(L,{className:"max-w-4xl mx-auto shadow-xl",children:e.jsxs(O,{className:"p-12 md:p-16 text-center",children:[e.jsxs("h2",{className:"text-3xl md:text-5xl font-black mb-6",children:["ZATAŃCZ Z ",e.jsx("span",{className:"text-primary",children:"NAMI"})]}),e.jsx("p",{className:"text-xl text-muted-foreground mb-10 max-w-2xl mx-auto",children:"Dołącz do największej społeczności tanecznej w Polsce. Pierwsze 30 dni premium gratis!"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8",children:[e.jsx(v,{size:"lg",className:"px-8 py-6 text-lg",onClick:()=>i("/register"),children:"Dołącz za darmo"}),e.jsx(v,{onClick:()=>i("/app-preview"),size:"lg",variant:"outline",className:"px-8 py-6 text-lg",children:"Zobacz aplikację"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bez zobowiązań • Premium 30 dni gratis • Anuluj w każdej chwili"})]})})})}),e.jsx("footer",{className:"border-t",children:e.jsx("div",{className:"container mx-auto px-6 py-12",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-2xl font-black tracking-tighter flex items-center gap-2",children:[e.jsx(Ne,{className:"w-6 h-6 text-primary"}),"DANCE HUBR",e.jsx("span",{className:"text-primary",children:"."})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"© 2025 Dance Hub. Stworzone z pasją dla tańca."})]})})})]})};function Bl(){return e.jsx(gr,{children:e.jsxs(Dr,{dataProvider:Ir(I),liveProvider:Tr(I),authProvider:Bs,routerProvider:Er,resources:[dn,wl,bl,Qi,nn,an,Cl],options:{syncWithLocation:!0,warnWhenUnsavedChanges:!0,useNewQueryKeys:!0,liveMode:"auto"},children:[e.jsxs(wr,{children:[e.jsx(Y,{path:"/",element:e.jsx(ql,{})}),...Wl,e.jsxs(Y,{element:e.jsx(da,{fallback:e.jsx(Lr,{to:"/login"}),children:e.jsx(Hi,{children:e.jsx(yr,{})})},"protected-layout"),children:[e.jsx(Y,{path:"/profiles",element:e.jsx(ps,{to:"/profiles/show",replace:!0})}),...Xi,...tn,...ln,...mn,...yl,...zl,...Pl,"      ",e.jsx(Y,{path:"*",element:e.jsx(Mr,{})})]}),e.jsx(Y,{path:"*",element:e.jsx(da,{fallback:e.jsx(ps,{to:"/login",replace:!0}),children:e.jsx(ps,{to:"/profiles",replace:!0})},"catch-all")})]}),e.jsx(Ar,{}),e.jsx(Rr,{})]})})}const Ul=document.getElementById("root"),Zl=fi.createRoot(Ul);Zl.render(e.jsx(K.StrictMode,{children:e.jsx(Bl,{})}));
